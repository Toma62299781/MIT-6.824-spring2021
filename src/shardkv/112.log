Test: concurrent configuration change and restart...
000'003 29 S100 empty snap
000'004 34 S100 check new config wanted 1
000'004 35 S100 current config num 0 done
000'004 29 S101 empty snap
000'006 29 S102 empty snap
000'008 34 S101 check new config wanted 1
000'009 35 S101 current config num 0 done
000'010 35 S102 current config num 0 done
000'009 29 S200 empty snap
000'013 34 S102 check new config wanted 1
000'017 29 S201 empty snap
000'018 34 S200 check new config wanted 1
000'019 35 S200 current config num 0 done
000'020 29 S202 empty snap
000'020 35 S201 current config num 0 done
000'020 34 S201 check new config wanted 1
000'026 29 S300 empty snap
000'027 29 S301 empty snap
000'028 29 S302 empty snap
000'029 35 S202 current config num 0 done
000'029 34 S300 check new config wanted 1
000'029 35 S300 current config num 0 done
000'029 34 S301 check new config wanted 1
000'029 35 S301 current config num 0 done
000'029 34 S302 check new config wanted 1
000'030 35 S302 current config num 0 done
000'030 34 S202 check new config wanted 1
000'054 35 S100 current config num 0 done
000'060 35 S101 current config num 0 done
000'060 35 S102 current config num 0 done
000'069 35 S200 current config num 0 done
000'070 35 S201 current config num 0 done
000'079 35 S202 current config num 0 done
000'079 35 S300 current config num 0 done
000'080 35 S302 current config num 0 done
000'080 35 S301 current config num 0 done
000'105 35 S100 current config num 0 done
000'110 35 S101 current config num 0 done
000'110 35 S102 current config num 0 done
000'119 35 S200 current config num 0 done
000'122 35 S201 current config num 0 done
labgob warning: Decoding into a non-default variable/field Term may not work
000'130 35 S300 current config num 0 done
000'130 35 S202 current config num 0 done
000'130 35 S302 current config num 0 done
000'130 35 S301 current config num 0 done
000'147 30 S102 nop apply <nil>
000'158 30 S301 nop apply <nil>
000'160 35 S100 current config num 0 done
000'164 35 S101 current config num 0 done
000'164 35 S102 current config num 0 done
000'169 35 S200 current config num 0 done
000'172 35 S201 current config num 0 done
join &{map[100:[server-100-0 server-100-1 server-100-2]] 1074585914363486070 0}
join &{map[100:[server-100-0 server-100-1 server-100-2]] 1074585914363486070 0}
000'182 35 S302 current config num 0 done
000'182 35 S300 current config num 0 done
000'182 35 S202 current config num 0 done
join &{map[100:[server-100-0 server-100-1 server-100-2]] 1074585914363486070 0}
000'188 35 S301 current config num 0 done
000'193 44 S2 ctrler change to config &{1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
000'196 44 S1 ctrler change to config &{1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
000'210 35 S100 current config num 0 done
000'213 30 S200 nop apply <nil>
000'214 35 S101 current config num 0 done
000'214 35 S102 current config num 0 done
000'219 35 S200 current config num 0 done
000'224 35 S201 current config num 0 done
000'232 35 S202 current config num 0 done
000'232 34 S100 got new config {1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 0
000'233 35 S302 current config num 0 done
000'233 35 S300 current config num 0 done
000'233 34 S101 got new config {1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 0
000'233 44 S0 ctrler change to config &{1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
000'238 35 S301 current config num 0 done
000'260 35 S100 current config num 0 done
000'269 35 S101 current config num 0 done
000'269 35 S102 current config num 0 done
000'269 35 S200 current config num 0 done
000'274 35 S201 current config num 0 done
000'276 34 S102 check new config wanted 1
000'277 34 S302 check new config wanted 1
000'277 34 S200 check new config wanted 1
000'282 35 S202 current config num 0 done
000'283 35 S302 current config num 0 done
000'283 35 S300 current config num 0 done
000'287 34 S202 check new config wanted 1
000'289 34 S301 check new config wanted 1
000'289 35 S301 current config num 0 done
000'289 34 S300 check new config wanted 1
000'293 34 S201 check new config wanted 1
000'310 34 S201 got new config {1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 0
000'313 34 S200 got new config {1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 0
000'314 34 S200 propose new config 1
000'314 34 S302 got new config {1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 0
000'315 34 S102 got new config {1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 0
000'315 34 S102 propose new config 1
000'316 35 S100 current config num 0 done
000'316 34 S301 got new config {1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 0
000'317 34 S301 propose new config 1
000'317 34 S300 got new config {1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 0
000'318 34 S202 got new config {1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 0
000'320 35 S200 current config num 0 done
000'320 35 S102 current config num 0 done
000'320 35 S101 current config num 0 done
000'325 28 S100 do request args:Key 0 type 2 num 1 Client 2079820695267196558 Seq 0 
000'325 28 S100 [558--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
000'325 30 S201 nop apply <nil>
000'331 31 S201 used size: 417 / 300 
000'332 29 S201 do snapshot for raft 1 1,size 356
000'332 27 S1 raft apply snapshot offset 1 ,lastApplied 1,total log 2, size 416,log cap:2
000'333 31 S201 after snap shot size416 356
000'333 34 S100 check new config wanted 1
000'333 30 S100 nop apply <nil>
000'333 35 S201 current config num 0 done
000'325 30 S200 apply index 2 key num 0 type 4   lastApplied 1
000'333 30 S101 nop apply <nil>
000'333 31 S101 used size: 417 / 300 
000'333 34 S200 apply new config num 1 :&{1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{0 [0 0 0 0 0 0 0 0 0 0] map[]}
000'334 34 S200 inited need send [],need recv []
000'334 31 S200 used size: 417 / 300 
000'334 29 S101 do snapshot for raft 1 1,size 356
000'334 29 S200 do snapshot for raft 2 2,size 412
000'334 27 S0 raft apply snapshot offset 2 ,lastApplied 2,total log 2, size 82,log cap:1
000'334 31 S200 after snap shot size82 412
000'327 30 S302 nop apply <nil>
000'335 31 S302 used size: 417 / 300 
000'335 27 S1 raft apply snapshot offset 1 ,lastApplied 1,total log 2, size 416,log cap:2
000'335 31 S101 after snap shot size416 356
000'333 31 S100 used size: 417 / 300 
000'335 30 S102 apply index 2 key num 0 type 4   lastApplied 1
000'335 29 S100 do snapshot for raft 1 1,size 356
000'335 34 S102 apply new config num 1 :&{1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{0 [0 0 0 0 0 0 0 0 0 0] map[]}
000'335 34 S102 inited need send [],need recv []
000'335 31 S102 used size: 417 / 300 
000'336 27 S0 raft apply snapshot offset 1 ,lastApplied 1,total log 2, size 416,log cap:2
000'336 31 S100 after snap shot size416 356
000'330 30 S300 nop apply <nil>
000'336 31 S300 used size: 417 / 300 
000'336 29 S102 do snapshot for raft 2 2,size 412
000'336 27 S2 raft apply snapshot offset 2 ,lastApplied 2,total log 2, size 82,log cap:1
000'336 31 S102 after snap shot size82 412
000'330 30 S202 nop apply <nil>
000'336 31 S202 used size: 417 / 300 
000'336 29 S300 do snapshot for raft 1 1,size 356
000'337 29 S202 do snapshot for raft 1 1,size 356
000'337 27 S2 raft apply snapshot offset 1 ,lastApplied 1,total log 2, size 416,log cap:2
000'337 31 S202 after snap shot size416 356
000'337 35 S202 current config num 0 done
000'338 34 S101 check new config wanted 1
000'341 29 S302 do snapshot for raft 1 1,size 356
000'341 27 S2 raft apply snapshot offset 1 ,lastApplied 1,total log 2, size 416,log cap:2
000'341 31 S302 after snap shot size416 356
000'328 30 S301 apply index 2 key num 0 type 4   lastApplied 1
000'341 34 S301 apply new config num 1 :&{1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{0 [0 0 0 0 0 0 0 0 0 0] map[]}
000'341 34 S301 inited need send [],need recv []
000'342 31 S301 used size: 417 / 300 
000'342 29 S301 do snapshot for raft 2 2,size 412
000'342 27 S1 raft apply snapshot offset 2 ,lastApplied 2,total log 2, size 82,log cap:1
000'342 31 S301 after snap shot size82 412
000'342 35 S302 current config num 0 done
000'342 35 S301 current config num 1 done
000'344 27 S0 raft apply snapshot offset 1 ,lastApplied 1,total log 2, size 416,log cap:2
000'344 31 S300 after snap shot size416 356
000'345 35 S300 current config num 0 done
000'351 34 S100 got new config {1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 0
000'351 34 S101 got new config {1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 0
000'366 35 S100 current config num 0 done
000'370 35 S102 current config num 1 done
000'370 35 S200 current config num 1 done
000'370 35 S101 current config num 0 done
000'383 35 S201 current config num 0 done
000'388 35 S202 current config num 0 done
000'393 35 S302 current config num 0 done
000'393 35 S301 current config num 1 done
000'395 35 S300 current config num 0 done
000'410 34 S201 check new config wanted 1
000'414 34 S200 check new config wanted 2
000'414 34 S302 check new config wanted 1
000'416 34 S102 check new config wanted 2
000'417 35 S100 current config num 0 done
000'417 34 S301 check new config wanted 2
000'420 34 S202 check new config wanted 1
000'420 34 S300 check new config wanted 1
000'424 35 S102 current config num 1 done
000'424 35 S200 current config num 1 done
000'424 35 S101 current config num 0 done
000'433 34 S302 got new config {1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 0
000'435 35 S201 current config num 0 done
000'435 34 S201 got new config {1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 0
000'440 35 S202 current config num 0 done
000'444 30 S101 apply index 2 key num 0 type 4   lastApplied 1
000'444 34 S101 apply new config num 1 :&{1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{0 [0 0 0 0 0 0 0 0 0 0] map[]}
000'444 34 S101 inited need send [],need recv []
000'444 31 S101 used size: 416 / 300 
000'445 35 S301 current config num 1 done
000'445 29 S101 do snapshot for raft 2 2,size 412
000'449 27 S1 raft apply snapshot offset 2 ,lastApplied 2,total log 2, size 82,log cap:1
000'449 31 S101 after snap shot size82 412
000'451 34 S100 check new config wanted 1
000'453 35 S302 current config num 0 done
000'453 34 S101 check new config wanted 2
000'454 35 S300 current config num 0 done
000'457 30 S100 apply index 2 key num 0 type 4   lastApplied 1
000'457 34 S100 apply new config num 1 :&{1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{0 [0 0 0 0 0 0 0 0 0 0] map[]}
000'457 34 S100 inited need send [],need recv []
000'457 31 S100 used size: 416 / 300 
000'458 29 S100 do snapshot for raft 2 2,size 412
000'458 27 S0 raft apply snapshot offset 2 ,lastApplied 2,total log 2, size 82,log cap:1
000'458 31 S100 after snap shot size82 412
000'465 34 S202 got new config {1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 0
000'466 34 S300 got new config {1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 0
000'468 35 S100 current config num 1 done
000'476 35 S101 current config num 1 done
000'476 35 S102 current config num 1 done
000'476 35 S200 current config num 1 done
000'478 30 S302 apply index 2 key num 0 type 4   lastApplied 1
000'478 34 S302 apply new config num 1 :&{1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{0 [0 0 0 0 0 0 0 0 0 0] map[]}
000'479 34 S302 inited need send [],need recv []
000'479 31 S302 used size: 416 / 300 
000'480 29 S302 do snapshot for raft 2 2,size 412
000'480 27 S2 raft apply snapshot offset 2 ,lastApplied 2,total log 2, size 82,log cap:1
000'480 31 S302 after snap shot size82 412
000'480 30 S300 apply index 2 key num 0 type 4   lastApplied 1
000'480 34 S300 apply new config num 1 :&{1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{0 [0 0 0 0 0 0 0 0 0 0] map[]}
000'480 34 S300 inited need send [],need recv []
000'480 31 S300 used size: 416 / 300 
000'485 35 S201 current config num 0 done
000'486 29 S300 do snapshot for raft 2 2,size 412
000'486 27 S0 raft apply snapshot offset 2 ,lastApplied 2,total log 2, size 82,log cap:1
000'486 31 S300 after snap shot size82 412
000'487 28 S100 do request args:Key 0 type 2 num 1 Client 2079820695267196558 Seq 0 
000'487 28 S100 declined [558--0] for not leader
000'487 28 S100 [558--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'488 34 S100 got new config {1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 0
000'489 28 S101 do request args:Key 0 type 2 num 1 Client 2079820695267196558 Seq 0 
000'489 28 S101 declined [558--0] for not leader
000'489 28 S101 [558--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'490 28 S102 do request args:Key 0 type 2 num 1 Client 2079820695267196558 Seq 0 
000'490 33 S102 start [558--0] as leader?
000'491 35 S202 current config num 0 done
000'495 35 S301 current config num 1 done
000'496 30 S102 apply index 3 key0 num 1 type 2   lastApplied 2
000'496 28 S102 [558--0] successed
000'496 28 S102 [558--0] ok 
000'497 28 S102 [558--0] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'497 36 S558 [0] clerk putAppend okkkkk
000'497 28 S100 do request args:Key 1 type 2 num 1 Client 2079820695267196558 Seq 1 
000'497 28 S100 declined [558--1] for not leader
000'497 28 S100 [558--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'499 28 S101 do request args:Key 1 type 2 num 1 Client 2079820695267196558 Seq 1 
000'499 28 S101 declined [558--1] for not leader
000'499 28 S101 [558--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'500 28 S102 do request args:Key 1 type 2 num 1 Client 2079820695267196558 Seq 1 
000'500 33 S102 start [558--1] as leader?
000'503 35 S302 current config num 1 done
000'504 35 S300 current config num 1 done
000'506 30 S102 apply index 4 key1 num 1 type 2   lastApplied 3
000'506 28 S102 [558--1] successed
000'506 28 S102 [558--1] ok 
000'506 28 S102 [558--1] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'506 30 S100 apply index 3 key0 num 1 type 2   lastApplied 2
000'507 36 S558 [1] clerk putAppend okkkkk
000'507 30 S101 apply index 3 key0 num 1 type 2   lastApplied 2
000'507 28 S100 do request args:Key 2 type 2 num 1 Client 2079820695267196558 Seq 2 
000'507 28 S100 declined [558--2] for not leader
000'507 28 S100 [558--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'508 28 S101 do request args:Key 2 type 2 num 1 Client 2079820695267196558 Seq 2 
000'508 28 S101 declined [558--2] for not leader
000'508 28 S101 [558--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'509 28 S102 do request args:Key 2 type 2 num 1 Client 2079820695267196558 Seq 2 
000'510 33 S102 start [558--2] as leader?
000'513 30 S202 apply index 2 key num 0 type 4   lastApplied 1
000'513 34 S202 apply new config num 1 :&{1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{0 [0 0 0 0 0 0 0 0 0 0] map[]}
000'513 34 S202 inited need send [],need recv []
000'513 31 S202 used size: 416 / 300 
000'513 30 S201 apply index 2 key num 0 type 4   lastApplied 1
000'513 34 S201 apply new config num 1 :&{1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{0 [0 0 0 0 0 0 0 0 0 0] map[]}
000'513 34 S201 inited need send [],need recv []
000'513 31 S201 used size: 416 / 300 
000'515 29 S202 do snapshot for raft 2 2,size 412
000'515 27 S2 raft apply snapshot offset 2 ,lastApplied 2,total log 2, size 82,log cap:1
000'515 31 S202 after snap shot size82 412
000'517 30 S100 apply index 4 key1 num 1 type 2   lastApplied 3
000'517 31 S100 used size: 346 / 300 
000'517 29 S100 do snapshot for raft 4 4,size 440
000'517 30 S101 apply index 4 key1 num 1 type 2   lastApplied 3
000'517 31 S101 used size: 346 / 300 
000'517 27 S0 raft apply snapshot offset 4 ,lastApplied 4,total log 5, size 223,log cap:2
000'518 31 S100 after snap shot size223 440
000'518 30 S102 apply index 5 key2 num 1 type 2   lastApplied 4
000'518 31 S102 used size: 346 / 300 
000'518 29 S101 do snapshot for raft 4 4,size 440
000'518 27 S1 raft apply snapshot offset 4 ,lastApplied 4,total log 5, size 223,log cap:2
000'518 31 S101 after snap shot size223 440
000'518 35 S100 current config num 1 done
000'518 29 S102 do snapshot for raft 5 5,size 454
000'519 27 S2 raft apply snapshot offset 5 ,lastApplied 5,total log 5, size 82,log cap:1
000'519 31 S102 after snap shot size82 454
000'519 28 S102 [558--2] successed
000'519 28 S102 [558--2] ok 
000'519 28 S102 [558--2] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'519 36 S558 [2] clerk putAppend okkkkk
000'520 28 S100 do request args:Key 3 type 2 num 1 Client 2079820695267196558 Seq 3 
000'520 28 S100 declined [558--3] for not leader
000'520 28 S100 [558--3] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'521 29 S201 do snapshot for raft 2 2,size 412
000'521 27 S1 raft apply snapshot offset 2 ,lastApplied 2,total log 2, size 82,log cap:1
000'521 31 S201 after snap shot size82 412
000'521 28 S101 do request args:Key 3 type 2 num 1 Client 2079820695267196558 Seq 3 
000'521 28 S101 declined [558--3] for not leader
000'521 28 S101 [558--3] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'522 28 S102 do request args:Key 3 type 2 num 1 Client 2079820695267196558 Seq 3 
000'523 33 S102 start [558--3] as leader?
000'526 35 S101 current config num 1 done
000'526 35 S102 current config num 1 done
000'528 30 S100 apply index 5 key2 num 1 type 2   lastApplied 4
000'529 30 S102 apply index 6 key3 num 1 type 2   lastApplied 5
000'529 28 S102 [558--3] successed
000'529 28 S102 [558--3] ok 
000'529 28 S102 [558--3] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'529 30 S101 apply index 5 key2 num 1 type 2   lastApplied 4
000'529 36 S558 [3] clerk putAppend okkkkk
000'529 35 S200 current config num 1 done
000'530 28 S100 do request args:Key 4 type 2 num 1 Client 2079820695267196558 Seq 4 
000'530 28 S100 declined [558--4] for not leader
000'530 28 S100 [558--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'531 28 S101 do request args:Key 4 type 2 num 1 Client 2079820695267196558 Seq 4 
000'531 28 S101 declined [558--4] for not leader
000'531 28 S101 [558--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'532 28 S102 do request args:Key 4 type 2 num 1 Client 2079820695267196558 Seq 4 
000'533 33 S102 start [558--4] as leader?
000'534 34 S302 check new config wanted 2
000'536 34 S201 check new config wanted 2
000'541 35 S201 current config num 1 done
000'542 35 S202 current config num 1 done
000'542 30 S100 apply index 6 key3 num 1 type 2   lastApplied 5
000'542 31 S100 used size: 348 / 300 
000'543 29 S100 do snapshot for raft 6 6,size 468
000'543 27 S0 raft apply snapshot offset 6 ,lastApplied 6,total log 7, size 223,log cap:2
000'543 31 S100 after snap shot size223 468
000'543 30 S102 apply index 7 key4 num 1 type 2   lastApplied 6
000'544 28 S102 [558--4] successed
000'544 28 S102 [558--4] ok 
000'544 28 S102 [558--4] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'545 36 S558 [4] clerk putAppend okkkkk
000'546 28 S100 do request args:Key 5 type 2 num 1 Client 2079820695267196558 Seq 5 
000'546 28 S100 declined [558--5] for not leader
000'546 28 S100 [558--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'547 35 S301 current config num 1 done
000'551 28 S101 do request args:Key 5 type 2 num 1 Client 2079820695267196558 Seq 5 
000'551 28 S101 declined [558--5] for not leader
000'551 28 S101 [558--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'555 35 S302 current config num 1 done
000'556 34 S200 check new config wanted 2
000'556 34 S301 check new config wanted 2
000'557 35 S300 current config num 1 done
000'558 28 S102 do request args:Key 5 type 2 num 1 Client 2079820695267196558 Seq 5 
000'561 30 S101 apply index 6 key3 num 1 type 2   lastApplied 5
000'561 31 S101 used size: 348 / 300 
000'561 29 S101 do snapshot for raft 6 6,size 468
000'562 27 S1 raft apply snapshot offset 6 ,lastApplied 6,total log 7, size 223,log cap:2
000'562 31 S101 after snap shot size223 468
000'567 34 S300 check new config wanted 2
000'569 35 S100 current config num 1 done
000'569 34 S202 check new config wanted 2
000'580 35 S101 current config num 1 done
000'583 35 S200 current config num 1 done
000'584 33 S102 start [558--5] as leader?
000'584 34 S102 check new config wanted 2
000'584 35 S102 current config num 1 done
000'590 34 S100 check new config wanted 2
000'592 34 S101 check new config wanted 2
000'593 35 S201 current config num 1 done
000'594 35 S202 current config num 1 done
000'597 30 S100 apply index 7 key4 num 1 type 2   lastApplied 6
000'597 30 S102 apply index 8 key5 num 1 type 2   lastApplied 7
000'598 31 S102 used size: 348 / 300 
000'598 29 S102 do snapshot for raft 8 8,size 497
000'598 27 S2 raft apply snapshot offset 8 ,lastApplied 8,total log 8, size 82,log cap:1
000'598 31 S102 after snap shot size82 497
000'598 28 S102 [558--5] successed
000'598 28 S102 [558--5] ok 
000'599 28 S102 [558--5] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'599 36 S558 [5] clerk putAppend okkkkk
000'599 35 S301 current config num 1 done
000'600 28 S100 do request args:Key 6 type 2 num 1 Client 2079820695267196558 Seq 6 
000'601 28 S100 declined [558--6] for not leader
000'601 28 S100 [558--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'604 30 S101 apply index 7 key4 num 1 type 2   lastApplied 6
000'605 28 S101 do request args:Key 6 type 2 num 1 Client 2079820695267196558 Seq 6 
000'605 28 S101 declined [558--6] for not leader
000'605 28 S101 [558--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'607 28 S102 do request args:Key 6 type 2 num 1 Client 2079820695267196558 Seq 6 
000'607 33 S102 start [558--6] as leader?
000'607 35 S302 current config num 1 done
000'607 35 S300 current config num 1 done
000'617 30 S101 apply index 8 key5 num 1 type 2   lastApplied 7
000'617 31 S101 used size: 348 / 300 
000'618 29 S101 do snapshot for raft 8 8,size 497
000'620 27 S1 raft apply snapshot offset 8 ,lastApplied 8,total log 9, size 223,log cap:2
000'620 31 S101 after snap shot size223 497
000'620 30 S102 apply index 9 key6 num 1 type 2   lastApplied 8
000'621 28 S102 [558--6] successed
000'621 28 S102 [558--6] ok 
000'621 28 S102 [558--6] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'621 30 S100 apply index 8 key5 num 1 type 2   lastApplied 7
000'621 31 S100 used size: 348 / 300 
000'622 29 S100 do snapshot for raft 8 8,size 497
000'622 27 S0 raft apply snapshot offset 8 ,lastApplied 8,total log 9, size 223,log cap:2
000'622 31 S100 after snap shot size223 497
000'623 36 S558 [6] clerk putAppend okkkkk
000'624 28 S100 do request args:Key 7 type 2 num 1 Client 2079820695267196558 Seq 7 
000'624 28 S100 declined [558--7] for not leader
000'624 28 S100 [558--7] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'627 35 S100 current config num 1 done
000'629 28 S101 do request args:Key 7 type 2 num 1 Client 2079820695267196558 Seq 7 
000'629 28 S101 declined [558--7] for not leader
000'629 28 S101 [558--7] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'630 35 S101 current config num 1 done
000'631 28 S102 do request args:Key 7 type 2 num 1 Client 2079820695267196558 Seq 7 
000'631 33 S102 start [558--7] as leader?
000'634 35 S200 current config num 1 done
000'635 35 S102 current config num 1 done
000'637 30 S100 apply index 9 key6 num 1 type 2   lastApplied 8
000'637 30 S102 apply index 10 key7 num 1 type 2   lastApplied 9
000'637 28 S102 [558--7] successed
000'637 28 S102 [558--7] ok 
000'637 28 S102 [558--7] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'637 30 S101 apply index 9 key6 num 1 type 2   lastApplied 8
000'638 36 S558 [7] clerk putAppend okkkkk
000'638 28 S100 do request args:Key 8 type 2 num 1 Client 2079820695267196558 Seq 8 
000'638 28 S100 declined [558--8] for not leader
000'638 28 S100 [558--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'639 28 S101 do request args:Key 8 type 2 num 1 Client 2079820695267196558 Seq 8 
000'639 28 S101 declined [558--8] for not leader
000'639 28 S101 [558--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'640 28 S102 do request args:Key 8 type 2 num 1 Client 2079820695267196558 Seq 8 
000'641 33 S102 start [558--8] as leader?
000'644 35 S202 current config num 1 done
000'644 35 S201 current config num 1 done
000'647 30 S100 apply index 10 key7 num 1 type 2   lastApplied 9
000'647 31 S100 used size: 348 / 300 
000'648 29 S100 do snapshot for raft 10 10,size 525
000'648 27 S0 raft apply snapshot offset 10 ,lastApplied 10,total log 11, size 223,log cap:2
000'648 31 S100 after snap shot size223 525
000'648 30 S102 apply index 11 key8 num 1 type 2   lastApplied 10
000'648 31 S102 used size: 348 / 300 
000'649 29 S102 do snapshot for raft 11 11,size 539
000'649 30 S101 apply index 10 key7 num 1 type 2   lastApplied 9
000'649 31 S101 used size: 348 / 300 
000'649 27 S2 raft apply snapshot offset 11 ,lastApplied 11,total log 11, size 82,log cap:1
000'649 31 S102 after snap shot size82 539
000'649 28 S102 [558--8] successed
000'649 28 S102 [558--8] ok 
000'649 28 S102 [558--8] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'649 34 S302 check new config wanted 2
000'650 36 S558 [8] clerk putAppend okkkkk
000'651 29 S101 do snapshot for raft 10 10,size 525
000'652 27 S1 raft apply snapshot offset 10 ,lastApplied 10,total log 11, size 223,log cap:2
000'652 31 S101 after snap shot size223 525
000'655 35 S301 current config num 1 done
000'659 28 S100 do request args:Key 9 type 2 num 1 Client 2079820695267196558 Seq 9 
000'659 28 S100 declined [558--9] for not leader
000'659 28 S100 [558--9] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'659 35 S302 current config num 1 done
000'659 35 S300 current config num 1 done
000'660 28 S101 do request args:Key 9 type 2 num 1 Client 2079820695267196558 Seq 9 
000'660 28 S101 declined [558--9] for not leader
000'660 28 S101 [558--9] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'661 28 S102 do request args:Key 9 type 2 num 1 Client 2079820695267196558 Seq 9 
000'662 33 S102 start [558--9] as leader?
000'667 34 S201 check new config wanted 2
000'670 30 S100 apply index 11 key8 num 1 type 2   lastApplied 10
000'670 30 S100 apply index 12 key9 num 1 type 2   lastApplied 11
000'670 30 S101 apply index 11 key8 num 1 type 2   lastApplied 10
000'670 30 S102 apply index 12 key9 num 1 type 2   lastApplied 11
000'670 28 S102 [558--9] successed
000'670 28 S102 [558--9] ok 
000'670 28 S102 [558--9] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'671 36 S558 [9] clerk putAppend okkkkk
-------con---------------
000'678 35 S100 current config num 1 done
000'680 35 S101 current config num 1 done
000'680 34 S301 check new config wanted 2
000'684 34 S200 check new config wanted 2
000'687 35 S200 current config num 1 done
000'688 35 S102 current config num 1 done
000'693 34 S300 check new config wanted 2
000'697 35 S201 current config num 1 done
000'697 35 S202 current config num 1 done
000'698 28 S100 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 0 
000'698 28 S100 declined [ 81--0] for not leader
000'698 28 S100 [ 81--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'699 28 S101 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 0 
000'699 28 S101 declined [ 81--0] for not leader
000'699 28 S101 [ 81--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'700 28 S102 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 0 
000'701 33 S102 start [ 81--0] as leader?
000'707 30 S102 apply index 13 key0 num 1 type 3   lastApplied 12
000'708 28 S102 [ 81--0] successed
000'708 28 S102 [ 81--0] ok 
000'708 28 S102 [ 81--0] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'708 36 S81 [0] clerk putAppend okkkkk
000'709 35 S301 current config num 1 done
000'709 30 S101 apply index 12 key9 num 1 type 2   lastApplied 11
000'709 31 S101 used size: 346 / 300 
000'709 28 S100 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 1 
000'709 28 S100 declined [ 81--1] for not leader
000'709 28 S100 [ 81--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'711 29 S101 do snapshot for raft 12 12,size 553
000'711 27 S1 raft apply snapshot offset 12 ,lastApplied 12,total log 13, size 221,log cap:2
000'711 31 S101 after snap shot size221 553
000'711 28 S101 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 1 
000'711 28 S101 declined [ 81--1] for not leader
000'711 28 S101 [ 81--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'714 28 S102 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 1 
000'715 33 S102 start [ 81--1] as leader?
000'715 35 S300 current config num 1 done
000'715 35 S302 current config num 1 done
000'722 30 S101 apply index 13 key0 num 1 type 3   lastApplied 12
000'722 30 S102 apply index 14 key0 num 1 type 3   lastApplied 13
000'722 31 S102 used size: 346 / 300 
000'723 29 S102 do snapshot for raft 14 14,size 565
000'723 27 S2 raft apply snapshot offset 14 ,lastApplied 14,total log 14, size 82,log cap:1
000'723 31 S102 after snap shot size82 565
000'723 28 S102 [ 81--1] successed
000'723 28 S102 [ 81--1] ok 
000'723 28 S102 [ 81--1] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'724 30 S100 apply index 13 key0 num 1 type 3   lastApplied 12
000'724 31 S100 used size: 408 / 300 
000'724 29 S100 do snapshot for raft 13 13,size 564
000'725 27 S0 raft apply snapshot offset 13 ,lastApplied 13,total log 14, size 223,log cap:2
000'725 31 S100 after snap shot size223 564
000'725 36 S81 [1] clerk putAppend okkkkk
000'725 34 S101 check new config wanted 2
000'726 34 S100 check new config wanted 2
000'727 34 S202 check new config wanted 2
000'728 28 S100 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 2 
000'728 28 S100 declined [ 81--2] for not leader
000'728 28 S100 [ 81--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'728 34 S102 check new config wanted 2
000'729 28 S101 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 2 
000'729 28 S101 declined [ 81--2] for not leader
000'729 28 S101 [ 81--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'730 35 S100 current config num 1 done
000'730 28 S102 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 2 
000'731 33 S102 start [ 81--2] as leader?
000'733 28 S100 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 0 
000'733 28 S100 declined [479--0] for not leader
000'733 28 S100 [479--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'734 35 S101 current config num 1 done
000'739 35 S102 current config num 1 done
000'739 35 S200 current config num 1 done
000'740 28 S101 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 0 
000'740 28 S101 declined [479--0] for not leader
000'740 28 S101 [479--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'741 28 S102 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 0 
000'742 33 S102 start [479--0] as leader?
000'744 30 S100 apply index 14 key0 num 1 type 3   lastApplied 13
000'744 30 S102 apply index 15 key0 num 1 type 3   lastApplied 14
000'744 28 S102 [ 81--2] successed
000'744 28 S102 [ 81--2] ok 
000'744 28 S102 [ 81--2] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'744 30 S101 apply index 14 key0 num 1 type 3   lastApplied 13
000'744 31 S101 used size: 406 / 300 
000'745 36 S81 [2] clerk putAppend okkkkk
000'747 30 S102 apply index 16 key1 num 1 type 3   lastApplied 15
000'747 28 S102 [479--0] successed
000'747 28 S102 [479--0] ok 
000'747 28 S102 [479--0] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'747 36 S479 [0] clerk putAppend okkkkk
000'748 29 S101 do snapshot for raft 14 14,size 565
000'748 27 S1 raft apply snapshot offset 14 ,lastApplied 14,total log 16, size 283,log cap:3
000'749 31 S101 after snap shot size283 565
000'751 35 S202 current config num 1 done
000'751 35 S201 current config num 1 done
000'752 28 S100 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 1 
000'752 28 S100 declined [479--1] for not leader
000'752 28 S100 [479--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'756 30 S101 apply index 15 key0 num 1 type 3   lastApplied 14
000'756 30 S101 apply index 16 key1 num 1 type 3   lastApplied 15
000'757 28 S100 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 3 
000'757 28 S100 declined [ 81--3] for not leader
000'757 28 S100 [ 81--3] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'758 28 S101 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 1 
000'758 28 S101 declined [479--1] for not leader
000'758 28 S101 [479--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'759 28 S101 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 3 
000'759 28 S101 declined [ 81--3] for not leader
000'759 28 S101 [ 81--3] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'760 35 S301 current config num 1 done
000'765 35 S300 current config num 1 done
000'765 35 S302 current config num 1 done
000'767 28 S102 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 3 
000'768 33 S102 start [ 81--3] as leader?
000'768 28 S102 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 1 
000'769 28 S100 do request args:Key 2 type 3 num 1 Client 1679014388048817729 Seq 0 
000'771 34 S302 check new config wanted 2
000'771 33 S102 start [479--1] as leader?
000'769 28 S100 declined [729--0] for not leader
000'773 28 S100 [729--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'775 30 S100 apply index 15 key0 num 1 type 3   lastApplied 14
000'775 31 S100 used size: 346 / 300 
000'775 29 S100 do snapshot for raft 15 15,size 566
000'776 27 S0 raft apply snapshot offset 15 ,lastApplied 16,total log 16, size 221,log cap:2
000'776 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"1", ClientID:418781717203629479, Seq:0, OptType:3, Opt:"y", Num:1}}
000'776 31 S100 after snap shot size221 566
000'776 30 S100 apply index 16 key1 num 1 type 3   lastApplied 15
000'776 28 S101 do request args:Key 2 type 3 num 1 Client 1679014388048817729 Seq 0 
000'776 28 S101 declined [729--0] for not leader
000'776 28 S101 [729--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'782 35 S100 current config num 1 done
000'782 30 S102 apply index 17 key0 num 1 type 3   lastApplied 16
000'782 31 S102 used size: 408 / 300 
000'783 29 S102 do snapshot for raft 17 17,size 578
000'783 27 S2 raft apply snapshot offset 17 ,lastApplied 18,total log 18, size 223,log cap:2
000'783 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"1", ClientID:418781717203629479, Seq:1, OptType:3, Opt:"d", Num:1}}
000'783 31 S102 after snap shot size223 578
000'783 30 S102 apply index 18 key1 num 1 type 3   lastApplied 17
000'784 28 S102 do request args:Key 2 type 3 num 1 Client 1679014388048817729 Seq 0 
000'784 33 S102 start [729--0] as leader?
000'784 28 S102 [ 81--3] successed
000'784 28 S102 [ 81--3] ok 
000'784 28 S102 [ 81--3] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'784 28 S102 [479--1] successed
000'784 28 S102 [479--1] ok 
000'784 28 S102 [479--1] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'785 36 S479 [1] clerk putAppend okkkkk
000'786 34 S201 check new config wanted 2
000'787 28 S100 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 2 
000'787 28 S100 declined [479--2] for not leader
000'787 28 S100 [479--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'789 36 S81 [3] clerk putAppend okkkkk
000'790 35 S101 current config num 1 done
000'790 35 S200 current config num 1 done
000'794 28 S101 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 2 
000'794 28 S101 declined [479--2] for not leader
000'794 28 S101 [479--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'790 35 S102 current config num 1 done
000'799 30 S102 apply index 19 key2 num 1 type 3   lastApplied 18
000'799 28 S102 [729--0] successed
000'799 28 S102 [729--0] ok 
000'799 28 S102 [729--0] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'799 28 S100 do request args:Key 3 type 3 num 1 Client 2238025532150463055 Seq 0 
000'800 28 S100 declined [ 55--0] for not leader
000'800 28 S100 [ 55--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'801 28 S101 do request args:Key 3 type 3 num 1 Client 2238025532150463055 Seq 0 
000'801 28 S101 declined [ 55--0] for not leader
000'801 28 S101 [ 55--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'803 35 S202 current config num 1 done
000'803 35 S201 current config num 1 done
000'805 28 S102 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 2 
000'805 33 S102 start [479--2] as leader?
000'808 30 S101 apply index 17 key0 num 1 type 3   lastApplied 16
000'808 31 S101 used size: 469 / 300 
000'808 29 S101 do snapshot for raft 17 17,size 578
000'809 27 S1 raft apply snapshot offset 17 ,lastApplied 18,total log 19, size 283,log cap:3
000'809 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"1", ClientID:418781717203629479, Seq:1, OptType:3, Opt:"d", Num:1}}
000'809 31 S101 after snap shot size283 578
000'809 30 S101 apply index 18 key1 num 1 type 3   lastApplied 17
000'810 30 S100 apply index 17 key0 num 1 type 3   lastApplied 16
000'810 31 S100 used size: 406 / 300 
000'810 29 S100 do snapshot for raft 17 17,size 578
000'811 27 S0 raft apply snapshot offset 17 ,lastApplied 18,total log 19, size 283,log cap:3
000'811 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"1", ClientID:418781717203629479, Seq:1, OptType:3, Opt:"d", Num:1}}
000'811 31 S100 after snap shot size283 578
000'811 30 S100 apply index 18 key1 num 1 type 3   lastApplied 17
000'814 28 S102 do request args:Key 3 type 3 num 1 Client 2238025532150463055 Seq 0 
000'814 33 S102 start [ 55--0] as leader?
000'815 30 S100 apply index 19 key2 num 1 type 3   lastApplied 18
000'815 31 S100 used size: 346 / 300 
000'818 29 S100 do snapshot for raft 19 19,size 590
000'818 34 S300 check new config wanted 2
000'818 27 S0 raft apply snapshot offset 19 ,lastApplied 19,total log 20, size 223,log cap:2
000'818 31 S100 after snap shot size223 590
000'818 34 S200 check new config wanted 2
000'818 30 S101 apply index 19 key2 num 1 type 3   lastApplied 18
000'818 31 S101 used size: 346 / 300 
000'818 30 S102 apply index 20 key1 num 1 type 3   lastApplied 19
000'819 31 S102 used size: 406 / 300 
000'819 34 S301 check new config wanted 2
000'819 35 S300 current config num 1 done
000'819 35 S301 current config num 1 done
000'819 35 S302 current config num 1 done
000'820 29 S102 do snapshot for raft 20 20,size 591
000'821 29 S101 do snapshot for raft 19 19,size 590
000'822 27 S1 raft apply snapshot offset 19 ,lastApplied 19,total log 20, size 223,log cap:2
000'822 31 S101 after snap shot size223 590
000'822 28 S100 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 4 
000'822 28 S100 declined [ 81--4] for not leader
000'822 28 S100 [ 81--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'823 28 S101 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 4 
000'823 28 S101 declined [ 81--4] for not leader
000'823 28 S101 [ 81--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'825 36 S729 [0] clerk putAppend okkkkk
000'831 28 S100 do request args:Key 2 type 3 num 1 Client 1679014388048817729 Seq 1 
000'831 28 S100 declined [729--1] for not leader
000'831 28 S100 [729--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'833 35 S100 current config num 1 done
000'835 28 S100 do request args:Key 4 type 3 num 1 Client 132246879705026825 Seq 0 
000'836 28 S100 declined [825--0] for not leader
000'836 28 S100 [825--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'837 28 S101 do request args:Key 2 type 3 num 1 Client 1679014388048817729 Seq 1 
000'838 28 S101 declined [729--1] for not leader
000'838 28 S101 [729--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'840 28 S101 do request args:Key 4 type 3 num 1 Client 132246879705026825 Seq 0 
000'840 28 S101 declined [825--0] for not leader
000'840 28 S101 [825--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'843 35 S200 current config num 1 done
000'844 35 S101 current config num 1 done
000'844 27 S2 raft apply snapshot offset 20 ,lastApplied 20,total log 21, size 221,log cap:2
000'844 31 S102 after snap shot size221 591
000'844 28 S102 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 4 
000'845 33 S102 start [ 81--4] as leader?
000'845 28 S102 do request args:Key 2 type 3 num 1 Client 1679014388048817729 Seq 1 
000'852 30 S101 apply index 20 key1 num 1 type 3   lastApplied 19
000'853 31 S101 used size: 346 / 300 
000'853 29 S101 do snapshot for raft 20 20,size 591
000'854 27 S1 raft apply snapshot offset 20 ,lastApplied 20,total log 22, size 283,log cap:3
000'854 31 S101 after snap shot size283 591
000'855 33 S102 start [729--1] as leader?
000'856 35 S201 current config num 1 done
000'856 35 S202 current config num 1 done
000'856 28 S102 do request args:Key 4 type 3 num 1 Client 132246879705026825 Seq 0 
000'856 30 S100 apply index 20 key1 num 1 type 3   lastApplied 19
000'856 33 S102 start [825--0] as leader?
000'856 28 S102 [479--2] successed
000'856 28 S102 [479--2] ok 
000'857 28 S102 [479--2] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'856 31 S100 used size: 346 / 300 
000'858 29 S100 do snapshot for raft 20 20,size 591
000'858 27 S0 raft apply snapshot offset 20 ,lastApplied 20,total log 22, size 283,log cap:3
000'858 31 S100 after snap shot size283 591
000'872 35 S300 current config num 1 done
000'872 35 S301 current config num 1 done
000'872 35 S302 current config num 1 done
000'873 30 S100 apply index 21 key3 num 1 type 3   lastApplied 20
000'873 35 S102 current config num 1 done
000'873 31 S100 used size: 406 / 300 
000'874 29 S100 do snapshot for raft 21 21,size 602
000'874 27 S0 raft apply snapshot offset 21 ,lastApplied 22,total log 24, size 346,log cap:4
000'874 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"0", ClientID:940626237948413081, Seq:4, OptType:3, Opt:"C", Num:1}}
000'874 31 S100 after snap shot size346 602
000'874 30 S100 apply index 22 key0 num 1 type 3   lastApplied 21
000'874 31 S100 used size: 346 / 300 
000'875 29 S100 do snapshot for raft 22 22,size 603
000'875 27 S0 raft apply snapshot offset 22 ,lastApplied 22,total log 24, size 283,log cap:3
000'876 31 S100 after snap shot size283 603
000'876 30 S102 apply index 21 key3 num 1 type 3   lastApplied 20
000'876 31 S102 used size: 406 / 300 
000'876 28 S100 do request args:Key 5 type 3 num 1 Client 3482757038087095369 Seq 0 
000'876 28 S100 declined [369--0] for not leader
000'876 28 S100 [369--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'876 29 S102 do snapshot for raft 21 21,size 602
000'877 27 S2 raft apply snapshot offset 21 ,lastApplied 24,total log 24, size 346,log cap:4
000'877 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"4", ClientID:132246879705026825, Seq:0, OptType:3, Opt:"3", Num:1}}
000'877 31 S102 after snap shot size346 602
000'877 30 S102 apply index 22 key0 num 1 type 3   lastApplied 21
000'877 31 S102 used size: 346 / 300 
000'878 29 S102 do snapshot for raft 22 22,size 603
000'872 30 S101 apply index 21 key3 num 1 type 3   lastApplied 20
000'878 31 S101 used size: 406 / 300 
000'879 29 S101 do snapshot for raft 21 21,size 602
000'879 27 S1 raft apply snapshot offset 21 ,lastApplied 22,total log 24, size 346,log cap:4
000'879 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"0", ClientID:940626237948413081, Seq:4, OptType:3, Opt:"C", Num:1}}
000'879 31 S101 after snap shot size346 602
000'879 30 S101 apply index 22 key0 num 1 type 3   lastApplied 21
000'879 31 S101 used size: 346 / 300 
000'880 29 S101 do snapshot for raft 22 22,size 603
000'880 27 S1 raft apply snapshot offset 22 ,lastApplied 22,total log 24, size 283,log cap:3
000'880 31 S101 after snap shot size283 603
000'882 28 S101 do request args:Key 5 type 3 num 1 Client 3482757038087095369 Seq 0 
000'882 28 S101 declined [369--0] for not leader
000'882 28 S101 [369--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'882 34 S202 check new config wanted 2
000'882 34 S100 check new config wanted 2
000'882 34 S101 check new config wanted 2
000'883 27 S2 raft apply snapshot offset 22 ,lastApplied 24,total log 24, size 283,log cap:3
000'883 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"4", ClientID:132246879705026825, Seq:0, OptType:3, Opt:"3", Num:1}}
000'883 31 S102 after snap shot size283 603
000'883 30 S102 apply index 23 key2 num 1 type 3   lastApplied 22
000'883 30 S102 apply index 24 key4 num 1 type 3   lastApplied 23
000'883 28 S102 [729--1] successed
000'883 28 S102 [729--1] ok 
000'883 28 S102 [729--1] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'883 28 S102 [ 81--4] successed
000'883 28 S102 [ 81--4] ok 
000'883 28 S102 [ 81--4] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'884 28 S102 [ 55--0] successed
000'884 28 S102 [ 55--0] ok 
000'884 28 S102 [ 55--0] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'884 36 S55 [0] clerk putAppend okkkkk
000'885 34 S102 check new config wanted 2
000'885 28 S102 [825--0] successed
000'885 28 S102 [825--0] ok 
000'885 28 S102 [825--0] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'885 36 S729 [1] clerk putAppend okkkkk
000'886 36 S81 [4] clerk putAppend okkkkk
000'887 28 S102 do request args:Key 5 type 3 num 1 Client 3482757038087095369 Seq 0 
000'888 33 S102 start [369--0] as leader?
000'891 36 S479 [2] clerk putAppend okkkkk
000'887 28 S100 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 5 
000'892 28 S100 declined [ 81--5] for not leader
000'892 28 S100 [ 81--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'892 28 S100 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 3 
000'892 28 S100 declined [479--3] for not leader
000'892 28 S100 [479--3] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'896 35 S100 current config num 1 done
000'896 28 S100 do request args:Key 3 type 3 num 1 Client 2238025532150463055 Seq 1 
000'896 28 S100 declined [ 55--1] for not leader
000'896 28 S101 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 3 
000'896 28 S101 declined [479--3] for not leader
000'896 28 S101 [479--3] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'896 28 S100 [ 55--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'897 28 S100 do request args:Key 2 type 3 num 1 Client 1679014388048817729 Seq 2 
000'897 28 S100 declined [729--2] for not leader
000'897 28 S100 [729--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'898 36 S825 [0] clerk putAppend okkkkk
000'898 28 S101 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 5 
000'898 28 S101 declined [ 81--5] for not leader
000'898 28 S101 [ 81--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'899 34 S302 check new config wanted 2
000'898 35 S101 current config num 1 done
000'903 28 S102 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 3 
000'904 33 S102 start [479--3] as leader?
000'904 28 S100 do request args:Key 4 type 3 num 1 Client 132246879705026825 Seq 1 
000'904 28 S100 declined [825--1] for not leader
000'904 28 S100 [825--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'904 28 S101 do request args:Key 2 type 3 num 1 Client 1679014388048817729 Seq 2 
000'904 28 S101 declined [729--2] for not leader
000'904 28 S101 [729--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'905 28 S102 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 5 
000'906 33 S102 start [ 81--5] as leader?
000'912 28 S102 do request args:Key 2 type 3 num 1 Client 1679014388048817729 Seq 2 
000'910 35 S200 current config num 1 done
000'913 33 S102 start [729--2] as leader?
000'914 30 S100 apply index 23 key2 num 1 type 3   lastApplied 22
000'914 31 S100 used size: 469 / 300 
000'914 29 S100 do snapshot for raft 23 23,size 604
000'915 27 S0 raft apply snapshot offset 23 ,lastApplied 24,total log 27, size 406,log cap:5
000'915 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"4", ClientID:132246879705026825, Seq:0, OptType:3, Opt:"3", Num:1}}
000'915 31 S100 after snap shot size406 604
000'915 30 S100 apply index 24 key4 num 1 type 3   lastApplied 23
000'915 31 S100 used size: 406 / 300 
000'916 29 S100 do snapshot for raft 24 24,size 616
000'916 27 S0 raft apply snapshot offset 24 ,lastApplied 24,total log 27, size 346,log cap:4
000'916 31 S100 after snap shot size346 616
000'918 30 S101 apply index 23 key2 num 1 type 3   lastApplied 22
000'919 31 S101 used size: 469 / 300 
000'919 29 S101 do snapshot for raft 23 23,size 604
000'920 27 S1 raft apply snapshot offset 23 ,lastApplied 24,total log 27, size 406,log cap:5
000'920 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"4", ClientID:132246879705026825, Seq:0, OptType:3, Opt:"3", Num:1}}
000'920 31 S101 after snap shot size406 604
000'920 30 S101 apply index 24 key4 num 1 type 3   lastApplied 23
000'920 31 S101 used size: 406 / 300 
000'920 29 S101 do snapshot for raft 24 24,size 616
000'921 27 S1 raft apply snapshot offset 24 ,lastApplied 24,total log 27, size 346,log cap:4
000'921 31 S101 after snap shot size346 616
000'921 28 S101 do request args:Key 3 type 3 num 1 Client 2238025532150463055 Seq 1 
000'921 28 S101 declined [ 55--1] for not leader
000'921 28 S101 [ 55--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'922 30 S102 apply index 25 key5 num 1 type 3   lastApplied 24
000'922 31 S102 used size: 531 / 300 
000'923 29 S102 do snapshot for raft 25 25,size 627
000'923 27 S2 raft apply snapshot offset 25 ,lastApplied 27,total log 28, size 348,log cap:4
000'923 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"0", ClientID:940626237948413081, Seq:5, OptType:3, Opt:"z", Num:1}}
000'923 31 S102 after snap shot size348 627
000'923 30 S102 apply index 26 key1 num 1 type 3   lastApplied 25
000'923 31 S102 used size: 348 / 300 
000'925 35 S201 current config num 1 done
000'925 35 S202 current config num 1 done
000'928 35 S300 current config num 1 done
000'928 35 S302 current config num 1 done
000'928 35 S301 current config num 1 done
000'931 34 S201 check new config wanted 2
000'933 28 S101 do request args:Key 4 type 3 num 1 Client 132246879705026825 Seq 1 
000'933 28 S101 declined [825--1] for not leader
000'933 28 S101 [825--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'935 30 S100 apply index 25 key5 num 1 type 3   lastApplied 24
000'935 31 S100 used size: 408 / 300 
000'937 29 S100 do snapshot for raft 25 25,size 627
000'924 29 S102 do snapshot for raft 26 26,size 628
000'938 27 S0 raft apply snapshot offset 25 ,lastApplied 27,total log 28, size 348,log cap:4
000'938 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"0", ClientID:940626237948413081, Seq:5, OptType:3, Opt:"z", Num:1}}
000'938 31 S100 after snap shot size348 627
000'938 30 S100 apply index 26 key1 num 1 type 3   lastApplied 25
000'938 31 S100 used size: 348 / 300 
000'938 27 S2 raft apply snapshot offset 26 ,lastApplied 28,total log 28, size 285,log cap:3
000'938 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"2", ClientID:1679014388048817729, Seq:2, OptType:3, Opt:"E", Num:1}}
000'938 31 S102 after snap shot size285 628
000'938 30 S102 apply index 27 key0 num 1 type 3   lastApplied 26
000'938 30 S102 apply index 28 key2 num 1 type 3   lastApplied 27
000'938 28 S102 [729--2] successed
000'938 28 S102 [729--2] ok 
000'938 28 S102 [729--2] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'940 35 S102 current config num 1 done
000'940 28 S102 [369--0] successed
000'940 28 S102 [369--0] ok 
000'940 28 S102 [369--0] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'940 28 S102 [ 81--5] successed
000'940 28 S102 [ 81--5] ok 
000'940 28 S102 [ 81--5] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'941 36 S81 [5] clerk putAppend okkkkk
000'941 28 S102 [479--3] successed
000'941 28 S102 [479--3] ok 
000'941 28 S102 [479--3] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
000'942 30 S101 apply index 25 key5 num 1 type 3   lastApplied 24
000'942 31 S101 used size: 408 / 300 
000'943 29 S101 do snapshot for raft 25 25,size 627
000'943 27 S1 raft apply snapshot offset 25 ,lastApplied 27,total log 28, size 348,log cap:4
000'938 29 S100 do snapshot for raft 26 26,size 628
000'943 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"0", ClientID:940626237948413081, Seq:5, OptType:3, Opt:"z", Num:1}}
000'944 31 S101 after snap shot size348 627
000'944 30 S101 apply index 26 key1 num 1 type 3   lastApplied 25
000'944 31 S101 used size: 348 / 300 
000'944 27 S0 raft apply snapshot offset 26 ,lastApplied 27,total log 28, size 285,log cap:3
000'944 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"0", ClientID:940626237948413081, Seq:5, OptType:3, Opt:"z", Num:1}}
000'944 31 S100 after snap shot size285 628
000'944 30 S100 apply index 27 key0 num 1 type 3   lastApplied 26
000'944 29 S101 do snapshot for raft 26 26,size 628
000'945 28 S102 do request args:Key 4 type 3 num 1 Client 132246879705026825 Seq 1 
000'945 27 S1 raft apply snapshot offset 26 ,lastApplied 27,total log 28, size 285,log cap:3
000'945 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"0", ClientID:940626237948413081, Seq:5, OptType:3, Opt:"z", Num:1}}
000'945 31 S101 after snap shot size285 628
000'945 30 S101 apply index 27 key0 num 1 type 3   lastApplied 26
000'945 33 S102 start [825--1] as leader?
000'945 36 S369 [0] clerk putAppend okkkkk
000'946 28 S100 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 6 
000'946 28 S100 declined [ 81--6] for not leader
000'946 28 S100 [ 81--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'946 28 S100 do request args:Key 5 type 3 num 1 Client 3482757038087095369 Seq 1 
000'946 28 S100 declined [369--1] for not leader
000'946 28 S100 [369--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'947 35 S100 current config num 1 done
000'947 28 S101 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 6 
000'947 28 S101 declined [ 81--6] for not leader
000'947 28 S101 [ 81--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'947 28 S101 do request args:Key 5 type 3 num 1 Client 3482757038087095369 Seq 1 
000'948 28 S101 declined [369--1] for not leader
000'948 28 S101 [369--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'948 28 S102 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 6 
000'949 33 S102 start [ 81--6] as leader?
000'949 28 S102 do request args:Key 5 type 3 num 1 Client 3482757038087095369 Seq 1 
000'950 33 S102 start [369--1] as leader?
000'954 35 S101 current config num 1 done
000'956 28 S102 do request args:Key 3 type 3 num 1 Client 2238025532150463055 Seq 1 
000'956 33 S102 start [ 55--1] as leader?
000'957 36 S479 [3] clerk putAppend okkkkk
000'958 36 S729 [2] clerk putAppend okkkkk
000'959 30 S100 apply index 28 key2 num 1 type 3   lastApplied 27
000'959 31 S100 used size: 348 / 300 
000'960 29 S100 do snapshot for raft 28 28,size 630
000'960 27 S0 raft apply snapshot offset 28 ,lastApplied 28,total log 29, size 223,log cap:2
000'960 31 S100 after snap shot size223 630
000'962 28 S100 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 4 
000'962 28 S100 declined [479--4] for not leader
000'962 28 S100 [479--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'969 34 S200 check new config wanted 2
000'970 34 S301 check new config wanted 2
000'970 34 S300 check new config wanted 2
000'971 35 S200 current config num 1 done
000'973 30 S101 apply index 28 key2 num 1 type 3   lastApplied 27
000'973 31 S101 used size: 410 / 300 
000'974 29 S101 do snapshot for raft 28 28,size 630
000'974 27 S1 raft apply snapshot offset 28 ,lastApplied 28,total log 30, size 285,log cap:3
000'974 31 S101 after snap shot size285 630
000'977 35 S202 current config num 1 done
000'977 35 S201 current config num 1 done
000'979 28 S100 do request args:Key 2 type 3 num 1 Client 1679014388048817729 Seq 3 
000'979 28 S100 declined [729--3] for not leader
000'979 28 S100 [729--3] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'981 30 S102 apply index 29 key4 num 1 type 3   lastApplied 28
000'981 31 S102 used size: 535 / 300 
000'982 35 S301 current config num 1 done
000'982 35 S300 current config num 1 done
000'982 35 S302 current config num 1 done
000'992 28 S101 do request args:Key 2 type 3 num 1 Client 1679014388048817729 Seq 3 
000'992 28 S101 declined [729--3] for not leader
000'992 28 S101 [729--3] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
000'997 35 S100 current config num 1 done
000'998 29 S102 do snapshot for raft 29 29,size 631
000'998 27 S2 raft apply snapshot offset 29 ,lastApplied 32,total log 32, size 348,log cap:4
000'999 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"3", ClientID:2238025532150463055, Seq:1, OptType:3, Opt:"P", Num:1}}
000'999 31 S102 after snap shot size348 631
000'999 30 S102 apply index 30 key0 num 1 type 3   lastApplied 29
000'999 31 S102 used size: 348 / 300 
000'999 29 S102 do snapshot for raft 30 30,size 632
001'000 27 S2 raft apply snapshot offset 30 ,lastApplied 32,total log 32, size 285,log cap:3
001'000 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"3", ClientID:2238025532150463055, Seq:1, OptType:3, Opt:"P", Num:1}}
001'000 31 S102 after snap shot size285 632
001'000 30 S102 apply index 31 key5 num 1 type 3   lastApplied 30
001'000 30 S102 apply index 32 key3 num 1 type 3   lastApplied 31
001'001 28 S102 [825--1] successed
001'001 28 S102 [825--1] ok 
001'001 28 S102 [825--1] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'001 35 S102 current config num 1 done
001'001 28 S102 [ 81--6] successed
001'001 28 S102 [ 81--6] ok 
001'001 28 S102 [ 81--6] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'002 28 S102 [369--1] successed
001'002 28 S102 [369--1] ok 
001'002 28 S102 [369--1] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'002 28 S102 [ 55--1] successed
001'002 28 S102 [ 55--1] ok 
001'002 28 S102 [ 55--1] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'002 36 S55 [1] clerk putAppend okkkkk
001'003 28 S101 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 4 
001'003 28 S101 declined [479--4] for not leader
001'003 28 S101 [479--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'004 36 S369 [1] clerk putAppend okkkkk
001'004 35 S101 current config num 1 done
001'005 36 S825 [1] clerk putAppend okkkkk
001'005 28 S102 do request args:Key 2 type 3 num 1 Client 1679014388048817729 Seq 3 
001'006 33 S102 start [729--3] as leader?
001'006 36 S81 [6] clerk putAppend okkkkk
001'007 28 S100 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 7 
001'007 28 S100 declined [ 81--7] for not leader
001'007 28 S100 [ 81--7] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'008 28 S100 do request args:Key 5 type 3 num 1 Client 3482757038087095369 Seq 2 
001'008 28 S100 declined [369--2] for not leader
001'008 28 S100 [369--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'008 28 S100 do request args:Key 3 type 3 num 1 Client 2238025532150463055 Seq 2 
001'008 28 S100 declined [ 55--2] for not leader
001'008 28 S100 [ 55--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'010 28 S100 do request args:Key 4 type 3 num 1 Client 132246879705026825 Seq 2 
001'010 28 S100 declined [825--2] for not leader
001'010 28 S100 [825--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'012 28 S101 do request args:Key 3 type 3 num 1 Client 2238025532150463055 Seq 2 
001'012 28 S101 declined [ 55--2] for not leader
001'012 28 S101 [ 55--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'013 28 S101 do request args:Key 5 type 3 num 1 Client 3482757038087095369 Seq 2 
001'013 28 S101 declined [369--2] for not leader
001'013 28 S101 [369--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'019 28 S102 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 4 
001'020 33 S102 start [479--4] as leader?
001'023 28 S101 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 7 
001'024 35 S200 current config num 1 done
001'025 28 S102 do request args:Key 5 type 3 num 1 Client 3482757038087095369 Seq 2 
001'027 35 S201 current config num 1 done
001'030 28 S100 do request args:Key 6 type 3 num 1 Client 542732653461723544 Seq 0 
001'030 28 S100 declined [544--0] for not leader
001'030 28 S100 [544--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'033 35 S202 current config num 1 done
001'033 35 S302 current config num 1 done
001'033 33 S102 start [369--2] as leader?
001'033 30 S102 apply index 33 key2 num 1 type 3   lastApplied 32
001'033 31 S102 used size: 473 / 300 
001'034 29 S102 do snapshot for raft 33 33,size 635
001'034 27 S2 raft apply snapshot offset 33 ,lastApplied 33,total log 35, size 285,log cap:3
001'034 31 S102 after snap shot size285 635
001'035 35 S301 current config num 1 done
001'035 30 S100 apply index 29 key4 num 1 type 3   lastApplied 28
001'035 31 S100 used size: 473 / 300 
001'036 28 S101 declined [ 81--7] for not leader
001'036 28 S101 [ 81--7] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'037 30 S102 apply index 34 key1 num 1 type 3   lastApplied 33
001'038 28 S102 [479--4] successed
001'038 28 S102 [479--4] ok 
001'038 28 S102 [479--4] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'038 30 S101 apply index 29 key4 num 1 type 3   lastApplied 28
001'038 31 S101 used size: 535 / 300 
001'039 29 S101 do snapshot for raft 29 29,size 631
001'041 27 S1 raft apply snapshot offset 29 ,lastApplied 32,total log 34, size 473,log cap:6
001'041 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"3", ClientID:2238025532150463055, Seq:1, OptType:3, Opt:"P", Num:1}}
001'041 31 S101 after snap shot size473 631
001'041 30 S101 apply index 30 key0 num 1 type 3   lastApplied 29
001'041 31 S101 used size: 473 / 300 
001'042 29 S101 do snapshot for raft 30 30,size 632
001'042 27 S1 raft apply snapshot offset 30 ,lastApplied 32,total log 34, size 410,log cap:5
001'043 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"3", ClientID:2238025532150463055, Seq:1, OptType:3, Opt:"P", Num:1}}
001'043 31 S101 after snap shot size410 632
001'043 30 S101 apply index 31 key5 num 1 type 3   lastApplied 30
001'043 31 S101 used size: 410 / 300 
001'043 29 S101 do snapshot for raft 31 31,size 633
001'044 27 S1 raft apply snapshot offset 31 ,lastApplied 32,total log 34, size 348,log cap:4
001'044 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"3", ClientID:2238025532150463055, Seq:1, OptType:3, Opt:"P", Num:1}}
001'045 31 S101 after snap shot size348 633
001'045 30 S101 apply index 32 key3 num 1 type 3   lastApplied 31
001'045 31 S101 used size: 348 / 300 
001'046 29 S101 do snapshot for raft 32 32,size 634
001'046 27 S1 raft apply snapshot offset 32 ,lastApplied 32,total log 34, size 285,log cap:3
001'046 31 S101 after snap shot size285 634
001'046 28 S101 do request args:Key 6 type 3 num 1 Client 542732653461723544 Seq 0 
001'046 28 S101 declined [544--0] for not leader
001'046 28 S101 [544--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'038 36 S479 [4] clerk putAppend okkkkk
001'047 28 S102 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 7 
001'048 33 S102 start [ 81--7] as leader?
001'050 28 S102 do request args:Key 3 type 3 num 1 Client 2238025532150463055 Seq 2 
001'050 33 S102 start [ 55--2] as leader?
001'050 28 S101 do request args:Key 4 type 3 num 1 Client 132246879705026825 Seq 2 
001'050 28 S101 declined [825--2] for not leader
001'050 28 S101 [825--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'053 28 S102 do request args:Key 6 type 3 num 1 Client 542732653461723544 Seq 0 
001'054 33 S102 start [544--0] as leader?
001'055 35 S101 current config num 1 done
001'061 35 S102 current config num 1 done
001'041 29 S100 do snapshot for raft 29 29,size 631
001'066 27 S0 raft apply snapshot offset 29 ,lastApplied 32,total log 34, size 473,log cap:6
001'066 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"3", ClientID:2238025532150463055, Seq:1, OptType:3, Opt:"P", Num:1}}
001'066 31 S100 after snap shot size473 631
001'066 30 S100 apply index 30 key0 num 1 type 3   lastApplied 29
001'066 31 S100 used size: 473 / 300 
001'067 29 S100 do snapshot for raft 30 30,size 632
001'067 27 S0 raft apply snapshot offset 30 ,lastApplied 32,total log 34, size 410,log cap:5
001'067 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"3", ClientID:2238025532150463055, Seq:1, OptType:3, Opt:"P", Num:1}}
001'067 31 S100 after snap shot size410 632
001'067 30 S100 apply index 31 key5 num 1 type 3   lastApplied 30
001'068 31 S100 used size: 410 / 300 
001'068 29 S100 do snapshot for raft 31 31,size 633
001'069 27 S0 raft apply snapshot offset 31 ,lastApplied 32,total log 34, size 348,log cap:4
001'069 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"3", ClientID:2238025532150463055, Seq:1, OptType:3, Opt:"P", Num:1}}
001'069 31 S100 after snap shot size348 633
001'069 30 S100 apply index 32 key3 num 1 type 3   lastApplied 31
001'069 31 S100 used size: 348 / 300 
001'073 29 S100 do snapshot for raft 32 32,size 634
001'073 27 S0 raft apply snapshot offset 32 ,lastApplied 32,total log 34, size 285,log cap:3
001'073 31 S100 after snap shot size285 634
001'073 35 S100 current config num 1 done
001'073 28 S100 do request args:Key 7 type 3 num 1 Client 2972145661651991667 Seq 0 
001'073 28 S100 declined [667--0] for not leader
001'073 28 S100 [667--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'065 35 S300 current config num 1 done
001'065 28 S102 [729--3] successed
001'074 28 S102 [729--3] ok 
001'074 28 S102 [729--3] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'080 36 S729 [3] clerk putAppend okkkkk
001'081 28 S100 do request args:Key 2 type 3 num 1 Client 1679014388048817729 Seq 4 
001'082 28 S102 do request args:Key 4 type 3 num 1 Client 132246879705026825 Seq 2 
001'084 35 S302 current config num 1 done
001'084 35 S202 current config num 1 done
001'089 35 S301 current config num 1 done
001'092 34 S101 check new config wanted 2
001'093 34 S302 check new config wanted 2
001'075 35 S200 current config num 1 done
001'095 34 S202 check new config wanted 2
001'096 28 S101 do request args:Key 7 type 3 num 1 Client 2972145661651991667 Seq 0 
001'078 35 S201 current config num 1 done
001'099 34 S201 check new config wanted 2
001'100 28 S100 declined [729--4] for not leader
001'100 28 S100 [729--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'102 33 S102 start [825--2] as leader?
001'102 34 S102 check new config wanted 2
001'102 30 S102 apply index 35 key5 num 1 type 3   lastApplied 34
001'102 31 S102 used size: 533 / 300 
001'103 29 S102 do snapshot for raft 35 35,size 637
001'103 27 S2 raft apply snapshot offset 35 ,lastApplied 38,total log 39, size 408,log cap:5
001'103 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"6", ClientID:542732653461723544, Seq:0, OptType:3, Opt:"A", Num:1}}
001'103 31 S102 after snap shot size408 637
001'103 30 S102 apply index 36 key0 num 1 type 3   lastApplied 35
001'103 31 S102 used size: 408 / 300 
001'106 28 S100 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 5 
001'106 28 S100 declined [479--5] for not leader
001'106 28 S100 [479--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'112 34 S100 check new config wanted 2
001'112 30 S100 apply index 33 key2 num 1 type 3   lastApplied 32
001'112 31 S100 used size: 533 / 300 
001'113 29 S100 do snapshot for raft 33 33,size 635
001'113 27 S0 raft apply snapshot offset 33 ,lastApplied 34,total log 38, size 471,log cap:6
001'114 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"1", ClientID:418781717203629479, Seq:4, OptType:3, Opt:"l", Num:1}}
001'114 31 S100 after snap shot size471 635
001'114 30 S100 apply index 34 key1 num 1 type 3   lastApplied 33
001'114 31 S100 used size: 471 / 300 
001'114 29 S100 do snapshot for raft 34 34,size 636
001'115 27 S0 raft apply snapshot offset 34 ,lastApplied 34,total log 38, size 408,log cap:5
001'115 31 S100 after snap shot size408 636
001'120 28 S101 declined [667--0] for not leader
001'120 28 S101 [667--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'121 35 S101 current config num 1 done
001'124 30 S101 apply index 33 key2 num 1 type 3   lastApplied 32
001'124 31 S101 used size: 533 / 300 
001'125 29 S101 do snapshot for raft 33 33,size 635
001'125 27 S1 raft apply snapshot offset 33 ,lastApplied 34,total log 38, size 471,log cap:6
001'125 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"1", ClientID:418781717203629479, Seq:4, OptType:3, Opt:"l", Num:1}}
001'125 31 S101 after snap shot size471 635
001'125 30 S101 apply index 34 key1 num 1 type 3   lastApplied 33
001'125 31 S101 used size: 471 / 300 
001'126 35 S300 current config num 1 done
001'126 29 S101 do snapshot for raft 34 34,size 636
001'126 27 S1 raft apply snapshot offset 34 ,lastApplied 34,total log 38, size 408,log cap:5
001'126 31 S101 after snap shot size408 636
001'127 28 S101 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 5 
001'127 28 S101 declined [479--5] for not leader
001'127 28 S101 [479--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'127 35 S100 current config num 1 done
001'127 28 S101 do request args:Key 2 type 3 num 1 Client 1679014388048817729 Seq 4 
001'127 28 S101 declined [729--4] for not leader
001'127 28 S101 [729--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'131 29 S102 do snapshot for raft 36 36,size 638
001'131 27 S2 raft apply snapshot offset 36 ,lastApplied 38,total log 39, size 346,log cap:4
001'131 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"6", ClientID:542732653461723544, Seq:0, OptType:3, Opt:"A", Num:1}}
001'131 31 S102 after snap shot size346 638
001'131 30 S102 apply index 37 key3 num 1 type 3   lastApplied 36
001'131 31 S102 used size: 346 / 300 
001'132 29 S102 do snapshot for raft 37 37,size 639
001'132 27 S2 raft apply snapshot offset 37 ,lastApplied 38,total log 39, size 283,log cap:3
001'132 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"6", ClientID:542732653461723544, Seq:0, OptType:3, Opt:"A", Num:1}}
001'132 31 S102 after snap shot size283 639
001'132 30 S102 apply index 38 key6 num 1 type 3   lastApplied 37
001'132 28 S102 [544--0] successed
001'132 28 S102 [544--0] ok 
001'132 28 S102 [544--0] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'133 28 S102 [ 81--7] successed
001'133 28 S102 [ 81--7] ok 
001'133 28 S102 [ 81--7] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'133 28 S102 [ 55--2] successed
001'133 28 S102 [ 55--2] ok 
001'133 28 S102 [ 55--2] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'134 36 S81 [7] clerk putAppend okkkkk
001'134 35 S202 current config num 1 done
001'134 28 S102 [369--2] successed
001'134 28 S102 [369--2] ok 
001'134 28 S102 [369--2] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'134 28 S100 do request args:Key 8 type 3 num 1 Client 2953714763196401582 Seq 0 
001'134 28 S100 declined [582--0] for not leader
001'134 35 S102 current config num 1 done
001'134 28 S100 [582--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'136 35 S302 current config num 1 done
001'137 36 S55 [2] clerk putAppend okkkkk
001'139 28 S100 do request args:Key 3 type 3 num 1 Client 2238025532150463055 Seq 3 
001'139 28 S100 declined [ 55--3] for not leader
001'139 28 S100 [ 55--3] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'139 36 S369 [2] clerk putAppend okkkkk
001'140 28 S101 do request args:Key 8 type 3 num 1 Client 2953714763196401582 Seq 0 
001'140 28 S101 declined [582--0] for not leader
001'140 28 S101 [582--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'140 35 S301 current config num 1 done
001'141 28 S100 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 8 
001'141 28 S100 declined [ 81--8] for not leader
001'141 28 S100 [ 81--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'144 28 S102 do request args:Key 7 type 3 num 1 Client 2972145661651991667 Seq 0 
001'145 33 S102 start [667--0] as leader?
001'148 35 S200 current config num 1 done
001'152 30 S101 apply index 35 key5 num 1 type 3   lastApplied 34
001'152 31 S101 used size: 471 / 300 
001'153 36 S544 [0] clerk putAppend okkkkk
001'153 29 S101 do snapshot for raft 35 35,size 637
001'153 27 S1 raft apply snapshot offset 35 ,lastApplied 38,total log 39, size 408,log cap:5
001'153 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"6", ClientID:542732653461723544, Seq:0, OptType:3, Opt:"A", Num:1}}
001'153 31 S101 after snap shot size408 637
001'154 30 S101 apply index 36 key0 num 1 type 3   lastApplied 35
001'154 31 S101 used size: 408 / 300 
001'154 28 S102 do request args:Key 8 type 3 num 1 Client 2953714763196401582 Seq 0 
001'154 29 S101 do snapshot for raft 36 36,size 638
001'154 33 S102 start [582--0] as leader?
001'155 27 S1 raft apply snapshot offset 36 ,lastApplied 38,total log 39, size 346,log cap:4
001'155 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"6", ClientID:542732653461723544, Seq:0, OptType:3, Opt:"A", Num:1}}
001'155 31 S101 after snap shot size346 638
001'155 30 S101 apply index 37 key3 num 1 type 3   lastApplied 36
001'155 31 S101 used size: 346 / 300 
001'155 28 S100 do request args:Key 5 type 3 num 1 Client 3482757038087095369 Seq 3 
001'155 29 S101 do snapshot for raft 37 37,size 639
001'156 27 S1 raft apply snapshot offset 37 ,lastApplied 38,total log 39, size 283,log cap:3
001'156 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"6", ClientID:542732653461723544, Seq:0, OptType:3, Opt:"A", Num:1}}
001'156 31 S101 after snap shot size283 639
001'156 30 S101 apply index 38 key6 num 1 type 3   lastApplied 37
001'156 28 S101 do request args:Key 3 type 3 num 1 Client 2238025532150463055 Seq 3 
001'156 28 S101 declined [ 55--3] for not leader
001'156 28 S101 [ 55--3] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'160 30 S102 apply index 39 key4 num 1 type 3   lastApplied 38
001'160 31 S102 used size: 404 / 300 
001'161 29 S102 do snapshot for raft 39 39,size 651
001'161 34 S301 check new config wanted 2
001'161 34 S200 check new config wanted 2
001'161 35 S201 current config num 1 done
001'164 28 S100 declined [369--3] for not leader
001'178 28 S100 [369--3] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'178 28 S100 do request args:Key 6 type 3 num 1 Client 542732653461723544 Seq 1 
001'178 28 S100 declined [544--1] for not leader
001'178 28 S100 [544--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'178 30 S100 apply index 35 key5 num 1 type 3   lastApplied 34
001'178 31 S100 used size: 591 / 300 
001'179 29 S100 do snapshot for raft 35 35,size 637
001'180 27 S0 raft apply snapshot offset 35 ,lastApplied 40,total log 41, size 529,log cap:7
001'180 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:0, OptType:3, Opt:"W", Num:1}}
001'180 31 S100 after snap shot size529 637
001'180 30 S100 apply index 36 key0 num 1 type 3   lastApplied 35
001'180 31 S100 used size: 529 / 300 
001'180 29 S100 do snapshot for raft 36 36,size 638
001'181 27 S0 raft apply snapshot offset 36 ,lastApplied 40,total log 41, size 467,log cap:6
001'181 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:0, OptType:3, Opt:"W", Num:1}}
001'181 31 S100 after snap shot size467 638
001'181 30 S100 apply index 37 key3 num 1 type 3   lastApplied 36
001'181 31 S100 used size: 467 / 300 
001'167 28 S101 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 8 
001'181 28 S101 declined [ 81--8] for not leader
001'181 28 S101 [ 81--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'181 30 S101 apply index 39 key4 num 1 type 3   lastApplied 38
001'182 31 S101 used size: 404 / 300 
001'182 29 S100 do snapshot for raft 37 37,size 639
001'182 29 S101 do snapshot for raft 39 39,size 651
001'177 35 S300 current config num 1 done
-------start config and restart---------------
001'192 27 S2 raft apply snapshot offset 39 ,lastApplied 41,total log 41, size 281,log cap:3
join &{map[102:[server-102-0 server-102-1 server-102-2]] 1074585914363486070 1}
001'193 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"8", ClientID:2953714763196401582, Seq:0, OptType:3, Opt:"H", Num:1}}
001'193 31 S102 after snap shot size281 651
001'193 30 S102 apply index 40 key7 num 1 type 3   lastApplied 39
001'193 30 S102 apply index 41 key8 num 1 type 3   lastApplied 40
001'193 28 S102 [582--0] successed
001'193 28 S102 [582--0] ok 
001'193 28 S102 [582--0] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
join &{map[102:[server-102-0 server-102-1 server-102-2]] 1074585914363486070 1}
join &{map[102:[server-102-0 server-102-1 server-102-2]] 1074585914363486070 1}
001'196 28 S102 [825--2] successed
001'196 28 S102 [825--2] ok 
001'196 28 S102 [825--2] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'197 28 S102 do request args:Key 3 type 3 num 1 Client 2238025532150463055 Seq 3 
001'198 33 S102 start [ 55--3] as leader?
001'199 34 S300 check new config wanted 2
001'182 27 S0 raft apply snapshot offset 37 ,lastApplied 40,total log 41, size 404,log cap:5
001'207 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:0, OptType:3, Opt:"W", Num:1}}
001'208 31 S100 after snap shot size404 639
001'200 28 S102 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 8 
001'200 35 S202 current config num 1 done
001'200 35 S302 current config num 1 done
001'200 35 S301 current config num 1 done
001'200 35 S200 current config num 1 done
001'200 27 S1 raft apply snapshot offset 39 ,lastApplied 40,total log 41, size 281,log cap:3
001'203 36 S582 [0] clerk putAppend okkkkk
001'208 35 S100 current config num 1 done
001'213 33 S102 start [ 81--8] as leader?
001'213 35 S102 current config num 1 done
001'213 28 S102 do request args:Key 2 type 3 num 1 Client 1679014388048817729 Seq 4 
001'214 33 S102 start [729--4] as leader?
001'214 28 S102 [667--0] successed
001'214 28 S102 [667--0] ok 
001'214 28 S102 [667--0] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'214 28 S102 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 5 
001'215 33 S102 start [479--5] as leader?
001'215 36 S667 [0] clerk putAppend okkkkk
001'223 44 S2 ctrler change to config &{2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
join &{map[101:[server-101-0 server-101-1 server-101-2]] 1074585914363486070 2}
001'229 35 S201 current config num 1 done
001'229 30 S102 apply index 42 key3 num 1 type 3   lastApplied 41
001'229 31 S102 used size: 531 / 300 
join &{map[101:[server-101-0 server-101-1 server-101-2]] 1074585914363486070 2}
001'234 29 S102 do snapshot for raft 42 42,size 674
001'235 27 S2 raft apply snapshot offset 42 ,lastApplied 45,total log 45, size 348,log cap:4
001'235 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"1", ClientID:418781717203629479, Seq:5, OptType:3, Opt:"P", Num:1}}
001'235 31 S102 after snap shot size348 674
001'235 30 S102 apply index 43 key0 num 1 type 3   lastApplied 42
001'235 31 S102 used size: 348 / 300 
001'235 28 S100 do request args:Key 9 type 3 num 1 Client 3620950086299709532 Seq 0 
001'235 28 S100 declined [532--0] for not leader
001'211 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:0, OptType:3, Opt:"W", Num:1}}
001'235 31 S101 after snap shot size281 651
001'235 30 S101 apply index 40 key7 num 1 type 3   lastApplied 39
001'235 30 S100 apply index 38 key6 num 1 type 3   lastApplied 37
001'235 31 S100 used size: 653 / 300 
001'235 28 S100 [532--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'235 35 S101 current config num 1 done
001'236 28 S101 do request args:Key 6 type 3 num 1 Client 542732653461723544 Seq 1 
001'236 44 S1 ctrler change to config &{2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
001'236 35 S300 current config num 1 done
001'238 29 S102 do snapshot for raft 43 43,size 675
001'238 27 S2 raft apply snapshot offset 43 ,lastApplied 45,total log 45, size 285,log cap:3
join &{map[101:[server-101-0 server-101-1 server-101-2]] 1074585914363486070 2}
001'239 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"1", ClientID:418781717203629479, Seq:5, OptType:3, Opt:"P", Num:1}}
001'239 31 S102 after snap shot size285 675
001'239 30 S102 apply index 44 key2 num 1 type 3   lastApplied 43
001'239 30 S102 apply index 45 key1 num 1 type 3   lastApplied 44
001'239 28 S102 [479--5] successed
001'239 28 S102 [479--5] ok 
001'239 28 S102 [479--5] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'239 28 S102 [ 81--8] successed
001'239 28 S102 [ 81--8] ok 
001'239 28 S102 [ 81--8] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'239 28 S102 [ 55--3] successed
001'239 28 S102 [ 55--3] ok 
001'239 28 S102 [ 55--3] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'240 28 S102 [729--4] successed
001'240 28 S102 [729--4] ok 
001'240 28 S102 [729--4] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'241 36 S81 [8] clerk putAppend okkkkk
001'242 36 S729 [4] clerk putAppend okkkkk
001'243 36 S479 [5] clerk putAppend okkkkk
001'244 36 S55 [3] clerk putAppend okkkkk
001'245 29 S100 do snapshot for raft 38 38,size 650
001'246 27 S0 raft apply snapshot offset 38 ,lastApplied 41,total log 45, size 593,log cap:8
001'246 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"8", ClientID:2953714763196401582, Seq:0, OptType:3, Opt:"H", Num:1}}
001'246 31 S100 after snap shot size593 650
001'246 28 S101 declined [544--1] for not leader
001'246 28 S101 [544--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'246 28 S101 do request args:Key 5 type 3 num 1 Client 3482757038087095369 Seq 3 
001'246 28 S101 declined [369--3] for not leader
001'246 28 S101 [369--3] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'246 30 S101 apply index 41 key8 num 1 type 3   lastApplied 40
001'246 31 S101 used size: 531 / 300 
001'247 28 S100 do request args:Key 7 type 3 num 1 Client 2972145661651991667 Seq 1 
001'247 28 S100 declined [667--1] for not leader
001'247 28 S100 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 9 
001'247 28 S100 declined [ 81--9] for not leader
001'247 28 S100 [667--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'247 28 S100 do request args:Key 3 type 3 num 1 Client 2238025532150463055 Seq 4 
001'247 28 S100 declined [ 55--4] for not leader
001'247 28 S100 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 6 
001'247 28 S100 declined [479--6] for not leader
001'247 28 S100 do request args:Key 2 type 3 num 1 Client 1679014388048817729 Seq 5 
001'247 28 S100 declined [729--5] for not leader
001'247 30 S100 apply index 39 key4 num 1 type 3   lastApplied 38
001'247 31 S100 used size: 593 / 300 
001'247 28 S100 [ 81--9] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'247 28 S100 [ 55--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'247 28 S100 [479--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'247 28 S100 [729--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'249 36 S825 [2] clerk putAppend okkkkk
001'254 34 S301 got new config {2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 1
001'255 34 S301 propose new config 2
001'256 29 S101 do snapshot for raft 41 41,size 673
001'256 27 S1 raft apply snapshot offset 41 ,lastApplied 41,total log 45, size 410,log cap:5
001'257 31 S101 after snap shot size410 673
001'257 44 S0 ctrler change to config &{2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
001'259 28 S102 do request args:Key 5 type 3 num 1 Client 3482757038087095369 Seq 3 
001'260 33 S102 start [369--3] as leader?
001'260 35 S302 current config num 1 done
001'260 35 S301 current config num 1 done
001'260 35 S200 current config num 1 done
001'260 35 S202 current config num 1 done
001'261 28 S101 do request args:Key 9 type 3 num 1 Client 3620950086299709532 Seq 0 
001'261 28 S101 declined [532--0] for not leader
001'261 28 S101 [532--0] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'262 29 S100 do snapshot for raft 39 39,size 651
001'262 28 S102 do request args:Key 6 type 3 num 1 Client 542732653461723544 Seq 1 
001'263 33 S102 start [544--1] as leader?
001'263 28 S102 do request args:Key 9 type 3 num 1 Client 3620950086299709532 Seq 0 
001'264 27 S0 raft apply snapshot offset 39 ,lastApplied 41,total log 45, size 531,log cap:7
001'264 28 S101 do request args:Key 7 type 3 num 1 Client 2972145661651991667 Seq 1 
001'264 28 S101 declined [667--1] for not leader
001'264 28 S101 [667--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'264 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"8", ClientID:2953714763196401582, Seq:0, OptType:3, Opt:"H", Num:1}}
001'264 31 S100 after snap shot size531 651
001'264 30 S100 apply index 40 key7 num 1 type 3   lastApplied 39
001'264 31 S100 used size: 531 / 300 
001'266 28 S101 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 9 
001'266 28 S101 declined [ 81--9] for not leader
001'266 28 S101 [ 81--9] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'269 29 S100 do snapshot for raft 40 40,size 662
001'270 28 S101 do request args:Key 3 type 3 num 1 Client 2238025532150463055 Seq 4 
001'270 28 S101 declined [ 55--4] for not leader
001'270 28 S101 [ 55--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'270 27 S0 raft apply snapshot offset 40 ,lastApplied 41,total log 45, size 471,log cap:6
001'275 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"8", ClientID:2953714763196401582, Seq:0, OptType:3, Opt:"H", Num:1}}
001'275 31 S100 after snap shot size471 662
001'275 28 S100 do request args:Key 4 type 3 num 1 Client 132246879705026825 Seq 3 
001'276 28 S100 declined [825--3] for not leader
001'276 35 S100 current config num 1 done
001'276 28 S100 [825--3] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'276 28 S100 do request args:Key 8 type 3 num 1 Client 2953714763196401582 Seq 1 
001'277 28 S100 declined [582--1] for not leader
001'277 30 S100 apply index 41 key8 num 1 type 3   lastApplied 40
001'277 31 S100 used size: 471 / 300 
001'277 29 S100 do snapshot for raft 41 41,size 673
001'281 33 S102 start [532--0] as leader?
001'282 44 S2 ctrler change to config &{3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
001'282 35 S102 current config num 1 done
001'284 27 S0 raft apply snapshot offset 41 ,lastApplied 41,total log 45, size 410,log cap:5
001'284 31 S100 after snap shot size410 673
001'284 30 S101 apply index 42 key3 num 1 type 3   lastApplied 41
001'284 31 S101 used size: 595 / 300 
001'285 29 S101 do snapshot for raft 42 42,size 674
001'285 30 S102 apply index 46 key5 num 1 type 3   lastApplied 45
001'285 31 S102 used size: 471 / 300 
001'286 29 S102 do snapshot for raft 46 46,size 678
001'286 27 S2 raft apply snapshot offset 46 ,lastApplied 48,total log 48, size 283,log cap:3
001'286 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"9", ClientID:3620950086299709532, Seq:0, OptType:3, Opt:"w", Num:1}}
001'286 31 S102 after snap shot size283 678
001'286 30 S102 apply index 47 key6 num 1 type 3   lastApplied 46
001'287 30 S102 apply index 48 key9 num 1 type 3   lastApplied 47
001'287 28 S102 [532--0] successed
001'287 28 S102 [532--0] ok 
001'287 28 S102 [532--0] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'287 27 S1 raft apply snapshot offset 42 ,lastApplied 45,total log 48, size 533,log cap:7
001'287 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"1", ClientID:418781717203629479, Seq:5, OptType:3, Opt:"P", Num:1}}
001'287 31 S101 after snap shot size533 674
001'287 30 S101 apply index 43 key0 num 1 type 3   lastApplied 42
001'287 31 S101 used size: 533 / 300 
001'288 29 S101 do snapshot for raft 43 43,size 675
001'288 27 S1 raft apply snapshot offset 43 ,lastApplied 45,total log 48, size 471,log cap:6
001'288 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"1", ClientID:418781717203629479, Seq:5, OptType:3, Opt:"P", Num:1}}
001'288 31 S101 after snap shot size471 675
001'288 30 S101 apply index 44 key2 num 1 type 3   lastApplied 43
001'288 31 S101 used size: 471 / 300 
001'289 34 S300 got new config {2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 1
001'289 28 S102 [369--3] successed
001'289 28 S102 [369--3] ok 
001'289 28 S102 [369--3] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'289 29 S101 do snapshot for raft 44 44,size 676
001'289 36 S369 [3] clerk putAppend okkkkk
001'289 28 S102 [544--1] successed
001'290 28 S102 [544--1] ok 
001'290 28 S102 [544--1] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'290 35 S300 current config num 1 done
001'290 35 S201 current config num 1 done
001'290 36 S544 [1] clerk putAppend okkkkk
001'290 27 S1 raft apply snapshot offset 44 ,lastApplied 45,total log 48, size 408,log cap:5
001'292 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"1", ClientID:418781717203629479, Seq:5, OptType:3, Opt:"P", Num:1}}
001'292 36 S532 [0] clerk putAppend okkkkk
001'292 31 S101 after snap shot size408 676
001'292 30 S101 apply index 45 key1 num 1 type 3   lastApplied 44
001'292 31 S101 used size: 408 / 300 
001'293 29 S101 do snapshot for raft 45 45,size 677
001'293 27 S1 raft apply snapshot offset 45 ,lastApplied 45,total log 48, size 346,log cap:4
001'293 31 S101 after snap shot size346 677
001'293 28 S100 do request args:Key 5 type 3 num 1 Client 3482757038087095369 Seq 4 
001'294 28 S100 declined [369--4] for not leader
001'294 28 S100 [369--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'294 34 S200 got new config {2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 1
001'295 34 S200 propose new config 2
001'295 28 S100 do request args:Key 6 type 3 num 1 Client 542732653461723544 Seq 2 
001'295 28 S100 declined [544--2] for not leader
001'295 28 S100 [544--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'297 28 S100 do request args:Key 9 type 3 num 1 Client 3620950086299709532 Seq 1 
001'297 28 S100 declined [532--1] for not leader
001'297 28 S100 [532--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'299 28 S101 do request args:Key 6 type 3 num 1 Client 542732653461723544 Seq 2 
001'299 28 S101 declined [544--2] for not leader
001'299 28 S101 [544--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'300 28 S101 do request args:Key 5 type 3 num 1 Client 3482757038087095369 Seq 4 
001'300 28 S101 declined [369--4] for not leader
001'300 28 S101 [369--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'300 29 S100 recv Installsnapshot 46 41
001'300 27 S0 raft apply snapshot offset 46 ,lastApplied 46,total log 46, size 82,log cap:1
001'300 29 S100 decide Installsnapshot 46 <- 41
001'301 30 S100 install snap index 46,config {1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 pending shards [false false false false false false false false false false]
001'302 28 S101 do request args:Key 9 type 3 num 1 Client 3620950086299709532 Seq 1 
001'302 28 S101 declined [532--1] for not leader
001'302 28 S101 [532--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'304 28 S102 do request args:Key 6 type 3 num 1 Client 542732653461723544 Seq 2 
001'305 33 S102 start [544--2] as leader?
001'305 28 S102 do request args:Key 9 type 3 num 1 Client 3620950086299709532 Seq 1 
001'306 35 S101 current config num 1 done
001'309 28 S101 do request args:Key 4 type 3 num 1 Client 132246879705026825 Seq 3 
001'309 28 S101 declined [825--3] for not leader
001'309 28 S101 [825--3] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'312 33 S102 start [532--1] as leader?
001'313 28 S102 do request args:Key 3 type 3 num 1 Client 2238025532150463055 Seq 4 
001'313 35 S200 current config num 1 done
001'313 34 S202 check new config wanted 2
001'313 34 S201 check new config wanted 2
001'313 35 S302 current config num 1 done
001'313 34 S100 check new config wanted 2
001'313 35 S301 current config num 1 done
001'313 35 S202 current config num 1 done
001'313 34 S101 check new config wanted 2
001'313 34 S302 check new config wanted 2
001'319 30 S200 apply index 3 key num 0 type 4   lastApplied 2
001'319 34 S200 apply new config num 2 :&{2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
001'319 34 S200 inited need send [],need recv []
001'319 31 S200 used size: 459 / 300 
001'319 44 S1 ctrler change to config &{3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
001'320 29 S200 do snapshot for raft 3 3,size 454
001'284 28 S100 [582--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'320 28 S101 do request args:Key 2 type 3 num 1 Client 1679014388048817729 Seq 5 
001'320 28 S101 declined [729--5] for not leader
001'320 28 S101 [729--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'321 28 S101 do request args:Key 8 type 3 num 1 Client 2953714763196401582 Seq 1 
001'321 28 S101 declined [582--1] for not leader
001'321 28 S101 [582--1] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'322 33 S102 start [ 55--4] as leader?
001'323 28 S102 do request args:Key 8 type 3 num 1 Client 2953714763196401582 Seq 1 
001'323 33 S102 start [582--1] as leader?
001'324 34 S102 check new config wanted 2
001'325 28 S102 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 9 
001'326 33 S102 start [ 81--9] as leader?
001'326 30 S301 apply index 3 key num 0 type 4   lastApplied 2
001'326 34 S301 apply new config num 2 :&{2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
001'326 34 S301 inited need send [],need recv [0 1 2 3 4]
001'326 31 S301 used size: 459 / 300 
001'327 29 S301 do snapshot for raft 3 3,size 454
001'327 27 S1 raft apply snapshot offset 3 ,lastApplied 3,total log 3, size 82,log cap:1
001'327 31 S301 after snap shot size82 454
001'328 28 S101 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 6 
001'328 28 S101 declined [479--6] for not leader
001'328 28 S101 [479--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'330 28 S102 do request args:Key 5 type 3 num 1 Client 3482757038087095369 Seq 4 
001'331 33 S102 start [369--4] as leader?
001'333 28 S102 do request args:Key 2 type 3 num 1 Client 1679014388048817729 Seq 5 
001'334 33 S102 start [729--5] as leader?
001'337 27 S0 raft apply snapshot offset 3 ,lastApplied 3,total log 3, size 82,log cap:1
001'337 31 S200 after snap shot size82 454
001'336 35 S100 current config num 1 done
001'343 30 S100 apply index 47 key6 num 1 type 3   lastApplied 46
001'343 31 S100 used size: 533 / 300 
001'343 35 S201 current config num 1 done
001'343 35 S300 current config num 1 done
001'344 29 S100 do snapshot for raft 47 47,size 679
001'336 35 S102 current config num 1 done
001'344 28 S102 do request args:Key 4 type 3 num 1 Client 132246879705026825 Seq 3 
001'344 30 S101 apply index 46 key5 num 1 type 3   lastApplied 45
001'344 31 S101 used size: 533 / 300 
001'346 27 S0 raft apply snapshot offset 47 ,lastApplied 48,total log 52, size 471,log cap:6
001'346 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"9", ClientID:3620950086299709532, Seq:0, OptType:3, Opt:"w", Num:1}}
001'346 31 S100 after snap shot size471 679
001'346 30 S100 apply index 48 key9 num 1 type 3   lastApplied 47
001'346 31 S100 used size: 471 / 300 
001'346 29 S100 do snapshot for raft 48 48,size 690
001'347 27 S0 raft apply snapshot offset 48 ,lastApplied 48,total log 52, size 410,log cap:5
001'347 31 S100 after snap shot size410 690
001'347 33 S102 start [825--3] as leader?
001'347 28 S102 do request args:Key 7 type 3 num 1 Client 2972145661651991667 Seq 1 
001'348 33 S102 start [667--1] as leader?
001'350 28 S102 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 6 
001'351 33 S102 start [479--6] as leader?
001'354 30 S102 apply index 49 key6 num 1 type 3   lastApplied 48
001'354 31 S102 used size: 905 / 300 
001'355 29 S102 do snapshot for raft 49 49,size 691
001'355 27 S2 raft apply snapshot offset 49 ,lastApplied 55,total log 58, size 721,log cap:10
001'355 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"2", ClientID:1679014388048817729, Seq:5, OptType:3, Opt:"I", Num:1}}
001'356 31 S102 after snap shot size721 691
001'356 30 S102 apply index 50 key9 num 1 type 3   lastApplied 49
001'356 31 S102 used size: 721 / 300 
001'356 29 S102 do snapshot for raft 50 50,size 692
001'359 29 S101 do snapshot for raft 46 46,size 678
001'359 44 S0 ctrler change to config &{3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
001'359 27 S1 raft apply snapshot offset 46 ,lastApplied 48,total log 51, size 471,log cap:6
001'359 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"9", ClientID:3620950086299709532, Seq:0, OptType:3, Opt:"w", Num:1}}
001'359 31 S101 after snap shot size471 678
001'359 30 S101 apply index 47 key6 num 1 type 3   lastApplied 46
001'359 31 S101 used size: 471 / 300 
001'360 29 S101 do snapshot for raft 47 47,size 679
001'361 27 S1 raft apply snapshot offset 47 ,lastApplied 48,total log 51, size 408,log cap:5
001'361 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"9", ClientID:3620950086299709532, Seq:0, OptType:3, Opt:"w", Num:1}}
001'361 31 S101 after snap shot size408 679
001'361 30 S101 apply index 48 key9 num 1 type 3   lastApplied 47
001'361 31 S101 used size: 408 / 300 
001'362 29 S101 do snapshot for raft 48 48,size 690
001'362 27 S1 raft apply snapshot offset 48 ,lastApplied 48,total log 51, size 348,log cap:4
001'362 31 S101 after snap shot size348 690
001'363 27 S2 raft apply snapshot offset 50 ,lastApplied 55,total log 58, size 659,log cap:9
001'363 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"2", ClientID:1679014388048817729, Seq:5, OptType:3, Opt:"I", Num:1}}
001'363 31 S102 after snap shot size659 692
001'363 30 S102 apply index 51 key3 num 1 type 3   lastApplied 50
001'363 31 S102 used size: 659 / 300 
001'364 29 S102 do snapshot for raft 51 51,size 693
001'364 27 S2 raft apply snapshot offset 51 ,lastApplied 55,total log 58, size 597,log cap:8
001'364 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"2", ClientID:1679014388048817729, Seq:5, OptType:3, Opt:"I", Num:1}}
001'365 31 S102 after snap shot size597 693
001'365 30 S102 apply index 52 key8 num 1 type 3   lastApplied 51
001'365 31 S102 used size: 597 / 300 
001'365 29 S102 do snapshot for raft 52 52,size 694
001'366 34 S301 check new config wanted 3
001'372 35 S202 current config num 1 done
001'373 27 S2 raft apply snapshot offset 52 ,lastApplied 55,total log 58, size 535,log cap:7
001'373 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"2", ClientID:1679014388048817729, Seq:5, OptType:3, Opt:"I", Num:1}}
001'373 31 S102 after snap shot size535 694
001'373 30 S102 apply index 53 key0 num 1 type 3   lastApplied 52
001'373 31 S102 used size: 535 / 300 
001'374 29 S102 do snapshot for raft 53 53,size 695
001'374 27 S2 raft apply snapshot offset 53 ,lastApplied 55,total log 58, size 473,log cap:6
001'374 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"2", ClientID:1679014388048817729, Seq:5, OptType:3, Opt:"I", Num:1}}
001'374 31 S102 after snap shot size473 695
001'374 30 S102 apply index 54 key5 num 1 type 3   lastApplied 53
001'374 31 S102 used size: 473 / 300 
001'375 29 S102 do snapshot for raft 54 54,size 696
001'376 27 S2 raft apply snapshot offset 54 ,lastApplied 55,total log 58, size 410,log cap:5
001'376 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"2", ClientID:1679014388048817729, Seq:5, OptType:3, Opt:"I", Num:1}}
001'376 31 S102 after snap shot size410 696
001'376 30 S102 apply index 55 key2 num 1 type 3   lastApplied 54
001'376 31 S102 used size: 410 / 300 
001'377 29 S102 do snapshot for raft 55 55,size 697
001'377 30 S100 apply index 49 key6 num 1 type 3   lastApplied 48
001'377 31 S100 used size: 721 / 300 
001'378 27 S2 raft apply snapshot offset 55 ,lastApplied 55,total log 58, size 348,log cap:4
001'379 29 S100 do snapshot for raft 49 49,size 691
001'380 27 S0 raft apply snapshot offset 49 ,lastApplied 55,total log 57, size 659,log cap:9
001'380 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"2", ClientID:1679014388048817729, Seq:5, OptType:3, Opt:"I", Num:1}}
001'380 31 S100 after snap shot size659 691
001'380 30 S100 apply index 50 key9 num 1 type 3   lastApplied 49
001'380 31 S100 used size: 659 / 300 
001'380 29 S100 do snapshot for raft 50 50,size 692
001'381 27 S0 raft apply snapshot offset 50 ,lastApplied 55,total log 57, size 597,log cap:8
001'381 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"2", ClientID:1679014388048817729, Seq:5, OptType:3, Opt:"I", Num:1}}
001'381 31 S100 after snap shot size597 692
001'381 30 S100 apply index 51 key3 num 1 type 3   lastApplied 50
001'381 31 S100 used size: 597 / 300 
001'382 29 S100 do snapshot for raft 51 51,size 693
001'382 27 S0 raft apply snapshot offset 51 ,lastApplied 55,total log 57, size 535,log cap:7
001'382 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"2", ClientID:1679014388048817729, Seq:5, OptType:3, Opt:"I", Num:1}}
001'382 31 S100 after snap shot size535 693
001'383 30 S100 apply index 52 key8 num 1 type 3   lastApplied 51
001'383 31 S100 used size: 535 / 300 
001'383 35 S101 current config num 1 done
001'383 35 S200 current config num 2 done
001'383 35 S302 current config num 1 done
001'383 35 S301 num 2 waiting [0 1 2 3 4] shards 
001'385 29 S100 do snapshot for raft 52 52,size 694
001'385 27 S0 raft apply snapshot offset 52 ,lastApplied 55,total log 57, size 473,log cap:6
001'385 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"2", ClientID:1679014388048817729, Seq:5, OptType:3, Opt:"I", Num:1}}
001'386 31 S100 after snap shot size473 694
001'386 30 S100 apply index 53 key0 num 1 type 3   lastApplied 52
001'386 31 S100 used size: 473 / 300 
001'386 29 S100 do snapshot for raft 53 53,size 695
001'387 27 S0 raft apply snapshot offset 53 ,lastApplied 55,total log 57, size 410,log cap:5
001'387 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"2", ClientID:1679014388048817729, Seq:5, OptType:3, Opt:"I", Num:1}}
001'387 31 S100 after snap shot size410 695
001'387 30 S100 apply index 54 key5 num 1 type 3   lastApplied 53
001'387 31 S100 used size: 410 / 300 
001'387 29 S100 do snapshot for raft 54 54,size 696
001'388 27 S0 raft apply snapshot offset 54 ,lastApplied 55,total log 57, size 348,log cap:4
001'388 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"2", ClientID:1679014388048817729, Seq:5, OptType:3, Opt:"I", Num:1}}
001'388 31 S100 after snap shot size348 696
001'388 30 S100 apply index 55 key2 num 1 type 3   lastApplied 54
001'388 31 S100 used size: 348 / 300 
001'389 29 S100 do snapshot for raft 55 55,size 697
001'389 27 S0 raft apply snapshot offset 55 ,lastApplied 55,total log 57, size 285,log cap:3
001'389 31 S100 after snap shot size285 697
001'389 31 S102 after snap shot size348 697
001'389 28 S102 [369--4] successed
001'389 28 S102 [369--4] ok 
001'389 28 S102 [369--4] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'390 35 S100 current config num 1 done
001'391 28 S102 [729--5] successed
001'391 28 S102 [729--5] ok 
001'392 28 S102 [729--5] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'393 28 S102 [582--1] successed
001'393 28 S102 [582--1] ok 
001'393 28 S102 [582--1] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'394 35 S300 current config num 1 done
001'395 28 S102 [ 81--9] successed
001'395 28 S102 [ 81--9] ok 
001'395 28 S102 [ 81--9] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'396 36 S582 [1] clerk putAppend okkkkk
001'396 35 S201 current config num 1 done
001'397 36 S369 [4] clerk putAppend okkkkk
001'398 30 S102 apply index 56 key4 num 1 type 3   lastApplied 55
001'398 31 S102 used size: 348 / 300 
001'398 29 S102 do snapshot for raft 56 56,size 698
001'399 34 S200 check new config wanted 3
001'399 27 S2 raft apply snapshot offset 56 ,lastApplied 58,total log 58, size 285,log cap:3
001'399 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"1", ClientID:418781717203629479, Seq:6, OptType:3, Opt:"B", Num:1}}
001'399 31 S102 after snap shot size285 698
001'399 30 S102 apply index 57 key7 num 1 type 3   lastApplied 56
001'399 30 S102 apply index 58 key1 num 1 type 3   lastApplied 57
001'399 28 S102 [667--1] successed
001'399 34 S300 check new config wanted 2
001'400 36 S729 [5] clerk putAppend okkkkk
001'400 36 S81 [9] clerk putAppend okkkkk
001'401 28 S100 do request args:Key 8 type 3 num 1 Client 2953714763196401582 Seq 2 
001'401 28 S100 declined [582--2] for not leader
001'401 28 S100 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'402 28 S101 do request args:Key 8 type 3 num 1 Client 2953714763196401582 Seq 2 
001'402 28 S101 declined [582--2] for not leader
001'402 28 S101 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'403 28 S100 do request args:Key 5 type 3 num 1 Client 3482757038087095369 Seq 5 
001'403 28 S100 declined [369--5] for not leader
001'403 28 S100 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'408 28 S100 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 10 
001'409 28 S100 declined [ 81--10] for not leader
001'409 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'411 30 S101 apply index 49 key6 num 1 type 3   lastApplied 48
001'411 31 S101 used size: 783 / 300 
001'412 29 S101 do snapshot for raft 49 49,size 691
001'413 27 S1 raft apply snapshot offset 49 ,lastApplied 56,total log 58, size 721,log cap:10
001'413 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"4", ClientID:132246879705026825, Seq:3, OptType:3, Opt:"H", Num:1}}
001'413 31 S101 after snap shot size721 691
001'413 30 S101 apply index 50 key9 num 1 type 3   lastApplied 49
001'413 31 S101 used size: 721 / 300 
001'414 29 S101 do snapshot for raft 50 50,size 692
001'414 27 S1 raft apply snapshot offset 50 ,lastApplied 56,total log 58, size 659,log cap:9
001'415 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"4", ClientID:132246879705026825, Seq:3, OptType:3, Opt:"H", Num:1}}
001'415 31 S101 after snap shot size659 692
001'415 30 S101 apply index 51 key3 num 1 type 3   lastApplied 50
001'415 31 S101 used size: 659 / 300 
001'415 29 S101 do snapshot for raft 51 51,size 693
001'416 27 S1 raft apply snapshot offset 51 ,lastApplied 56,total log 58, size 597,log cap:8
001'416 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"4", ClientID:132246879705026825, Seq:3, OptType:3, Opt:"H", Num:1}}
001'416 31 S101 after snap shot size597 693
001'416 30 S101 apply index 52 key8 num 1 type 3   lastApplied 51
001'416 31 S101 used size: 597 / 300 
001'417 29 S101 do snapshot for raft 52 52,size 694
001'417 27 S1 raft apply snapshot offset 52 ,lastApplied 56,total log 58, size 535,log cap:7
001'417 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"4", ClientID:132246879705026825, Seq:3, OptType:3, Opt:"H", Num:1}}
001'417 31 S101 after snap shot size535 694
001'417 30 S101 apply index 53 key0 num 1 type 3   lastApplied 52
001'417 31 S101 used size: 535 / 300 
001'418 29 S101 do snapshot for raft 53 53,size 695
001'418 27 S1 raft apply snapshot offset 53 ,lastApplied 56,total log 58, size 473,log cap:6
001'418 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"4", ClientID:132246879705026825, Seq:3, OptType:3, Opt:"H", Num:1}}
001'419 31 S101 after snap shot size473 695
001'419 30 S101 apply index 54 key5 num 1 type 3   lastApplied 53
001'419 31 S101 used size: 473 / 300 
001'419 29 S101 do snapshot for raft 54 54,size 696
001'420 27 S1 raft apply snapshot offset 54 ,lastApplied 56,total log 58, size 410,log cap:5
001'420 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"4", ClientID:132246879705026825, Seq:3, OptType:3, Opt:"H", Num:1}}
001'420 31 S101 after snap shot size410 696
001'420 30 S101 apply index 55 key2 num 1 type 3   lastApplied 54
001'420 31 S101 used size: 410 / 300 
001'420 30 S302 apply index 3 key num 0 type 4   lastApplied 2
001'420 34 S302 apply new config num 2 :&{2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
001'421 34 S302 inited need send [],need recv [0 1 2 3 4]
001'421 31 S302 used size: 459 / 300 
001'421 29 S302 do snapshot for raft 3 3,size 454
001'399 28 S102 [667--1] ok 
001'423 28 S102 [544--2] successed
001'423 28 S102 [544--2] ok 
001'424 30 S300 apply index 3 key num 0 type 4   lastApplied 2
001'424 34 S300 apply new config num 2 :&{2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
001'424 34 S300 inited need send [],need recv [0 1 2 3 4]
001'424 31 S300 used size: 459 / 300 
001'424 34 S302 got new config {2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 1
001'425 35 S202 current config num 1 done
001'425 29 S300 do snapshot for raft 3 3,size 454
001'421 27 S2 raft apply snapshot offset 3 ,lastApplied 3,total log 3, size 82,log cap:1
001'425 31 S302 after snap shot size82 454
001'425 27 S0 raft apply snapshot offset 3 ,lastApplied 3,total log 3, size 82,log cap:1
001'425 31 S300 after snap shot size82 454
001'425 28 S102 [544--2] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'426 28 S102 [667--1] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'427 36 S667 [1] clerk putAppend okkkkk
001'427 28 S100 do request args:Key 2 type 3 num 1 Client 1679014388048817729 Seq 6 
001'427 28 S100 declined [729--6] for not leader
001'427 28 S100 [729--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'427 28 S102 [ 55--4] successed
001'427 28 S102 [ 55--4] ok 
001'428 36 S544 [2] clerk putAppend okkkkk
001'429 34 S101 got new config {2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 1
001'429 34 S201 got new config {2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 1
001'430 28 S102 [532--1] successed
001'430 28 S102 [532--1] ok 
001'430 28 S102 [825--3] successed
001'430 28 S102 [825--3] ok 
001'430 28 S102 [479--6] successed
001'430 28 S102 [479--6] ok 
001'430 35 S102 current config num 1 done
001'430 28 S102 [ 55--4] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'431 28 S102 [532--1] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'431 28 S102 [825--3] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'431 28 S102 [479--6] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'431 28 S100 do request args:Key 6 type 3 num 1 Client 542732653461723544 Seq 3 
001'431 29 S101 do snapshot for raft 55 55,size 697
001'431 28 S100 declined [544--3] for not leader
001'431 28 S100 [544--3] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'432 27 S1 raft apply snapshot offset 55 ,lastApplied 56,total log 58, size 348,log cap:4
001'432 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"4", ClientID:132246879705026825, Seq:3, OptType:3, Opt:"H", Num:1}}
001'432 31 S101 after snap shot size348 697
001'432 30 S101 apply index 56 key4 num 1 type 3   lastApplied 55
001'432 31 S101 used size: 348 / 300 
001'432 29 S101 do snapshot for raft 56 56,size 698
001'433 27 S1 raft apply snapshot offset 56 ,lastApplied 56,total log 58, size 285,log cap:3
001'433 31 S101 after snap shot size285 698
001'433 35 S200 current config num 2 done
001'433 35 S302 num 2 waiting [0 1 2 3 4] shards 
001'433 35 S101 current config num 1 done
001'433 35 S301 num 2 waiting [0 1 2 3 4] shards 
001'435 30 S202 apply index 3 key num 0 type 4   lastApplied 2
001'435 34 S202 apply new config num 2 :&{2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
001'435 34 S202 inited need send [],need recv []
001'435 31 S202 used size: 459 / 300 
001'436 29 S202 do snapshot for raft 3 3,size 454
001'436 27 S2 raft apply snapshot offset 3 ,lastApplied 3,total log 3, size 82,log cap:1
001'436 31 S202 after snap shot size82 454
001'440 35 S100 current config num 1 done
001'441 30 S201 apply index 3 key num 0 type 4   lastApplied 2
001'441 34 S201 apply new config num 2 :&{2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
001'441 34 S201 inited need send [],need recv []
001'441 31 S201 used size: 459 / 300 
001'442 29 S201 do snapshot for raft 3 3,size 454
001'442 27 S1 raft apply snapshot offset 3 ,lastApplied 3,total log 3, size 82,log cap:1
001'442 31 S201 after snap shot size82 454
001'442 28 S100 do request args:Key 7 type 3 num 1 Client 2972145661651991667 Seq 2 
001'442 28 S100 declined [667--2] for not leader
001'443 28 S100 [667--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'444 36 S55 [4] clerk putAppend okkkkk
001'445 36 S825 [3] clerk putAppend okkkkk
001'445 36 S479 [6] clerk putAppend okkkkk
001'447 28 S101 do request args:Key 6 type 3 num 1 Client 542732653461723544 Seq 3 
001'447 28 S101 declined [544--3] for not leader
001'447 28 S101 [544--3] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'449 28 S100 do request args:Key 3 type 3 num 1 Client 2238025532150463055 Seq 5 
001'449 28 S100 declined [ 55--5] for not leader
001'449 35 S201 current config num 2 done
001'451 28 S102 do request args:Key 6 type 3 num 1 Client 542732653461723544 Seq 3 
001'452 33 S102 start [544--3] as leader?
001'452 35 S300 num 2 waiting [0 1 2 3 4] shards 
001'449 28 S100 [ 55--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'453 28 S100 do request args:Key 4 type 3 num 1 Client 132246879705026825 Seq 4 
001'453 28 S100 declined [825--4] for not leader
001'453 28 S100 [825--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'450 28 S101 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 10 
001'456 28 S101 declined [ 81--10] for not leader
001'456 28 S101 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'457 28 S101 do request args:Key 2 type 3 num 1 Client 1679014388048817729 Seq 6 
001'457 28 S101 declined [729--6] for not leader
001'457 28 S101 [729--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'462 28 S102 do request args:Key 0 type 3 num 1 Client 940626237948413081 Seq 10 
001'462 33 S102 start [ 81--10] as leader?
001'466 28 S101 do request args:Key 7 type 3 num 1 Client 2972145661651991667 Seq 2 
001'466 28 S101 declined [667--2] for not leader
001'466 28 S101 [667--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'467 28 S101 do request args:Key 4 type 3 num 1 Client 132246879705026825 Seq 4 
001'468 28 S101 declined [825--4] for not leader
001'468 28 S101 [825--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'469 28 S100 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 7 
001'469 28 S100 declined [479--7] for not leader
001'469 28 S100 [479--7] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'469 30 S100 apply index 56 key4 num 1 type 3   lastApplied 55
001'470 31 S100 used size: 410 / 300 
001'471 28 S101 do request args:Key 3 type 3 num 1 Client 2238025532150463055 Seq 5 
001'471 28 S101 declined [ 55--5] for not leader
001'471 34 S100 got new config {2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 1
001'471 28 S101 [ 55--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'472 30 S102 apply index 59 key6 num 1 type 3   lastApplied 58
001'472 31 S102 used size: 410 / 300 
001'472 29 S102 do snapshot for raft 59 59,size 701
001'472 34 S202 got new config {2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 1
001'473 27 S2 raft apply snapshot offset 59 ,lastApplied 59,total log 60, size 223,log cap:2
001'473 31 S102 after snap shot size223 701
001'473 30 S101 apply index 57 key7 num 1 type 3   lastApplied 56
001'473 31 S101 used size: 348 / 300 
001'474 29 S101 do snapshot for raft 57 57,size 699
001'479 28 S102 do request args:Key 2 type 3 num 1 Client 1679014388048817729 Seq 6 
001'479 33 S102 start [729--6] as leader?
001'482 28 S102 do request args:Key 7 type 3 num 1 Client 2972145661651991667 Seq 2 
001'483 33 S102 start [667--2] as leader?
001'483 35 S102 current config num 1 done
001'484 29 S100 do snapshot for raft 56 56,size 698
001'484 34 S102 got new config {2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 1
001'485 27 S0 raft apply snapshot offset 56 ,lastApplied 58,total log 59, size 348,log cap:4
001'485 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"1", ClientID:418781717203629479, Seq:6, OptType:3, Opt:"B", Num:1}}
001'485 31 S100 after snap shot size348 698
001'485 30 S100 apply index 57 key7 num 1 type 3   lastApplied 56
001'485 31 S100 used size: 348 / 300 
001'485 34 S102 propose new config 2
001'485 29 S100 do snapshot for raft 57 57,size 699
001'486 27 S0 raft apply snapshot offset 57 ,lastApplied 58,total log 59, size 285,log cap:3
001'486 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"1", ClientID:418781717203629479, Seq:6, OptType:3, Opt:"B", Num:1}}
001'486 31 S100 after snap shot size285 699
001'486 30 S100 apply index 58 key1 num 1 type 3   lastApplied 57
001'486 34 S301 got new config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 2
001'487 34 S301 propose new config 3
001'487 35 S302 num 2 waiting [0 1 2 3 4] shards 
001'487 28 S102 [544--3] successed
001'487 28 S102 [544--3] ok 
001'487 35 S301 num 2 waiting [0 1 2 3 4] shards 
001'487 28 S102 [544--3] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
001'487 35 S200 current config num 2 done
001'487 35 S202 current config num 2 done
001'489 27 S1 raft apply snapshot offset 57 ,lastApplied 58,total log 59, size 285,log cap:3
001'489 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"1", ClientID:418781717203629479, Seq:6, OptType:3, Opt:"B", Num:1}}
001'489 31 S101 after snap shot size285 699
001'489 30 S101 apply index 58 key1 num 1 type 3   lastApplied 57
001'490 35 S101 current config num 1 done
001'490 28 S101 do request args:Key 5 type 3 num 1 Client 3482757038087095369 Seq 5 
001'490 28 S101 declined [369--5] for not leader
001'490 28 S101 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'491 28 S102 do request args:Key 4 type 3 num 1 Client 132246879705026825 Seq 4 
001'492 33 S102 start [825--4] as leader?
001'492 35 S100 current config num 1 done
001'493 34 S300 got new config {2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 1
001'495 30 S101 apply index 59 key6 num 1 type 3   lastApplied 58
001'495 31 S101 used size: 348 / 300 
001'495 29 S101 do snapshot for raft 59 59,size 701
001'496 28 S102 do request args:Key 3 type 3 num 1 Client 2238025532150463055 Seq 5 
001'496 27 S1 raft apply snapshot offset 59 ,lastApplied 59,total log 60, size 223,log cap:2
001'496 31 S101 after snap shot size223 701
001'496 33 S102 start [ 55--5] as leader?
001'499 28 S102 do request args:Key 5 type 3 num 1 Client 3482757038087095369 Seq 5 
001'501 36 S544 [3] clerk putAppend okkkkk
001'502 33 S102 start [369--5] as leader?
001'503 30 S102 apply index 60 key0 num 1 type 3   lastApplied 59
001'503 31 S102 used size: 832 / 300 
001'504 29 S102 do snapshot for raft 60 60,size 702
001'506 27 S2 raft apply snapshot offset 60 ,lastApplied 63,total log 66, size 770,log cap:7
001'506 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:4, Opt:shardctrler.Config{Num:2, Shards:[10]int{102, 102, 102, 102, 102, 100, 100, 100, 100, 100}, Groups:map[int][]string{100:[]string{"server-100-0", "server-100-1", "server-100-2"}, 102:[]string{"server-102-0", "server-102-1", "server-102-2"}}}, Num:0}}
001'506 31 S102 after snap shot size770 702
001'506 30 S102 apply index 61 key2 num 1 type 3   lastApplied 60
001'506 31 S102 used size: 770 / 300 
001'507 29 S102 do snapshot for raft 61 61,size 703
001'508 36 S532 [1] clerk putAppend okkkkk
001'510 27 S2 raft apply snapshot offset 61 ,lastApplied 63,total log 66, size 708,log cap:6
001'510 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:4, Opt:shardctrler.Config{Num:2, Shards:[10]int{102, 102, 102, 102, 102, 100, 100, 100, 100, 100}, Groups:map[int][]string{100:[]string{"server-100-0", "server-100-1", "server-100-2"}, 102:[]string{"server-102-0", "server-102-1", "server-102-2"}}}, Num:0}}
001'510 31 S102 after snap shot size708 703
001'510 30 S102 apply index 62 key7 num 1 type 3   lastApplied 61
001'510 31 S102 used size: 708 / 300 
001'511 29 S102 do snapshot for raft 62 62,size 704
001'512 28 S100 do request args:Key 6 type 3 num 1 Client 542732653461723544 Seq 4 
001'512 28 S100 declined [544--4] for not leader
001'512 28 S100 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'512 28 S100 do request args:Key 9 type 3 num 1 Client 3620950086299709532 Seq 2 
001'513 28 S100 declined [532--2] for not leader
001'513 28 S100 [532--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'513 35 S300 num 2 waiting [0 1 2 3 4] shards 
001'514 35 S201 current config num 2 done
001'515 27 S2 raft apply snapshot offset 62 ,lastApplied 63,total log 66, size 646,log cap:5
001'515 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:4, Opt:shardctrler.Config{Num:2, Shards:[10]int{102, 102, 102, 102, 102, 100, 100, 100, 100, 100}, Groups:map[int][]string{100:[]string{"server-100-0", "server-100-1", "server-100-2"}, 102:[]string{"server-102-0", "server-102-1", "server-102-2"}}}, Num:0}}
001'515 31 S102 after snap shot size646 704
001'515 30 S102 apply index 63 key num 0 type 4   lastApplied 62
001'516 34 S102 apply new config num 2 :&{2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
001'516 34 S102 inited need send [0 1 2 3 4],need recv []
001'516 31 S102 used size: 646 / 300 
001'516 29 S102 do snapshot for raft 63 63,size 746
001'517 27 S2 raft apply snapshot offset 63 ,lastApplied 63,total log 66, size 349,log cap:4
001'518 31 S102 after snap shot size349 746
001'518 30 S301 apply index 4 key num 0 type 4   lastApplied 3
001'518 34 S301 apply new config num 3 failed, for old num 2 still pending:[true true true true true false false false false false]
001'518 31 S301 used size: 503 / 300 
001'519 29 S301 do snapshot for raft 4 4,size 454
001'519 27 S1 raft apply snapshot offset 4 ,lastApplied 4,total log 4, size 82,log cap:1
001'519 31 S301 after snap shot size82 454
001'519 28 S102 [729--6] failed applied ava false
001'519 28 S102 [729--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
001'519 28 S102 [ 81--10] failed applied ava false
001'519 28 S102 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
001'520 28 S102 [667--2] failed applied ava false
001'520 28 S102 [667--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
001'520 28 S102 do request args:Key 8 type 3 num 1 Client 2953714763196401582 Seq 2 
001'520 28 S102 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
001'513 30 S100 apply index 59 key6 num 1 type 3   lastApplied 58
001'523 31 S100 used size: 769 / 300 
001'524 29 S100 do snapshot for raft 59 59,size 701
001'525 27 S0 raft apply snapshot offset 59 ,lastApplied 59,total log 63, size 645,log cap:5
001'525 31 S100 after snap shot size645 701
001'526 34 S302 check new config wanted 3
001'526 30 S100 apply index 60 key0 num 1 type 3   lastApplied 59
001'526 31 S100 used size: 832 / 300 
001'529 29 S100 do snapshot for raft 60 60,size 702
001'529 27 S0 raft apply snapshot offset 60 ,lastApplied 63,total log 66, size 770,log cap:7
001'529 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:4, Opt:shardctrler.Config{Num:2, Shards:[10]int{102, 102, 102, 102, 102, 100, 100, 100, 100, 100}, Groups:map[int][]string{100:[]string{"server-100-0", "server-100-1", "server-100-2"}, 102:[]string{"server-102-0", "server-102-1", "server-102-2"}}}, Num:0}}
001'530 31 S100 after snap shot size770 702
001'530 30 S100 apply index 61 key2 num 1 type 3   lastApplied 60
001'530 31 S100 used size: 770 / 300 
001'530 34 S201 check new config wanted 3
001'530 29 S100 do snapshot for raft 61 61,size 703
001'531 27 S0 raft apply snapshot offset 61 ,lastApplied 63,total log 66, size 708,log cap:6
001'531 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:4, Opt:shardctrler.Config{Num:2, Shards:[10]int{102, 102, 102, 102, 102, 100, 100, 100, 100, 100}, Groups:map[int][]string{100:[]string{"server-100-0", "server-100-1", "server-100-2"}, 102:[]string{"server-102-0", "server-102-1", "server-102-2"}}}, Num:0}}
001'531 31 S100 after snap shot size708 703
001'531 30 S100 apply index 62 key7 num 1 type 3   lastApplied 61
001'531 31 S100 used size: 708 / 300 
001'532 29 S100 do snapshot for raft 62 62,size 704
001'532 27 S0 raft apply snapshot offset 62 ,lastApplied 63,total log 66, size 646,log cap:5
001'532 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:4, Opt:shardctrler.Config{Num:2, Shards:[10]int{102, 102, 102, 102, 102, 100, 100, 100, 100, 100}, Groups:map[int][]string{100:[]string{"server-100-0", "server-100-1", "server-100-2"}, 102:[]string{"server-102-0", "server-102-1", "server-102-2"}}}, Num:0}}
001'533 31 S100 after snap shot size646 704
001'533 30 S100 apply index 63 key num 0 type 4   lastApplied 62
001'533 34 S100 apply new config num 2 :&{2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
001'533 34 S100 inited need send [0 1 2 3 4],need recv []
001'533 31 S100 used size: 646 / 300 
001'534 29 S100 do snapshot for raft 63 63,size 746
001'534 27 S0 raft apply snapshot offset 63 ,lastApplied 63,total log 66, size 349,log cap:4
001'534 31 S100 after snap shot size349 746
001'537 30 S102 apply index 64 key4 num 1 type 3   lastApplied 63
001'537 31 S102 used size: 349 / 300 
001'537 29 S102 do snapshot for raft 64 64,size 747
001'539 34 S101 check new config wanted 2
001'541 30 S101 apply index 60 key0 num 1 type 3   lastApplied 59
001'541 31 S101 used size: 832 / 300 
001'542 29 S101 do snapshot for raft 60 60,size 702
001'543 27 S1 raft apply snapshot offset 60 ,lastApplied 63,total log 66, size 770,log cap:7
001'543 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:4, Opt:shardctrler.Config{Num:2, Shards:[10]int{102, 102, 102, 102, 102, 100, 100, 100, 100, 100}, Groups:map[int][]string{100:[]string{"server-100-0", "server-100-1", "server-100-2"}, 102:[]string{"server-102-0", "server-102-1", "server-102-2"}}}, Num:0}}
001'543 31 S101 after snap shot size770 702
001'543 30 S101 apply index 61 key2 num 1 type 3   lastApplied 60
001'543 31 S101 used size: 770 / 300 
001'544 29 S101 do snapshot for raft 61 61,size 703
001'544 27 S1 raft apply snapshot offset 61 ,lastApplied 63,total log 66, size 708,log cap:6
001'544 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:4, Opt:shardctrler.Config{Num:2, Shards:[10]int{102, 102, 102, 102, 102, 100, 100, 100, 100, 100}, Groups:map[int][]string{100:[]string{"server-100-0", "server-100-1", "server-100-2"}, 102:[]string{"server-102-0", "server-102-1", "server-102-2"}}}, Num:0}}
001'544 31 S101 after snap shot size708 703
001'545 30 S101 apply index 62 key7 num 1 type 3   lastApplied 61
001'545 31 S101 used size: 708 / 300 
001'545 29 S101 do snapshot for raft 62 62,size 704
001'546 27 S1 raft apply snapshot offset 62 ,lastApplied 63,total log 66, size 646,log cap:5
001'546 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:4, Opt:shardctrler.Config{Num:2, Shards:[10]int{102, 102, 102, 102, 102, 100, 100, 100, 100, 100}, Groups:map[int][]string{100:[]string{"server-100-0", "server-100-1", "server-100-2"}, 102:[]string{"server-102-0", "server-102-1", "server-102-2"}}}, Num:0}}
001'546 31 S101 after snap shot size646 704
001'546 30 S101 apply index 63 key num 0 type 4   lastApplied 62
001'546 34 S101 apply new config num 2 :&{2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{1 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
001'546 34 S101 inited need send [0 1 2 3 4],need recv []
001'546 31 S101 used size: 646 / 300 
001'547 29 S101 do snapshot for raft 63 63,size 746
001'547 27 S1 raft apply snapshot offset 63 ,lastApplied 63,total log 66, size 349,log cap:4
001'547 31 S101 after snap shot size349 746
001'548 28 S101 do request args:Key 1 type 3 num 1 Client 418781717203629479 Seq 7 
001'548 28 S101 [479--7] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
001'548 28 S101 do request args:Key 6 type 3 num 1 Client 542732653461723544 Seq 4 
001'548 28 S101 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
001'550 35 S301 num 2 waiting [0 1 2 3 4] shards 
001'550 35 S200 current config num 2 done
001'555 34 S200 got new config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 2
001'556 34 S200 propose new config 3
001'559 35 S100 num 2 sending shards [0 1 2 3 4] to group 102
001'562 35 S302 num 2 waiting [0 1 2 3 4] shards 
001'562 35 S202 current config num 2 done
001'562 35 S101 num 2 sending shards [0 1 2 3 4] to group 102
001'538 27 S2 raft apply snapshot offset 64 ,lastApplied 65,total log 66, size 287,log cap:3
001'563 27 S2 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"3", ClientID:2238025532150463055, Seq:5, OptType:3, Opt:"M", Num:1}}
001'563 31 S102 after snap shot size287 747
001'563 30 S102 apply index 65 key3 num 1 type 3   lastApplied 64
001'567 35 S201 current config num 2 done
001'568 35 S102 num 2 sending shards [0 1 2 3 4] to group 102
001'568 28 S102 [825--4] failed applied ava false
001'568 28 S102 [825--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
001'569 35 S300 num 2 waiting [0 1 2 3 4] shards 
001'570 28 S101 do request args:Key 9 type 3 num 1 Client 3620950086299709532 Seq 2 
001'570 28 S101 [532--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
001'570 35 S300 num 2 handle num 2 move rpc [0 1 2 3 4]
001'570 35 S300 move handle not leader
001'574 28 S102 [ 55--5] failed applied ava false
001'574 28 S102 [ 55--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
001'575 35 S301 num 2 handle num 2 move rpc [0 1 2 3 4]
001'576 35 S301 move handle num 2 shards [0 1 2 3 4] as leader?
001'582 35 S300 num 2 handle num 2 move rpc [0 1 2 3 4]
001'582 35 S300 move handle not leader
001'583 35 S300 num 2 handle num 2 move rpc [0 1 2 3 4]
001'583 30 S200 apply index 4 key num 0 type 4   lastApplied 3
001'583 35 S300 move handle not leader
001'574 34 S202 check new config wanted 3
001'584 30 S102 apply index 66 key5 num 1 type 3   lastApplied 65
001'584 28 S102 [369--5] failed applied ava false
001'584 28 S102 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
001'583 34 S200 apply new config num 3 :&{3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
001'585 34 S200 inited need send [],need recv [0 5 6]
001'585 31 S200 used size: 503 / 300 
001'586 34 S100 check new config wanted 3
001'587 34 S302 got new config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 2
001'590 35 S100 num 2 sending shards [0 1 2 3 4] to group 102
001'590 34 S102 check new config wanted 3
001'591 34 S301 check new config wanted 3
001'594 35 S300 num 2 handle num 2 move rpc [0 1 2 3 4]
001'594 35 S300 move handle not leader
001'595 34 S101 got new config {2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 1
001'596 34 S201 got new config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 2
001'596 35 S101 num 2 sending shards [0 1 2 3 4] to group 102
001'598 35 S102 num 2 sending shards [0 1 2 3 4] to group 102
001'602 34 S300 check new config wanted 3
001'602 29 S200 do snapshot for raft 4 4,size 497
001'602 27 S0 raft apply snapshot offset 4 ,lastApplied 4,total log 4, size 82,log cap:1
001'602 31 S200 after snap shot size82 497
001'602 30 S300 apply index 4 key num 0 type 4   lastApplied 3
001'602 34 S300 apply new config num 3 failed, for old num 2 still pending:[true true true true true false false false false false]
001'603 31 S300 used size: 1016 / 300 
001'603 29 S300 do snapshot for raft 4 4,size 454
001'605 30 S301 apply index 5 key num 0 type 5   lastApplied 4
001'605 35 S301 apply num 2 migration [0 1 2 3 4]
001'605 30 S301 safely recv and decided shard 0
001'605 30 S301 safely recv and decided shard 1
001'605 30 S301 safely recv and decided shard 2
001'605 30 S301 safely recv and decided shard 3
001'605 30 S301 safely recv and decided shard 4
001'605 31 S301 used size: 676 / 300 
001'606 29 S301 do snapshot for raft 5 5,size 600
001'606 27 S1 raft apply snapshot offset 5 ,lastApplied 5,total log 5, size 82,log cap:1
001'606 31 S301 after snap shot size82 600
001'606 35 S301 num 2 move [0 1 2 3 4] is done yet
001'608 35 S200 num 3 waiting [0 5 6] shards 
001'608 35 S301 current config num 2 done
001'612 35 S302 num 2 waiting [0 1 2 3 4] shards 
001'613 35 S202 current config num 2 done
001'613 30 S302 apply index 4 key num 0 type 4   lastApplied 3
001'613 34 S302 apply new config num 3 failed, for old num 2 still pending:[true true true true true false false false false false]
001'613 31 S302 used size: 1016 / 300 
001'614 29 S302 do snapshot for raft 4 4,size 454
001'615 27 S2 raft apply snapshot offset 4 ,lastApplied 4,total log 5, size 676,log cap:2
001'615 31 S302 after snap shot size676 454
001'615 35 S301 num 2 handle num 2 move rpc [0 1 2 3 4]
001'615 35 S301 num 2 move [0 1 2 3 4] is done yet
001'617 35 S301 num 2 handle num 2 move rpc [0 1 2 3 4]
001'617 35 S301 num 2 move [0 1 2 3 4] is done yet
001'617 27 S0 raft apply snapshot offset 4 ,lastApplied 4,total log 5, size 676,log cap:2
001'617 31 S300 after snap shot size676 454
001'617 35 S300 num 2 handle num 2 move rpc [0 1 2 3 4]
001'617 35 S300 move handle not leader
001'617 35 S300 num 2 handle num 2 move rpc [0 1 2 3 4]
001'618 35 S300 move handle not leader
001'618 35 S201 current config num 2 done
001'619 30 S101 after send shards ok
001'619 35 S101 move delete propose not leader
001'619 30 S100 after send shards ok
001'619 35 S100 move delete propose not leader
001'619 35 S300 num 2 waiting [0 1 2 3 4] shards 
001'621 35 S301 num 2 handle num 2 move rpc [0 1 2 3 4]
001'621 35 S301 num 2 move [0 1 2 3 4] is done yet
001'622 30 S100 after send shards ok
001'622 35 S100 move delete propose not leader
001'623 35 S100 num 2 sending shards [0 1 2 3 4] to group 102
001'624 35 S301 num 2 handle num 2 move rpc [0 1 2 3 4]
001'624 35 S301 num 2 move [0 1 2 3 4] is done yet
001'625 30 S101 after send shards ok
001'625 35 S101 move delete propose not leader
001'625 35 S300 num 2 handle num 2 move rpc [0 1 2 3 4]
001'625 35 S300 move handle not leader
001'627 35 S301 num 2 handle num 2 move rpc [0 1 2 3 4]
001'627 35 S301 num 2 move [0 1 2 3 4] is done yet
001'628 30 S100 after send shards ok
001'628 35 S100 move delete propose not leader
001'628 35 S101 num 2 sending shards [0 1 2 3 4] to group 102
001'629 35 S300 num 2 handle num 2 move rpc [0 1 2 3 4]
001'629 35 S300 move handle not leader
001'632 35 S301 num 2 handle num 2 move rpc [0 1 2 3 4]
001'632 35 S301 num 2 move [0 1 2 3 4] is done yet
001'633 30 S101 after send shards ok
001'633 35 S101 move delete propose not leader
001'623 30 S102 after send shards ok
001'637 35 S102 move delete propose num 2 shards [0 1 2 3 4] as leader?
001'637 35 S102 num 2 sending shards [0 1 2 3 4] to group 102
001'641 35 S300 num 2 handle num 2 move rpc [0 1 2 3 4]
001'641 35 S300 move handle not leader
001'653 35 S301 num 2 handle num 2 move rpc [0 1 2 3 4]
001'653 35 S301 num 2 move [0 1 2 3 4] is done yet
001'657 35 S100 num 2 sending shards [0 1 2 3 4] to group 102
001'657 30 S102 apply index 67 key num 0 type 5   lastApplied 66
001'657 35 S102 apply num 2 migration [0 1 2 3 4]
001'658 30 S102 safely delete shard 0
001'658 30 S102 safely delete shard 1
001'658 30 S102 safely delete shard 2
001'658 30 S102 safely delete shard 3
001'658 30 S102 safely delete shard 4
001'658 31 S102 used size: 802 / 300 
001'660 34 S300 got new config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 2
001'660 35 S301 num 2 handle num 2 move rpc [0 1 2 3 4]
001'660 35 S301 num 2 move [0 1 2 3 4] is done yet
001'663 29 S102 do snapshot for raft 67 67,size 601
001'663 27 S2 raft apply snapshot offset 67 ,lastApplied 67,total log 67, size 84,log cap:1
001'663 31 S102 after snap shot size84 601
001'663 30 S102 after send shards ok
001'663 35 S102 num 2 move [0 1 2 3 4] is done yet
001'663 35 S202 current config num 2 done
001'663 35 S200 num 3 waiting [0 5 6] shards 
001'663 35 S301 current config num 2 done
001'663 35 S101 num 2 sending shards [0 1 2 3 4] to group 102
001'666 34 S202 got new config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 2
001'666 34 S100 got new config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 2
001'667 28 S200 do request args:Key 7 type 3 num 3 Client 2972145661651991667 Seq 2 
001'667 28 S200 [667--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
001'665 35 S300 num 2 handle num 2 move rpc [0 1 2 3 4]
001'668 35 S300 move handle not leader
001'668 35 S302 num 2 waiting [0 1 2 3 4] shards 
001'670 35 S300 num 2 waiting [0 1 2 3 4] shards 
001'670 35 S300 num 2 handle num 2 move rpc [0 1 2 3 4]
001'670 35 S300 move handle not leader
001'674 35 S301 num 2 handle num 2 move rpc [0 1 2 3 4]
001'674 35 S301 num 2 move [0 1 2 3 4] is done yet
001'675 28 S201 do request args:Key 7 type 3 num 3 Client 2972145661651991667 Seq 2 
001'675 28 S201 [667--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
001'677 30 S101 after send shards ok
001'677 35 S101 move delete propose not leader
001'680 30 S102 after send shards ok
001'680 35 S102 num 2 move [0 1 2 3 4] is done yet
001'680 35 S102 current config num 2 done
001'682 35 S301 num 2 handle num 2 move rpc [0 1 2 3 4]
001'682 35 S301 num 2 move [0 1 2 3 4] is done yet
001'682 30 S100 after send shards ok
001'683 30 S300 apply index 5 key num 0 type 5   lastApplied 4
001'683 35 S300 apply num 2 migration [0 1 2 3 4]
001'683 30 S300 safely recv and decided shard 0
001'683 30 S300 safely recv and decided shard 1
001'683 30 S300 safely recv and decided shard 2
001'683 30 S300 safely recv and decided shard 3
001'684 30 S300 safely recv and decided shard 4
001'684 31 S300 used size: 676 / 300 
001'685 30 S101 apply index 64 key4 num 1 type 3   lastApplied 63
001'685 31 S101 used size: 863 / 300 
001'686 29 S101 do snapshot for raft 64 64,size 747
001'687 27 S1 raft apply snapshot offset 64 ,lastApplied 66,total log 67, size 802,log cap:4
001'687 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"5", ClientID:3482757038087095369, Seq:5, OptType:3, Opt:"v", Num:1}}
001'687 31 S101 after snap shot size802 747
001'687 30 S101 apply index 65 key3 num 1 type 3   lastApplied 64
001'687 31 S101 used size: 802 / 300 
001'688 29 S101 do snapshot for raft 65 65,size 747
001'690 27 S1 raft apply snapshot offset 65 ,lastApplied 66,total log 67, size 740,log cap:3
001'690 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"5", ClientID:3482757038087095369, Seq:5, OptType:3, Opt:"v", Num:1}}
001'690 31 S101 after snap shot size740 747
001'690 30 S101 apply index 66 key5 num 1 type 3   lastApplied 65
001'690 31 S101 used size: 740 / 300 
001'682 35 S201 current config num 2 done
001'691 29 S101 do snapshot for raft 66 66,size 747
001'690 35 S100 move delete propose not leader
001'694 30 S100 apply index 64 key4 num 1 type 3   lastApplied 63
001'694 31 S100 used size: 863 / 300 
001'694 29 S100 do snapshot for raft 64 64,size 747
001'695 27 S0 raft apply snapshot offset 64 ,lastApplied 66,total log 67, size 802,log cap:4
001'695 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"5", ClientID:3482757038087095369, Seq:5, OptType:3, Opt:"v", Num:1}}
001'695 31 S100 after snap shot size802 747
001'695 30 S100 apply index 65 key3 num 1 type 3   lastApplied 64
001'695 31 S100 used size: 802 / 300 
001'696 29 S100 do snapshot for raft 65 65,size 747
001'697 27 S0 raft apply snapshot offset 65 ,lastApplied 66,total log 67, size 740,log cap:3
001'697 27 S0 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"5", ClientID:3482757038087095369, Seq:5, OptType:3, Opt:"v", Num:1}}
001'697 31 S100 after snap shot size740 747
001'697 30 S100 apply index 66 key5 num 1 type 3   lastApplied 65
001'697 31 S100 used size: 740 / 300 
001'698 29 S100 do snapshot for raft 66 66,size 747
001'698 34 S201 check new config wanted 3
001'699 27 S0 raft apply snapshot offset 66 ,lastApplied 66,total log 67, size 678,log cap:2
001'699 31 S100 after snap shot size678 747
001'699 35 S100 num 2 sending shards [0 1 2 3 4] to group 102
001'700 29 S100 recv Installsnapshot 67 66
001'701 27 S0 raft apply snapshot offset 67 ,lastApplied 67,total log 67, size 84,log cap:1
001'701 29 S100 decide Installsnapshot 67 <- 66
001'701 30 S100 install snap index 67,config {2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
001'691 34 S200 check new config wanted 4
001'691 34 S302 check new config wanted 3
001'702 30 S302 apply index 5 key num 0 type 5   lastApplied 4
001'702 35 S302 apply num 2 migration [0 1 2 3 4]
001'702 30 S302 safely recv and decided shard 0
001'702 30 S302 safely recv and decided shard 1
001'702 30 S302 safely recv and decided shard 2
001'702 30 S302 safely recv and decided shard 3
001'702 30 S302 safely recv and decided shard 4
001'702 31 S302 used size: 676 / 300 
001'703 29 S302 do snapshot for raft 5 5,size 600
001'703 27 S2 raft apply snapshot offset 5 ,lastApplied 5,total log 5, size 82,log cap:1
001'703 31 S302 after snap shot size82 600
001'710 29 S300 do snapshot for raft 5 5,size 600
001'710 27 S0 raft apply snapshot offset 5 ,lastApplied 5,total log 5, size 82,log cap:1
001'710 31 S300 after snap shot size82 600
001'711 27 S1 raft apply snapshot offset 66 ,lastApplied 67,total log 67, size 678,log cap:2
001'711 27 S1 last applied not snapshoted raft.LogEntry{Term:1, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIb"}, NextSeq:map[int64]int{1679014388048817729:7, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BE"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:5}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdH"}, NextSeq:map[int64]int{132246879705026825:4, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:2}, Num:0}}
001'712 35 S300 num 2 handle num 2 move rpc [0 1 2 3 4]
001'712 31 S101 after snap shot size678 747
001'717 35 S300 num 2 move [0 1 2 3 4] is done yet
001'717 30 S101 apply index 67 key num 0 type 5   lastApplied 66
001'718 35 S101 apply num 2 migration [0 1 2 3 4]
001'718 30 S101 safely delete shard 0
001'718 30 S101 safely delete shard 1
001'718 30 S101 safely delete shard 2
001'718 30 S101 safely delete shard 3
001'718 30 S101 safely delete shard 4
001'718 31 S101 used size: 678 / 300 
001'718 30 S100 after send shards ok
001'718 29 S101 do snapshot for raft 67 67,size 601
001'718 35 S100 num 2 move [0 1 2 3 4] is done yet
001'719 27 S1 raft apply snapshot offset 67 ,lastApplied 67,total log 67, size 84,log cap:1
001'719 31 S101 after snap shot size84 601
001'719 35 S101 current config num 2 done
001'719 34 S101 check new config wanted 3
001'725 35 S301 current config num 2 done
001'728 30 S202 apply index 4 key num 0 type 4   lastApplied 3
001'729 34 S202 apply new config num 3 :&{3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
001'729 34 S202 inited need send [],need recv [0 5 6]
001'729 35 S200 num 3 waiting [0 5 6] shards 
001'729 31 S202 used size: 503 / 300 
001'730 29 S202 do snapshot for raft 4 4,size 497
001'730 27 S2 raft apply snapshot offset 4 ,lastApplied 4,total log 4, size 82,log cap:1
001'730 31 S202 after snap shot size82 497
001'730 30 S201 apply index 4 key num 0 type 4   lastApplied 3
001'731 34 S201 apply new config num 3 :&{3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
001'731 34 S201 inited need send [],need recv [0 5 6]
001'731 31 S201 used size: 503 / 300 
001'731 35 S302 current config num 2 done
001'731 35 S300 current config num 2 done
001'731 29 S201 do snapshot for raft 4 4,size 497
001'732 27 S1 raft apply snapshot offset 4 ,lastApplied 4,total log 4, size 82,log cap:1
001'732 31 S201 after snap shot size82 497
001'732 35 S202 num 3 waiting [0 5 6] shards 
001'732 35 S102 current config num 2 done
001'732 35 S100 current config num 2 done
001'742 35 S201 num 3 waiting [0 5 6] shards 
001'760 34 S300 check new config wanted 3
001'780 35 S301 current config num 2 done
001'781 35 S200 num 3 waiting [0 5 6] shards 
001'781 34 S100 check new config wanted 3
001'781 35 S101 current config num 2 done
001'781 35 S302 current config num 2 done
001'781 34 S202 check new config wanted 4
001'786 35 S102 current config num 2 done
001'787 35 S202 num 3 waiting [0 5 6] shards 
001'787 35 S100 current config num 2 done
001'796 35 S201 num 3 waiting [0 5 6] shards 
001'782 35 S300 current config num 2 done
001'800 32 S100 server killed######
001'800 32 S101 server killed######
001'800 32 S102 server killed######
001'800 32 S200 server killed######
001'800 32 S201 server killed######
001'801 32 S202 server killed######
001'801 32 S300 server killed######
001'801 32 S301 server killed######
001'801 32 S302 server killed######
001'802 30 S100 install snap index 67,config {2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
001'804 30 S101 install snap index 67,config {2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
001'805 30 S102 install snap index 67,config {2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
001'807 30 S200 install snap index 4,config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [true false false false false true true false false false]
001'809 30 S201 install snap index 4,config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [true false false false false true true false false false]
001'810 30 S202 install snap index 4,config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [true false false false false true true false false false]
001'813 30 S300 install snap index 5,config {2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
001'815 30 S301 install snap index 5,config {2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
001'818 30 S302 install snap index 5,config {2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
001'819 34 S302 check new config wanted 3
001'820 35 S302 current config num 2 done
001'820 34 S301 check new config wanted 3
001'821 35 S301 current config num 2 done
001'803 34 S100 check new config wanted 3
001'826 35 S100 current config num 2 done
001'805 34 S101 check new config wanted 3
001'831 35 S101 current config num 2 done
001'806 34 S102 check new config wanted 3
001'831 35 S200 num 3 waiting [0 5 6] shards 
001'831 34 S200 check new config wanted 4
001'831 35 S102 current config num 2 done
001'834 35 S201 num 3 waiting [0 5 6] shards 
001'835 34 S201 check new config wanted 4
001'812 34 S202 check new config wanted 4
001'836 35 S202 num 3 waiting [0 5 6] shards 
001'814 35 S300 current config num 2 done
001'837 34 S300 check new config wanted 3
001'868 28 S300 do request args:Key 5 type 3 num 3 Client 3482757038087095369 Seq 5 
001'868 28 S300 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
001'870 35 S302 current config num 2 done
001'874 35 S301 current config num 2 done
001'877 35 S100 current config num 2 done
001'882 35 S102 current config num 2 done
001'882 35 S200 num 3 waiting [0 5 6] shards 
001'882 35 S101 current config num 2 done
001'885 35 S201 num 3 waiting [0 5 6] shards 
001'886 35 S202 num 3 waiting [0 5 6] shards 
001'897 35 S300 current config num 2 done
001'920 35 S302 current config num 2 done
001'925 35 S301 current config num 2 done
001'934 35 S200 num 3 waiting [0 5 6] shards 
001'934 35 S102 current config num 2 done
001'934 35 S101 current config num 2 done
001'934 35 S100 current config num 2 done
001'952 35 S201 num 3 waiting [0 5 6] shards 
001'952 35 S202 num 3 waiting [0 5 6] shards 
001'960 30 S200 nop apply <nil>
001'961 35 S300 current config num 2 done
001'975 35 S302 current config num 2 done
001'975 35 S301 current config num 2 done
001'988 35 S100 current config num 2 done
001'988 35 S101 current config num 2 done
001'993 34 S300 got new config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 2
001'996 28 S100 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 7 
001'997 28 S100 [479--7] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
001'997 34 S102 got new config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 2
001'998 34 S101 got new config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 2
001'999 28 S300 do request args:Key 4 type 3 num 3 Client 132246879705026825 Seq 4 
001'999 28 S300 [825--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
002'000 35 S200 num 3 waiting [0 5 6] shards 
002'000 35 S102 current config num 2 done
002'002 28 S200 do request args:Key 8 type 3 num 3 Client 2953714763196401582 Seq 2 
002'007 28 S200 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'004 34 S302 got new config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 2
002'007 28 S200 do request args:Key 2 type 3 num 3 Client 1679014388048817729 Seq 6 
002'007 28 S200 [729--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'009 28 S201 do request args:Key 8 type 3 num 3 Client 2953714763196401582 Seq 2 
002'009 28 S201 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'005 34 S301 got new config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 2
002'005 34 S100 got new config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 2
002'006 28 S300 do request args:Key 3 type 3 num 3 Client 2238025532150463055 Seq 5 
002'009 28 S300 [ 55--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
002'012 28 S300 do request args:Key 6 type 3 num 3 Client 542732653461723544 Seq 4 
002'012 28 S300 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
002'012 28 S200 do request args:Key 7 type 3 num 3 Client 2972145661651991667 Seq 2 
002'012 28 S200 [667--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'015 35 S300 current config num 2 done
002'015 35 S201 num 3 waiting [0 5 6] shards 
002'016 35 S202 num 3 waiting [0 5 6] shards 
002'007 28 S100 do request args:Key 0 type 3 num 3 Client 940626237948413081 Seq 10 
002'020 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
002'021 28 S100 do request args:Key 9 type 3 num 3 Client 3620950086299709532 Seq 2 
002'021 28 S100 [532--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
002'023 28 S201 do request args:Key 7 type 3 num 3 Client 2972145661651991667 Seq 2 
002'023 28 S201 [667--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'026 30 S102 nop apply <nil>
002'027 28 S202 do request args:Key 7 type 3 num 3 Client 2972145661651991667 Seq 2 
002'027 28 S202 [667--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'028 28 S201 do request args:Key 2 type 3 num 3 Client 1679014388048817729 Seq 6 
002'028 28 S201 [729--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'028 28 S202 do request args:Key 8 type 3 num 3 Client 2953714763196401582 Seq 2 
002'030 28 S202 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'030 28 S202 do request args:Key 2 type 3 num 3 Client 1679014388048817729 Seq 6 
002'030 28 S202 [729--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'031 35 S301 current config num 2 done
002'031 35 S302 current config num 2 done
002'040 35 S100 current config num 2 done
002'040 35 S101 current config num 2 done
002'043 30 S301 nop apply <nil>
002'046 28 S300 do request args:Key 5 type 3 num 3 Client 3482757038087095369 Seq 5 
002'046 28 S300 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
002'051 35 S102 current config num 2 done
002'051 35 S200 num 3 waiting [0 5 6] shards 
002'065 35 S300 current config num 2 done
002'065 35 S201 num 3 waiting [0 5 6] shards 
002'066 35 S202 num 3 waiting [0 5 6] shards 
002'081 35 S302 current config num 2 done
002'081 35 S301 current config num 2 done
002'090 35 S100 current config num 2 done
002'090 35 S101 current config num 2 done
002'094 34 S300 check new config wanted 3
002'097 34 S102 check new config wanted 3
002'101 34 S200 check new config wanted 4
002'101 34 S101 check new config wanted 3
002'101 34 S202 check new config wanted 4
002'102 34 S201 check new config wanted 4
002'104 35 S102 current config num 2 done
002'108 34 S302 check new config wanted 3
002'112 35 S200 num 3 waiting [0 5 6] shards 
002'109 34 S301 check new config wanted 3
002'116 35 S202 num 3 waiting [0 5 6] shards 
002'118 35 S300 current config num 2 done
002'118 35 S201 num 3 waiting [0 5 6] shards 
002'122 34 S100 check new config wanted 3
002'137 35 S302 current config num 2 done
002'137 35 S301 current config num 2 done
002'142 35 S100 current config num 2 done
002'142 35 S101 current config num 2 done
002'160 35 S102 current config num 2 done
002'163 35 S200 num 3 waiting [0 5 6] shards 
002'167 35 S202 num 3 waiting [0 5 6] shards 
002'171 35 S201 num 3 waiting [0 5 6] shards 
002'171 35 S300 current config num 2 done
002'187 35 S302 current config num 2 done
002'187 35 S301 current config num 2 done
002'200 35 S100 current config num 2 done
002'200 35 S101 current config num 2 done
002'214 28 S100 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 7 
002'215 28 S100 [479--7] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
002'216 34 S300 got new config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 2
002'216 35 S102 current config num 2 done
002'216 35 S200 num 3 waiting [0 5 6] shards 
002'217 35 S202 num 3 waiting [0 5 6] shards 
002'223 35 S201 num 3 waiting [0 5 6] shards 
002'223 35 S300 current config num 2 done
002'252 35 S100 current config num 2 done
002'252 35 S101 current config num 2 done
002'237 35 S302 current config num 2 done
002'255 34 S100 got new config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 2
002'237 35 S301 current config num 2 done
002'258 30 S201 nop apply <nil>
002'259 30 S202 nop apply <nil>
002'270 35 S202 num 3 waiting [0 5 6] shards 
002'270 35 S102 current config num 2 done
002'270 35 S200 num 3 waiting [0 5 6] shards 
002'273 35 S300 current config num 2 done
002'273 35 S201 num 3 waiting [0 5 6] shards 
002'295 34 S102 got new config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 2
002'296 34 S102 propose new config 3
002'296 28 S300 do request args:Key 6 type 3 num 3 Client 542732653461723544 Seq 4 
002'296 28 S300 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
002'296 34 S101 got new config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 2
002'297 34 S302 got new config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 2
002'299 28 S300 do request args:Key 4 type 3 num 3 Client 132246879705026825 Seq 4 
002'299 28 S300 [825--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
002'301 28 S100 do request args:Key 0 type 3 num 3 Client 940626237948413081 Seq 10 
002'302 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
002'303 34 S301 got new config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 2
002'303 34 S301 propose new config 3
002'304 28 S100 do request args:Key 9 type 3 num 3 Client 3620950086299709532 Seq 2 
002'304 28 S100 [532--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
002'307 35 S100 current config num 2 done
002'307 35 S101 current config num 2 done
002'307 30 S101 nop apply <nil>
002'307 31 S101 used size: 508 / 300 
002'307 28 S200 do request args:Key 2 type 3 num 3 Client 1679014388048817729 Seq 6 
002'307 28 S200 [729--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'308 29 S101 do snapshot for raft 68 68,size 601
002'310 27 S1 raft apply snapshot offset 68 ,lastApplied 68,total log 69, size 505,log cap:2
002'310 28 S201 do request args:Key 2 type 3 num 3 Client 1679014388048817729 Seq 6 
002'310 31 S101 after snap shot size505 601
002'310 28 S201 [729--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'311 28 S300 do request args:Key 3 type 3 num 3 Client 2238025532150463055 Seq 5 
002'311 28 S300 [ 55--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
002'312 28 S202 do request args:Key 2 type 3 num 3 Client 1679014388048817729 Seq 6 
002'312 28 S202 [729--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'313 28 S200 do request args:Key 8 type 3 num 3 Client 2953714763196401582 Seq 2 
002'313 28 S200 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'313 30 S102 apply index 69 key num 0 type 4   lastApplied 68
002'313 34 S102 apply new config num 3 :&{3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
002'313 34 S102 inited need send [5 6],need recv []
002'313 31 S102 used size: 508 / 300 
002'314 29 S102 do snapshot for raft 69 69,size 644
002'314 28 S201 do request args:Key 8 type 3 num 3 Client 2953714763196401582 Seq 2 
002'314 28 S201 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'314 27 S2 raft apply snapshot offset 69 ,lastApplied 69,total log 69, size 84,log cap:1
002'314 31 S102 after snap shot size84 644
002'316 35 S301 current config num 2 done
002'316 35 S302 current config num 2 done
002'317 34 S300 check new config wanted 3
002'321 35 S102 num 3 sending shards [5 6] to group 101
002'321 28 S202 do request args:Key 8 type 3 num 3 Client 2953714763196401582 Seq 2 
002'321 28 S202 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'323 30 S101 apply index 69 key num 0 type 4   lastApplied 68
002'323 34 S101 apply new config num 3 :&{3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
002'323 34 S101 inited need send [5 6],need recv []
002'323 31 S101 used size: 505 / 300 
002'324 29 S101 do snapshot for raft 69 69,size 644
002'324 27 S1 raft apply snapshot offset 69 ,lastApplied 69,total log 69, size 84,log cap:1
002'324 31 S101 after snap shot size84 644
002'324 35 S202 num 3 waiting [0 5 6] shards 
002'324 35 S200 num 3 waiting [0 5 6] shards 
002'325 35 S300 current config num 2 done
002'325 35 S201 num 3 waiting [0 5 6] shards 
002'328 35 S200 num 3 handle num 3 move rpc [5 6]
002'328 35 S200 move handle num 3 shards [5 6] as leader?
002'329 29 S100 recv Installsnapshot 69 67
002'329 27 S0 raft apply snapshot offset 69 ,lastApplied 69,total log 69, size 84,log cap:1
002'329 29 S100 decide Installsnapshot 69 <- 67
002'329 30 S300 nop apply <nil>
002'329 31 S300 used size: 506 / 300 
002'331 30 S100 install snap index 69,config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false true true false false false]
002'332 30 S301 apply index 7 key num 0 type 4   lastApplied 6
002'332 34 S301 apply new config num 3 :&{3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
002'332 34 S301 inited need send [0],need recv []
002'332 31 S301 used size: 506 / 300 
002'334 29 S301 do snapshot for raft 7 7,size 643
002'334 27 S1 raft apply snapshot offset 7 ,lastApplied 7,total log 7, size 82,log cap:1
002'334 31 S301 after snap shot size82 643
002'335 29 S300 do snapshot for raft 6 6,size 600
002'336 27 S0 raft apply snapshot offset 6 ,lastApplied 6,total log 7, size 503,log cap:2
002'336 31 S300 after snap shot size503 600
002'336 28 S300 do request args:Key 5 type 3 num 3 Client 3482757038087095369 Seq 5 
002'336 28 S300 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
002'337 28 S200 do request args:Key 7 type 3 num 3 Client 2972145661651991667 Seq 2 
002'337 28 S200 [667--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'339 28 S201 do request args:Key 7 type 3 num 3 Client 2972145661651991667 Seq 2 
002'339 28 S201 [667--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'340 28 S202 do request args:Key 7 type 3 num 3 Client 2972145661651991667 Seq 2 
002'340 28 S202 [667--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'340 30 S302 nop apply <nil>
002'340 31 S302 used size: 506 / 300 
002'341 29 S302 do snapshot for raft 6 6,size 600
002'342 27 S2 raft apply snapshot offset 6 ,lastApplied 6,total log 7, size 503,log cap:2
002'342 31 S302 after snap shot size503 600
002'351 35 S102 num 3 sending shards [5 6] to group 101
002'352 35 S200 num 3 handle num 3 move rpc [5 6]
002'353 35 S200 move handle num 3 shards [5 6] as leader?
002'354 30 S302 apply index 7 key num 0 type 4   lastApplied 6
002'354 34 S302 apply new config num 3 :&{3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
002'354 34 S302 inited need send [0],need recv []
002'354 31 S302 used size: 503 / 300 
002'354 30 S300 apply index 7 key num 0 type 4   lastApplied 6
002'354 34 S300 apply new config num 3 :&{3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{2 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
002'354 34 S300 inited need send [0],need recv []
002'354 31 S300 used size: 503 / 300 
002'355 30 S200 apply index 6 key num 0 type 5   lastApplied 5
002'355 35 S200 apply num 3 migration [5 6]
002'355 30 S200 safely recv and decided shard 5
002'355 30 S200 safely recv and decided shard 6
002'355 31 S200 used size: 701 / 300 
002'356 34 S100 check new config wanted 4
002'357 29 S200 do snapshot for raft 6 6,size 550
002'357 35 S101 num 3 sending shards [5 6] to group 101
002'357 27 S0 raft apply snapshot offset 6 ,lastApplied 6,total log 7, size 557,log cap:2
002'357 31 S200 after snap shot size557 550
002'358 35 S100 num 3 sending shards [5 6] to group 101
002'359 35 S200 num 3 handle num 3 move rpc [5 6]
002'359 35 S200 num 3 move [5 6] is done yet
002'360 30 S100 after send shards ok
002'360 35 S100 move delete propose not leader
002'361 29 S202 recv Installsnapshot 6 5
002'361 35 S200 num 3 handle num 3 move rpc [5 6]
002'361 35 S200 num 3 move [5 6] is done yet
002'361 27 S2 raft apply snapshot offset 6 ,lastApplied 6,total log 6, size 82,log cap:1
002'361 30 S201 apply index 6 key num 0 type 5   lastApplied 5
002'361 35 S201 apply num 3 migration [5 6]
002'361 30 S201 safely recv and decided shard 5
002'361 30 S201 safely recv and decided shard 6
002'361 31 S201 used size: 701 / 300 
002'361 35 S200 num 3 move [5 6] is done yet
002'362 29 S201 do snapshot for raft 6 6,size 550
002'362 30 S102 after send shards ok
002'363 27 S1 raft apply snapshot offset 6 ,lastApplied 6,total log 7, size 557,log cap:2
002'363 31 S201 after snap shot size557 550
002'361 29 S202 decide Installsnapshot 6 <- 5
002'363 35 S102 move delete propose num 3 shards [5 6] as leader?
002'363 30 S200 apply index 7 key num 0 type 5   lastApplied 6
002'364 35 S200 apply num 3 migration [5 6]
002'364 31 S200 used size: 557 / 300 
002'364 30 S202 install snap index 6,config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [true false false false false false false false false false]
002'364 30 S101 after send shards ok
002'364 35 S101 move delete propose not leader
002'364 29 S200 do snapshot for raft 7 7,size 550
002'364 27 S0 raft apply snapshot offset 7 ,lastApplied 7,total log 7, size 82,log cap:1
002'364 31 S200 after snap shot size82 550
002'365 35 S200 num 3 move [5 6] is done yet
002'365 30 S102 after send shards ok
002'366 35 S102 move delete propose num 3 shards [5 6] as leader?
002'368 29 S302 do snapshot for raft 7 7,size 643
002'369 27 S2 raft apply snapshot offset 7 ,lastApplied 7,total log 7, size 82,log cap:1
002'369 31 S302 after snap shot size82 643
002'370 29 S300 do snapshot for raft 7 7,size 643
002'370 27 S0 raft apply snapshot offset 7 ,lastApplied 7,total log 7, size 82,log cap:1
002'370 31 S300 after snap shot size82 643
002'374 30 S102 apply index 70 key num 0 type 5   lastApplied 69
002'374 35 S102 apply num 3 migration [5 6]
002'374 30 S102 safely delete shard 5
002'374 30 S102 safely delete shard 6
002'374 31 S102 used size: 700 / 300 
002'374 35 S301 num 3 sending shards [0] to group 101
002'375 29 S102 do snapshot for raft 70 70,size 591
002'375 27 S2 raft apply snapshot offset 70 ,lastApplied 71,total log 71, size 559,log cap:2
002'375 27 S2 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:3}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:3}, Num:0}}
002'376 31 S102 after snap shot size559 591
002'376 30 S102 apply index 71 key num 0 type 5   lastApplied 70
002'376 35 S102 apply num 3 migration [5 6]
002'376 31 S102 used size: 559 / 300 
002'377 35 S200 num 3 handle num 3 move rpc [0]
002'378 29 S102 do snapshot for raft 71 71,size 591
002'378 27 S2 raft apply snapshot offset 71 ,lastApplied 71,total log 71, size 84,log cap:1
002'378 31 S102 after snap shot size84 591
002'378 35 S201 num 3 waiting [0] shards 
002'379 35 S202 num 3 waiting [0] shards 
002'374 35 S302 num 3 sending shards [0] to group 101
002'379 35 S300 num 3 sending shards [0] to group 101
002'381 35 S102 current config num 3 done
002'383 35 S200 move handle num 3 shards [0] as leader?
002'383 35 S200 num 3 waiting [0] shards 
002'383 35 S200 num 3 handle num 3 move rpc [0]
002'384 35 S200 move handle num 3 shards [0] as leader?
002'384 35 S200 num 3 handle num 3 move rpc [0]
002'385 35 S200 move handle num 3 shards [0] as leader?
002'387 35 S101 num 3 sending shards [5 6] to group 101
002'396 30 S201 apply index 7 key num 0 type 5   lastApplied 6
002'396 35 S201 apply num 3 migration [5 6]
002'396 31 S201 used size: 881 / 300 
002'396 29 S201 do snapshot for raft 7 7,size 550
002'399 35 S100 num 3 sending shards [5 6] to group 101
002'399 34 S101 check new config wanted 4
002'400 35 S200 num 3 handle num 3 move rpc [5 6]
002'400 35 S200 num 3 move [5 6] is done yet
002'401 29 S202 recv Installsnapshot 7 6
002'402 27 S2 raft apply snapshot offset 7 ,lastApplied 7,total log 7, size 82,log cap:1
002'403 27 S1 raft apply snapshot offset 7 ,lastApplied 7,total log 10, size 740,log cap:4
002'403 31 S201 after snap shot size740 550
002'404 34 S301 check new config wanted 4
002'405 34 S102 check new config wanted 4
002'405 34 S302 check new config wanted 4
002'405 34 S201 check new config wanted 4
002'407 35 S301 num 3 sending shards [0] to group 101
002'410 30 S100 after send shards ok
002'410 35 S100 move delete propose not leader
002'410 35 S200 num 3 handle num 3 move rpc [5 6]
002'410 35 S200 num 3 move [5 6] is done yet
002'410 30 S101 after send shards ok
002'410 35 S101 move delete propose not leader
002'402 29 S202 decide Installsnapshot 7 <- 6
002'413 30 S202 install snap index 7,config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [true false false false false false false false false false]
002'414 34 S202 check new config wanted 4
002'414 35 S300 num 3 sending shards [0] to group 101
002'414 35 S302 num 3 sending shards [0] to group 101
002'417 35 S200 num 3 handle num 3 move rpc [0]
002'418 35 S200 move handle num 3 shards [0] as leader?
002'419 35 S200 num 3 handle num 3 move rpc [0]
002'420 35 S200 move handle num 3 shards [0] as leader?
002'420 35 S101 num 3 sending shards [5 6] to group 101
002'429 35 S202 num 3 waiting [0] shards 
002'430 30 S202 apply index 8 key num 0 type 5   lastApplied 7
002'430 35 S202 apply num 3 migration [0]
002'430 30 S202 safely recv and decided shard 0
002'430 31 S202 used size: 740 / 300 
002'431 29 S202 do snapshot for raft 8 8,size 582
002'431 27 S2 raft apply snapshot offset 8 ,lastApplied 10,total log 10, size 632,log cap:3
002'431 27 S2 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIb"}, NextSeq:map[int64]int{1679014388048817729:7, 2079820695267196558:3}}}}, Num:3}, Num:0}}
002'431 31 S202 after snap shot size632 582
002'431 30 S202 apply index 9 key num 0 type 5   lastApplied 8
002'432 35 S202 apply num 3 migration [0]
002'432 31 S202 used size: 632 / 300 
002'432 29 S202 do snapshot for raft 9 9,size 582
002'433 27 S2 raft apply snapshot offset 9 ,lastApplied 10,total log 10, size 524,log cap:2
002'433 27 S2 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIb"}, NextSeq:map[int64]int{1679014388048817729:7, 2079820695267196558:3}}}}, Num:3}, Num:0}}
002'433 31 S202 after snap shot size524 582
002'433 30 S202 apply index 10 key num 0 type 5   lastApplied 9
002'433 35 S202 apply num 3 migration [0]
002'433 31 S202 used size: 524 / 300 
002'434 29 S202 do snapshot for raft 10 10,size 582
002'434 27 S2 raft apply snapshot offset 10 ,lastApplied 10,total log 10, size 82,log cap:1
002'434 31 S202 after snap shot size82 582
002'430 30 S200 apply index 8 key num 0 type 5   lastApplied 7
002'434 35 S200 apply num 3 migration [0]
002'434 30 S200 safely recv and decided shard 0
002'434 31 S200 used size: 956 / 300 
002'435 29 S200 do snapshot for raft 8 8,size 582
002'435 27 S0 raft apply snapshot offset 8 ,lastApplied 10,total log 12, size 848,log cap:5
002'436 27 S0 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIb"}, NextSeq:map[int64]int{1679014388048817729:7, 2079820695267196558:3}}}}, Num:3}, Num:0}}
002'436 31 S200 after snap shot size848 582
002'436 30 S200 apply index 9 key num 0 type 5   lastApplied 8
002'436 35 S200 apply num 3 migration [0]
002'436 31 S200 used size: 848 / 300 
002'436 29 S200 do snapshot for raft 9 9,size 582
002'437 27 S0 raft apply snapshot offset 9 ,lastApplied 10,total log 12, size 740,log cap:4
002'437 27 S0 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIb"}, NextSeq:map[int64]int{1679014388048817729:7, 2079820695267196558:3}}}}, Num:3}, Num:0}}
002'437 31 S200 after snap shot size740 582
002'437 30 S200 apply index 10 key num 0 type 5   lastApplied 9
002'437 35 S200 apply num 3 migration [0]
002'437 31 S200 used size: 740 / 300 
002'438 29 S200 do snapshot for raft 10 10,size 582
002'438 27 S0 raft apply snapshot offset 10 ,lastApplied 10,total log 12, size 632,log cap:3
002'439 31 S200 after snap shot size632 582
002'439 35 S200 num 3 move [0] is done yet
002'440 30 S302 after send shards ok
002'446 35 S302 move delete propose not leader
leave &{[101] 1074585914363486070 3}
002'440 34 S200 check new config wanted 4
002'441 35 S301 num 3 sending shards [0] to group 101
002'450 35 S200 current config num 3 done
002'442 35 S100 num 3 sending shards [5 6] to group 101
002'442 35 S201 num 3 waiting [0] shards 
002'451 35 S200 num 3 handle num 3 move rpc [0]
002'451 35 S200 num 3 move [0] is done yet
002'442 35 S102 current config num 3 done
002'453 35 S101 num 3 sending shards [5 6] to group 101
002'451 30 S201 apply index 8 key num 0 type 5   lastApplied 7
002'455 35 S201 apply num 3 migration [0]
002'455 30 S201 safely recv and decided shard 0
002'455 31 S201 used size: 956 / 300 
002'455 29 S201 do snapshot for raft 8 8,size 582
002'456 27 S1 raft apply snapshot offset 8 ,lastApplied 10,total log 12, size 848,log cap:5
002'456 27 S1 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIb"}, NextSeq:map[int64]int{1679014388048817729:7, 2079820695267196558:3}}}}, Num:3}, Num:0}}
002'456 31 S201 after snap shot size848 582
002'457 30 S201 apply index 9 key num 0 type 5   lastApplied 8
002'457 35 S201 apply num 3 migration [0]
002'457 31 S201 used size: 848 / 300 
002'457 29 S201 do snapshot for raft 9 9,size 582
002'458 27 S1 raft apply snapshot offset 9 ,lastApplied 10,total log 12, size 740,log cap:4
002'458 27 S1 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIb"}, NextSeq:map[int64]int{1679014388048817729:7, 2079820695267196558:3}}}}, Num:3}, Num:0}}
002'458 31 S201 after snap shot size740 582
002'458 30 S201 apply index 10 key num 0 type 5   lastApplied 9
002'458 35 S201 apply num 3 migration [0]
002'458 31 S201 used size: 740 / 300 
002'459 29 S201 do snapshot for raft 10 10,size 582
002'459 27 S1 raft apply snapshot offset 10 ,lastApplied 10,total log 12, size 632,log cap:3
002'459 31 S201 after snap shot size632 582
002'460 35 S200 num 3 handle num 3 move rpc [5 6]
002'460 35 S200 num 3 move [5 6] is done yet
002'460 30 S101 after send shards ok
002'460 35 S101 move delete propose not leader
002'460 30 S200 apply index 11 key num 0 type 5   lastApplied 10
002'460 35 S200 apply num 3 migration [0]
002'460 31 S200 used size: 632 / 300 
002'461 29 S200 do snapshot for raft 11 11,size 582
002'462 27 S0 raft apply snapshot offset 11 ,lastApplied 12,total log 12, size 524,log cap:2
002'462 27 S0 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIb"}, NextSeq:map[int64]int{1679014388048817729:7, 2079820695267196558:3}}}}, Num:3}, Num:0}}
002'462 31 S200 after snap shot size524 582
002'462 30 S200 apply index 12 key num 0 type 5   lastApplied 11
002'462 35 S200 apply num 3 migration [0]
002'462 31 S200 used size: 524 / 300 
002'462 29 S200 do snapshot for raft 12 12,size 582
002'463 27 S0 raft apply snapshot offset 12 ,lastApplied 12,total log 12, size 82,log cap:1
002'463 31 S200 after snap shot size82 582
002'463 35 S200 num 3 move [0] is done yet
002'463 30 S301 after send shards ok
002'464 35 S301 move delete propose num 3 shards [0] as leader?
002'464 35 S200 num 3 move [0] is done yet
002'464 35 S200 num 3 move [0] is done yet
002'464 35 S200 num 3 move [0] is done yet
002'467 35 S200 num 3 handle num 3 move rpc [0]
002'467 35 S200 num 3 move [0] is done yet
002'467 30 S301 after send shards ok
002'468 35 S301 move delete propose num 3 shards [0] as leader?
002'469 35 S300 num 3 sending shards [0] to group 101
002'469 30 S300 after send shards ok
002'469 35 S300 move delete propose not leader
002'469 35 S302 num 3 sending shards [0] to group 101
002'470 30 S300 after send shards ok
002'470 35 S300 move delete propose not leader
002'470 30 S302 after send shards ok
002'470 35 S302 move delete propose not leader
002'473 34 S300 got new config {3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 2
002'475 35 S200 num 3 handle num 3 move rpc [5 6]
002'475 35 S200 num 3 move [5 6] is done yet
002'476 30 S101 after send shards ok
002'476 35 S101 move delete propose not leader
002'481 28 S100 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 7 
002'482 28 S100 declined [479--7] for not leader
002'482 28 S100 [479--7] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'483 35 S301 num 3 sending shards [0] to group 101
leave &{[101] 1074585914363486070 3}
002'483 35 S100 num 3 sending shards [5 6] to group 101
002'484 35 S101 num 3 sending shards [5 6] to group 101
002'486 30 S301 apply index 8 key num 0 type 5   lastApplied 7
002'486 35 S301 apply num 3 migration [0]
002'486 30 S301 safely delete shard 0
002'486 31 S301 used size: 632 / 300 
002'486 29 S301 do snapshot for raft 8 8,size 612
002'487 27 S1 raft apply snapshot offset 8 ,lastApplied 9,total log 9, size 524,log cap:2
002'487 27 S1 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIb"}, NextSeq:map[int64]int{1679014388048817729:7, 2079820695267196558:3}}}}, Num:3}, Num:0}}
002'487 31 S301 after snap shot size524 612
002'487 30 S301 apply index 9 key num 0 type 5   lastApplied 8
002'487 35 S301 apply num 3 migration [0]
002'487 31 S301 used size: 524 / 300 
002'488 29 S301 do snapshot for raft 9 9,size 612
002'488 27 S1 raft apply snapshot offset 9 ,lastApplied 9,total log 9, size 82,log cap:1
002'488 31 S301 after snap shot size82 612
002'489 28 S101 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 7 
002'489 28 S101 declined [479--7] for not leader
002'489 28 S101 [479--7] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'493 35 S202 current config num 3 done
002'495 28 S102 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 7 
002'495 33 S102 start [479--7] as leader?
002'496 35 S200 num 3 handle num 3 move rpc [5 6]
002'496 35 S200 num 3 move [5 6] is done yet
002'497 35 S200 num 3 handle num 3 move rpc [5 6]
002'497 35 S200 num 3 move [5 6] is done yet
002'497 30 S101 after send shards ok
002'497 35 S101 move delete propose not leader
002'503 35 S200 current config num 3 done
002'503 35 S201 current config num 3 done
002'503 35 S102 current config num 3 done
002'504 30 S301 after send shards ok
002'504 35 S301 num 3 move [0] is done yet
002'506 35 S300 num 3 sending shards [0] to group 101
002'512 30 S100 after send shards ok
002'512 35 S100 move delete propose not leader
002'512 35 S200 num 3 handle num 3 move rpc [0]
002'512 35 S200 num 3 move [0] is done yet
002'513 35 S200 num 3 handle num 3 move rpc [5 6]
002'513 35 S200 num 3 move [5 6] is done yet
002'513 30 S301 after send shards ok
002'513 35 S301 num 3 move [0] is done yet
002'513 35 S302 num 3 sending shards [0] to group 101
002'513 30 S100 after send shards ok
002'513 35 S100 move delete propose not leader
002'514 35 S100 num 3 sending shards [5 6] to group 101
002'519 35 S200 num 3 handle num 3 move rpc [0]
002'519 35 S200 num 3 move [0] is done yet
002'520 30 S302 after send shards ok
002'520 35 S302 move delete propose not leader
002'524 35 S301 current config num 3 done
002'525 35 S200 num 3 handle num 3 move rpc [0]
002'525 35 S200 num 3 move [0] is done yet
002'525 30 S300 after send shards ok
002'525 35 S300 move delete propose not leader
002'529 35 S200 num 3 handle num 3 move rpc [0]
002'529 35 S200 num 3 move [0] is done yet
002'537 35 S101 num 3 sending shards [5 6] to group 101
002'539 35 S200 num 3 handle num 3 move rpc [5 6]
leave &{[101] 1074585914363486070 3}
002'539 35 S200 num 3 move [5 6] is done yet
002'545 30 S100 after send shards ok
002'545 35 S100 move delete propose not leader
002'545 35 S200 num 3 handle num 3 move rpc [5 6]
002'545 35 S200 num 3 move [5 6] is done yet
002'539 35 S300 num 3 sending shards [0] to group 101
002'541 30 S302 after send shards ok
002'546 35 S302 move delete propose not leader
002'546 35 S302 num 3 sending shards [0] to group 101
002'546 35 S200 num 3 handle num 3 move rpc [0]
002'546 35 S200 num 3 move [0] is done yet
002'547 30 S101 after send shards ok
002'547 35 S101 move delete propose not leader
002'548 30 S300 after send shards ok
002'551 35 S300 move delete propose not leader
002'548 30 S101 apply index 70 key num 0 type 5   lastApplied 69
002'551 35 S101 apply num 3 migration [5 6]
002'551 30 S101 safely delete shard 5
002'551 30 S101 safely delete shard 6
002'549 35 S100 num 3 sending shards [5 6] to group 101
002'551 31 S101 used size: 762 / 300 
002'549 30 S102 apply index 72 key1 num 3 type 3   lastApplied 71
002'550 35 S200 num 3 handle num 3 move rpc [0]
002'551 35 S200 num 3 move [0] is done yet
002'551 29 S101 do snapshot for raft 70 70,size 591
002'552 34 S100 check new config wanted 4
002'552 30 S100 apply index 70 key num 0 type 5   lastApplied 69
002'552 35 S100 apply num 3 migration [5 6]
002'552 30 S100 safely delete shard 5
002'552 30 S100 safely delete shard 6
002'552 31 S100 used size: 762 / 300 
002'552 27 S1 raft apply snapshot offset 70 ,lastApplied 71,total log 72, size 621,log cap:3
002'552 27 S1 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:3}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:3}, Num:0}}
002'552 31 S101 after snap shot size621 591
002'552 30 S101 apply index 71 key num 0 type 5   lastApplied 70
002'552 35 S101 apply num 3 migration [5 6]
002'553 31 S101 used size: 621 / 300 
002'553 35 S200 num 3 handle num 3 move rpc [0]
002'553 35 S200 num 3 move [0] is done yet
002'553 29 S101 do snapshot for raft 71 71,size 591
002'553 30 S302 after send shards ok
002'553 27 S1 raft apply snapshot offset 71 ,lastApplied 71,total log 72, size 225,log cap:2
002'554 35 S302 move delete propose not leader
002'554 31 S101 after snap shot size225 591
002'553 28 S102 [479--7] successed
002'554 35 S201 current config num 3 done
002'554 28 S102 [479--7] ok 
002'554 28 S102 [479--7] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
002'550 35 S202 current config num 3 done
002'553 29 S100 do snapshot for raft 70 70,size 591
002'554 35 S200 num 3 handle num 3 move rpc [5 6]
002'554 35 S200 num 3 move [5 6] is done yet
002'555 27 S0 raft apply snapshot offset 70 ,lastApplied 71,total log 72, size 621,log cap:3
002'555 27 S0 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:3}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:3}, Num:0}}
002'558 35 S200 current config num 3 done
002'558 35 S102 current config num 3 done
002'560 30 S300 after send shards ok
002'560 35 S300 move delete propose not leader
002'561 36 S479 [7] clerk putAppend okkkkk
002'564 31 S100 after snap shot size621 591
002'564 30 S100 apply index 71 key num 0 type 5   lastApplied 70
002'564 35 S100 apply num 3 migration [5 6]
002'564 31 S100 used size: 621 / 300 
002'564 30 S202 apply index 11 key num 0 type 5   lastApplied 10
002'564 35 S202 apply num 3 migration [0]
002'564 31 S202 used size: 632 / 300 
002'564 29 S100 do snapshot for raft 71 71,size 591
002'565 29 S202 do snapshot for raft 11 11,size 582
002'565 27 S0 raft apply snapshot offset 71 ,lastApplied 71,total log 72, size 225,log cap:2
002'565 31 S100 after snap shot size225 591
002'565 30 S100 after send shards ok
002'565 35 S100 num 3 move [5 6] is done yet
002'565 27 S2 raft apply snapshot offset 11 ,lastApplied 12,total log 12, size 524,log cap:2
002'565 27 S2 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIb"}, NextSeq:map[int64]int{1679014388048817729:7, 2079820695267196558:3}}}}, Num:3}, Num:0}}
002'565 31 S202 after snap shot size524 582
002'565 30 S202 apply index 12 key num 0 type 5   lastApplied 11
002'566 35 S202 apply num 3 migration [0]
002'566 31 S202 used size: 524 / 300 
002'566 29 S202 do snapshot for raft 12 12,size 582
002'566 27 S2 raft apply snapshot offset 12 ,lastApplied 12,total log 12, size 82,log cap:1
002'566 31 S202 after snap shot size82 582
002'567 30 S201 apply index 11 key num 0 type 5   lastApplied 10
002'567 35 S201 apply num 3 migration [0]
002'567 31 S201 used size: 632 / 300 
002'568 35 S101 current config num 3 done
002'569 28 S100 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 8 
002'569 28 S100 declined [479--8] for not leader
002'569 28 S100 [479--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'578 29 S201 do snapshot for raft 11 11,size 582
002'578 35 S300 num 3 sending shards [0] to group 101
002'579 27 S1 raft apply snapshot offset 11 ,lastApplied 12,total log 12, size 524,log cap:2
002'579 34 S300 check new config wanted 4
002'579 27 S1 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIb"}, NextSeq:map[int64]int{1679014388048817729:7, 2079820695267196558:3}}}}, Num:3}, Num:0}}
002'579 31 S201 after snap shot size524 582
002'579 35 S302 num 3 sending shards [0] to group 101
002'580 35 S200 num 3 handle num 3 move rpc [0]
002'580 35 S200 num 3 move [0] is done yet
002'579 30 S201 apply index 12 key num 0 type 5   lastApplied 11
002'581 35 S201 apply num 3 migration [0]
002'581 31 S201 used size: 524 / 300 
002'581 35 S200 num 3 handle num 3 move rpc [0]
002'581 29 S201 do snapshot for raft 12 12,size 582
002'581 27 S1 raft apply snapshot offset 12 ,lastApplied 12,total log 12, size 82,log cap:1
002'581 31 S201 after snap shot size82 582
002'581 30 S300 after send shards ok
002'582 35 S300 move delete propose not leader
002'582 35 S100 current config num 3 done
002'581 35 S200 num 3 move [0] is done yet
002'582 35 S301 current config num 3 done
002'584 28 S101 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 8 
002'584 28 S101 declined [479--8] for not leader
002'584 28 S101 [479--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'585 30 S302 after send shards ok
002'585 35 S302 move delete propose not leader
002'587 28 S102 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 8 
002'588 33 S102 start [479--8] as leader?
002'597 30 S102 apply index 73 key1 num 3 type 3   lastApplied 72
002'597 28 S102 [479--8] successed
002'597 28 S102 [479--8] ok 
002'597 28 S102 [479--8] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
002'597 30 S100 apply index 72 key1 num 3 type 3   lastApplied 71
002'597 30 S101 apply index 72 key1 num 3 type 3   lastApplied 71
002'602 36 S479 [8] clerk putAppend okkkkk
002'603 28 S100 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 9 
002'603 28 S100 declined [479--9] for not leader
002'603 28 S100 [479--9] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'604 28 S101 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 9 
002'604 28 S101 declined [479--9] for not leader
002'604 28 S101 [479--9] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'605 28 S102 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 9 
002'606 33 S102 start [479--9] as leader?
002'609 35 S302 num 3 sending shards [0] to group 101
002'610 35 S201 current config num 3 done
002'610 35 S200 current config num 3 done
002'610 35 S300 num 3 sending shards [0] to group 101
002'611 35 S102 current config num 3 done
002'612 35 S200 num 3 handle num 3 move rpc [0]
002'612 35 S200 num 3 move [0] is done yet
002'612 30 S302 after send shards ok
002'613 35 S302 move delete propose not leader
002'613 35 S200 num 3 handle num 3 move rpc [0]
002'613 35 S200 num 3 move [0] is done yet
002'614 30 S300 after send shards ok
002'614 35 S300 move delete propose not leader
002'616 30 S102 apply index 74 key1 num 3 type 3   lastApplied 73
002'616 31 S102 used size: 350 / 300 
002'617 29 S102 do snapshot for raft 74 74,size 594
002'617 35 S202 current config num 3 done
002'617 30 S100 apply index 73 key1 num 3 type 3   lastApplied 72
002'646 31 S100 used size: 350 / 300 
002'646 29 S100 do snapshot for raft 73 73,size 593
002'647 27 S0 raft apply snapshot offset 73 ,lastApplied 73,total log 74, size 225,log cap:2
002'647 31 S100 after snap shot size225 593
002'647 35 S100 current config num 3 done
002'617 27 S2 raft apply snapshot offset 74 ,lastApplied 74,total log 74, size 84,log cap:1
002'647 31 S102 after snap shot size84 594
002'647 28 S102 [479--9] successed
002'647 28 S102 [479--9] ok 
002'647 28 S102 [479--9] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
002'617 30 S101 apply index 73 key1 num 3 type 3   lastApplied 72
002'647 31 S101 used size: 350 / 300 
002'648 29 S101 do snapshot for raft 73 73,size 593
002'648 27 S1 raft apply snapshot offset 73 ,lastApplied 73,total log 74, size 225,log cap:2
002'648 31 S101 after snap shot size225 593
002'648 35 S101 current config num 3 done
002'649 36 S479 [9] clerk putAppend okkkkk
002'634 35 S301 current config num 3 done
002'641 35 S302 num 3 sending shards [0] to group 101
002'654 30 S100 apply index 74 key1 num 3 type 3   lastApplied 73
002'655 35 S200 num 3 handle num 3 move rpc [0]
002'655 35 S200 num 3 move [0] is done yet
002'656 30 S302 after send shards ok
002'656 35 S302 move delete propose not leader
002'656 28 S100 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 10 
002'656 28 S100 declined [479--10] for not leader
002'656 28 S100 [479--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'660 28 S101 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 10 
002'660 28 S101 declined [479--10] for not leader
002'660 28 S101 [479--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'660 30 S101 apply index 74 key1 num 3 type 3   lastApplied 73
002'661 28 S102 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 10 
002'662 33 S102 start [479--10] as leader?
002'667 30 S302 apply index 8 key num 0 type 5   lastApplied 7
002'667 35 S302 apply num 3 migration [0]
002'667 30 S302 safely delete shard 0
002'667 31 S302 used size: 632 / 300 
002'668 29 S302 do snapshot for raft 8 8,size 612
002'668 27 S2 raft apply snapshot offset 8 ,lastApplied 9,total log 9, size 524,log cap:2
002'668 27 S2 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIb"}, NextSeq:map[int64]int{1679014388048817729:7, 2079820695267196558:3}}}}, Num:3}, Num:0}}
002'669 31 S302 after snap shot size524 612
002'669 30 S302 apply index 9 key num 0 type 5   lastApplied 8
002'669 35 S302 apply num 3 migration [0]
002'669 31 S302 used size: 524 / 300 
002'669 29 S302 do snapshot for raft 9 9,size 612
002'670 27 S2 raft apply snapshot offset 9 ,lastApplied 9,total log 9, size 82,log cap:1
002'670 31 S302 after snap shot size82 612
002'672 35 S300 num 3 sending shards [0] to group 101
002'673 35 S200 num 3 handle num 3 move rpc [0]
002'673 35 S200 num 3 move [0] is done yet
002'674 35 S201 current config num 3 done
002'674 30 S300 apply index 8 key num 0 type 5   lastApplied 7
002'674 35 S300 apply num 3 migration [0]
002'674 30 S300 safely delete shard 0
002'674 31 S300 used size: 632 / 300 
002'675 29 S300 do snapshot for raft 8 8,size 612
002'675 27 S0 raft apply snapshot offset 8 ,lastApplied 9,total log 9, size 524,log cap:2
002'675 27 S0 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIb"}, NextSeq:map[int64]int{1679014388048817729:7, 2079820695267196558:3}}}}, Num:3}, Num:0}}
002'675 31 S300 after snap shot size524 612
002'675 30 S300 apply index 9 key num 0 type 5   lastApplied 8
002'676 35 S300 apply num 3 migration [0]
002'676 31 S300 used size: 524 / 300 
002'676 29 S300 do snapshot for raft 9 9,size 612
002'676 27 S0 raft apply snapshot offset 9 ,lastApplied 9,total log 9, size 82,log cap:1
002'676 31 S300 after snap shot size82 612
002'677 30 S102 apply index 75 key1 num 3 type 3   lastApplied 74
002'678 35 S200 current config num 3 done
002'678 35 S102 current config num 3 done
002'679 30 S300 after send shards ok
002'679 35 S300 num 3 move [0] is done yet
002'680 35 S302 current config num 3 done
002'680 28 S102 [479--10] successed
002'680 28 S102 [479--10] ok 
002'680 28 S102 [479--10] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
002'681 36 S479 [10] clerk putAppend okkkkk
002'682 28 S100 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 11 
002'682 28 S100 declined [479--11] for not leader
002'682 28 S100 [479--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'683 28 S101 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 11 
002'683 28 S101 declined [479--11] for not leader
002'683 28 S101 [479--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'684 28 S102 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 11 
002'692 33 S102 start [479--11] as leader?
002'696 35 S202 current config num 3 done
002'699 44 S0 ctrler change to config &{4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
002'697 35 S100 current config num 3 done
002'702 35 S101 current config num 3 done
002'702 35 S301 current config num 3 done
002'704 30 S101 apply index 75 key1 num 3 type 3   lastApplied 74
002'704 30 S100 apply index 75 key1 num 3 type 3   lastApplied 74
002'704 31 S101 used size: 350 / 300 
002'704 31 S100 used size: 350 / 300 
002'703 35 S300 current config num 3 done
002'704 30 S102 apply index 76 key1 num 3 type 3   lastApplied 75
002'705 28 S102 [479--11] successed
002'705 28 S102 [479--11] ok 
002'705 28 S102 [479--11] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
002'706 29 S100 do snapshot for raft 75 75,size 595
002'707 29 S101 do snapshot for raft 75 75,size 595
002'707 27 S0 raft apply snapshot offset 75 ,lastApplied 75,total log 76, size 225,log cap:2
002'707 31 S100 after snap shot size225 595
002'707 27 S1 raft apply snapshot offset 75 ,lastApplied 75,total log 76, size 225,log cap:2
002'707 31 S101 after snap shot size225 595
002'707 36 S479 [11] clerk putAppend okkkkk
002'708 28 S100 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 12 
002'708 28 S100 declined [479--12] for not leader
002'708 28 S100 [479--12] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'710 28 S101 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 12 
002'710 28 S101 declined [479--12] for not leader
002'710 28 S101 [479--12] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'711 28 S102 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 12 
002'711 33 S102 start [479--12] as leader?
002'722 30 S100 apply index 76 key1 num 3 type 3   lastApplied 75
002'722 30 S102 apply index 77 key1 num 3 type 3   lastApplied 76
002'722 31 S102 used size: 350 / 300 
002'722 29 S102 do snapshot for raft 77 77,size 597
002'723 27 S2 raft apply snapshot offset 77 ,lastApplied 77,total log 77, size 84,log cap:1
002'723 31 S102 after snap shot size84 597
002'723 28 S102 [479--12] successed
002'723 28 S102 [479--12] ok 
002'723 28 S102 [479--12] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
002'723 36 S479 [12] clerk putAppend okkkkk
002'724 30 S101 apply index 76 key1 num 3 type 3   lastApplied 75
002'731 28 S100 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 13 
002'731 28 S100 declined [479--13] for not leader
002'731 28 S100 [479--13] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'732 28 S101 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 13 
002'732 28 S101 declined [479--13] for not leader
002'732 28 S101 [479--13] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'734 28 S102 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 13 
002'734 33 S102 start [479--13] as leader?
002'735 35 S102 current config num 3 done
002'735 35 S201 current config num 3 done
002'735 35 S200 current config num 3 done
002'735 35 S302 current config num 3 done
002'745 30 S101 apply index 77 key1 num 3 type 3   lastApplied 76
002'746 31 S101 used size: 350 / 300 
002'748 29 S101 do snapshot for raft 77 77,size 597
002'748 30 S100 apply index 77 key1 num 3 type 3   lastApplied 76
002'748 31 S100 used size: 350 / 300 
002'749 29 S100 do snapshot for raft 77 77,size 597
002'749 27 S0 raft apply snapshot offset 77 ,lastApplied 77,total log 78, size 225,log cap:2
002'749 31 S100 after snap shot size225 597
002'750 30 S102 apply index 78 key1 num 3 type 3   lastApplied 77
002'750 28 S102 [479--13] successed
002'750 28 S102 [479--13] ok 
002'750 35 S202 current config num 3 done
002'751 44 S1 ctrler change to config &{4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
002'750 28 S102 [479--13] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
002'754 36 S479 [13] clerk putAppend okkkkk
002'755 28 S100 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 14 
002'755 28 S100 declined [479--14] for not leader
002'755 28 S100 [479--14] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'757 35 S301 current config num 3 done
002'757 35 S100 current config num 3 done
002'757 35 S300 current config num 3 done
002'763 27 S1 raft apply snapshot offset 77 ,lastApplied 77,total log 78, size 225,log cap:2
002'763 31 S101 after snap shot size225 597
002'764 28 S101 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 14 
002'764 28 S101 declined [479--14] for not leader
002'764 35 S101 current config num 3 done
002'764 28 S101 [479--14] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'765 28 S102 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 14 
002'765 33 S102 start [479--14] as leader?
002'773 30 S101 apply index 78 key1 num 3 type 3   lastApplied 77
002'773 30 S100 apply index 78 key1 num 3 type 3   lastApplied 77
002'773 30 S102 apply index 79 key1 num 3 type 3   lastApplied 78
002'773 28 S102 [479--14] successed
002'773 28 S102 [479--14] ok 
002'773 28 S102 [479--14] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
002'774 44 S2 ctrler change to config &{4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
002'778 36 S479 [14] clerk putAppend okkkkk
002'779 28 S100 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 15 
002'779 28 S100 declined [479--15] for not leader
002'779 28 S100 [479--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'780 34 S201 got new config {4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 3
002'782 34 S202 got new config {4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 3
002'784 34 S102 got new config {4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 3
002'784 34 S102 propose new config 4
002'785 35 S200 current config num 3 done
002'786 35 S302 current config num 3 done
002'786 35 S201 current config num 3 done
002'787 34 S300 got new config {4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 3
002'788 34 S100 got new config {4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 3
002'788 34 S200 got new config {4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 3
002'789 28 S300 do request args:Key 4 type 3 num 4 Client 132246879705026825 Seq 4 
002'789 28 S300 [825--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
002'789 34 S200 propose new config 4
002'796 28 S300 do request args:Key 6 type 3 num 4 Client 542732653461723544 Seq 4 
002'796 28 S300 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
002'797 28 S100 do request args:Key 2 type 3 num 4 Client 1679014388048817729 Seq 6 
002'797 28 S100 [729--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
002'801 35 S102 current config num 3 done
002'801 28 S100 do request args:Key 7 type 3 num 4 Client 2972145661651991667 Seq 2 
002'801 28 S100 [667--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
002'802 28 S100 do request args:Key 0 type 3 num 4 Client 940626237948413081 Seq 10 
002'802 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
002'803 35 S202 current config num 3 done
002'803 28 S101 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 15 
002'803 28 S101 declined [479--15] for not leader
002'803 28 S300 do request args:Key 5 type 3 num 4 Client 3482757038087095369 Seq 5 
leave &{[102] 1074585914363486070 4}
002'807 28 S300 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
002'807 35 S300 current config num 3 done
002'813 30 S102 apply index 80 key num 0 type 4   lastApplied 79
002'813 34 S102 apply new config num 4 :&{4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
002'813 34 S102 inited need send [],need recv [0 5]
002'813 31 S102 used size: 585 / 300 
002'814 30 S101 apply index 79 key1 num 3 type 3   lastApplied 78
002'814 31 S101 used size: 585 / 300 
002'815 29 S101 do snapshot for raft 79 79,size 599
002'816 27 S1 raft apply snapshot offset 79 ,lastApplied 79,total log 80, size 461,log cap:2
002'816 31 S101 after snap shot size461 599
002'803 28 S101 [479--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'804 30 S200 apply index 13 key num 0 type 4   lastApplied 12
002'804 34 S302 got new config {4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 3
002'817 29 S102 do snapshot for raft 80 80,size 556
002'817 27 S2 raft apply snapshot offset 80 ,lastApplied 80,total log 80, size 84,log cap:1
002'817 31 S102 after snap shot size84 556
002'823 30 S100 apply index 79 key1 num 3 type 3   lastApplied 78
002'823 31 S100 used size: 585 / 300 
002'816 35 S301 current config num 3 done
002'823 34 S200 apply new config num 4 :&{4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
002'824 34 S200 inited need send [0 5 6],need recv []
002'824 31 S200 used size: 459 / 300 
002'824 29 S100 do snapshot for raft 79 79,size 599
002'824 29 S200 do snapshot for raft 13 13,size 539
002'824 27 S0 raft apply snapshot offset 79 ,lastApplied 79,total log 80, size 461,log cap:2
002'824 31 S100 after snap shot size461 599
002'824 35 S100 current config num 3 done
002'825 27 S0 raft apply snapshot offset 13 ,lastApplied 13,total log 13, size 82,log cap:1
002'825 31 S200 after snap shot size82 539
002'816 35 S101 current config num 3 done
leave &{[102] 1074585914363486070 4}
002'826 28 S102 do request args:Key 1 type 3 num 3 Client 418781717203629479 Seq 15 
002'826 28 S102 [479--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
leave &{[102] 1074585914363486070 4}
002'836 35 S302 current config num 3 done
002'836 35 S200 num 4 sending shards [0 5] to group 100
002'836 35 S200 num 4 sending shards [6] to group 102
002'839 35 S201 current config num 3 done
002'840 35 S300 num 3 handle num 4 move rpc [6]
002'842 35 S100 num 3 handle num 4 move rpc [0 5]
002'843 35 S301 num 3 handle num 4 move rpc [6]
002'844 35 S101 num 3 handle num 4 move rpc [0 5]
002'849 35 S302 num 3 handle num 4 move rpc [6]
002'849 35 S102 num 4 handle num 4 move rpc [0 5]
002'850 35 S102 move handle num 4 shards [0 5] as leader?
002'851 44 S2 ctrler change to config &{5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
002'852 35 S102 num 4 waiting [0 5] shards 
002'853 35 S202 current config num 3 done
002'856 30 S100 apply index 80 key num 0 type 4   lastApplied 79
002'856 34 S100 apply new config num 4 :&{4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
002'856 34 S100 inited need send [],need recv [0 5]
002'856 31 S100 used size: 858 / 300 
002'856 30 S102 apply index 81 key num 0 type 5   lastApplied 80
002'856 35 S102 apply num 4 migration [0 5]
002'856 30 S102 safely recv and decided shard 0
002'856 30 S102 safely recv and decided shard 5
002'856 31 S102 used size: 562 / 300 
002'857 29 S100 do snapshot for raft 80 80,size 556
002'857 29 S102 do snapshot for raft 81 81,size 614
002'857 27 S0 raft apply snapshot offset 80 ,lastApplied 80,total log 81, size 562,log cap:2
002'857 27 S2 raft apply snapshot offset 81 ,lastApplied 81,total log 81, size 84,log cap:1
002'860 31 S100 after snap shot size562 556
002'860 30 S101 apply index 80 key num 0 type 4   lastApplied 79
002'860 31 S102 after snap shot size84 614
002'860 35 S102 num 4 move [0 5] is done yet
002'860 34 S101 apply new config num 4 :&{4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
002'860 34 S101 inited need send [],need recv [0 5]
002'860 31 S101 used size: 858 / 300 
002'861 30 S200 after send shards ok
002'861 29 S101 do snapshot for raft 80 80,size 556
002'861 35 S200 move delete propose num 4 shards [0 5] as leader?
002'861 27 S1 raft apply snapshot offset 80 ,lastApplied 80,total log 81, size 562,log cap:2
002'861 31 S101 after snap shot size562 556
002'862 35 S300 current config num 3 done
002'865 30 S200 apply index 14 key num 0 type 5   lastApplied 13
002'865 35 S200 apply num 4 migration [0 5]
002'865 30 S200 safely delete shard 0
002'865 30 S200 safely delete shard 5
002'865 31 S200 used size: 560 / 300 
002'865 30 S201 apply index 13 key num 0 type 4   lastApplied 12
002'865 34 S201 apply new config num 4 :&{4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
002'865 34 S201 inited need send [0 5 6],need recv []
002'865 31 S201 used size: 856 / 300 
002'867 29 S200 do snapshot for raft 14 14,size 480
002'867 30 S202 apply index 13 key num 0 type 4   lastApplied 12
002'867 27 S0 raft apply snapshot offset 14 ,lastApplied 14,total log 14, size 82,log cap:1
002'867 31 S200 after snap shot size82 480
002'867 34 S202 apply new config num 4 :&{4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
002'867 34 S202 inited need send [0 5 6],need recv []
002'867 31 S202 used size: 856 / 300 
002'868 29 S201 do snapshot for raft 13 13,size 539
002'868 29 S202 do snapshot for raft 13 13,size 539
002'868 27 S1 raft apply snapshot offset 13 ,lastApplied 13,total log 14, size 560,log cap:2
002'868 31 S201 after snap shot size560 539
002'868 27 S2 raft apply snapshot offset 13 ,lastApplied 13,total log 14, size 560,log cap:2
002'868 31 S202 after snap shot size560 539
002'869 35 S200 num 4 sending shards [6] to group 102
002'870 35 S300 num 3 handle num 4 move rpc [6]
002'871 30 S202 apply index 14 key num 0 type 5   lastApplied 13
002'871 35 S202 apply num 4 migration [0 5]
002'871 30 S202 safely delete shard 0
002'871 30 S202 safely delete shard 5
002'871 31 S202 used size: 560 / 300 
002'872 30 S201 apply index 14 key num 0 type 5   lastApplied 13
002'872 35 S201 apply num 4 migration [0 5]
002'873 30 S201 safely delete shard 0
002'873 30 S201 safely delete shard 5
002'873 31 S201 used size: 560 / 300 
002'873 29 S201 do snapshot for raft 14 14,size 480
002'873 27 S1 raft apply snapshot offset 14 ,lastApplied 14,total log 14, size 82,log cap:1
002'873 31 S201 after snap shot size82 480
002'874 35 S301 current config num 3 done
002'875 35 S100 num 4 waiting [0 5] shards 
002'875 35 S101 num 4 waiting [0 5] shards 
002'876 29 S202 do snapshot for raft 14 14,size 480
002'876 27 S2 raft apply snapshot offset 14 ,lastApplied 14,total log 14, size 82,log cap:1
002'876 31 S202 after snap shot size82 480
002'877 35 S301 num 3 handle num 4 move rpc [6]
002'878 35 S302 num 3 handle num 4 move rpc [6]
002'880 34 S301 got new config {4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 3
002'881 34 S301 propose new config 4
002'881 34 S201 check new config wanted 5
002'883 28 S100 do request args:Key 9 type 3 num 4 Client 3620950086299709532 Seq 2 
002'883 28 S100 declined [532--2] for not leader
002'883 28 S100 [532--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'883 34 S202 check new config wanted 5
002'885 34 S102 check new config wanted 5
002'886 28 S101 do request args:Key 9 type 3 num 4 Client 3620950086299709532 Seq 2 
002'886 28 S101 declined [532--2] for not leader
002'886 28 S101 [532--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'892 28 S102 do request args:Key 9 type 3 num 4 Client 3620950086299709532 Seq 2 
002'892 33 S102 start [532--2] as leader?
002'893 30 S301 apply index 10 key num 0 type 4   lastApplied 9
002'893 34 S301 apply new config num 4 :&{4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
002'893 34 S301 inited need send [],need recv [6]
002'893 35 S201 num 4 sending shards [6] to group 102
002'893 31 S301 used size: 459 / 300 
002'894 29 S301 do snapshot for raft 10 10,size 569
002'894 27 S1 raft apply snapshot offset 10 ,lastApplied 10,total log 10, size 82,log cap:1
002'894 31 S301 after snap shot size82 569
002'894 35 S300 num 3 handle num 4 move rpc [6]
002'898 28 S300 do request args:Key 3 type 3 num 4 Client 2238025532150463055 Seq 5 
002'898 28 S300 [ 55--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
002'899 34 S300 check new config wanted 4
002'899 34 S101 check new config wanted 5
002'899 35 S302 current config num 3 done
002'899 34 S100 check new config wanted 5
002'900 34 S200 check new config wanted 5
002'900 35 S200 num 4 sending shards [6] to group 102
002'902 35 S102 current config num 4 done
002'903 35 S301 num 4 handle num 4 move rpc [6]
002'905 35 S202 num 4 sending shards [6] to group 102
002'906 35 S301 move handle num 4 shards [6] as leader?
002'921 28 S300 do request args:Key 8 type 3 num 4 Client 2953714763196401582 Seq 2 
002'921 28 S300 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
002'922 35 S300 num 3 handle num 4 move rpc [6]
002'924 35 S201 num 4 sending shards [6] to group 102
002'925 35 S100 num 4 waiting [0 5] shards 
002'925 35 S300 current config num 3 done
002'926 35 S301 num 4 waiting [6] shards 
002'927 35 S101 num 4 waiting [0 5] shards 
002'927 30 S101 apply index 81 key num 0 type 5   lastApplied 80
002'927 35 S101 apply num 4 migration [0 5]
002'927 30 S101 safely recv and decided shard 0
002'927 30 S101 safely recv and decided shard 5
002'927 31 S101 used size: 624 / 300 
002'929 34 S302 check new config wanted 4
002'929 30 S102 apply index 82 key9 num 4 type 3   lastApplied 81
002'929 28 S102 [532--2] successed
002'929 28 S102 [532--2] ok 
002'929 28 S102 [532--2] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
002'930 36 S532 [2] clerk putAppend okkkkk
002'932 35 S300 num 3 handle num 4 move rpc [6]
002'932 29 S101 do snapshot for raft 81 81,size 614
002'933 27 S1 raft apply snapshot offset 81 ,lastApplied 81,total log 82, size 225,log cap:2
002'933 31 S101 after snap shot size225 614
002'933 35 S200 num 4 sending shards [6] to group 102
002'938 35 S202 num 4 sending shards [6] to group 102
002'952 35 S300 num 3 handle num 4 move rpc [6]
002'952 30 S302 apply index 10 key num 0 type 4   lastApplied 9
002'952 34 S302 apply new config num 4 :&{4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
002'952 34 S302 inited need send [],need recv [6]
002'952 31 S302 used size: 817 / 300 
002'953 35 S102 current config num 4 done
002'953 30 S301 apply index 11 key num 0 type 5   lastApplied 10
002'953 35 S301 apply num 4 migration [6]
002'954 30 S301 safely recv and decided shard 6
002'954 31 S301 used size: 521 / 300 
002'954 29 S301 do snapshot for raft 11 11,size 595
002'954 27 S1 raft apply snapshot offset 11 ,lastApplied 11,total log 11, size 82,log cap:1
002'955 31 S301 after snap shot size82 595
002'955 35 S301 num 4 move [6] is done yet
002'955 35 S301 num 4 handle num 4 move rpc [6]
002'955 35 S301 num 4 move [6] is done yet
002'955 35 S201 num 4 sending shards [6] to group 102
002'955 30 S201 after send shards ok
002'955 35 S201 move delete propose not leader
002'956 30 S201 after send shards ok
002'956 35 S201 move delete propose not leader
002'957 29 S302 do snapshot for raft 10 10,size 569
002'957 27 S2 raft apply snapshot offset 10 ,lastApplied 10,total log 11, size 521,log cap:2
002'958 31 S302 after snap shot size521 569
002'958 35 S302 num 4 waiting [6] shards 
002'959 35 S300 num 3 handle num 4 move rpc [6]
002'959 35 S301 num 4 handle num 4 move rpc [6]
002'959 35 S301 num 4 move [6] is done yet
002'961 30 S200 after send shards ok
002'963 30 S300 apply index 10 key num 0 type 4   lastApplied 9
002'963 34 S300 apply new config num 4 :&{4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{3 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
002'963 34 S300 inited need send [],need recv [6]
002'963 31 S300 used size: 817 / 300 
002'964 29 S300 do snapshot for raft 10 10,size 569
002'964 27 S0 raft apply snapshot offset 10 ,lastApplied 10,total log 11, size 521,log cap:2
002'964 31 S300 after snap shot size521 569
002'966 35 S301 num 4 handle num 4 move rpc [6]
002'966 35 S301 num 4 move [6] is done yet
002'966 30 S202 after send shards ok
002'966 35 S202 move delete propose not leader
002'967 35 S301 num 4 handle num 4 move rpc [6]
002'967 35 S301 num 4 move [6] is done yet
002'968 30 S201 after send shards ok
002'968 35 S201 move delete propose not leader
002'968 44 S1 ctrler change to config &{5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
002'968 35 S202 num 4 sending shards [6] to group 102
002'969 35 S200 move delete propose num 4 shards [6] as leader?
002'969 35 S200 num 4 sending shards [6] to group 102
002'970 28 S100 do request args:Key 9 type 3 num 4 Client 3620950086299709532 Seq 3 
002'976 35 S300 num 4 waiting [6] shards 
002'976 28 S100 declined [532--3] for not leader
002'976 28 S100 [532--3] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'976 30 S100 apply index 81 key num 0 type 5   lastApplied 80
002'976 35 S100 apply num 4 migration [0 5]
002'976 30 S100 safely recv and decided shard 0
002'976 30 S100 safely recv and decided shard 5
002'976 31 S100 used size: 624 / 300 
002'977 29 S100 do snapshot for raft 81 81,size 614
002'982 44 S0 ctrler change to config &{5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
002'984 27 S0 raft apply snapshot offset 81 ,lastApplied 81,total log 82, size 225,log cap:2
002'984 31 S100 after snap shot size225 614
002'985 35 S300 num 4 handle num 4 move rpc [6]
002'985 35 S300 move handle not leader
002'986 34 S301 check new config wanted 5
002'988 35 S100 current config num 4 done
002'988 35 S301 current config num 4 done
002'988 35 S101 current config num 4 done
002'988 35 S201 num 4 sending shards [6] to group 102
002'992 35 S300 num 4 handle num 4 move rpc [6]
002'992 35 S300 move handle not leader
002'994 28 S101 do request args:Key 9 type 3 num 4 Client 3620950086299709532 Seq 3 
002'994 28 S101 declined [532--3] for not leader
002'994 28 S101 [532--3] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
002'995 35 S301 num 4 handle num 4 move rpc [6]
002'995 35 S301 num 4 move [6] is done yet
002'995 30 S202 after send shards ok
002'995 35 S202 move delete propose not leader
002'997 35 S300 num 4 handle num 4 move rpc [6]
002'997 35 S300 move handle not leader
002'998 30 S300 apply index 11 key num 0 type 5   lastApplied 10
002'998 35 S300 apply num 4 migration [6]
002'998 30 S300 safely recv and decided shard 6
002'998 31 S300 used size: 521 / 300 
002'999 29 S300 do snapshot for raft 11 11,size 595
003'001 27 S0 raft apply snapshot offset 11 ,lastApplied 11,total log 11, size 82,log cap:1
003'001 31 S300 after snap shot size82 595
003'001 35 S200 num 4 sending shards [6] to group 102
003'002 28 S102 do request args:Key 9 type 3 num 4 Client 3620950086299709532 Seq 3 
003'002 33 S102 start [532--3] as leader?
003'005 30 S200 apply index 15 key num 0 type 5   lastApplied 14
003'005 35 S200 apply num 4 migration [6]
003'005 30 S200 safely delete shard 6
003'005 31 S200 used size: 521 / 300 
003'005 29 S200 do snapshot for raft 15 15,size 454
003'005 27 S0 raft apply snapshot offset 15 ,lastApplied 15,total log 15, size 82,log cap:1
003'006 31 S200 after snap shot size82 454
003'007 35 S301 num 4 handle num 4 move rpc [6]
003'007 35 S301 num 4 move [6] is done yet
003'007 30 S201 after send shards ok
003'007 35 S201 move delete propose not leader
003'008 35 S300 num 4 handle num 4 move rpc [6]
003'009 35 S300 num 4 move [6] is done yet
003'009 30 S200 after send shards ok
003'009 35 S200 num 4 move [6] is done yet
003'014 35 S202 num 4 sending shards [6] to group 102
003'016 35 S300 num 4 handle num 4 move rpc [6]
003'016 35 S300 num 4 move [6] is done yet
003'018 30 S202 after send shards ok
003'018 35 S202 move delete propose not leader
003'019 35 S201 num 4 sending shards [6] to group 102
003'020 35 S302 num 4 waiting [6] shards 
003'028 35 S300 current config num 4 done
003'029 35 S102 current config num 4 done
003'035 35 S200 current config num 4 done
003'036 35 S300 num 4 handle num 4 move rpc [6]
003'036 35 S300 num 4 move [6] is done yet
003'037 35 S301 num 4 handle num 4 move rpc [6]
003'037 35 S301 num 4 move [6] is done yet
003'037 30 S200 after send shards ok
003'037 35 S200 num 4 move [6] is done yet
003'039 30 S302 apply index 11 key num 0 type 5   lastApplied 10
003'039 35 S302 apply num 4 migration [6]
003'039 30 S302 safely recv and decided shard 6
003'039 31 S302 used size: 521 / 300 
003'039 29 S302 do snapshot for raft 11 11,size 595
003'040 27 S2 raft apply snapshot offset 11 ,lastApplied 11,total log 11, size 82,log cap:1
003'040 31 S302 after snap shot size82 595
003'040 30 S101 apply index 82 key9 num 4 type 3   lastApplied 81
003'042 30 S200 after send shards ok
003'042 35 S200 num 4 move [6] is done yet
003'043 30 S102 apply index 83 key9 num 4 type 3   lastApplied 82
003'043 28 S102 [532--3] successed
003'043 28 S102 [532--3] ok 
003'043 28 S102 [532--3] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
003'043 36 S532 [3] clerk putAppend okkkkk
003'044 28 S100 do request args:Key 9 type 3 num 4 Client 3620950086299709532 Seq 4 
003'045 35 S202 num 4 sending shards [6] to group 102
003'047 35 S300 num 4 handle num 4 move rpc [6]
003'047 35 S300 num 4 move [6] is done yet
003'048 35 S300 num 4 handle num 4 move rpc [6]
003'048 35 S300 num 4 move [6] is done yet
003'048 35 S301 current config num 4 done
003'048 35 S101 current config num 4 done
003'055 28 S100 declined [532--4] for not leader
003'055 28 S100 [532--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'055 35 S100 current config num 4 done
003'055 30 S100 apply index 82 key9 num 4 type 3   lastApplied 81
003'060 30 S201 after send shards ok
003'060 35 S201 move delete propose not leader
003'060 30 S202 after send shards ok
003'061 35 S202 move delete propose not leader
003'069 28 S101 do request args:Key 9 type 3 num 4 Client 3620950086299709532 Seq 4 
003'069 28 S101 declined [532--4] for not leader
003'069 28 S101 [532--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'069 35 S300 num 4 handle num 4 move rpc [6]
003'069 35 S300 num 4 move [6] is done yet
003'070 30 S202 after send shards ok
003'070 35 S202 move delete propose not leader
003'070 35 S201 num 4 sending shards [6] to group 102
003'070 28 S102 do request args:Key 9 type 3 num 4 Client 3620950086299709532 Seq 4 
003'070 33 S102 start [532--4] as leader?
003'071 35 S302 current config num 4 done
003'074 35 S300 num 4 handle num 4 move rpc [6]
003'074 35 S300 num 4 move [6] is done yet
003'075 30 S201 after send shards ok
003'075 35 S201 move delete propose not leader
003'077 35 S202 num 4 sending shards [6] to group 102
003'078 35 S300 current config num 4 done
003'080 35 S300 num 4 handle num 4 move rpc [6]
003'080 35 S300 num 4 move [6] is done yet
003'080 30 S202 after send shards ok
003'080 35 S202 move delete propose not leader
003'080 35 S102 current config num 4 done
003'101 35 S201 num 4 sending shards [6] to group 102
003'104 35 S300 num 4 handle num 4 move rpc [6]
003'104 35 S300 num 4 move [6] is done yet
003'105 30 S201 after send shards ok
003'105 35 S201 move delete propose not leader
003'108 35 S202 num 4 sending shards [6] to group 102
003'108 35 S100 current config num 4 done
003'109 30 S100 apply index 83 key9 num 4 type 3   lastApplied 82
003'109 31 S100 used size: 350 / 300 
003'109 30 S101 apply index 83 key9 num 4 type 3   lastApplied 82
003'109 29 S100 do snapshot for raft 83 83,size 616
003'110 27 S0 raft apply snapshot offset 83 ,lastApplied 83,total log 84, size 225,log cap:2
003'110 31 S100 after snap shot size225 616
003'110 35 S301 current config num 4 done
003'110 30 S102 apply index 84 key9 num 4 type 3   lastApplied 83
003'110 31 S102 used size: 350 / 300 
003'109 31 S101 used size: 350 / 300 
003'110 29 S102 do snapshot for raft 84 84,size 617
003'111 27 S2 raft apply snapshot offset 84 ,lastApplied 84,total log 84, size 84,log cap:1
003'111 31 S102 after snap shot size84 617
003'111 28 S102 [532--4] successed
003'111 28 S102 [532--4] ok 
003'111 28 S102 [532--4] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
003'111 29 S101 do snapshot for raft 83 83,size 616
003'111 27 S1 raft apply snapshot offset 83 ,lastApplied 83,total log 84, size 225,log cap:2
003'111 31 S101 after snap shot size225 616
003'111 36 S532 [4] clerk putAppend okkkkk
003'112 35 S101 current config num 4 done
003'112 35 S300 num 4 handle num 4 move rpc [6]
003'112 35 S300 num 4 move [6] is done yet
003'113 30 S202 after send shards ok
003'113 35 S202 move delete propose not leader
003'113 35 S200 current config num 4 done
003'122 28 S100 do request args:Key 9 type 3 num 4 Client 3620950086299709532 Seq 5 
003'123 28 S100 declined [532--5] for not leader
003'123 28 S100 [532--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'124 28 S101 do request args:Key 9 type 3 num 4 Client 3620950086299709532 Seq 5 
003'124 28 S101 declined [532--5] for not leader
003'124 28 S101 [532--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'124 35 S302 current config num 4 done
003'125 28 S102 do request args:Key 9 type 3 num 4 Client 3620950086299709532 Seq 5 
003'126 33 S102 start [532--5] as leader?
003'129 35 S300 current config num 4 done
003'133 30 S100 apply index 84 key9 num 4 type 3   lastApplied 83
003'134 30 S102 apply index 85 key9 num 4 type 3   lastApplied 84
003'134 28 S102 [532--5] successed
003'134 28 S102 [532--5] ok 
003'134 28 S102 [532--5] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
003'134 30 S101 apply index 84 key9 num 4 type 3   lastApplied 83
003'134 36 S532 [5] clerk putAppend okkkkk
003'135 28 S100 do request args:Key 9 type 3 num 4 Client 3620950086299709532 Seq 6 
003'135 28 S100 declined [532--6] for not leader
003'135 28 S100 [532--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'136 28 S101 do request args:Key 9 type 3 num 4 Client 3620950086299709532 Seq 6 
003'136 28 S101 declined [532--6] for not leader
003'136 28 S101 [532--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'138 28 S102 do request args:Key 9 type 3 num 4 Client 3620950086299709532 Seq 6 
003'138 33 S102 start [532--6] as leader?
003'138 35 S102 current config num 4 done
003'138 35 S201 num 4 sending shards [6] to group 102
003'139 35 S202 num 4 sending shards [6] to group 102
003'140 35 S300 num 4 handle num 4 move rpc [6]
003'140 35 S300 num 4 move [6] is done yet
003'150 35 S300 num 4 handle num 4 move rpc [6]
003'150 35 S300 num 4 move [6] is done yet
003'151 30 S201 after send shards ok
003'151 35 S201 move delete propose not leader
003'152 30 S202 after send shards ok
003'152 35 S202 move delete propose not leader
003'157 30 S100 apply index 85 key9 num 4 type 3   lastApplied 84
003'157 31 S100 used size: 350 / 300 
003'157 29 S100 do snapshot for raft 85 85,size 618
003'158 27 S0 raft apply snapshot offset 85 ,lastApplied 85,total log 86, size 225,log cap:2
003'158 31 S100 after snap shot size225 618
003'158 30 S102 apply index 86 key9 num 4 type 3   lastApplied 85
003'158 28 S102 [532--6] successed
003'158 28 S102 [532--6] ok 
003'158 28 S102 [532--6] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
003'158 36 S532 [6] clerk putAppend okkkkk
003'159 35 S100 current config num 4 done
003'160 35 S301 current config num 4 done
003'161 28 S100 do request args:Key 9 type 3 num 4 Client 3620950086299709532 Seq 7 
003'161 28 S100 declined [532--7] for not leader
003'161 28 S100 [532--7] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'162 28 S101 do request args:Key 9 type 3 num 4 Client 3620950086299709532 Seq 7 
003'162 28 S101 declined [532--7] for not leader
003'162 28 S101 [532--7] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'167 30 S201 apply index 15 key num 0 type 5   lastApplied 14
003'167 35 S201 apply num 4 migration [6]
003'167 30 S201 safely delete shard 6
003'167 31 S201 used size: 521 / 300 
003'168 29 S201 do snapshot for raft 15 15,size 454
003'168 27 S1 raft apply snapshot offset 15 ,lastApplied 15,total log 15, size 82,log cap:1
003'168 31 S201 after snap shot size82 454
003'168 30 S202 apply index 15 key num 0 type 5   lastApplied 14
003'168 35 S202 apply num 4 migration [6]
003'168 30 S202 safely delete shard 6
003'168 31 S202 used size: 521 / 300 
003'169 29 S202 do snapshot for raft 15 15,size 454
003'169 27 S2 raft apply snapshot offset 15 ,lastApplied 15,total log 15, size 82,log cap:1
003'169 31 S202 after snap shot size82 454
003'170 35 S202 current config num 4 done
003'170 35 S201 current config num 4 done
003'174 35 S302 current config num 4 done
003'169 35 S200 current config num 4 done
003'163 35 S101 current config num 4 done
003'175 30 S101 apply index 85 key9 num 4 type 3   lastApplied 84
003'175 31 S101 used size: 350 / 300 
003'176 29 S101 do snapshot for raft 85 85,size 618
003'176 27 S1 raft apply snapshot offset 85 ,lastApplied 85,total log 86, size 225,log cap:2
003'176 31 S101 after snap shot size225 618
003'177 34 S201 got new config {5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 4
003'178 28 S102 do request args:Key 9 type 3 num 4 Client 3620950086299709532 Seq 7 
003'179 33 S102 start [532--7] as leader?
003'180 34 S202 got new config {5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 4
003'181 34 S102 got new config {5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 4
003'181 34 S100 got new config {5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 4
003'181 34 S102 propose new config 5
003'185 28 S100 do request args:Key 4 type 3 num 5 Client 132246879705026825 Seq 4 
003'185 28 S100 [825--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
003'186 34 S301 got new config {5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 4
003'187 35 S300 current config num 4 done
003'189 28 S100 do request args:Key 7 type 3 num 5 Client 2972145661651991667 Seq 2 
003'189 28 S100 [667--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
003'189 28 S100 do request args:Key 5 type 3 num 5 Client 3482757038087095369 Seq 5 
003'189 28 S100 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
003'190 35 S102 current config num 4 done
003'193 34 S301 propose new config 5
003'194 28 S100 do request args:Key 2 type 3 num 5 Client 1679014388048817729 Seq 6 
003'194 28 S100 [729--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
003'194 28 S100 do request args:Key 0 type 3 num 5 Client 940626237948413081 Seq 10 
003'194 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
003'198 34 S302 got new config {4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 3
003'201 30 S100 apply index 86 key9 num 4 type 3   lastApplied 85
003'201 31 S100 used size: 543 / 300 
003'201 34 S200 got new config {5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 4
003'201 29 S100 do snapshot for raft 86 86,size 619
003'202 34 S300 got new config {4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 3
003'209 27 S0 raft apply snapshot offset 86 ,lastApplied 86,total log 88, size 481,log cap:3
003'209 31 S100 after snap shot size481 619
003'209 34 S200 propose new config 5
003'210 35 S100 current config num 4 done
003'210 35 S301 current config num 4 done
003'211 30 S102 apply index 87 key9 num 4 type 3   lastApplied 86
003'211 31 S102 used size: 605 / 300 
003'212 29 S102 do snapshot for raft 87 87,size 620
003'212 27 S2 raft apply snapshot offset 87 ,lastApplied 88,total log 88, size 418,log cap:2
003'212 27 S2 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:4, Opt:shardctrler.Config{Num:5, Shards:[10]int{100, 100, 100, 100, 100, 100, 100, 100, 100, 100}, Groups:map[int][]string{100:[]string{"server-100-0", "server-100-1", "server-100-2"}}}, Num:0}}
003'212 31 S102 after snap shot size418 620
003'212 30 S102 apply index 88 key num 0 type 4   lastApplied 87
003'212 34 S102 apply new config num 5 :&{5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
003'212 34 S102 inited need send [],need recv [1 2 3 4 6]
003'212 31 S102 used size: 418 / 300 
003'213 29 S102 do snapshot for raft 88 88,size 578
003'213 27 S2 raft apply snapshot offset 88 ,lastApplied 88,total log 88, size 84,log cap:1
003'213 31 S102 after snap shot size84 578
003'214 28 S102 [532--7] failed applied ava false
003'214 28 S102 [532--7] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
003'221 30 S101 apply index 86 key9 num 4 type 3   lastApplied 85
003'221 31 S101 used size: 543 / 300 
003'222 29 S101 do snapshot for raft 86 86,size 619
003'222 27 S1 raft apply snapshot offset 86 ,lastApplied 86,total log 88, size 481,log cap:3
003'223 31 S101 after snap shot size481 619
003'220 30 S301 apply index 12 key num 0 type 4   lastApplied 11
003'224 34 S301 apply new config num 5 :&{5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
003'224 34 S301 inited need send [1 2 3 4 6],need recv []
003'224 31 S301 used size: 416 / 300 
003'225 29 S301 do snapshot for raft 12 12,size 553
003'225 27 S1 raft apply snapshot offset 12 ,lastApplied 12,total log 12, size 82,log cap:1
003'225 31 S301 after snap shot size82 553
003'225 35 S202 current config num 4 done
003'225 35 S200 current config num 4 done
003'225 35 S201 current config num 4 done
003'225 35 S101 current config num 4 done
003'226 35 S302 current config num 4 done
003'226 28 S100 do request args:Key 3 type 3 num 5 Client 2238025532150463055 Seq 5 
003'226 28 S100 [ 55--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
003'227 28 S100 do request args:Key 6 type 3 num 5 Client 542732653461723544 Seq 4 
003'227 28 S100 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
003'228 28 S100 do request args:Key 1 type 3 num 5 Client 418781717203629479 Seq 15 
003'228 28 S100 [479--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
003'229 28 S100 do request args:Key 8 type 3 num 5 Client 2953714763196401582 Seq 2 
003'229 28 S100 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
003'231 30 S200 apply index 16 key num 0 type 4   lastApplied 15
003'231 34 S200 apply new config num 5 :&{5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
003'232 34 S200 inited need send [],need recv []
003'232 31 S200 used size: 416 / 300 
003'232 29 S200 do snapshot for raft 16 16,size 412
003'232 27 S0 raft apply snapshot offset 16 ,lastApplied 16,total log 16, size 82,log cap:1
003'232 31 S200 after snap shot size82 412
003'233 30 S101 apply index 87 key9 num 4 type 3   lastApplied 86
003'233 31 S101 used size: 481 / 300 
003'234 30 S100 apply index 87 key9 num 4 type 3   lastApplied 86
003'234 31 S100 used size: 481 / 300 
003'234 29 S100 do snapshot for raft 87 87,size 620
003'235 27 S0 raft apply snapshot offset 87 ,lastApplied 88,total log 88, size 418,log cap:2
003'235 27 S0 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:4, Opt:shardctrler.Config{Num:5, Shards:[10]int{100, 100, 100, 100, 100, 100, 100, 100, 100, 100}, Groups:map[int][]string{100:[]string{"server-100-0", "server-100-1", "server-100-2"}}}, Num:0}}
003'235 31 S100 after snap shot size418 620
003'235 30 S100 apply index 88 key num 0 type 4   lastApplied 87
003'235 34 S100 apply new config num 5 :&{5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
003'235 34 S100 inited need send [],need recv [1 2 3 4 6]
003'235 31 S100 used size: 418 / 300 
003'236 29 S100 do snapshot for raft 88 88,size 578
003'236 27 S0 raft apply snapshot offset 88 ,lastApplied 88,total log 88, size 84,log cap:1
003'236 31 S100 after snap shot size84 578
003'238 29 S101 do snapshot for raft 87 87,size 620
003'238 35 S300 current config num 4 done
003'239 27 S1 raft apply snapshot offset 87 ,lastApplied 88,total log 88, size 418,log cap:2
003'240 27 S1 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:4, Opt:shardctrler.Config{Num:5, Shards:[10]int{100, 100, 100, 100, 100, 100, 100, 100, 100, 100}, Groups:map[int][]string{100:[]string{"server-100-0", "server-100-1", "server-100-2"}}}, Num:0}}
003'240 31 S101 after snap shot size418 620
003'240 30 S101 apply index 88 key num 0 type 4   lastApplied 87
003'240 34 S101 apply new config num 5 :&{5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
003'240 34 S101 inited need send [],need recv [1 2 3 4 6]
003'240 31 S101 used size: 418 / 300 
003'240 29 S101 do snapshot for raft 88 88,size 578
003'240 27 S1 raft apply snapshot offset 88 ,lastApplied 88,total log 88, size 84,log cap:1
003'240 31 S101 after snap shot size84 578
003'240 35 S102 num 5 waiting [1 2 3 4 6] shards 
003'243 34 S101 got new config {5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 4
003'260 35 S100 num 5 waiting [1 2 3 4 6] shards 
003'260 35 S301 num 5 sending shards [1 2 3 4 6] to group 100
003'262 35 S100 num 5 handle num 5 move rpc [1 2 3 4 6]
003'262 35 S100 move handle not leader
003'264 35 S101 num 5 handle num 5 move rpc [1 2 3 4 6]
003'264 35 S101 move handle not leader
003'265 35 S102 num 5 handle num 5 move rpc [1 2 3 4 6]
003'266 35 S102 move handle num 5 shards [1 2 3 4 6] as leader?
003'269 30 S302 apply index 12 key num 0 type 4   lastApplied 11
003'269 30 S300 apply index 12 key num 0 type 4   lastApplied 11
003'269 34 S302 apply new config num 5 :&{5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
003'269 34 S302 inited need send [1 2 3 4 6],need recv []
003'269 34 S300 apply new config num 5 :&{5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
003'269 34 S300 inited need send [1 2 3 4 6],need recv []
003'269 31 S300 used size: 416 / 300 
003'270 29 S300 do snapshot for raft 12 12,size 553
003'270 27 S0 raft apply snapshot offset 12 ,lastApplied 12,total log 12, size 82,log cap:1
003'270 31 S300 after snap shot size82 553
003'269 31 S302 used size: 416 / 300 
003'271 29 S302 do snapshot for raft 12 12,size 553
003'273 27 S2 raft apply snapshot offset 12 ,lastApplied 12,total log 12, size 82,log cap:1
003'273 31 S302 after snap shot size82 553
003'277 30 S102 apply index 89 key num 0 type 5   lastApplied 88
003'277 35 S302 num 5 sending shards [1 2 3 4 6] to group 100
003'277 35 S102 apply num 5 migration [1 2 3 4 6]
003'277 30 S102 safely recv and decided shard 1
003'277 30 S102 safely recv and decided shard 2
003'277 30 S102 safely recv and decided shard 3
003'277 30 S102 safely recv and decided shard 4
003'277 30 S102 safely recv and decided shard 6
003'277 31 S102 used size: 675 / 300 
003'278 34 S201 check new config wanted 5
003'278 29 S102 do snapshot for raft 89 89,size 719
003'278 35 S201 current config num 4 done
003'278 35 S202 current config num 4 done
003'278 35 S200 current config num 5 done
003'278 27 S2 raft apply snapshot offset 89 ,lastApplied 89,total log 89, size 84,log cap:1
003'278 35 S101 num 5 waiting [1 2 3 4 6] shards 
003'278 31 S102 after snap shot size84 719
003'278 35 S102 num 5 move [1 2 3 4 6] is done yet
003'279 35 S100 num 5 handle num 5 move rpc [1 2 3 4 6]
003'279 35 S100 move handle not leader
003'281 35 S101 num 5 handle num 5 move rpc [1 2 3 4 6]
003'281 35 S101 move handle not leader
003'282 34 S100 check new config wanted 6
003'282 34 S202 check new config wanted 5
003'283 35 S102 num 5 handle num 5 move rpc [1 2 3 4 6]
003'283 35 S102 num 5 move [1 2 3 4 6] is done yet
003'284 30 S302 after send shards ok
003'284 35 S302 move delete propose not leader
003'288 35 S300 num 5 sending shards [1 2 3 4 6] to group 100
003'289 30 S301 after send shards ok
003'289 34 S102 check new config wanted 6
003'289 35 S301 move delete propose num 5 shards [1 2 3 4 6] as leader?
003'291 35 S301 num 5 sending shards [1 2 3 4 6] to group 100
003'292 35 S100 num 5 handle num 5 move rpc [1 2 3 4 6]
003'292 35 S100 move handle not leader
003'296 35 S102 current config num 5 done
003'299 35 S100 num 5 handle num 5 move rpc [1 2 3 4 6]
003'299 35 S100 move handle not leader
003'301 34 S301 check new config wanted 6
003'302 34 S300 check new config wanted 6
003'305 35 S101 num 5 handle num 5 move rpc [1 2 3 4 6]
003'305 35 S101 move handle not leader
003'301 34 S302 check new config wanted 6
003'307 35 S101 num 5 handle num 5 move rpc [1 2 3 4 6]
003'307 35 S101 move handle not leader
003'310 34 S200 check new config wanted 6
003'311 30 S301 apply index 13 key num 0 type 5   lastApplied 12
003'311 35 S301 apply num 5 migration [1 2 3 4 6]
003'311 30 S301 safely delete shard 1
003'311 30 S301 safely delete shard 2
003'311 30 S301 safely delete shard 3
003'311 30 S301 safely delete shard 4
003'311 30 S301 safely delete shard 6
003'311 31 S301 used size: 673 / 300 
003'312 29 S301 do snapshot for raft 13 13,size 412
003'312 27 S1 raft apply snapshot offset 13 ,lastApplied 13,total log 13, size 82,log cap:1
003'312 31 S301 after snap shot size82 412
003'317 35 S102 num 5 handle num 5 move rpc [1 2 3 4 6]
003'317 35 S102 num 5 move [1 2 3 4 6] is done yet
003'319 30 S301 after send shards ok
003'319 35 S301 num 5 move [1 2 3 4 6] is done yet
003'323 35 S300 num 5 sending shards [1 2 3 4 6] to group 100
003'327 35 S301 current config num 5 done
003'327 35 S302 num 5 sending shards [1 2 3 4 6] to group 100
003'328 35 S201 current config num 4 done
003'328 35 S200 current config num 5 done
003'328 35 S101 num 5 waiting [1 2 3 4 6] shards 
003'329 35 S100 num 5 handle num 5 move rpc [1 2 3 4 6]
003'329 35 S100 move handle not leader
003'329 35 S202 current config num 4 done
003'331 35 S100 num 5 waiting [1 2 3 4 6] shards 
003'336 35 S101 num 5 handle num 5 move rpc [1 2 3 4 6]
003'336 35 S101 move handle not leader
003'337 35 S100 num 5 handle num 5 move rpc [1 2 3 4 6]
003'337 35 S100 move handle not leader
003'340 35 S102 num 5 handle num 5 move rpc [1 2 3 4 6]
003'340 35 S102 num 5 move [1 2 3 4 6] is done yet
003'340 30 S300 after send shards ok
003'341 35 S300 move delete propose not leader
003'349 35 S102 num 5 handle num 5 move rpc [1 2 3 4 6]
003'349 35 S102 num 5 move [1 2 3 4 6] is done yet
003'349 34 S101 check new config wanted 6
003'350 35 S101 num 5 handle num 5 move rpc [1 2 3 4 6]
003'350 35 S101 move handle not leader
003'350 30 S302 after send shards ok
003'353 35 S102 num 5 handle num 5 move rpc [1 2 3 4 6]
003'353 35 S102 num 5 move [1 2 3 4 6] is done yet
003'353 30 S300 after send shards ok
003'353 35 S300 move delete propose not leader
003'356 35 S102 current config num 5 done
003'360 35 S300 num 5 sending shards [1 2 3 4 6] to group 100
003'362 35 S100 num 5 handle num 5 move rpc [1 2 3 4 6]
003'362 35 S100 move handle not leader
003'366 35 S302 move delete propose not leader
003'373 35 S302 num 5 sending shards [1 2 3 4 6] to group 100
003'375 35 S100 num 5 handle num 5 move rpc [1 2 3 4 6]
003'375 35 S100 move handle not leader
003'377 35 S101 num 5 handle num 5 move rpc [1 2 3 4 6]
003'378 35 S101 move handle not leader
003'378 35 S200 current config num 5 done
003'379 35 S301 current config num 5 done
003'380 35 S201 current config num 4 done
003'380 35 S101 num 5 waiting [1 2 3 4 6] shards 
003'380 35 S202 current config num 4 done
003'381 35 S102 num 5 handle num 5 move rpc [1 2 3 4 6]
003'381 35 S102 num 5 move [1 2 3 4 6] is done yet
003'381 30 S302 after send shards ok
003'381 35 S302 move delete propose not leader
003'383 35 S101 num 5 handle num 5 move rpc [1 2 3 4 6]
003'383 35 S101 move handle not leader
003'384 35 S100 num 5 waiting [1 2 3 4 6] shards 
003'385 35 S102 num 5 handle num 5 move rpc [1 2 3 4 6]
003'385 35 S102 num 5 move [1 2 3 4 6] is done yet
003'385 30 S300 after send shards ok
003'386 35 S300 move delete propose not leader
003'386 34 S201 got new config {5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 4
003'393 35 S300 num 5 sending shards [1 2 3 4 6] to group 100
003'395 35 S100 num 5 handle num 5 move rpc [1 2 3 4 6]
003'395 35 S100 move handle not leader
003'397 35 S101 num 5 handle num 5 move rpc [1 2 3 4 6]
003'397 35 S101 move handle not leader
003'400 35 S102 num 5 handle num 5 move rpc [1 2 3 4 6]
003'400 35 S102 num 5 move [1 2 3 4 6] is done yet
003'400 30 S300 after send shards ok
003'400 35 S300 move delete propose not leader
003'403 35 S302 num 5 sending shards [1 2 3 4 6] to group 100
003'405 35 S100 num 5 handle num 5 move rpc [1 2 3 4 6]
003'405 35 S100 move handle not leader
003'407 35 S101 num 5 handle num 5 move rpc [1 2 3 4 6]
003'407 35 S101 move handle not leader
003'408 35 S102 current config num 5 done
003'410 35 S102 num 5 handle num 5 move rpc [1 2 3 4 6]
003'410 35 S102 num 5 move [1 2 3 4 6] is done yet
003'411 30 S302 after send shards ok
003'411 35 S302 move delete propose not leader
003'434 35 S100 num 5 waiting [1 2 3 4 6] shards 
003'435 35 S302 num 5 sending shards [1 2 3 4 6] to group 100
003'437 35 S200 current config num 5 done
003'437 35 S201 current config num 4 done
003'437 35 S101 num 5 waiting [1 2 3 4 6] shards 
003'437 35 S202 current config num 4 done
003'437 35 S301 current config num 5 done
003'438 35 S300 num 5 sending shards [1 2 3 4 6] to group 100
003'459 35 S102 current config num 5 done
003'438 35 S100 num 5 handle num 5 move rpc [1 2 3 4 6]
003'460 35 S100 move handle not leader
003'460 35 S100 num 5 handle num 5 move rpc [1 2 3 4 6]
003'460 35 S100 move handle not leader
003'463 35 S101 num 5 handle num 5 move rpc [1 2 3 4 6]
003'463 35 S101 move handle not leader
003'466 30 S202 apply index 16 key num 0 type 4   lastApplied 15
003'467 34 S202 apply new config num 5 :&{5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
003'467 34 S202 inited need send [],need recv []
003'467 31 S202 used size: 416 / 300 
003'467 29 S202 do snapshot for raft 16 16,size 412
003'468 27 S2 raft apply snapshot offset 16 ,lastApplied 16,total log 16, size 82,log cap:1
003'468 31 S202 after snap shot size82 412
003'469 30 S201 apply index 16 key num 0 type 4   lastApplied 15
003'469 34 S201 apply new config num 5 :&{5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{4 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
003'470 34 S201 inited need send [],need recv []
003'470 31 S201 used size: 416 / 300 
003'472 29 S201 do snapshot for raft 16 16,size 412
003'472 27 S1 raft apply snapshot offset 16 ,lastApplied 16,total log 16, size 82,log cap:1
003'472 31 S201 after snap shot size82 412
003'478 35 S101 num 5 handle num 5 move rpc [1 2 3 4 6]
003'478 35 S101 move handle not leader
003'479 35 S302 num 5 sending shards [1 2 3 4 6] to group 100
003'480 35 S102 num 5 handle num 5 move rpc [1 2 3 4 6]
003'480 35 S102 num 5 move [1 2 3 4 6] is done yet
003'481 35 S102 num 5 handle num 5 move rpc [1 2 3 4 6]
003'481 35 S102 num 5 move [1 2 3 4 6] is done yet
003'481 30 S300 after send shards ok
003'481 35 S300 move delete propose not leader
003'481 35 S100 num 5 handle num 5 move rpc [1 2 3 4 6]
003'481 35 S100 move handle not leader
003'482 30 S302 after send shards ok
003'482 35 S302 move delete propose not leader
003'484 35 S300 num 5 sending shards [1 2 3 4 6] to group 100
003'484 35 S100 num 5 waiting [1 2 3 4 6] shards 
003'487 35 S101 num 5 waiting [1 2 3 4 6] shards 
003'487 35 S202 current config num 5 done
003'487 35 S200 current config num 5 done
003'487 35 S301 current config num 5 done
003'487 34 S100 check new config wanted 6
003'490 35 S101 num 5 handle num 5 move rpc [1 2 3 4 6]
003'490 35 S101 move handle not leader
003'491 35 S100 num 5 handle num 5 move rpc [1 2 3 4 6]
003'492 35 S100 move handle not leader
003'505 35 S101 num 5 handle num 5 move rpc [1 2 3 4 6]
003'505 35 S101 move handle not leader
003'508 35 S102 num 5 handle num 5 move rpc [1 2 3 4 6]
003'508 35 S102 num 5 move [1 2 3 4 6] is done yet
003'487 34 S201 check new config wanted 6
003'508 35 S201 current config num 5 done
003'510 30 S302 after send shards ok
003'510 35 S302 move delete propose not leader
003'519 35 S302 num 5 sending shards [1 2 3 4 6] to group 100
003'520 35 S102 current config num 5 done
003'522 35 S102 num 5 handle num 5 move rpc [1 2 3 4 6]
003'522 35 S102 num 5 move [1 2 3 4 6] is done yet
003'523 35 S100 num 5 handle num 5 move rpc [1 2 3 4 6]
003'523 35 S100 move handle not leader
003'524 35 S300 num 5 sending shards [1 2 3 4 6] to group 100
003'526 35 S100 num 5 handle num 5 move rpc [1 2 3 4 6]
003'526 35 S100 move handle not leader
003'529 35 S101 num 5 handle num 5 move rpc [1 2 3 4 6]
003'529 35 S101 move handle not leader
003'535 35 S102 num 5 handle num 5 move rpc [1 2 3 4 6]
003'535 35 S102 num 5 move [1 2 3 4 6] is done yet
003'536 30 S302 after send shards ok
003'536 35 S302 move delete propose not leader
003'536 35 S100 num 5 waiting [1 2 3 4 6] shards 
003'536 35 S101 num 5 handle num 5 move rpc [1 2 3 4 6]
003'536 35 S101 move handle not leader
003'538 35 S200 current config num 5 done
003'538 35 S102 num 5 handle num 5 move rpc [1 2 3 4 6]
003'538 35 S102 num 5 move [1 2 3 4 6] is done yet
003'538 35 S101 num 5 waiting [1 2 3 4 6] shards 
003'538 35 S202 current config num 5 done
003'539 30 S300 after send shards ok
003'539 35 S300 move delete propose not leader
003'538 35 S301 current config num 5 done
003'543 30 S300 after send shards ok
003'543 35 S300 move delete propose not leader
003'546 30 S101 apply index 89 key num 0 type 5   lastApplied 88
003'546 35 S101 apply num 5 migration [1 2 3 4 6]
003'546 30 S101 safely recv and decided shard 1
003'546 30 S101 safely recv and decided shard 2
003'546 30 S101 safely recv and decided shard 3
003'546 30 S101 safely recv and decided shard 4
003'546 30 S101 safely recv and decided shard 6
003'546 31 S101 used size: 675 / 300 
003'547 29 S101 do snapshot for raft 89 89,size 719
003'547 27 S1 raft apply snapshot offset 89 ,lastApplied 89,total log 89, size 84,log cap:1
003'547 31 S101 after snap shot size84 719
003'549 35 S302 num 5 sending shards [1 2 3 4 6] to group 100
003'551 35 S100 num 5 handle num 5 move rpc [1 2 3 4 6]
003'551 35 S100 move handle not leader
003'553 35 S101 num 5 handle num 5 move rpc [1 2 3 4 6]
003'553 35 S101 num 5 move [1 2 3 4 6] is done yet
003'556 30 S100 apply index 89 key num 0 type 5   lastApplied 88
003'556 35 S100 apply num 5 migration [1 2 3 4 6]
003'556 30 S100 safely recv and decided shard 1
003'556 30 S100 safely recv and decided shard 2
003'556 30 S100 safely recv and decided shard 3
003'556 30 S100 safely recv and decided shard 4
003'556 30 S100 safely recv and decided shard 6
003'556 31 S100 used size: 675 / 300 
003'557 29 S100 do snapshot for raft 89 89,size 719
003'557 27 S0 raft apply snapshot offset 89 ,lastApplied 89,total log 89, size 84,log cap:1
003'557 31 S100 after snap shot size84 719
003'558 30 S302 after send shards ok
003'558 35 S302 move delete propose not leader
003'558 35 S300 num 5 sending shards [1 2 3 4 6] to group 100
003'562 35 S201 current config num 5 done
003'573 35 S102 current config num 5 done
003'576 30 S300 apply index 13 key num 0 type 5   lastApplied 12
003'576 35 S300 apply num 5 migration [1 2 3 4 6]
003'576 30 S300 safely delete shard 1
003'576 30 S300 safely delete shard 2
003'576 30 S300 safely delete shard 3
003'576 30 S300 safely delete shard 4
003'576 30 S300 safely delete shard 6
003'576 31 S300 used size: 673 / 300 
003'560 35 S100 num 5 handle num 5 move rpc [1 2 3 4 6]
003'576 35 S100 num 5 move [1 2 3 4 6] is done yet
003'576 30 S302 apply index 13 key num 0 type 5   lastApplied 12
003'576 35 S302 apply num 5 migration [1 2 3 4 6]
003'576 30 S302 safely delete shard 1
003'576 30 S302 safely delete shard 2
003'577 30 S302 safely delete shard 3
003'577 30 S302 safely delete shard 4
003'577 30 S302 safely delete shard 6
003'577 31 S302 used size: 673 / 300 
003'585 29 S300 do snapshot for raft 13 13,size 412
003'586 27 S0 raft apply snapshot offset 13 ,lastApplied 13,total log 13, size 82,log cap:1
003'586 31 S300 after snap shot size82 412
003'586 35 S100 current config num 5 done
003'588 29 S302 do snapshot for raft 13 13,size 412
003'588 27 S2 raft apply snapshot offset 13 ,lastApplied 13,total log 13, size 82,log cap:1
003'588 31 S302 after snap shot size82 412
003'588 35 S200 current config num 5 done
003'588 35 S302 current config num 5 done
003'588 35 S101 current config num 5 done
003'590 30 S300 after send shards ok
003'590 35 S300 num 5 move [1 2 3 4 6] is done yet
003'592 35 S301 current config num 5 done
003'592 35 S202 current config num 5 done
003'592 35 S300 current config num 5 done
join &{map[102:[server-102-0 server-102-1 server-102-2]] 1074585914363486070 5}
003'617 35 S201 current config num 5 done
join &{map[102:[server-102-0 server-102-1 server-102-2]] 1074585914363486070 5}
003'624 35 S102 current config num 5 done
003'637 35 S100 current config num 5 done
join &{map[102:[server-102-0 server-102-1 server-102-2]] 1074585914363486070 5}
003'649 35 S300 current config num 5 done
003'649 35 S301 current config num 5 done
003'649 35 S202 current config num 5 done
003'652 34 S202 got new config {5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 4
003'652 35 S302 current config num 5 done
003'653 35 S200 current config num 5 done
003'653 35 S101 current config num 5 done
003'667 35 S201 current config num 5 done
003'674 35 S102 current config num 5 done
003'687 44 S2 ctrler change to config &{6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
003'688 35 S100 current config num 5 done
003'690 28 S100 do request args:Key 9 type 3 num 5 Client 3620950086299709532 Seq 7 
003'690 28 S100 [532--7] successed
003'690 28 S100 [532--7] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
003'691 36 S532 [7] clerk putAppend okkkkk
003'692 28 S100 do request args:Key 7 type 3 num 5 Client 2972145661651991667 Seq 2 
003'692 28 S100 [667--2] successed
003'693 28 S100 [667--2] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
003'693 36 S667 [2] clerk putAppend okkkkk
003'694 28 S100 do request args:Key 7 type 3 num 5 Client 2972145661651991667 Seq 3 
003'694 28 S100 declined [667--3] for not leader
003'694 28 S100 [667--3] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'696 28 S101 do request args:Key 7 type 3 num 5 Client 2972145661651991667 Seq 3 
003'696 28 S101 declined [667--3] for not leader
003'696 28 S101 [667--3] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'697 28 S102 do request args:Key 7 type 3 num 5 Client 2972145661651991667 Seq 3 
003'698 33 S102 start [667--3] as leader?
join &{map[101:[server-101-0 server-101-1 server-101-2]] 1074585914363486070 6}
003'699 28 S100 do request args:Key 3 type 3 num 5 Client 2238025532150463055 Seq 5 
003'699 28 S100 declined [ 55--5] for not leader
003'699 28 S100 [ 55--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
join &{map[101:[server-101-0 server-101-1 server-101-2]] 1074585914363486070 6}
003'700 28 S101 do request args:Key 3 type 3 num 5 Client 2238025532150463055 Seq 5 
003'700 28 S101 declined [ 55--5] for not leader
003'700 28 S101 [ 55--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'702 35 S301 current config num 5 done
003'706 28 S100 do request args:Key 4 type 3 num 5 Client 132246879705026825 Seq 4 
003'706 28 S100 declined [825--4] for not leader
003'706 28 S100 [825--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'707 35 S300 current config num 5 done
003'707 35 S202 current config num 5 done
003'707 35 S200 current config num 5 done
join &{map[101:[server-101-0 server-101-1 server-101-2]] 1074585914363486070 6}
003'707 35 S302 current config num 5 done
003'707 35 S101 current config num 5 done
003'719 28 S101 do request args:Key 4 type 3 num 5 Client 132246879705026825 Seq 4 
003'719 28 S101 declined [825--4] for not leader
003'719 28 S101 [825--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'711 28 S102 do request args:Key 3 type 3 num 5 Client 2238025532150463055 Seq 5 
003'720 33 S102 start [ 55--5] as leader?
003'711 28 S100 do request args:Key 1 type 3 num 5 Client 418781717203629479 Seq 15 
003'720 28 S100 declined [479--15] for not leader
003'720 28 S100 [479--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'718 35 S201 current config num 5 done
003'721 28 S100 do request args:Key 9 type 3 num 5 Client 3620950086299709532 Seq 8 
003'721 28 S100 declined [532--8] for not leader
003'721 28 S100 [532--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'721 30 S102 apply index 90 key7 num 5 type 3   lastApplied 89
003'722 28 S102 [667--3] successed
003'722 28 S102 [667--3] ok 
003'722 28 S102 [667--3] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
003'723 36 S667 [3] clerk putAppend okkkkk
003'737 30 S100 apply index 90 key7 num 5 type 3   lastApplied 89
003'723 28 S102 do request args:Key 4 type 3 num 5 Client 132246879705026825 Seq 4 
003'738 28 S100 do request args:Key 7 type 3 num 5 Client 2972145661651991667 Seq 4 
003'738 28 S100 declined [667--4] for not leader
003'738 28 S100 [667--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'738 33 S102 start [825--4] as leader?
003'738 35 S102 current config num 5 done
003'738 30 S102 apply index 91 key3 num 5 type 3   lastApplied 90
003'739 31 S102 used size: 350 / 300 
003'724 28 S101 do request args:Key 1 type 3 num 5 Client 418781717203629479 Seq 15 
003'739 28 S101 declined [479--15] for not leader
003'739 35 S100 current config num 5 done
003'739 28 S101 [479--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'739 28 S101 do request args:Key 9 type 3 num 5 Client 3620950086299709532 Seq 8 
003'739 28 S101 declined [532--8] for not leader
003'735 44 S1 ctrler change to config &{6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
003'735 44 S2 ctrler change to config &{7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
003'739 29 S102 do snapshot for raft 91 91,size 721
003'742 27 S2 raft apply snapshot offset 91 ,lastApplied 91,total log 92, size 225,log cap:2
003'742 31 S102 after snap shot size225 721
003'739 28 S101 [532--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'743 28 S102 [ 55--5] successed
003'743 28 S102 [ 55--5] ok 
003'743 28 S102 [ 55--5] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
003'743 28 S102 do request args:Key 1 type 3 num 5 Client 418781717203629479 Seq 15 
003'743 33 S102 start [479--15] as leader?
003'740 30 S101 apply index 90 key7 num 5 type 3   lastApplied 89
003'744 28 S101 do request args:Key 7 type 3 num 5 Client 2972145661651991667 Seq 4 
003'744 28 S101 declined [667--4] for not leader
003'744 36 S55 [5] clerk putAppend okkkkk
003'744 28 S101 [667--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'744 28 S102 do request args:Key 9 type 3 num 5 Client 3620950086299709532 Seq 8 
003'745 33 S102 start [532--8] as leader?
003'740 44 S0 ctrler change to config &{6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
003'748 30 S101 apply index 91 key3 num 5 type 3   lastApplied 90
003'748 31 S101 used size: 475 / 300 
003'748 29 S101 do snapshot for raft 91 91,size 721
003'748 28 S100 do request args:Key 3 type 3 num 5 Client 2238025532150463055 Seq 6 
003'749 28 S100 declined [ 55--6] for not leader
003'749 28 S100 [ 55--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'749 27 S1 raft apply snapshot offset 91 ,lastApplied 91,total log 94, size 350,log cap:4
003'749 31 S101 after snap shot size350 721
003'750 28 S101 do request args:Key 3 type 3 num 5 Client 2238025532150463055 Seq 6 
003'750 28 S101 declined [ 55--6] for not leader
003'750 28 S101 [ 55--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'752 28 S300 do request args:Key 6 type 3 num 6 Client 542732653461723544 Seq 4 
003'752 28 S300 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
003'753 30 S100 apply index 91 key3 num 5 type 3   lastApplied 90
003'753 31 S100 used size: 475 / 300 
003'750 30 S102 apply index 92 key4 num 5 type 3   lastApplied 91
003'755 29 S100 do snapshot for raft 91 91,size 721
003'755 31 S102 used size: 350 / 300 
003'755 27 S0 raft apply snapshot offset 91 ,lastApplied 94,total log 94, size 350,log cap:4
003'755 27 S0 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"9", ClientID:3620950086299709532, Seq:8, OptType:3, Opt:"-", Num:5}}
003'755 31 S100 after snap shot size350 721
003'755 30 S100 apply index 92 key4 num 5 type 3   lastApplied 91
003'756 31 S100 used size: 350 / 300 
003'756 29 S102 do snapshot for raft 92 92,size 722
003'756 34 S202 check new config wanted 6
003'756 35 S301 current config num 5 done
003'757 29 S100 do snapshot for raft 92 92,size 722
003'757 27 S0 raft apply snapshot offset 92 ,lastApplied 94,total log 94, size 287,log cap:3
003'757 27 S0 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"9", ClientID:3620950086299709532, Seq:8, OptType:3, Opt:"-", Num:5}}
003'757 31 S100 after snap shot size287 722
003'757 30 S100 apply index 93 key1 num 5 type 3   lastApplied 92
003'757 30 S100 apply index 94 key9 num 5 type 3   lastApplied 93
003'758 27 S2 raft apply snapshot offset 92 ,lastApplied 94,total log 94, size 287,log cap:3
003'758 27 S2 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"9", ClientID:3620950086299709532, Seq:8, OptType:3, Opt:"-", Num:5}}
003'758 31 S102 after snap shot size287 722
003'758 30 S102 apply index 93 key1 num 5 type 3   lastApplied 92
003'758 30 S102 apply index 94 key9 num 5 type 3   lastApplied 93
003'758 28 S102 [479--15] successed
003'758 28 S102 [479--15] ok 
003'758 28 S102 [479--15] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
003'758 30 S101 apply index 92 key4 num 5 type 3   lastApplied 91
003'758 28 S102 [825--4] successed
003'764 28 S102 [825--4] ok 
003'764 28 S102 [825--4] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
003'758 31 S101 used size: 350 / 300 
003'765 29 S101 do snapshot for raft 92 92,size 722
003'765 28 S102 [532--8] successed
003'765 28 S102 [532--8] ok 
003'765 28 S102 [532--8] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
003'765 27 S1 raft apply snapshot offset 92 ,lastApplied 94,total log 94, size 287,log cap:3
003'765 27 S1 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"9", ClientID:3620950086299709532, Seq:8, OptType:3, Opt:"-", Num:5}}
003'765 31 S101 after snap shot size287 722
003'765 30 S101 apply index 93 key1 num 5 type 3   lastApplied 92
003'766 36 S532 [8] clerk putAppend okkkkk
003'766 36 S825 [4] clerk putAppend okkkkk
003'766 28 S102 do request args:Key 3 type 3 num 5 Client 2238025532150463055 Seq 6 
003'767 33 S102 start [ 55--6] as leader?
003'768 28 S102 do request args:Key 7 type 3 num 5 Client 2972145661651991667 Seq 4 
003'768 33 S102 start [667--4] as leader?
003'758 35 S202 current config num 5 done
003'759 35 S300 current config num 5 done
003'761 36 S479 [15] clerk putAppend okkkkk
003'761 28 S100 do request args:Key 8 type 3 num 6 Client 2953714763196401582 Seq 2 
003'769 28 S100 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
003'771 35 S200 current config num 5 done
003'771 35 S302 current config num 5 done
003'761 44 S0 ctrler change to config &{7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
003'762 44 S1 ctrler change to config &{7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
003'766 30 S101 apply index 94 key9 num 5 type 3   lastApplied 93
003'774 35 S101 current config num 5 done
003'774 28 S100 do request args:Key 9 type 3 num 5 Client 3620950086299709532 Seq 9 
003'774 28 S100 declined [532--9] for not leader
003'774 28 S100 [532--9] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'774 28 S100 do request args:Key 4 type 3 num 5 Client 132246879705026825 Seq 5 
003'774 28 S100 declined [825--5] for not leader
003'774 28 S100 [825--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'775 35 S201 current config num 5 done
003'778 34 S201 check new config wanted 6
003'779 28 S100 do request args:Key 1 type 3 num 5 Client 418781717203629479 Seq 16 
003'780 28 S100 declined [479--16] for not leader
003'780 28 S100 [479--16] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'781 30 S102 apply index 95 key3 num 5 type 3   lastApplied 94
003'781 31 S102 used size: 412 / 300 
003'784 34 S200 got new config {6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 5
003'785 29 S102 do snapshot for raft 95 95,size 725
003'786 27 S2 raft apply snapshot offset 95 ,lastApplied 96,total log 96, size 225,log cap:2
003'786 34 S200 propose new config 6
003'786 27 S2 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:4, OptType:3, Opt:"a", Num:5}}
003'786 31 S102 after snap shot size225 725
003'786 30 S102 apply index 96 key7 num 5 type 3   lastApplied 95
003'792 35 S100 current config num 5 done
003'792 34 S101 check new config wanted 6
003'794 34 S301 got new config {6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 5
003'795 34 S301 propose new config 6
003'796 34 S300 check new config wanted 6
003'797 28 S100 do request args:Key 0 type 3 num 7 Client 940626237948413081 Seq 10 
003'811 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
003'797 28 S101 do request args:Key 9 type 3 num 5 Client 3620950086299709532 Seq 9 
003'811 28 S101 declined [532--9] for not leader
003'811 28 S101 [532--9] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'812 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 6 
003'813 28 S200 [729--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
003'812 34 S100 check new config wanted 6
003'813 30 S200 apply index 17 key num 0 type 4   lastApplied 16
003'813 34 S200 apply new config num 6 :&{6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
003'814 34 S200 inited need send [],need recv []
003'814 31 S200 used size: 459 / 300 
003'814 29 S200 do snapshot for raft 17 17,size 454
003'814 27 S0 raft apply snapshot offset 17 ,lastApplied 17,total log 17, size 82,log cap:1
003'814 31 S200 after snap shot size82 454
003'800 34 S302 check new config wanted 6
003'802 28 S300 do request args:Key 5 type 3 num 7 Client 3482757038087095369 Seq 5 
003'819 28 S300 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
003'819 35 S300 current config num 5 done
003'820 35 S202 current config num 5 done
003'806 35 S301 current config num 5 done
003'812 28 S101 do request args:Key 4 type 3 num 5 Client 132246879705026825 Seq 5 
003'820 28 S101 declined [825--5] for not leader
003'820 28 S101 [825--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'820 30 S301 apply index 14 key num 0 type 4   lastApplied 13
003'820 34 S301 apply new config num 6 :&{6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
003'821 34 S301 inited need send [],need recv [0 1 2 3 4]
003'821 31 S301 used size: 459 / 300 
003'786 28 S102 [ 55--6] successed
003'821 28 S102 [ 55--6] ok 
003'821 28 S102 [ 55--6] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
003'821 28 S101 do request args:Key 1 type 3 num 5 Client 418781717203629479 Seq 16 
003'821 28 S101 declined [479--16] for not leader
003'821 29 S301 do snapshot for raft 14 14,size 454
003'821 28 S101 [479--16] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'821 28 S102 [667--4] successed
003'822 27 S1 raft apply snapshot offset 14 ,lastApplied 14,total log 14, size 82,log cap:1
003'822 31 S301 after snap shot size82 454
003'822 35 S302 current config num 5 done
003'822 28 S102 [667--4] ok 
003'822 28 S102 [667--4] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
003'822 35 S102 current config num 5 done
003'822 35 S200 current config num 6 done
003'822 34 S102 check new config wanted 6
003'823 28 S102 do request args:Key 9 type 3 num 5 Client 3620950086299709532 Seq 9 
003'823 33 S102 start [532--9] as leader?
003'824 36 S667 [4] clerk putAppend okkkkk
003'824 36 S55 [6] clerk putAppend okkkkk
003'825 35 S101 current config num 5 done
003'825 35 S201 current config num 5 done
003'828 28 S102 do request args:Key 4 type 3 num 5 Client 132246879705026825 Seq 5 
003'829 33 S102 start [825--5] as leader?
003'829 28 S100 do request args:Key 7 type 3 num 5 Client 2972145661651991667 Seq 5 
003'830 28 S100 declined [667--5] for not leader
003'830 28 S100 [667--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'830 28 S100 do request args:Key 3 type 3 num 5 Client 2238025532150463055 Seq 7 
003'830 28 S100 declined [ 55--7] for not leader
003'830 28 S100 [ 55--7] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'837 28 S101 do request args:Key 7 type 3 num 5 Client 2972145661651991667 Seq 5 
003'837 28 S101 declined [667--5] for not leader
003'837 28 S101 [667--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'838 28 S101 do request args:Key 3 type 3 num 5 Client 2238025532150463055 Seq 7 
003'838 28 S101 declined [ 55--7] for not leader
003'838 28 S101 [ 55--7] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'844 30 S101 apply index 95 key3 num 5 type 3   lastApplied 94
003'844 31 S101 used size: 475 / 300 
003'845 29 S101 do snapshot for raft 95 95,size 725
003'845 27 S1 raft apply snapshot offset 95 ,lastApplied 96,total log 97, size 287,log cap:3
003'845 27 S1 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:4, OptType:3, Opt:"a", Num:5}}
003'845 31 S101 after snap shot size287 725
003'845 30 S101 apply index 96 key7 num 5 type 3   lastApplied 95
003'846 30 S100 apply index 95 key3 num 5 type 3   lastApplied 94
003'846 31 S100 used size: 537 / 300 
003'847 29 S100 do snapshot for raft 95 95,size 725
003'848 27 S0 raft apply snapshot offset 95 ,lastApplied 96,total log 98, size 350,log cap:4
003'848 27 S0 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:4, OptType:3, Opt:"a", Num:5}}
003'848 31 S100 after snap shot size350 725
003'848 30 S100 apply index 96 key7 num 5 type 3   lastApplied 95
003'848 31 S100 used size: 350 / 300 
003'848 29 S100 do snapshot for raft 96 96,size 726
003'849 27 S0 raft apply snapshot offset 96 ,lastApplied 96,total log 98, size 287,log cap:3
003'849 31 S100 after snap shot size287 726
003'850 28 S102 do request args:Key 1 type 3 num 5 Client 418781717203629479 Seq 16 
003'850 33 S102 start [479--16] as leader?
003'850 35 S100 current config num 5 done
003'852 30 S102 apply index 97 key9 num 5 type 3   lastApplied 96
003'852 31 S102 used size: 412 / 300 
003'853 29 S102 do snapshot for raft 97 97,size 727
003'853 27 S2 raft apply snapshot offset 97 ,lastApplied 98,total log 99, size 287,log cap:3
003'853 27 S2 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"4", ClientID:132246879705026825, Seq:5, OptType:3, Opt:"-", Num:5}}
003'853 31 S102 after snap shot size287 727
003'853 30 S102 apply index 98 key4 num 5 type 3   lastApplied 97
003'853 28 S102 [825--5] successed
003'853 28 S102 [825--5] ok 
003'853 28 S102 [825--5] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
003'853 28 S102 [532--9] successed
003'854 28 S102 [532--9] ok 
003'854 28 S102 [532--9] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
003'854 36 S532 [9] clerk putAppend okkkkk
003'854 28 S102 do request args:Key 7 type 3 num 5 Client 2972145661651991667 Seq 5 
003'855 33 S102 start [667--5] as leader?
003'855 36 S825 [5] clerk putAppend okkkkk
003'857 28 S102 do request args:Key 3 type 3 num 5 Client 2238025532150463055 Seq 7 
003'857 28 S100 do request args:Key 9 type 3 num 5 Client 3620950086299709532 Seq 10 
003'857 28 S100 declined [532--10] for not leader
003'857 28 S100 [532--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'857 33 S102 start [ 55--7] as leader?
003'858 28 S100 do request args:Key 4 type 3 num 5 Client 132246879705026825 Seq 6 
003'858 28 S100 declined [825--6] for not leader
003'858 28 S100 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'861 28 S101 do request args:Key 4 type 3 num 5 Client 132246879705026825 Seq 6 
003'861 28 S101 declined [825--6] for not leader
003'861 28 S101 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'865 30 S101 apply index 97 key9 num 5 type 3   lastApplied 96
003'866 31 S101 used size: 537 / 300 
003'866 29 S101 do snapshot for raft 97 97,size 727
003'867 27 S1 raft apply snapshot offset 97 ,lastApplied 98,total log 101, size 412,log cap:5
003'867 27 S1 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"4", ClientID:132246879705026825, Seq:5, OptType:3, Opt:"-", Num:5}}
003'867 31 S101 after snap shot size412 727
003'867 30 S101 apply index 98 key4 num 5 type 3   lastApplied 97
003'867 31 S101 used size: 412 / 300 
003'867 29 S101 do snapshot for raft 98 98,size 728
003'868 27 S1 raft apply snapshot offset 98 ,lastApplied 98,total log 101, size 350,log cap:4
003'868 31 S101 after snap shot size350 728
003'868 30 S102 apply index 99 key1 num 5 type 3   lastApplied 98
003'868 31 S102 used size: 412 / 300 
003'869 29 S102 do snapshot for raft 99 99,size 729
003'869 27 S2 raft apply snapshot offset 99 ,lastApplied 101,total log 101, size 287,log cap:3
003'869 27 S2 last applied not snapshoted raft.LogEntry{Term:2, Command:shardkv.Command{Key:"3", ClientID:2238025532150463055, Seq:7, OptType:3, Opt:"v", Num:5}}
003'869 31 S102 after snap shot size287 729
003'869 30 S102 apply index 100 key7 num 5 type 3   lastApplied 99
003'869 30 S102 apply index 101 key3 num 5 type 3   lastApplied 100
003'869 28 S102 [479--16] successed
003'870 28 S102 [479--16] ok 
003'870 28 S102 [479--16] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
003'870 28 S102 [667--5] successed
003'870 28 S102 [667--5] ok 
003'870 28 S102 [667--5] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
003'870 35 S202 current config num 5 done
003'870 28 S102 [ 55--7] successed
003'870 28 S102 [ 55--7] ok 
003'870 28 S102 [ 55--7] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
003'871 35 S300 current config num 5 done
003'874 36 S667 [5] clerk putAppend okkkkk
003'875 36 S55 [7] clerk putAppend okkkkk
003'876 36 S479 [16] clerk putAppend okkkkk
003'878 32 S100 server killed######
003'878 32 S101 server killed######
003'878 32 S102 server killed######
003'878 32 S200 server killed######
003'878 32 S201 server killed######
003'878 32 S202 server killed######
003'878 32 S300 server killed######
003'878 32 S301 server killed######
003'878 32 S302 server killed######
003'880 30 S100 install snap index 96,config {5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 pending shards [false false false false false false false false false false]
003'886 30 S101 install snap index 98,config {5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 pending shards [false false false false false false false false false false]
003'889 30 S102 install snap index 99,config {5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 pending shards [false false false false false false false false false false]
003'894 34 S102 check new config wanted 6
003'894 35 S102 current config num 5 done
003'903 28 S102 do request args:Key 4 type 3 num 5 Client 132246879705026825 Seq 6 
003'903 28 S102 declined [825--6] for not leader
003'903 28 S102 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'893 35 S101 current config num 5 done
003'910 34 S101 check new config wanted 6
003'910 28 S101 do request args:Key 9 type 3 num 5 Client 3620950086299709532 Seq 10 
003'910 28 S101 declined [532--10] for not leader
003'910 28 S101 [532--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'893 35 S100 current config num 5 done
003'912 28 S102 do request args:Key 9 type 3 num 5 Client 3620950086299709532 Seq 10 
003'912 28 S102 declined [532--10] for not leader
003'912 28 S102 [532--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'912 34 S100 check new config wanted 6
003'914 28 S100 do request args:Key 3 type 3 num 5 Client 2238025532150463055 Seq 8 
003'914 28 S100 declined [ 55--8] for not leader
003'914 28 S100 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'914 28 S100 do request args:Key 7 type 3 num 5 Client 2972145661651991667 Seq 6 
003'914 28 S100 declined [667--6] for not leader
003'914 28 S100 [667--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'914 28 S100 do request args:Key 1 type 3 num 5 Client 418781717203629479 Seq 17 
003'914 28 S100 declined [479--17] for not leader
003'914 28 S100 [479--17] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'918 28 S101 do request args:Key 3 type 3 num 5 Client 2238025532150463055 Seq 8 
003'918 28 S101 declined [ 55--8] for not leader
003'918 28 S101 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'921 28 S101 do request args:Key 1 type 3 num 5 Client 418781717203629479 Seq 17 
003'921 28 S101 declined [479--17] for not leader
003'921 28 S101 [479--17] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'922 28 S101 do request args:Key 7 type 3 num 5 Client 2972145661651991667 Seq 6 
003'922 28 S101 declined [667--6] for not leader
003'922 28 S101 [667--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'924 30 S200 install snap index 17,config {6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
003'925 28 S102 do request args:Key 3 type 3 num 5 Client 2238025532150463055 Seq 8 
003'925 28 S102 declined [ 55--8] for not leader
003'925 28 S102 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'927 28 S102 do request args:Key 1 type 3 num 5 Client 418781717203629479 Seq 17 
003'927 28 S102 declined [479--17] for not leader
003'927 28 S102 [479--17] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'927 28 S102 do request args:Key 7 type 3 num 5 Client 2972145661651991667 Seq 6 
003'928 28 S102 declined [667--6] for not leader
003'928 28 S102 [667--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
003'939 34 S200 check new config wanted 7
003'939 35 S200 current config num 6 done
003'940 30 S201 install snap index 16,config {5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 pending shards [false false false false false false false false false false]
003'943 34 S201 check new config wanted 6
003'944 35 S102 current config num 5 done
003'945 35 S201 current config num 5 done
003'943 30 S202 install snap index 16,config {5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 pending shards [false false false false false false false false false false]
003'951 30 S300 install snap index 13,config {5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 pending shards [false false false false false false false false false false]
003'951 34 S202 check new config wanted 6
003'953 35 S202 current config num 5 done
003'953 34 S300 check new config wanted 6
003'953 35 S300 current config num 5 done
003'959 30 S301 install snap index 14,config {6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [true true true true true false false false false false]
003'961 30 S302 install snap index 13,config {5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 pending shards [false false false false false false false false false false]
003'962 34 S302 check new config wanted 6
003'963 34 S301 check new config wanted 7
003'963 35 S301 num 6 waiting [0 1 2 3 4] shards 
003'963 35 S302 current config num 5 done
003'975 35 S101 current config num 5 done
003'975 35 S100 current config num 5 done
003'999 35 S200 current config num 6 done
003'999 35 S102 current config num 5 done
003'999 35 S201 current config num 5 done
004'006 35 S300 current config num 5 done
004'006 35 S202 current config num 5 done
004'014 35 S301 num 6 waiting [0 1 2 3 4] shards 
004'014 35 S302 current config num 5 done
004'025 35 S101 current config num 5 done
004'025 35 S100 current config num 5 done
004'050 35 S201 current config num 5 done
004'050 35 S200 current config num 6 done
004'050 35 S102 current config num 5 done
004'064 35 S300 current config num 5 done
004'064 35 S202 current config num 5 done
004'064 35 S302 current config num 5 done
004'064 35 S301 num 6 waiting [0 1 2 3 4] shards 
004'074 34 S102 got new config {6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 5
004'075 35 S101 current config num 5 done
004'086 35 S100 current config num 5 done
004'111 30 S302 apply index 14 key num 0 type 4   lastApplied 13
004'111 34 S302 apply new config num 6 :&{6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
004'112 34 S302 inited need send [],need recv [0 1 2 3 4]
004'112 31 S302 used size: 462 / 300 
004'112 29 S302 do snapshot for raft 14 14,size 454
004'113 27 S2 raft apply snapshot offset 14 ,lastApplied 15,total log 15, size 85,log cap:2
004'113 27 S2 last applied not snapshoted raft.LogEntry{Term:3, Command:interface {}(nil)}
004'113 31 S302 after snap shot size85 454
004'113 30 S302 nop apply <nil>
004'115 35 S102 current config num 5 done
004'115 35 S201 current config num 5 done
004'115 35 S200 current config num 6 done
004'115 35 S300 current config num 5 done
004'117 35 S301 num 6 waiting [0 1 2 3 4] shards 
004'119 35 S302 num 6 waiting [0 1 2 3 4] shards 
004'120 35 S202 current config num 5 done
004'120 30 S202 apply index 17 key num 0 type 4   lastApplied 16
004'120 34 S202 apply new config num 6 :&{6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
004'120 34 S202 inited need send [],need recv []
004'120 31 S202 used size: 462 / 300 
004'121 29 S202 do snapshot for raft 17 17,size 454
004'121 27 S2 raft apply snapshot offset 17 ,lastApplied 18,total log 18, size 85,log cap:2
004'121 27 S2 last applied not snapshoted raft.LogEntry{Term:3, Command:interface {}(nil)}
004'121 31 S202 after snap shot size85 454
004'121 30 S202 nop apply <nil>
004'131 35 S101 current config num 5 done
004'139 35 S100 current config num 5 done
004'153 30 S101 apply index 99 key1 num 5 type 3   lastApplied 98
004'153 31 S101 used size: 353 / 300 
004'154 29 S101 do snapshot for raft 99 99,size 729
004'154 27 S1 raft apply snapshot offset 99 ,lastApplied 99,total log 102, size 290,log cap:4
004'155 31 S101 after snap shot size290 729
004'155 30 S102 apply index 100 key7 num 5 type 3   lastApplied 99
004'155 30 S102 apply index 101 key3 num 5 type 3   lastApplied 100
004'155 30 S102 nop apply <nil>
004'171 35 S300 current config num 5 done
004'171 35 S102 current config num 5 done
004'171 35 S200 current config num 6 done
004'171 35 S201 current config num 5 done
004'171 35 S301 num 6 waiting [0 1 2 3 4] shards 
004'171 35 S302 num 6 waiting [0 1 2 3 4] shards 
004'171 35 S202 current config num 6 done
004'176 34 S102 check new config wanted 6
004'186 35 S101 current config num 5 done
004'195 35 S100 current config num 5 done
004'221 35 S300 current config num 5 done
004'221 35 S200 current config num 6 done
004'221 35 S201 current config num 5 done
004'221 35 S102 current config num 5 done
004'222 35 S202 current config num 6 done
004'232 35 S302 num 6 waiting [0 1 2 3 4] shards 
004'233 35 S301 num 6 waiting [0 1 2 3 4] shards 
004'236 35 S101 current config num 5 done
004'247 35 S100 current config num 5 done
004'272 35 S200 current config num 6 done
004'272 35 S300 current config num 5 done
004'272 35 S201 current config num 5 done
004'272 35 S102 current config num 5 done
004'272 35 S202 current config num 6 done
004'284 35 S301 num 6 waiting [0 1 2 3 4] shards 
004'285 35 S302 num 6 waiting [0 1 2 3 4] shards 
004'288 35 S101 current config num 5 done
004'296 28 S200 do request args:Key 8 type 3 num 7 Client 2953714763196401582 Seq 2 
004'296 28 S200 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
004'307 28 S300 do request args:Key 6 type 3 num 7 Client 542732653461723544 Seq 4 
004'307 28 S300 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
004'308 35 S100 current config num 5 done
004'323 34 S200 got new config {7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 6
004'322 35 S200 current config num 6 done
004'322 35 S300 current config num 5 done
004'322 35 S201 current config num 5 done
004'322 35 S102 current config num 5 done
004'329 34 S302 got new config {6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 5
004'323 35 S202 current config num 6 done
004'337 34 S101 got new config {6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 5
004'338 35 S302 num 6 waiting [0 1 2 3 4] shards 
004'338 35 S301 num 6 waiting [0 1 2 3 4] shards 
004'339 34 S100 got new config {6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 5
004'339 28 S100 do request args:Key 9 type 3 num 7 Client 3620950086299709532 Seq 10 
004'339 28 S100 [532--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
004'339 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 6 
004'339 28 S200 [729--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
004'340 28 S300 do request args:Key 4 type 3 num 7 Client 132246879705026825 Seq 6 
004'340 28 S300 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
004'341 35 S101 current config num 5 done
004'342 28 S300 do request args:Key 5 type 3 num 7 Client 3482757038087095369 Seq 5 
004'343 28 S300 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
004'342 34 S300 got new config {6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 5
004'345 28 S100 do request args:Key 0 type 3 num 7 Client 940626237948413081 Seq 10 
004'345 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
004'346 34 S201 got new config {6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 5
004'347 34 S202 got new config {6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 5
004'348 34 S301 got new config {7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 6
004'349 28 S200 do request args:Key 7 type 3 num 7 Client 2972145661651991667 Seq 6 
004'349 28 S200 [667--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
004'351 28 S300 do request args:Key 3 type 3 num 7 Client 2238025532150463055 Seq 8 
004'351 28 S300 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
004'353 28 S100 do request args:Key 1 type 3 num 7 Client 418781717203629479 Seq 17 
004'353 28 S100 [479--17] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
004'358 35 S100 current config num 5 done
004'362 34 S102 got new config {6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 5
004'363 34 S102 propose new config 6
004'368 29 S100 recv Installsnapshot 99 96
004'368 27 S0 raft apply snapshot offset 99 ,lastApplied 99,total log 99, size 84,log cap:1
004'368 29 S100 decide Installsnapshot 99 <- 96
004'369 30 S102 apply index 103 key num 0 type 4   lastApplied 102
004'369 34 S102 apply new config num 6 :&{6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
004'370 34 S102 inited need send [0 1 2 3 4],need recv []
004'370 31 S102 used size: 588 / 300 
004'369 30 S100 install snap index 99,config {5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 pending shards [false false false false false false false false false false]
004'370 30 S101 apply index 100 key7 num 5 type 3   lastApplied 99
004'370 31 S101 used size: 588 / 300 
004'371 29 S102 do snapshot for raft 103 103,size 773
004'371 27 S2 raft apply snapshot offset 103 ,lastApplied 103,total log 103, size 84,log cap:1
004'371 31 S102 after snap shot size84 773
004'371 29 S101 do snapshot for raft 100 100,size 730
004'372 27 S1 raft apply snapshot offset 100 ,lastApplied 102,total log 103, size 526,log cap:4
004'372 27 S1 last applied not snapshoted raft.LogEntry{Term:4, Command:interface {}(nil)}
004'372 31 S101 after snap shot size526 730
004'372 30 S101 apply index 101 key3 num 5 type 3   lastApplied 100
004'372 31 S101 used size: 526 / 300 
004'372 29 S101 do snapshot for raft 101 101,size 731
004'373 27 S1 raft apply snapshot offset 101 ,lastApplied 102,total log 103, size 464,log cap:3
004'373 27 S1 last applied not snapshoted raft.LogEntry{Term:4, Command:interface {}(nil)}
004'373 31 S101 after snap shot size464 731
004'373 30 S101 nop apply <nil>
004'373 31 S101 used size: 464 / 300 
004'373 29 S101 do snapshot for raft 102 102,size 731
004'374 27 S1 raft apply snapshot offset 102 ,lastApplied 102,total log 103, size 461,log cap:2
004'374 31 S101 after snap shot size461 731
004'377 35 S200 current config num 6 done
004'377 35 S300 current config num 5 done
004'377 35 S201 current config num 5 done
004'379 35 S102 num 6 sending shards [0 1 2 3 4] to group 102
004'380 35 S300 num 5 handle num 6 move rpc [0 1 2 3 4]
004'380 35 S202 current config num 6 done
004'381 35 S301 num 6 handle num 6 move rpc [0 1 2 3 4]
004'381 35 S301 move handle not leader
004'383 35 S302 num 6 handle num 6 move rpc [0 1 2 3 4]
004'384 35 S302 move handle num 6 shards [0 1 2 3 4] as leader?
004'389 35 S301 num 6 waiting [0 1 2 3 4] shards 
004'389 35 S302 num 6 waiting [0 1 2 3 4] shards 
004'391 35 S101 current config num 5 done
004'391 30 S300 apply index 14 key num 0 type 4   lastApplied 13
004'392 30 S302 apply index 16 key num 0 type 5   lastApplied 15
004'392 35 S302 apply num 6 migration [0 1 2 3 4]
004'392 30 S302 safely recv and decided shard 0
004'392 30 S302 safely recv and decided shard 1
004'392 30 S302 safely recv and decided shard 2
004'392 30 S302 safely recv and decided shard 3
004'391 34 S300 apply new config num 6 :&{6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
004'392 34 S300 inited need send [],need recv [0 1 2 3 4]
004'392 31 S300 used size: 980 / 300 
004'392 30 S302 safely recv and decided shard 4
004'392 31 S302 used size: 684 / 300 
004'393 29 S300 do snapshot for raft 14 14,size 454
004'393 29 S302 do snapshot for raft 16 16,size 605
004'393 27 S2 raft apply snapshot offset 16 ,lastApplied 16,total log 16, size 82,log cap:1
004'393 31 S302 after snap shot size82 605
004'393 27 S0 raft apply snapshot offset 14 ,lastApplied 15,total log 16, size 684,log cap:3
004'393 35 S302 num 6 move [0 1 2 3 4] is done yet
004'394 30 S102 after send shards ok
004'393 27 S0 last applied not snapshoted raft.LogEntry{Term:3, Command:interface {}(nil)}
004'394 31 S300 after snap shot size684 454
004'394 30 S300 nop apply <nil>
004'394 31 S300 used size: 684 / 300 
004'395 29 S300 do snapshot for raft 15 15,size 454
004'395 27 S0 raft apply snapshot offset 15 ,lastApplied 15,total log 16, size 681,log cap:2
004'395 31 S300 after snap shot size681 454
004'395 35 S102 move delete propose num 6 shards [0 1 2 3 4] as leader?
004'396 30 S301 nop apply <nil>
004'396 31 S301 used size: 684 / 300 
004'397 29 S301 do snapshot for raft 15 15,size 454
004'397 27 S1 raft apply snapshot offset 15 ,lastApplied 15,total log 16, size 681,log cap:2
004'397 31 S301 after snap shot size681 454
004'399 29 S100 recv Installsnapshot 103 99
004'399 27 S0 raft apply snapshot offset 103 ,lastApplied 103,total log 103, size 84,log cap:1
004'399 29 S100 decide Installsnapshot 103 <- 99
004'400 30 S100 install snap index 103,config {6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [true true true true true false false false false false]
004'402 30 S101 apply index 103 key num 0 type 4   lastApplied 102
004'402 34 S101 apply new config num 6 :&{6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
004'402 34 S101 inited need send [0 1 2 3 4],need recv []
004'402 31 S101 used size: 979 / 300 
004'403 29 S101 do snapshot for raft 103 103,size 773
004'403 27 S1 raft apply snapshot offset 103 ,lastApplied 103,total log 104, size 683,log cap:2
004'403 31 S101 after snap shot size683 773
004'404 30 S102 apply index 104 key num 0 type 5   lastApplied 103
004'404 35 S102 apply num 6 migration [0 1 2 3 4]
004'404 30 S102 safely delete shard 0
004'404 30 S102 safely delete shard 1
004'404 30 S102 safely delete shard 2
004'404 30 S102 safely delete shard 3
004'404 30 S102 safely delete shard 4
004'404 31 S102 used size: 683 / 300 
004'405 29 S102 do snapshot for raft 104 104,size 622
004'405 27 S2 raft apply snapshot offset 104 ,lastApplied 104,total log 104, size 84,log cap:1
004'405 31 S102 after snap shot size84 622
004'407 30 S301 apply index 16 key num 0 type 5   lastApplied 15
004'407 35 S301 apply num 6 migration [0 1 2 3 4]
004'407 30 S301 safely recv and decided shard 0
004'407 30 S301 safely recv and decided shard 1
004'407 30 S301 safely recv and decided shard 2
004'407 30 S301 safely recv and decided shard 3
004'407 30 S301 safely recv and decided shard 4
004'407 31 S301 used size: 681 / 300 
004'408 29 S301 do snapshot for raft 16 16,size 605
004'408 27 S1 raft apply snapshot offset 16 ,lastApplied 16,total log 16, size 82,log cap:1
004'408 31 S301 after snap shot size82 605
004'409 30 S300 apply index 16 key num 0 type 5   lastApplied 15
004'409 35 S300 apply num 6 migration [0 1 2 3 4]
004'409 30 S300 safely recv and decided shard 0
004'409 30 S300 safely recv and decided shard 1
004'410 30 S300 safely recv and decided shard 2
004'410 30 S300 safely recv and decided shard 3
004'410 30 S300 safely recv and decided shard 4
004'410 31 S300 used size: 681 / 300 
004'410 29 S300 do snapshot for raft 16 16,size 605
004'410 27 S0 raft apply snapshot offset 16 ,lastApplied 16,total log 16, size 82,log cap:1
004'411 31 S300 after snap shot size82 605
004'412 35 S100 num 6 sending shards [0 1 2 3 4] to group 102
004'414 35 S300 num 6 handle num 6 move rpc [0 1 2 3 4]
004'414 30 S201 apply index 17 key num 0 type 4   lastApplied 16
004'414 35 S300 num 6 move [0 1 2 3 4] is done yet
004'414 34 S201 apply new config num 6 :&{6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{5 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
004'414 34 S201 inited need send [],need recv []
004'414 31 S201 used size: 462 / 300 
004'414 30 S100 after send shards ok
004'414 35 S100 move delete propose not leader
004'415 30 S200 nop apply <nil>
004'415 29 S201 do snapshot for raft 17 17,size 454
004'415 35 S102 current config num 6 done
004'416 27 S1 raft apply snapshot offset 17 ,lastApplied 18,total log 18, size 85,log cap:2
004'416 27 S1 last applied not snapshoted raft.LogEntry{Term:3, Command:interface {}(nil)}
004'416 31 S201 after snap shot size85 454
004'416 30 S201 nop apply <nil>
004'429 35 S300 current config num 6 done
004'429 34 S200 check new config wanted 7
004'429 35 S200 current config num 6 done
004'429 35 S201 current config num 6 done
004'430 34 S302 check new config wanted 7
004'453 35 S302 current config num 6 done
004'447 34 S101 check new config wanted 7
004'447 34 S201 check new config wanted 7
004'454 35 S101 num 6 sending shards [0 1 2 3 4] to group 102
004'447 34 S202 check new config wanted 7
004'460 35 S202 current config num 6 done
004'482 35 S200 current config num 6 done
004'484 35 S201 current config num 6 done
004'487 34 S102 check new config wanted 7
004'491 35 S100 num 6 sending shards [0 1 2 3 4] to group 102
004'491 34 S100 check new config wanted 7
004'447 35 S301 current config num 6 done
004'493 34 S301 check new config wanted 7
004'494 35 S101 num 6 sending shards [0 1 2 3 4] to group 102
004'447 34 S300 check new config wanted 7
004'496 35 S300 num 6 handle num 6 move rpc [0 1 2 3 4]
004'496 35 S300 num 6 move [0 1 2 3 4] is done yet
004'496 35 S300 num 6 handle num 6 move rpc [0 1 2 3 4]
004'496 35 S300 num 6 move [0 1 2 3 4] is done yet
004'496 35 S300 num 6 handle num 6 move rpc [0 1 2 3 4]
004'496 35 S300 num 6 move [0 1 2 3 4] is done yet
004'497 35 S300 current config num 6 done
004'498 30 S101 after send shards ok
004'498 35 S101 move delete propose not leader
004'499 30 S101 after send shards ok
004'499 35 S101 move delete propose not leader
004'500 30 S100 after send shards ok
004'500 35 S100 move delete propose not leader
004'502 30 S101 apply index 104 key num 0 type 5   lastApplied 103
004'502 35 S101 apply num 6 migration [0 1 2 3 4]
004'502 30 S101 safely delete shard 0
004'502 30 S101 safely delete shard 1
004'502 30 S101 safely delete shard 2
004'502 30 S101 safely delete shard 3
004'502 30 S101 safely delete shard 4
004'502 31 S101 used size: 683 / 300 
004'503 29 S101 do snapshot for raft 104 104,size 622
004'503 27 S1 raft apply snapshot offset 104 ,lastApplied 104,total log 104, size 84,log cap:1
004'503 31 S101 after snap shot size84 622
004'504 35 S102 current config num 6 done
004'505 29 S100 recv Installsnapshot 104 103
004'506 27 S0 raft apply snapshot offset 104 ,lastApplied 104,total log 104, size 84,log cap:1
004'506 29 S100 decide Installsnapshot 104 <- 103
004'507 30 S100 install snap index 104,config {6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
004'512 35 S202 current config num 6 done
004'513 35 S302 current config num 6 done
004'523 35 S100 current config num 6 done
004'525 35 S101 current config num 6 done
004'533 35 S200 current config num 6 done
004'548 35 S300 current config num 6 done
004'541 35 S201 current config num 6 done
004'557 35 S102 current config num 6 done
004'548 35 S301 current config num 6 done
004'567 35 S302 current config num 6 done
004'567 35 S202 current config num 6 done
004'573 35 S100 current config num 6 done
004'579 35 S101 current config num 6 done
004'585 35 S200 current config num 6 done
004'599 35 S300 current config num 6 done
004'606 35 S201 current config num 6 done
004'613 35 S301 current config num 6 done
004'614 35 S102 current config num 6 done
004'621 35 S202 current config num 6 done
004'621 35 S302 current config num 6 done
004'624 35 S100 current config num 6 done
004'637 35 S101 current config num 6 done
004'637 35 S200 current config num 6 done
004'652 34 S101 got new config {7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 6
004'657 35 S300 current config num 6 done
004'674 35 S100 current config num 6 done
004'667 35 S102 current config num 6 done
004'667 35 S201 current config num 6 done
004'667 35 S301 current config num 6 done
004'671 35 S202 current config num 6 done
004'671 35 S302 current config num 6 done
004'689 35 S200 current config num 6 done
004'700 35 S101 current config num 6 done
004'709 35 S300 current config num 6 done
004'728 35 S301 current config num 6 done
004'728 35 S102 current config num 6 done
004'728 35 S201 current config num 6 done
004'728 35 S202 current config num 6 done
004'728 35 S302 current config num 6 done
004'739 35 S200 current config num 6 done
leave &{[101] 1074585914363486070 7}
leave &{[101] 1074585914363486070 7}
004'744 35 S100 current config num 6 done
004'750 35 S101 current config num 6 done
004'752 34 S101 check new config wanted 7
004'760 35 S300 current config num 6 done
004'781 35 S302 current config num 6 done
004'781 35 S301 current config num 6 done
004'781 35 S201 current config num 6 done
004'781 35 S102 current config num 6 done
004'781 35 S202 current config num 6 done
004'794 35 S200 current config num 6 done
004'797 35 S100 current config num 6 done
004'800 28 S200 do request args:Key 8 type 3 num 7 Client 2953714763196401582 Seq 2 
004'800 28 S200 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
004'802 34 S200 got new config {7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 6
004'803 28 S300 do request args:Key 6 type 3 num 7 Client 542732653461723544 Seq 4 
004'803 28 S300 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
004'803 34 S300 got new config {7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 6
004'804 34 S302 got new config {7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 6
004'805 34 S302 propose new config 7
004'805 35 S101 current config num 6 done
004'807 34 S202 got new config {7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 6
004'807 34 S202 propose new config 7
leave &{[101] 1074585914363486070 7}
004'819 34 S201 got new config {7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 6
004'820 28 S100 do request args:Key 0 type 3 num 7 Client 940626237948413081 Seq 10 
004'820 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
004'822 35 S300 current config num 6 done
004'827 30 S302 apply index 17 key num 0 type 4   lastApplied 16
004'827 34 S302 apply new config num 7 :&{7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
004'827 34 S302 inited need send [0],need recv []
004'827 31 S302 used size: 503 / 300 
004'828 29 S302 do snapshot for raft 17 17,size 648
004'828 27 S2 raft apply snapshot offset 17 ,lastApplied 17,total log 17, size 82,log cap:1
004'828 31 S302 after snap shot size82 648
004'833 30 S202 apply index 19 key num 0 type 4   lastApplied 18
004'833 34 S202 apply new config num 7 :&{7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
004'833 34 S202 inited need send [],need recv [0 5 6]
004'833 31 S202 used size: 506 / 300 
004'833 29 S202 do snapshot for raft 19 19,size 497
004'834 27 S2 raft apply snapshot offset 19 ,lastApplied 19,total log 19, size 82,log cap:1
004'834 31 S202 after snap shot size82 497
004'834 35 S201 current config num 6 done
004'834 35 S301 current config num 6 done
004'834 35 S302 num 7 sending shards [0] to group 101
004'834 35 S102 current config num 6 done
004'834 35 S202 num 7 waiting [0 5 6] shards 
004'836 35 S200 num 6 handle num 7 move rpc [0]
004'837 35 S201 num 6 handle num 7 move rpc [0]
004'839 35 S202 num 7 handle num 7 move rpc [0]
004'839 35 S202 move handle num 7 shards [0] as leader?
004'846 35 S200 current config num 6 done
004'847 28 S300 do request args:Key 3 type 3 num 7 Client 2238025532150463055 Seq 8 
004'847 28 S300 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
004'848 35 S100 current config num 6 done
004'849 28 S100 do request args:Key 1 type 3 num 7 Client 418781717203629479 Seq 17 
004'849 28 S100 [479--17] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
004'849 34 S100 got new config {7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 6
004'851 28 S300 do request args:Key 5 type 3 num 7 Client 3482757038087095369 Seq 5 
004'851 28 S300 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
004'847 28 S200 do request args:Key 7 type 3 num 7 Client 2972145661651991667 Seq 6 
004'862 35 S101 current config num 6 done
004'867 30 S201 apply index 19 key num 0 type 4   lastApplied 18
004'868 34 S201 apply new config num 7 :&{7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
004'868 34 S201 inited need send [],need recv [0 5 6]
004'868 31 S201 used size: 867 / 300 
004'869 29 S201 do snapshot for raft 19 19,size 497
004'869 27 S1 raft apply snapshot offset 19 ,lastApplied 19,total log 20, size 524,log cap:2
004'869 31 S201 after snap shot size524 497
004'879 28 S100 do request args:Key 9 type 3 num 7 Client 3620950086299709532 Seq 10 
004'879 28 S100 [532--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
004'883 28 S200 [667--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
004'884 30 S200 apply index 19 key num 0 type 4   lastApplied 18
004'884 34 S200 apply new config num 7 :&{7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
004'884 34 S200 inited need send [],need recv [0 5 6]
004'884 31 S200 used size: 867 / 300 
004'885 29 S200 do snapshot for raft 19 19,size 497
004'885 27 S0 raft apply snapshot offset 19 ,lastApplied 19,total log 20, size 524,log cap:2
004'885 31 S200 after snap shot size524 497
004'886 44 S2 ctrler change to config &{8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
004'886 35 S202 num 7 waiting [0 5 6] shards 
004'886 35 S201 num 7 waiting [0 5 6] shards 
004'886 35 S301 current config num 6 done
004'886 35 S102 current config num 6 done
004'888 34 S102 got new config {7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 6
004'888 34 S102 propose new config 7
leave &{[102] 1074585914363486070 8}
004'890 34 S301 got new config {7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 6
004'890 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 6 
004'890 28 S200 [729--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
leave &{[102] 1074585914363486070 8}
004'891 35 S302 num 7 sending shards [0] to group 101
004'892 30 S202 apply index 20 key num 0 type 5   lastApplied 19
004'892 35 S202 apply num 7 migration [0]
004'892 30 S202 safely recv and decided shard 0
004'892 31 S202 used size: 524 / 300 
004'892 28 S201 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 6 
004'892 28 S201 [729--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
004'892 29 S202 do snapshot for raft 20 20,size 528
004'893 27 S2 raft apply snapshot offset 20 ,lastApplied 20,total log 20, size 82,log cap:1
004'893 31 S202 after snap shot size82 528
004'893 35 S200 num 7 handle num 7 move rpc [0]
004'893 35 S200 move handle not leader
004'893 28 S202 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 6 
004'893 28 S202 [729--6] successed
004'894 28 S202 [729--6] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
004'895 35 S202 num 7 move [0] is done yet
004'895 35 S201 num 7 handle num 7 move rpc [0]
004'895 35 S201 move handle not leader
004'872 35 S300 current config num 6 done
004'896 28 S300 do request args:Key 4 type 3 num 7 Client 132246879705026825 Seq 6 
004'896 28 S300 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
004'897 35 S202 num 7 handle num 7 move rpc [0]
004'897 35 S202 num 7 move [0] is done yet
004'898 30 S302 after send shards ok
004'899 35 S302 move delete propose num 7 shards [0] as leader?
004'899 35 S200 num 7 waiting [0 5 6] shards 
leave &{[102] 1074585914363486070 8}
004'901 36 S729 [6] clerk putAppend okkkkk
004'902 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 7 
004'902 28 S200 [729--7] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
004'902 34 S200 check new config wanted 8
004'906 30 S302 after send shards ok
004'906 35 S302 move delete propose num 7 shards [0] as leader?
004'907 35 S100 current config num 6 done
004'907 34 S302 check new config wanted 8
004'907 34 S300 check new config wanted 7
004'907 34 S101 got new config {7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 6
004'908 28 S201 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 7 
004'908 28 S201 [729--7] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
004'909 34 S202 check new config wanted 8
004'919 28 S202 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 7 
004'919 33 S202 start [729--7] as leader?
004'922 30 S102 apply index 105 key num 0 type 4   lastApplied 104
004'922 34 S102 apply new config num 7 :&{7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
004'922 34 S102 inited need send [5 6],need recv []
004'923 31 S102 used size: 505 / 300 
004'923 29 S102 do snapshot for raft 105 105,size 665
004'923 27 S2 raft apply snapshot offset 105 ,lastApplied 105,total log 105, size 84,log cap:1
004'923 31 S102 after snap shot size84 665
004'925 30 S300 apply index 17 key num 0 type 4   lastApplied 16
004'925 34 S300 apply new config num 7 :&{7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
004'925 34 S300 inited need send [0],need recv []
004'925 31 S300 used size: 972 / 300 
004'926 29 S300 do snapshot for raft 17 17,size 648
004'926 27 S0 raft apply snapshot offset 17 ,lastApplied 17,total log 19, size 632,log cap:3
004'926 31 S300 after snap shot size632 648
004'927 30 S301 apply index 17 key num 0 type 4   lastApplied 16
004'927 34 S301 apply new config num 7 :&{7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
004'927 34 S301 inited need send [0],need recv []
004'927 31 S301 used size: 972 / 300 
004'927 29 S301 do snapshot for raft 17 17,size 648
004'928 27 S1 raft apply snapshot offset 17 ,lastApplied 17,total log 19, size 632,log cap:3
004'928 31 S301 after snap shot size632 648
004'928 30 S302 apply index 18 key num 0 type 5   lastApplied 17
004'928 35 S302 apply num 7 migration [0]
004'928 30 S302 safely delete shard 0
004'928 31 S302 used size: 632 / 300 
004'929 35 S101 current config num 6 done
004'929 34 S201 check new config wanted 8
004'933 29 S302 do snapshot for raft 18 18,size 617
004'934 27 S2 raft apply snapshot offset 18 ,lastApplied 19,total log 19, size 524,log cap:2
004'934 27 S2 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIb"}, NextSeq:map[int64]int{1679014388048817729:7, 2079820695267196558:3}}}}, Num:7}, Num:0}}
004'934 31 S302 after snap shot size524 617
004'934 30 S302 apply index 19 key num 0 type 5   lastApplied 18
004'934 35 S302 apply num 7 migration [0]
004'934 31 S302 used size: 524 / 300 
004'935 29 S302 do snapshot for raft 19 19,size 617
004'935 27 S2 raft apply snapshot offset 19 ,lastApplied 19,total log 19, size 82,log cap:1
004'935 31 S302 after snap shot size82 617
004'935 35 S302 current config num 7 done
004'939 30 S300 apply index 18 key num 0 type 5   lastApplied 17
004'939 35 S300 apply num 7 migration [0]
004'939 30 S300 safely delete shard 0
004'939 31 S300 used size: 632 / 300 
004'940 29 S300 do snapshot for raft 18 18,size 617
004'940 27 S0 raft apply snapshot offset 18 ,lastApplied 19,total log 19, size 524,log cap:2
004'940 27 S0 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIb"}, NextSeq:map[int64]int{1679014388048817729:7, 2079820695267196558:3}}}}, Num:7}, Num:0}}
004'941 31 S300 after snap shot size524 617
004'941 30 S300 apply index 19 key num 0 type 5   lastApplied 18
004'941 35 S300 apply num 7 migration [0]
004'941 31 S300 used size: 524 / 300 
004'942 35 S301 num 7 sending shards [0] to group 101
004'943 35 S202 num 7 waiting [5 6] shards 
004'943 35 S201 num 7 waiting [0 5 6] shards 
004'943 30 S201 apply index 20 key num 0 type 5   lastApplied 19
004'943 35 S201 apply num 7 migration [0]
004'943 30 S201 safely recv and decided shard 0
004'943 31 S201 used size: 586 / 300 
004'944 29 S201 do snapshot for raft 20 20,size 528
004'944 27 S1 raft apply snapshot offset 20 ,lastApplied 20,total log 21, size 223,log cap:2
004'944 31 S201 after snap shot size223 528
004'945 29 S300 do snapshot for raft 19 19,size 617
004'946 27 S0 raft apply snapshot offset 19 ,lastApplied 19,total log 19, size 82,log cap:1
004'946 31 S300 after snap shot size82 617
004'950 34 S100 check new config wanted 7
004'950 30 S202 apply index 21 key2 num 7 type 3   lastApplied 20
004'950 30 S200 apply index 20 key num 0 type 5   lastApplied 19
004'950 35 S200 apply num 7 migration [0]
004'950 30 S200 safely recv and decided shard 0
004'950 31 S200 used size: 586 / 300 
004'951 29 S200 do snapshot for raft 20 20,size 528
004'955 35 S300 current config num 7 done
004'956 27 S0 raft apply snapshot offset 20 ,lastApplied 20,total log 21, size 223,log cap:2
004'956 31 S200 after snap shot size223 528
004'956 28 S202 [729--7] successed
004'956 28 S202 [729--7] ok 
004'956 28 S202 [729--7] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
004'956 35 S200 num 7 waiting [5 6] shards 
004'957 36 S729 [7] clerk putAppend okkkkk
004'957 35 S100 current config num 6 done
004'958 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 8 
004'958 28 S200 declined [729--8] for not leader
004'958 28 S200 [729--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
004'959 28 S201 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 8 
004'960 28 S201 declined [729--8] for not leader
004'960 28 S201 [729--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
004'961 28 S202 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 8 
004'961 33 S202 start [729--8] as leader?
004'961 35 S102 num 7 sending shards [5 6] to group 101
004'961 35 S200 num 7 handle num 7 move rpc [0]
004'961 35 S200 num 7 move [0] is done yet
004'962 30 S301 after send shards ok
004'962 35 S301 move delete propose not leader
004'963 35 S200 num 7 handle num 7 move rpc [5 6]
004'963 35 S200 move handle not leader
004'966 35 S201 num 7 handle num 7 move rpc [5 6]
004'966 35 S201 move handle not leader
004'974 35 S202 num 7 handle num 7 move rpc [5 6]
004'985 30 S201 apply index 21 key2 num 7 type 3   lastApplied 20
004'974 30 S301 apply index 18 key num 0 type 5   lastApplied 17
004'985 35 S301 apply num 7 migration [0]
004'985 30 S301 safely delete shard 0
004'986 31 S301 used size: 632 / 300 
004'986 29 S301 do snapshot for raft 18 18,size 617
004'986 30 S200 apply index 21 key2 num 7 type 3   lastApplied 20
004'987 27 S1 raft apply snapshot offset 18 ,lastApplied 19,total log 19, size 524,log cap:2
004'987 27 S1 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIb"}, NextSeq:map[int64]int{1679014388048817729:7, 2079820695267196558:3}}}}, Num:7}, Num:0}}
004'987 31 S301 after snap shot size524 617
004'987 30 S301 apply index 19 key num 0 type 5   lastApplied 18
004'987 35 S301 apply num 7 migration [0]
004'987 31 S301 used size: 524 / 300 
004'988 29 S301 do snapshot for raft 19 19,size 617
004'988 27 S1 raft apply snapshot offset 19 ,lastApplied 19,total log 19, size 82,log cap:1
004'988 31 S301 after snap shot size82 617
004'988 35 S301 current config num 7 done
004'979 35 S101 current config num 6 done
004'988 34 S102 check new config wanted 8
004'990 34 S301 check new config wanted 8
005'003 35 S302 current config num 7 done
005'003 35 S102 num 7 sending shards [5 6] to group 101
005'004 35 S202 move handle num 7 shards [5 6] as leader?
005'004 30 S202 apply index 22 key2 num 7 type 3   lastApplied 21
005'004 31 S202 used size: 684 / 300 
005'005 29 S202 do snapshot for raft 22 22,size 530
005'005 35 S300 current config num 7 done
005'006 27 S2 raft apply snapshot offset 22 ,lastApplied 22,total log 23, size 560,log cap:2
005'006 31 S202 after snap shot size560 530
005'007 35 S200 num 7 waiting [5 6] shards 
005'007 28 S202 [729--8] successed
005'007 28 S202 [729--8] ok 
005'007 28 S202 [729--8] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
005'007 35 S202 num 7 waiting [5 6] shards 
005'008 36 S729 [8] clerk putAppend okkkkk
005'009 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 9 
005'009 28 S200 declined [729--9] for not leader
005'009 28 S200 [729--9] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'010 35 S100 current config num 6 done
005'020 35 S200 num 7 handle num 7 move rpc [5 6]
005'020 35 S200 move handle not leader
005'028 44 S0 ctrler change to config &{8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
005'030 30 S201 apply index 22 key2 num 7 type 3   lastApplied 21
005'030 31 S201 used size: 684 / 300 
005'030 29 S201 do snapshot for raft 22 22,size 530
005'033 34 S101 check new config wanted 7
005'038 44 S1 ctrler change to config &{8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
005'047 27 S1 raft apply snapshot offset 22 ,lastApplied 22,total log 23, size 560,log cap:2
005'047 31 S201 after snap shot size560 530
005'048 30 S200 apply index 22 key2 num 7 type 3   lastApplied 21
005'048 31 S200 used size: 684 / 300 
005'048 29 S200 do snapshot for raft 22 22,size 530
005'049 27 S0 raft apply snapshot offset 22 ,lastApplied 23,total log 23, size 560,log cap:2
005'049 27 S0 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:6}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:7}, Num:0}}
005'049 31 S200 after snap shot size560 530
005'049 30 S200 apply index 23 key num 0 type 5   lastApplied 22
005'049 35 S200 apply num 7 migration [5 6]
005'049 30 S200 safely recv and decided shard 5
005'049 30 S200 safely recv and decided shard 6
005'049 28 S201 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 9 
005'049 28 S201 declined [729--9] for not leader
005'049 35 S102 num 7 sending shards [5 6] to group 101
005'049 35 S201 num 7 waiting [5 6] shards 
005'051 30 S202 apply index 23 key num 0 type 5   lastApplied 22
005'052 35 S202 apply num 7 migration [5 6]
005'052 30 S202 safely recv and decided shard 5
005'052 30 S202 safely recv and decided shard 6
005'052 31 S202 used size: 560 / 300 
005'049 31 S200 used size: 560 / 300 
005'053 29 S200 do snapshot for raft 23 23,size 587
005'054 27 S0 raft apply snapshot offset 23 ,lastApplied 23,total log 23, size 82,log cap:1
005'054 31 S200 after snap shot size82 587
005'054 28 S201 [729--9] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'057 35 S300 current config num 7 done
005'061 35 S301 current config num 7 done
005'061 29 S202 do snapshot for raft 23 23,size 587
005'061 35 S200 current config num 7 done
005'062 35 S302 current config num 7 done
005'062 35 S100 current config num 6 done
005'064 35 S101 current config num 6 done
005'066 35 S201 num 7 handle num 7 move rpc [5 6]
005'080 35 S102 num 7 sending shards [5 6] to group 101
005'094 44 S0 ctrler change to config &{9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
005'094 27 S2 raft apply snapshot offset 23 ,lastApplied 23,total log 23, size 82,log cap:1
005'094 31 S202 after snap shot size82 587
005'094 35 S200 num 7 handle num 7 move rpc [5 6]
005'094 35 S200 num 7 move [5 6] is done yet
005'094 35 S202 num 7 move [5 6] is done yet
005'097 30 S102 after send shards ok
005'098 35 S102 move delete propose num 7 shards [5 6] as leader?
005'098 28 S202 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 9 
005'099 33 S202 start [729--9] as leader?
005'099 35 S202 current config num 7 done
005'099 35 S201 move handle not leader
005'083 30 S100 apply index 105 key num 0 type 4   lastApplied 104
005'099 34 S100 apply new config num 7 :&{7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
005'099 34 S100 inited need send [5 6],need recv []
005'100 31 S100 used size: 505 / 300 
005'101 29 S100 do snapshot for raft 105 105,size 665
005'102 27 S0 raft apply snapshot offset 105 ,lastApplied 105,total log 105, size 84,log cap:1
005'102 31 S100 after snap shot size84 665
005'083 30 S101 apply index 105 key num 0 type 4   lastApplied 104
005'102 34 S101 apply new config num 7 :&{7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{6 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
005'102 34 S101 inited need send [5 6],need recv []
005'102 31 S101 used size: 505 / 300 
005'103 29 S101 do snapshot for raft 105 105,size 665
005'103 27 S1 raft apply snapshot offset 105 ,lastApplied 105,total log 105, size 84,log cap:1
005'103 31 S101 after snap shot size84 665
005'104 30 S102 after send shards ok
005'106 35 S102 move delete propose num 7 shards [5 6] as leader?
005'108 35 S201 num 7 waiting [5 6] shards 
005'109 35 S202 num 7 handle num 7 move rpc [5 6]
005'109 35 S202 num 7 move [5 6] is done yet
005'112 44 S1 ctrler change to config &{9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
005'112 35 S200 num 7 handle num 7 move rpc [5 6]
005'112 35 S200 num 7 move [5 6] is done yet
005'114 30 S102 apply index 106 key num 0 type 5   lastApplied 105
005'114 35 S102 apply num 7 migration [5 6]
005'114 30 S102 safely delete shard 5
005'114 30 S102 safely delete shard 6
005'114 31 S102 used size: 706 / 300 
005'115 29 S102 do snapshot for raft 106 106,size 609
005'116 27 S2 raft apply snapshot offset 106 ,lastApplied 107,total log 107, size 562,log cap:2
005'116 30 S202 apply index 24 key2 num 7 type 3   lastApplied 23
005'117 28 S202 [729--9] successed
005'117 28 S202 [729--9] ok 
005'117 28 S202 [729--9] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
005'116 27 S2 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:6}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:7}, Num:0}}
005'117 31 S102 after snap shot size562 609
005'118 30 S102 apply index 107 key num 0 type 5   lastApplied 106
005'118 35 S102 apply num 7 migration [5 6]
005'118 31 S102 used size: 562 / 300 
005'118 29 S102 do snapshot for raft 107 107,size 609
005'118 27 S2 raft apply snapshot offset 107 ,lastApplied 107,total log 107, size 84,log cap:1
005'118 31 S102 after snap shot size84 609
005'119 30 S102 after send shards ok
005'119 35 S102 num 7 move [5 6] is done yet
005'120 36 S729 [9] clerk putAppend okkkkk
005'116 35 S300 current config num 7 done
005'121 30 S102 after send shards ok
005'121 35 S102 num 7 move [5 6] is done yet
005'121 35 S102 current config num 7 done
005'128 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 10 
005'128 28 S200 declined [729--10] for not leader
005'128 28 S200 [729--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'128 30 S201 apply index 23 key num 0 type 5   lastApplied 22
005'128 35 S201 apply num 7 migration [5 6]
005'128 30 S201 safely recv and decided shard 5
005'128 30 S201 safely recv and decided shard 6
005'128 31 S201 used size: 622 / 300 
005'129 29 S201 do snapshot for raft 23 23,size 587
005'129 27 S1 raft apply snapshot offset 23 ,lastApplied 23,total log 24, size 223,log cap:2
005'129 31 S201 after snap shot size223 587
005'130 28 S201 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 10 
005'130 28 S201 declined [729--10] for not leader
005'130 28 S201 [729--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'131 28 S202 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 10 
005'132 33 S202 start [729--10] as leader?
005'133 35 S301 current config num 7 done
005'133 35 S200 current config num 7 done
005'133 35 S100 num 7 sending shards [5 6] to group 101
005'134 35 S101 num 7 sending shards [5 6] to group 101
005'134 35 S302 current config num 7 done
005'135 35 S200 num 7 handle num 7 move rpc [5 6]
005'135 35 S200 num 7 move [5 6] is done yet
005'136 35 S200 num 7 handle num 7 move rpc [5 6]
005'136 35 S200 num 7 move [5 6] is done yet
005'137 30 S101 after send shards ok
005'137 35 S101 move delete propose not leader
005'137 30 S100 after send shards ok
005'137 35 S100 move delete propose not leader
005'140 30 S201 apply index 24 key2 num 7 type 3   lastApplied 23
005'141 30 S202 apply index 25 key2 num 7 type 3   lastApplied 24
005'141 28 S202 [729--10] successed
005'141 28 S202 [729--10] ok 
005'141 30 S200 apply index 24 key2 num 7 type 3   lastApplied 23
005'142 28 S202 [729--10] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
005'142 36 S729 [10] clerk putAppend okkkkk
005'146 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 11 
005'146 28 S200 declined [729--11] for not leader
005'146 28 S200 [729--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'147 28 S201 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 11 
005'147 28 S201 declined [729--11] for not leader
005'147 28 S201 [729--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'150 28 S202 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 11 
005'151 33 S202 start [729--11] as leader?
005'151 35 S202 current config num 7 done
005'160 30 S200 apply index 25 key2 num 7 type 3   lastApplied 24
005'161 31 S200 used size: 348 / 300 
005'161 29 S200 do snapshot for raft 25 25,size 589
005'161 27 S0 raft apply snapshot offset 25 ,lastApplied 25,total log 26, size 223,log cap:2
005'162 31 S200 after snap shot size223 589
005'162 30 S201 apply index 25 key2 num 7 type 3   lastApplied 24
005'162 31 S201 used size: 348 / 300 
005'166 30 S202 apply index 26 key2 num 7 type 3   lastApplied 25
005'166 31 S202 used size: 348 / 300 
005'167 29 S202 do snapshot for raft 26 26,size 590
005'167 27 S2 raft apply snapshot offset 26 ,lastApplied 26,total log 26, size 82,log cap:1
005'167 31 S202 after snap shot size82 590
005'167 28 S202 [729--11] successed
005'167 28 S202 [729--11] ok 
005'167 28 S202 [729--11] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
005'168 36 S729 [11] clerk putAppend okkkkk
005'169 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 12 
005'169 28 S200 declined [729--12] for not leader
005'169 28 S200 [729--12] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'184 35 S200 current config num 7 done
005'184 35 S101 num 7 sending shards [5 6] to group 101
005'185 35 S100 num 7 sending shards [5 6] to group 101
005'185 35 S301 current config num 7 done
005'185 35 S302 current config num 7 done
005'193 29 S201 do snapshot for raft 25 25,size 589
005'194 27 S1 raft apply snapshot offset 25 ,lastApplied 25,total log 26, size 223,log cap:2
005'194 31 S201 after snap shot size223 589
005'194 35 S200 num 7 handle num 7 move rpc [5 6]
005'195 35 S200 num 7 move [5 6] is done yet
005'195 35 S201 current config num 7 done
005'195 35 S200 num 7 handle num 7 move rpc [5 6]
005'196 35 S200 num 7 move [5 6] is done yet
005'196 28 S201 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 12 
005'196 28 S201 declined [729--12] for not leader
005'196 30 S101 after send shards ok
005'196 28 S201 [729--12] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'196 30 S100 after send shards ok
005'197 35 S100 move delete propose not leader
005'187 35 S102 current config num 7 done
005'187 35 S300 current config num 7 done
005'196 35 S101 move delete propose not leader
005'197 28 S202 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 12 
005'198 33 S202 start [729--12] as leader?
005'212 35 S202 current config num 7 done
005'218 30 S201 apply index 26 key2 num 7 type 3   lastApplied 25
005'218 30 S202 apply index 27 key2 num 7 type 3   lastApplied 26
005'218 28 S202 [729--12] successed
005'218 28 S202 [729--12] ok 
005'219 28 S202 [729--12] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
005'219 36 S729 [12] clerk putAppend okkkkk
005'220 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 13 
005'220 28 S200 declined [729--13] for not leader
005'220 28 S200 [729--13] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'221 28 S201 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 13 
005'221 28 S201 declined [729--13] for not leader
005'221 28 S201 [729--13] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'222 28 S202 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 13 
005'223 33 S202 start [729--13] as leader?
005'223 30 S200 apply index 26 key2 num 7 type 3   lastApplied 25
005'224 35 S101 num 7 sending shards [5 6] to group 101
005'224 35 S100 num 7 sending shards [5 6] to group 101
005'226 35 S200 num 7 handle num 7 move rpc [5 6]
005'226 35 S200 num 7 move [5 6] is done yet
005'232 35 S200 num 7 handle num 7 move rpc [5 6]
005'232 35 S200 num 7 move [5 6] is done yet
005'234 30 S100 after send shards ok
005'234 35 S100 move delete propose not leader
005'234 30 S201 apply index 27 key2 num 7 type 3   lastApplied 26
005'234 31 S201 used size: 348 / 300 
005'235 29 S201 do snapshot for raft 27 27,size 591
005'235 27 S1 raft apply snapshot offset 27 ,lastApplied 27,total log 28, size 223,log cap:2
005'235 31 S201 after snap shot size223 591
005'236 30 S101 after send shards ok
005'236 35 S101 move delete propose not leader
005'236 30 S202 apply index 28 key2 num 7 type 3   lastApplied 27
005'236 28 S202 [729--13] successed
005'236 28 S202 [729--13] ok 
005'236 28 S202 [729--13] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
005'238 36 S729 [13] clerk putAppend okkkkk
005'239 30 S200 apply index 27 key2 num 7 type 3   lastApplied 26
005'239 31 S200 used size: 348 / 300 
005'240 29 S200 do snapshot for raft 27 27,size 591
005'240 27 S0 raft apply snapshot offset 27 ,lastApplied 27,total log 28, size 223,log cap:2
005'240 31 S200 after snap shot size223 591
005'240 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 14 
005'240 28 S200 declined [729--14] for not leader
005'240 28 S200 [729--14] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'243 28 S201 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 14 
005'243 28 S201 declined [729--14] for not leader
005'244 28 S201 [729--14] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'245 28 S202 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 14 
005'246 33 S202 start [729--14] as leader?
005'252 35 S201 current config num 7 done
005'252 35 S300 current config num 7 done
005'252 35 S102 current config num 7 done
005'252 35 S200 current config num 7 done
005'252 35 S301 current config num 7 done
005'252 35 S302 current config num 7 done
005'256 30 S202 apply index 29 key2 num 7 type 3   lastApplied 28
005'256 31 S202 used size: 348 / 300 
005'256 29 S202 do snapshot for raft 29 29,size 593
005'257 27 S2 raft apply snapshot offset 29 ,lastApplied 29,total log 29, size 82,log cap:1
005'257 31 S202 after snap shot size82 593
005'257 28 S202 [729--14] successed
005'257 28 S202 [729--14] ok 
005'257 28 S202 [729--14] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
005'258 30 S201 apply index 28 key2 num 7 type 3   lastApplied 27
005'259 36 S729 [14] clerk putAppend okkkkk
005'260 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 15 
005'260 28 S200 declined [729--15] for not leader
005'260 28 S200 [729--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'260 30 S200 apply index 28 key2 num 7 type 3   lastApplied 27
005'261 28 S201 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 15 
005'261 28 S201 declined [729--15] for not leader
005'261 28 S201 [729--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'262 28 S202 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 15 
005'263 33 S202 start [729--15] as leader?
005'263 35 S202 current config num 7 done
005'267 35 S100 num 7 sending shards [5 6] to group 101
005'267 35 S101 num 7 sending shards [5 6] to group 101
005'278 35 S200 num 7 handle num 7 move rpc [5 6]
005'278 35 S200 num 7 move [5 6] is done yet
005'279 30 S101 after send shards ok
005'279 35 S101 move delete propose not leader
005'293 30 S200 apply index 29 key2 num 7 type 3   lastApplied 28
005'294 31 S200 used size: 348 / 300 
005'294 29 S200 do snapshot for raft 29 29,size 593
005'295 27 S0 raft apply snapshot offset 29 ,lastApplied 29,total log 30, size 223,log cap:2
005'295 31 S200 after snap shot size223 593
005'295 30 S202 apply index 30 key2 num 7 type 3   lastApplied 29
005'295 28 S202 [729--15] successed
005'295 28 S202 [729--15] ok 
005'295 28 S202 [729--15] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
005'296 36 S729 [15] clerk putAppend okkkkk
005'296 35 S200 num 7 handle num 7 move rpc [5 6]
005'296 35 S200 num 7 move [5 6] is done yet
005'301 30 S201 apply index 29 key2 num 7 type 3   lastApplied 28
005'301 31 S201 used size: 348 / 300 
005'302 29 S201 do snapshot for raft 29 29,size 593
005'302 27 S1 raft apply snapshot offset 29 ,lastApplied 29,total log 30, size 223,log cap:2
005'302 31 S201 after snap shot size223 593
005'302 35 S301 current config num 7 done
005'302 35 S201 current config num 7 done
005'302 35 S300 current config num 7 done
005'302 35 S102 current config num 7 done
005'302 35 S200 current config num 7 done
005'303 35 S302 current config num 7 done
005'304 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 16 
005'304 28 S200 declined [729--16] for not leader
005'304 28 S200 [729--16] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'305 35 S100 num 7 sending shards [5 6] to group 101
005'305 30 S100 after send shards ok
005'305 35 S100 move delete propose not leader
005'306 44 S2 ctrler change to config &{9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
005'306 35 S101 num 7 sending shards [5 6] to group 101
005'306 28 S201 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 16 
005'306 28 S201 declined [729--16] for not leader
005'306 28 S201 [729--16] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'307 35 S200 num 7 handle num 7 move rpc [5 6]
005'307 35 S200 num 7 move [5 6] is done yet
005'308 35 S200 num 7 handle num 7 move rpc [5 6]
005'308 35 S200 num 7 move [5 6] is done yet
005'309 28 S202 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 16 
005'310 30 S101 after send shards ok
005'310 35 S101 move delete propose not leader
005'311 30 S200 apply index 30 key2 num 7 type 3   lastApplied 29
005'312 30 S100 after send shards ok
005'312 35 S100 move delete propose not leader
005'314 33 S202 start [729--16] as leader?
005'317 35 S202 current config num 7 done
005'319 30 S201 apply index 30 key2 num 7 type 3   lastApplied 29
005'321 30 S202 apply index 31 key2 num 7 type 3   lastApplied 30
005'321 28 S202 [729--16] successed
005'321 28 S202 [729--16] ok 
005'321 28 S202 [729--16] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
005'335 35 S100 num 7 sending shards [5 6] to group 101
005'340 36 S729 [16] clerk putAppend okkkkk
005'340 35 S101 num 7 sending shards [5 6] to group 101
005'348 35 S200 num 7 handle num 7 move rpc [5 6]
005'348 35 S200 num 7 move [5 6] is done yet
005'349 30 S100 after send shards ok
005'349 35 S100 move delete propose not leader
005'350 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 17 
005'350 28 S200 declined [729--17] for not leader
005'350 28 S200 [729--17] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'354 28 S201 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 17 
005'354 28 S201 declined [729--17] for not leader
005'354 28 S201 [729--17] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'358 28 S202 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 17 
005'359 33 S202 start [729--17] as leader?
005'359 30 S101 apply index 106 key num 0 type 5   lastApplied 105
005'359 35 S101 apply num 7 migration [5 6]
005'359 30 S101 safely delete shard 5
005'359 30 S101 safely delete shard 6
005'359 31 S101 used size: 706 / 300 
005'361 29 S101 do snapshot for raft 106 106,size 609
005'362 27 S1 raft apply snapshot offset 106 ,lastApplied 107,total log 107, size 562,log cap:2
005'362 27 S1 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:6}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:7}, Num:0}}
005'362 31 S101 after snap shot size562 609
005'362 30 S101 apply index 107 key num 0 type 5   lastApplied 106
005'362 35 S101 apply num 7 migration [5 6]
005'362 31 S101 used size: 562 / 300 
005'363 29 S101 do snapshot for raft 107 107,size 609
005'363 27 S1 raft apply snapshot offset 107 ,lastApplied 107,total log 107, size 84,log cap:1
005'363 31 S101 after snap shot size84 609
005'363 30 S100 apply index 106 key num 0 type 5   lastApplied 105
005'363 35 S100 apply num 7 migration [5 6]
005'363 30 S100 safely delete shard 5
005'363 30 S100 safely delete shard 6
005'363 31 S100 used size: 706 / 300 
005'364 29 S100 do snapshot for raft 106 106,size 609
005'364 27 S0 raft apply snapshot offset 106 ,lastApplied 107,total log 107, size 562,log cap:2
005'364 27 S0 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:6}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:7}, Num:0}}
005'365 31 S100 after snap shot size562 609
005'365 30 S100 apply index 107 key num 0 type 5   lastApplied 106
005'365 35 S100 apply num 7 migration [5 6]
005'365 31 S100 used size: 562 / 300 
005'365 29 S100 do snapshot for raft 107 107,size 609
005'365 27 S0 raft apply snapshot offset 107 ,lastApplied 107,total log 107, size 84,log cap:1
005'365 31 S100 after snap shot size84 609
005'368 35 S301 current config num 7 done
005'368 35 S102 current config num 7 done
005'368 35 S201 current config num 7 done
005'368 35 S300 current config num 7 done
005'368 35 S202 current config num 7 done
005'368 35 S302 current config num 7 done
005'351 35 S200 num 7 handle num 7 move rpc [5 6]
005'369 35 S200 num 7 move [5 6] is done yet
005'372 30 S200 apply index 31 key2 num 7 type 3   lastApplied 30
005'372 31 S200 used size: 348 / 300 
005'372 29 S200 do snapshot for raft 31 31,size 595
005'373 27 S0 raft apply snapshot offset 31 ,lastApplied 31,total log 32, size 223,log cap:2
005'373 31 S200 after snap shot size223 595
005'374 35 S200 current config num 7 done
005'374 30 S101 after send shards ok
005'374 35 S101 num 7 move [5 6] is done yet
005'375 30 S202 apply index 32 key2 num 7 type 3   lastApplied 31
005'375 31 S202 used size: 348 / 300 
005'376 29 S202 do snapshot for raft 32 32,size 596
005'376 27 S2 raft apply snapshot offset 32 ,lastApplied 32,total log 32, size 82,log cap:1
005'376 31 S202 after snap shot size82 596
005'376 28 S202 [729--17] successed
005'376 28 S202 [729--17] ok 
005'376 28 S202 [729--17] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
005'377 36 S729 [17] clerk putAppend okkkkk
005'377 35 S100 current config num 7 done
005'377 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 18 
005'377 28 S200 declined [729--18] for not leader
005'378 28 S200 [729--18] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'380 30 S201 apply index 31 key2 num 7 type 3   lastApplied 30
005'380 31 S201 used size: 348 / 300 
005'380 29 S201 do snapshot for raft 31 31,size 595
005'380 27 S1 raft apply snapshot offset 31 ,lastApplied 31,total log 32, size 223,log cap:2
005'381 31 S201 after snap shot size223 595
005'381 35 S101 current config num 7 done
005'383 28 S201 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 18 
005'383 28 S201 declined [729--18] for not leader
005'383 28 S201 [729--18] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'385 28 S202 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 18 
005'397 33 S202 start [729--18] as leader?
005'413 28 S100 do request args:Key 7 type 3 num 9 Client 2972145661651991667 Seq 6 
005'413 28 S100 [667--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
005'416 34 S102 got new config {8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 7
005'416 34 S102 propose new config 8
005'417 34 S301 got new config {8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 7
005'420 30 S200 apply index 32 key2 num 7 type 3   lastApplied 31
005'420 34 S101 got new config {7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 6
005'420 28 S100 do request args:Key 4 type 3 num 9 Client 132246879705026825 Seq 6 
005'421 28 S100 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
005'422 28 S100 do request args:Key 9 type 3 num 9 Client 3620950086299709532 Seq 10 
005'422 28 S100 [532--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
005'423 35 S201 current config num 7 done
005'423 35 S301 current config num 7 done
005'423 35 S102 current config num 7 done
005'423 35 S300 current config num 7 done
005'423 35 S202 current config num 7 done
005'423 35 S302 current config num 7 done
005'424 30 S201 apply index 32 key2 num 7 type 3   lastApplied 31
005'424 30 S202 apply index 33 key2 num 7 type 3   lastApplied 32
005'424 28 S202 [729--18] successed
005'424 28 S202 [729--18] ok 
005'424 28 S202 [729--18] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
005'424 28 S100 do request args:Key 3 type 3 num 9 Client 2238025532150463055 Seq 8 
005'424 28 S100 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
005'425 36 S729 [18] clerk putAppend okkkkk
005'425 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 19 
005'425 28 S200 declined [729--19] for not leader
005'426 28 S200 [729--19] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'427 28 S201 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 19 
005'427 28 S201 declined [729--19] for not leader
005'427 28 S201 [729--19] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'428 28 S202 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 19 
005'428 30 S102 apply index 108 key num 0 type 4   lastApplied 107
005'428 33 S202 start [729--19] as leader?
005'428 34 S102 apply new config num 8 :&{8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
005'429 34 S102 inited need send [],need recv [0 5]
005'429 31 S102 used size: 461 / 300 
005'429 29 S102 do snapshot for raft 108 108,size 566
005'429 27 S2 raft apply snapshot offset 108 ,lastApplied 108,total log 108, size 84,log cap:1
005'430 31 S102 after snap shot size84 566
005'430 35 S100 current config num 7 done
005'431 35 S101 current config num 7 done
005'434 30 S201 apply index 33 key2 num 7 type 3   lastApplied 32
005'434 31 S201 used size: 348 / 300 
005'436 30 S202 apply index 34 key2 num 7 type 3   lastApplied 33
005'436 28 S202 [729--19] successed
005'436 28 S202 [729--19] ok 
005'436 28 S202 [729--19] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
005'436 36 S729 [19] clerk putAppend okkkkk
005'437 29 S201 do snapshot for raft 33 33,size 597
005'438 27 S1 raft apply snapshot offset 33 ,lastApplied 33,total log 34, size 223,log cap:2
005'438 31 S201 after snap shot size223 597
005'429 35 S200 current config num 7 done
005'443 30 S200 apply index 33 key2 num 7 type 3   lastApplied 32
005'443 31 S200 used size: 348 / 300 
005'444 29 S200 do snapshot for raft 33 33,size 597
005'444 27 S0 raft apply snapshot offset 33 ,lastApplied 33,total log 34, size 223,log cap:2
005'444 31 S200 after snap shot size223 597
005'444 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 20 
005'444 28 S200 declined [729--20] for not leader
005'444 28 S200 [729--20] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'445 28 S201 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 20 
005'445 28 S201 declined [729--20] for not leader
005'445 28 S201 [729--20] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'447 28 S202 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 20 
005'447 33 S202 start [729--20] as leader?
005'452 30 S201 apply index 34 key2 num 7 type 3   lastApplied 33
005'452 30 S200 apply index 34 key2 num 7 type 3   lastApplied 33
005'453 30 S202 apply index 35 key2 num 7 type 3   lastApplied 34
005'453 31 S202 used size: 348 / 300 
005'454 29 S202 do snapshot for raft 35 35,size 599
005'454 27 S2 raft apply snapshot offset 35 ,lastApplied 35,total log 35, size 82,log cap:1
005'454 31 S202 after snap shot size82 599
005'454 28 S202 [729--20] successed
005'454 28 S202 [729--20] ok 
005'454 28 S202 [729--20] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
005'454 36 S729 [20] clerk putAppend okkkkk
005'455 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 21 
005'455 28 S200 declined [729--21] for not leader
005'455 28 S200 [729--21] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'457 28 S201 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 21 
005'457 28 S201 declined [729--21] for not leader
005'457 28 S201 [729--21] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'458 28 S202 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 21 
005'459 33 S202 start [729--21] as leader?
005'464 30 S202 apply index 36 key2 num 7 type 3   lastApplied 35
005'464 28 S202 [729--21] successed
005'464 28 S202 [729--21] ok 
005'464 28 S202 [729--21] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
005'465 36 S729 [21] clerk putAppend okkkkk
005'465 30 S200 apply index 35 key2 num 7 type 3   lastApplied 34
005'465 31 S200 used size: 348 / 300 
005'465 30 S201 apply index 35 key2 num 7 type 3   lastApplied 34
005'465 31 S201 used size: 348 / 300 
005'466 29 S200 do snapshot for raft 35 35,size 599
005'466 27 S0 raft apply snapshot offset 35 ,lastApplied 35,total log 36, size 223,log cap:2
005'466 31 S200 after snap shot size223 599
005'466 29 S201 do snapshot for raft 35 35,size 599
005'467 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 22 
005'467 28 S200 declined [729--22] for not leader
005'467 28 S200 [729--22] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'467 27 S1 raft apply snapshot offset 35 ,lastApplied 35,total log 36, size 223,log cap:2
005'467 31 S201 after snap shot size223 599
005'468 28 S201 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 22 
005'468 28 S201 declined [729--22] for not leader
005'468 28 S201 [729--22] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'469 28 S202 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 22 
005'469 33 S202 start [729--22] as leader?
005'473 35 S201 current config num 7 done
005'474 35 S302 current config num 7 done
005'474 35 S102 num 8 waiting [0 5] shards 
005'474 35 S301 current config num 7 done
005'474 35 S300 current config num 7 done
005'474 35 S202 current config num 7 done
005'476 30 S201 apply index 36 key2 num 7 type 3   lastApplied 35
005'477 30 S202 apply index 37 key2 num 7 type 3   lastApplied 36
005'477 28 S202 [729--22] successed
005'477 28 S202 [729--22] ok 
005'477 28 S202 [729--22] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
005'477 30 S200 apply index 36 key2 num 7 type 3   lastApplied 35
005'477 36 S729 [22] clerk putAppend okkkkk
005'478 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 23 
005'478 28 S200 declined [729--23] for not leader
005'478 28 S200 [729--23] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'479 28 S201 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 23 
005'479 28 S201 declined [729--23] for not leader
005'479 28 S201 [729--23] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'480 35 S100 current config num 7 done
005'481 28 S202 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 23 
005'481 33 S202 start [729--23] as leader?
005'481 35 S101 current config num 7 done
005'487 30 S200 apply index 37 key2 num 7 type 3   lastApplied 36
005'487 31 S200 used size: 348 / 300 
005'487 30 S201 apply index 37 key2 num 7 type 3   lastApplied 36
005'487 31 S201 used size: 348 / 300 
005'488 29 S200 do snapshot for raft 37 37,size 601
005'488 27 S0 raft apply snapshot offset 37 ,lastApplied 37,total log 38, size 223,log cap:2
005'488 31 S200 after snap shot size223 601
005'488 30 S202 apply index 38 key2 num 7 type 3   lastApplied 37
005'488 31 S202 used size: 348 / 300 
005'489 29 S202 do snapshot for raft 38 38,size 602
005'489 27 S2 raft apply snapshot offset 38 ,lastApplied 38,total log 38, size 82,log cap:1
005'489 31 S202 after snap shot size82 602
005'489 28 S202 [729--23] successed
005'489 28 S202 [729--23] ok 
005'489 28 S202 [729--23] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
005'490 36 S729 [23] clerk putAppend okkkkk
005'490 34 S200 got new config {8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 7
005'490 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 24 
005'490 28 S200 declined [729--24] for not leader
005'490 28 S200 [729--24] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'491 34 S302 got new config {8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 7
005'488 29 S201 do snapshot for raft 37 37,size 601
005'492 27 S1 raft apply snapshot offset 37 ,lastApplied 37,total log 38, size 223,log cap:2
005'492 31 S201 after snap shot size223 601
005'492 28 S201 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 24 
005'492 28 S201 declined [729--24] for not leader
005'492 28 S201 [729--24] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'493 34 S302 propose new config 8
005'493 35 S200 current config num 7 done
005'494 28 S202 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 24 
005'494 33 S202 start [729--24] as leader?
005'501 30 S302 apply index 20 key num 0 type 4   lastApplied 19
005'501 34 S302 apply new config num 8 :&{8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
005'501 34 S302 inited need send [],need recv [6]
005'501 31 S302 used size: 459 / 300 
005'502 30 S202 apply index 39 key2 num 7 type 3   lastApplied 38
005'502 30 S200 apply index 38 key2 num 7 type 3   lastApplied 37
005'502 30 S201 apply index 38 key2 num 7 type 3   lastApplied 37
005'502 28 S202 [729--24] successed
005'502 28 S202 [729--24] ok 
005'502 28 S202 [729--24] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
005'502 29 S302 do snapshot for raft 20 20,size 574
005'502 27 S2 raft apply snapshot offset 20 ,lastApplied 20,total log 20, size 82,log cap:1
005'502 31 S302 after snap shot size82 574
005'503 36 S729 [24] clerk putAppend okkkkk
005'504 34 S300 got new config {7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 6
005'506 28 S200 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 25 
005'506 28 S200 declined [729--25] for not leader
005'506 28 S200 [729--25] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'507 28 S201 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 25 
005'507 28 S201 declined [729--25] for not leader
005'507 28 S201 [729--25] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
005'509 34 S202 got new config {8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 7
005'512 34 S202 propose new config 8
005'512 28 S202 do request args:Key 2 type 3 num 7 Client 1679014388048817729 Seq 25 
005'513 33 S202 start [729--25] as leader?
005'513 28 S100 do request args:Key 6 type 3 num 9 Client 542732653461723544 Seq 4 
005'513 28 S100 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
005'515 34 S100 got new config {7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 6
005'515 28 S100 do request args:Key 5 type 3 num 9 Client 3482757038087095369 Seq 5 
005'515 28 S100 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
005'517 34 S102 check new config wanted 9
005'518 34 S301 check new config wanted 8
005'520 30 S200 apply index 39 key2 num 7 type 3   lastApplied 38
005'521 31 S200 used size: 645 / 300 
005'521 34 S201 got new config {8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 7
005'522 29 S200 do snapshot for raft 39 39,size 603
005'522 27 S0 raft apply snapshot offset 39 ,lastApplied 39,total log 41, size 521,log cap:3
005'522 31 S200 after snap shot size521 603
005'523 30 S202 apply index 40 key num 0 type 4   lastApplied 39
005'523 34 S202 apply new config num 8 :&{8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
005'523 34 S202 inited need send [0 5 6],need recv []
005'523 31 S202 used size: 583 / 300 
005'524 29 S202 do snapshot for raft 40 40,size 560
005'524 27 S2 raft apply snapshot offset 40 ,lastApplied 41,total log 41, size 223,log cap:2
005'524 35 S302 num 8 waiting [6] shards 
005'524 35 S102 num 8 waiting [0 5] shards 
005'524 35 S301 current config num 7 done
005'524 27 S2 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"2", ClientID:1679014388048817729, Seq:25, OptType:3, Opt:"a", Num:7}}
005'525 31 S202 after snap shot size223 560
005'525 30 S202 apply index 41 key2 num 7 type 3   lastApplied 40
005'525 35 S300 current config num 7 done
005'526 28 S202 [729--25] failed applied ava false
005'526 28 S202 [729--25] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
005'528 35 S202 num 8 sending shards [0 5] to group 100
005'528 35 S202 num 8 sending shards [6] to group 102
005'534 34 S101 check new config wanted 8
005'559 35 S202 num 8 sending shards [0 5] to group 100
005'559 35 S202 num 8 sending shards [6] to group 102
005'560 35 S300 num 7 handle num 8 move rpc [6]
005'562 35 S301 num 7 handle num 8 move rpc [6]
005'534 35 S201 current config num 7 done
005'564 30 S201 apply index 39 key2 num 7 type 3   lastApplied 38
005'564 31 S201 used size: 645 / 300 
005'564 29 S201 do snapshot for raft 39 39,size 603
005'564 35 S302 num 8 handle num 8 move rpc [6]
005'565 27 S1 raft apply snapshot offset 39 ,lastApplied 39,total log 41, size 521,log cap:3
005'565 31 S201 after snap shot size521 603
005'565 35 S302 move handle num 8 shards [6] as leader?
005'535 35 S101 current config num 7 done
005'578 30 S301 apply index 20 key num 0 type 4   lastApplied 19
005'578 34 S301 apply new config num 8 :&{8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
005'578 34 S301 inited need send [],need recv [6]
005'578 31 S301 used size: 817 / 300 
005'579 30 S302 apply index 21 key num 0 type 5   lastApplied 20
005'579 35 S302 apply num 8 migration [6]
005'579 30 S302 safely recv and decided shard 6
005'579 31 S302 used size: 521 / 300 
005'580 29 S302 do snapshot for raft 21 21,size 600
005'580 27 S2 raft apply snapshot offset 21 ,lastApplied 21,total log 21, size 82,log cap:1
005'580 31 S302 after snap shot size82 600
005'580 35 S302 num 8 move [6] is done yet
005'581 29 S301 do snapshot for raft 20 20,size 574
005'582 27 S1 raft apply snapshot offset 20 ,lastApplied 20,total log 21, size 521,log cap:2
005'582 31 S301 after snap shot size521 574
005'585 30 S202 after send shards ok
005'586 35 S202 move delete propose num 8 shards [6] as leader?
005'586 30 S300 apply index 20 key num 0 type 4   lastApplied 19
005'586 34 S300 apply new config num 8 :&{8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
005'586 34 S300 inited need send [],need recv [6]
005'586 31 S300 used size: 817 / 300 
005'587 29 S300 do snapshot for raft 20 20,size 574
005'588 27 S0 raft apply snapshot offset 20 ,lastApplied 20,total log 21, size 521,log cap:2
005'588 31 S300 after snap shot size521 574
005'543 35 S100 current config num 7 done
005'590 35 S102 num 8 waiting [0 5] shards 
005'590 35 S302 current config num 8 done
005'590 35 S300 num 8 waiting [6] shards 
005'591 35 S300 num 8 handle num 8 move rpc [6]
005'591 35 S300 move handle not leader
005'592 35 S202 num 8 sending shards [0 5] to group 100
005'592 35 S100 num 7 handle num 8 move rpc [0 5]
005'592 35 S202 num 8 sending shards [6] to group 102
005'594 35 S300 num 8 handle num 8 move rpc [6]
005'594 35 S300 move handle not leader
005'548 35 S200 current config num 7 done
005'596 28 S100 do request args:Key 0 type 3 num 9 Client 940626237948413081 Seq 10 
005'596 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
005'596 28 S100 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 17 
005'596 28 S100 [479--17] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
005'596 35 S100 num 7 handle num 8 move rpc [0 5]
005'600 35 S101 num 7 handle num 8 move rpc [0 5]
005'601 35 S100 num 7 handle num 8 move rpc [0 5]
005'602 35 S101 num 7 handle num 8 move rpc [0 5]
005'588 35 S301 num 8 waiting [6] shards 
005'604 35 S301 num 8 handle num 8 move rpc [6]
005'604 35 S301 move handle not leader
005'606 35 S102 num 8 handle num 8 move rpc [0 5]
005'606 35 S102 move handle num 8 shards [0 5] as leader?
005'607 28 S100 do request args:Key 8 type 3 num 9 Client 2953714763196401582 Seq 2 
005'607 28 S100 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
005'609 34 S302 check new config wanted 9
005'609 34 S200 check new config wanted 8
005'610 35 S101 num 7 handle num 8 move rpc [0 5]
005'614 34 S300 check new config wanted 9
005'615 35 S102 num 8 handle num 8 move rpc [0 5]
005'620 35 S102 move handle num 8 shards [0 5] as leader?
005'615 35 S301 num 8 handle num 8 move rpc [6]
005'620 35 S301 move handle not leader
005'618 34 S100 check new config wanted 8
005'618 35 S201 current config num 7 done
005'618 34 S202 check new config wanted 9
005'618 35 S101 current config num 7 done
005'625 35 S202 num 8 sending shards [0 5] to group 100
005'625 35 S202 num 8 sending shards [6] to group 102
005'626 34 S201 check new config wanted 8
005'627 35 S302 num 8 handle num 8 move rpc [6]
005'627 35 S302 num 8 move [6] is done yet
005'627 30 S202 after send shards ok
005'630 35 S202 move delete propose num 8 shards [6] as leader?
005'631 30 S201 apply index 40 key num 0 type 4   lastApplied 39
005'631 34 S201 apply new config num 8 :&{8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
005'631 34 S201 inited need send [0 5 6],need recv []
005'632 31 S201 used size: 879 / 300 
005'632 29 S201 do snapshot for raft 40 40,size 560
005'633 27 S1 raft apply snapshot offset 40 ,lastApplied 41,total log 42, size 583,log cap:3
005'633 27 S1 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"2", ClientID:1679014388048817729, Seq:25, OptType:3, Opt:"a", Num:7}}
005'633 31 S201 after snap shot size583 560
005'633 30 S201 apply index 41 key2 num 7 type 3   lastApplied 40
005'633 31 S201 used size: 583 / 300 
005'634 29 S201 do snapshot for raft 41 41,size 560
005'640 27 S1 raft apply snapshot offset 41 ,lastApplied 41,total log 42, size 521,log cap:2
005'640 31 S201 after snap shot size521 560
005'661 35 S202 num 8 sending shards [6] to group 102
005'661 35 S202 num 8 sending shards [0 5] to group 100
005'640 35 S100 current config num 7 done
005'687 35 S102 num 8 waiting [0 5] shards 
005'640 35 S302 current config num 8 done
005'687 35 S300 num 8 waiting [6] shards 
005'688 35 S100 num 7 handle num 8 move rpc [0 5]
005'696 35 S202 num 8 sending shards [0 5] to group 100
005'696 35 S202 num 8 sending shards [6] to group 102
005'675 35 S101 current config num 7 done
005'690 35 S201 num 8 sending shards [0 5] to group 100
005'698 35 S201 num 8 sending shards [6] to group 102
005'698 35 S101 num 7 handle num 8 move rpc [0 5]
005'699 30 S100 apply index 108 key num 0 type 4   lastApplied 107
005'699 34 S100 apply new config num 8 :&{8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
005'699 34 S100 inited need send [],need recv [0 5]
005'699 31 S100 used size: 1045 / 300 
005'700 29 S100 do snapshot for raft 108 108,size 566
005'700 27 S0 raft apply snapshot offset 108 ,lastApplied 108,total log 110, size 749,log cap:3
005'700 31 S100 after snap shot size749 566
005'701 30 S202 apply index 42 key num 0 type 5   lastApplied 41
005'701 35 S202 apply num 8 migration [6]
005'701 30 S202 safely delete shard 6
005'702 31 S202 used size: 688 / 300 
005'702 29 S202 do snapshot for raft 42 42,size 534
005'703 27 S2 raft apply snapshot offset 42 ,lastApplied 42,total log 43, size 521,log cap:2
005'703 31 S202 after snap shot size521 534
005'705 35 S302 num 8 handle num 8 move rpc [6]
005'705 35 S302 num 8 move [6] is done yet
005'705 30 S202 after send shards ok
005'706 35 S202 num 8 move [6] is done yet
005'708 30 S102 apply index 109 key num 0 type 5   lastApplied 108
005'708 35 S102 apply num 8 migration [0 5]
005'708 30 S102 safely recv and decided shard 0
005'708 30 S102 safely recv and decided shard 5
005'708 31 S102 used size: 749 / 300 
005'709 29 S102 do snapshot for raft 109 109,size 645
005'710 27 S2 raft apply snapshot offset 109 ,lastApplied 110,total log 110, size 583,log cap:2
005'710 27 S2 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83"}, NextSeq:map[int64]int{1679014388048817729:25, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:6}}}}, Num:8}, Num:0}}
005'710 31 S102 after snap shot size583 645
005'710 30 S102 apply index 110 key num 0 type 5   lastApplied 109
005'710 35 S102 apply num 8 migration [0 5]
005'710 31 S102 used size: 583 / 300 
005'711 29 S102 do snapshot for raft 110 110,size 645
005'711 27 S2 raft apply snapshot offset 110 ,lastApplied 110,total log 110, size 84,log cap:1
005'711 31 S102 after snap shot size84 645
005'711 30 S300 apply index 21 key num 0 type 5   lastApplied 20
005'711 35 S300 apply num 8 migration [6]
005'711 30 S300 safely recv and decided shard 6
005'711 31 S300 used size: 521 / 300 
005'714 30 S101 apply index 108 key num 0 type 4   lastApplied 107
005'714 34 S101 apply new config num 8 :&{8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
005'715 34 S101 inited need send [],need recv [0 5]
005'715 31 S101 used size: 1045 / 300 
005'715 29 S101 do snapshot for raft 108 108,size 566
005'717 27 S1 raft apply snapshot offset 108 ,lastApplied 108,total log 110, size 749,log cap:3
005'717 31 S101 after snap shot size749 566
005'723 35 S100 num 8 handle num 8 move rpc [0 5]
005'723 35 S100 move handle not leader
005'649 35 S200 current config num 7 done
005'726 30 S200 apply index 40 key num 0 type 4   lastApplied 39
005'726 34 S200 apply new config num 8 :&{8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{7 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
005'726 34 S200 inited need send [0 5 6],need recv []
005'726 31 S200 used size: 879 / 300 
005'726 35 S102 num 8 move [0 5] is done yet
005'727 35 S102 num 8 move [0 5] is done yet
005'727 35 S102 num 8 handle num 8 move rpc [0 5]
005'727 35 S102 num 8 move [0 5] is done yet
005'727 35 S100 num 8 handle num 8 move rpc [0 5]
005'728 35 S100 move handle not leader
005'728 29 S300 do snapshot for raft 21 21,size 600
005'728 27 S0 raft apply snapshot offset 21 ,lastApplied 21,total log 21, size 82,log cap:1
005'728 31 S300 after snap shot size82 600
005'728 35 S300 num 8 handle num 8 move rpc [6]
005'728 35 S300 num 8 move [6] is done yet
005'729 29 S200 do snapshot for raft 40 40,size 560
005'689 35 S301 num 8 waiting [6] shards 
005'737 30 S301 apply index 21 key num 0 type 5   lastApplied 20
005'737 35 S301 apply num 8 migration [6]
005'737 30 S301 safely recv and decided shard 6
005'737 31 S301 used size: 521 / 300 
005'738 29 S301 do snapshot for raft 21 21,size 600
005'738 27 S1 raft apply snapshot offset 21 ,lastApplied 21,total log 21, size 82,log cap:1
005'738 31 S301 after snap shot size82 600
005'738 30 S202 after send shards ok
005'739 35 S202 move delete propose num 8 shards [0 5] as leader?
005'742 27 S0 raft apply snapshot offset 40 ,lastApplied 41,total log 42, size 583,log cap:3
005'742 27 S0 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"2", ClientID:1679014388048817729, Seq:25, OptType:3, Opt:"a", Num:7}}
005'742 31 S200 after snap shot size583 560
005'742 30 S200 apply index 41 key2 num 7 type 3   lastApplied 40
005'742 31 S200 used size: 583 / 300 
005'743 29 S200 do snapshot for raft 41 41,size 560
005'743 27 S0 raft apply snapshot offset 41 ,lastApplied 41,total log 42, size 521,log cap:2
005'744 31 S200 after snap shot size521 560
005'744 35 S302 current config num 8 done
005'744 35 S300 num 8 handle num 8 move rpc [6]
005'744 35 S300 num 8 move [6] is done yet
005'744 35 S300 current config num 8 done
005'741 35 S202 num 8 sending shards [0 5] to group 100
005'745 30 S202 after send shards ok
005'745 35 S202 num 8 move [6] is done yet
005'745 30 S202 after send shards ok
005'745 35 S202 num 8 move [6] is done yet
005'745 35 S100 num 8 waiting [0 5] shards 
005'745 35 S102 current config num 8 done
005'745 35 S300 num 8 handle num 8 move rpc [6]
005'745 35 S300 num 8 move [6] is done yet
005'746 30 S201 after send shards ok
005'746 35 S201 move delete propose not leader
005'747 34 S102 got new config {9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 8
005'748 34 S102 propose new config 9
005'753 35 S201 num 8 sending shards [6] to group 102
005'753 35 S201 num 8 sending shards [0 5] to group 100
005'757 35 S101 num 8 waiting [0 5] shards 
005'758 30 S202 after send shards ok
005'759 35 S202 move delete propose num 8 shards [0 5] as leader?
005'760 30 S202 after send shards ok
005'761 35 S202 move delete propose num 8 shards [0 5] as leader?
005'763 28 S100 do request args:Key 9 type 3 num 9 Client 3620950086299709532 Seq 10 
005'763 28 S100 [532--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
005'771 28 S100 do request args:Key 4 type 3 num 9 Client 132246879705026825 Seq 6 
005'771 28 S100 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
005'775 30 S100 apply index 109 key num 0 type 5   lastApplied 108
005'776 35 S100 apply num 8 migration [0 5]
005'776 30 S100 safely recv and decided shard 0
005'776 30 S100 safely recv and decided shard 5
005'776 31 S100 used size: 1003 / 300 
005'776 30 S102 apply index 111 key num 0 type 4   lastApplied 110
005'776 34 S102 apply new config num 9 :&{9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
005'777 34 S102 inited need send [],need recv [1 2 3 4 6]
005'777 31 S102 used size: 418 / 300 
005'777 29 S102 do snapshot for raft 111 111,size 603
005'777 27 S2 raft apply snapshot offset 111 ,lastApplied 111,total log 111, size 84,log cap:1
005'778 31 S102 after snap shot size84 603
005'782 29 S100 do snapshot for raft 109 109,size 645
005'783 27 S0 raft apply snapshot offset 109 ,lastApplied 110,total log 111, size 837,log cap:3
005'783 27 S0 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83"}, NextSeq:map[int64]int{1679014388048817729:25, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:6}}}}, Num:8}, Num:0}}
005'784 31 S100 after snap shot size837 645
005'784 30 S100 apply index 110 key num 0 type 5   lastApplied 109
005'784 35 S100 apply num 8 migration [0 5]
005'784 31 S100 used size: 837 / 300 
005'784 29 S100 do snapshot for raft 110 110,size 645
005'785 30 S101 apply index 109 key num 0 type 5   lastApplied 108
005'785 35 S101 apply num 8 migration [0 5]
005'785 30 S101 safely recv and decided shard 0
005'785 30 S101 safely recv and decided shard 5
005'785 27 S0 raft apply snapshot offset 110 ,lastApplied 110,total log 111, size 418,log cap:2
005'785 31 S100 after snap shot size418 645
005'785 31 S101 used size: 1003 / 300 
005'786 29 S101 do snapshot for raft 109 109,size 645
005'786 35 S300 num 8 handle num 8 move rpc [6]
005'786 35 S300 num 8 move [6] is done yet
005'787 35 S100 num 8 handle num 8 move rpc [0 5]
005'787 35 S100 num 8 move [0 5] is done yet
005'787 30 S201 after send shards ok
005'787 35 S201 move delete propose not leader
005'788 30 S201 after send shards ok
005'788 35 S201 move delete propose not leader
005'789 27 S1 raft apply snapshot offset 109 ,lastApplied 110,total log 111, size 837,log cap:3
005'789 27 S1 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83"}, NextSeq:map[int64]int{1679014388048817729:25, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:6}}}}, Num:8}, Num:0}}
005'789 31 S101 after snap shot size837 645
005'789 30 S101 apply index 110 key num 0 type 5   lastApplied 109
005'789 35 S101 apply num 8 migration [0 5]
005'789 31 S101 used size: 837 / 300 
005'790 35 S301 current config num 8 done
005'793 29 S101 do snapshot for raft 110 110,size 645
005'793 27 S1 raft apply snapshot offset 110 ,lastApplied 110,total log 111, size 418,log cap:2
005'793 31 S101 after snap shot size418 645
005'794 34 S301 got new config {8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 7
005'795 34 S101 got new config {8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 7
005'795 35 S300 current config num 8 done
005'798 28 S100 do request args:Key 3 type 3 num 9 Client 2238025532150463055 Seq 8 
005'802 28 S100 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
005'802 35 S100 current config num 8 done
005'800 35 S201 num 8 sending shards [6] to group 102
005'803 35 S201 num 8 sending shards [0 5] to group 100
005'801 35 S101 num 8 handle num 8 move rpc [0 5]
005'803 35 S101 num 8 move [0 5] is done yet
005'801 35 S302 current config num 8 done
005'801 35 S102 num 9 waiting [1 2 3 4 6] shards 
005'810 35 S101 current config num 8 done
005'811 35 S102 num 9 handle num 8 move rpc [0 5]
005'813 35 S100 num 8 handle num 8 move rpc [0 5]
005'813 35 S100 num 8 move [0 5] is done yet
005'819 30 S201 apply index 42 key num 0 type 5   lastApplied 41
005'819 35 S201 apply num 8 migration [6]
005'819 30 S201 safely delete shard 6
005'822 31 S201 used size: 792 / 300 
005'822 35 S200 num 8 sending shards [0 5] to group 100
005'822 35 S202 num 8 sending shards [0 5] to group 100
005'822 35 S200 num 8 sending shards [6] to group 102
005'822 30 S202 after send shards ok
005'824 35 S300 num 8 handle num 8 move rpc [6]
005'824 35 S300 num 8 move [6] is done yet
005'825 35 S100 num 8 handle num 8 move rpc [0 5]
005'825 35 S100 num 8 move [0 5] is done yet
005'838 29 S201 do snapshot for raft 42 42,size 534
005'839 27 S1 raft apply snapshot offset 42 ,lastApplied 43,total log 44, size 687,log cap:3
005'839 27 S1 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:8}, Num:0}}
005'839 31 S201 after snap shot size687 534
005'839 30 S201 apply index 43 key num 0 type 5   lastApplied 42
005'839 35 S201 apply num 8 migration [6]
005'839 31 S201 used size: 687 / 300 
005'840 29 S201 do snapshot for raft 43 43,size 534
005'840 35 S301 current config num 8 done
005'847 27 S1 raft apply snapshot offset 43 ,lastApplied 43,total log 44, size 581,log cap:2
005'847 31 S201 after snap shot size581 534
005'847 30 S201 after send shards ok
005'847 35 S201 num 8 move [6] is done yet
005'847 30 S201 after send shards ok
005'847 35 S201 move delete propose not leader
005'848 35 S300 current config num 8 done
005'848 30 S200 apply index 42 key num 0 type 5   lastApplied 41
005'848 35 S200 apply num 8 migration [6]
005'848 30 S200 safely delete shard 6
005'848 31 S200 used size: 792 / 300 
005'848 29 S200 do snapshot for raft 42 42,size 534
005'849 27 S0 raft apply snapshot offset 42 ,lastApplied 43,total log 44, size 687,log cap:3
005'849 27 S0 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:8}, Num:0}}
005'849 31 S200 after snap shot size687 534
005'849 30 S200 apply index 43 key num 0 type 5   lastApplied 42
005'849 35 S200 apply num 8 migration [6]
005'849 31 S200 used size: 687 / 300 
005'850 34 S102 check new config wanted 10
005'850 35 S201 num 8 sending shards [0 5] to group 100
005'852 35 S300 num 8 handle num 8 move rpc [6]
005'852 35 S300 num 8 move [6] is done yet
005'853 35 S100 num 8 handle num 8 move rpc [0 5]
005'853 35 S100 num 8 move [0 5] is done yet
005'854 30 S201 after send shards ok
005'854 35 S201 move delete propose not leader
005'854 35 S302 current config num 8 done
005'854 35 S102 num 9 waiting [1 2 3 4 6] shards 
005'855 29 S200 do snapshot for raft 43 43,size 534
005'857 27 S0 raft apply snapshot offset 43 ,lastApplied 43,total log 44, size 581,log cap:2
005'858 31 S200 after snap shot size581 534
005'858 35 S100 current config num 8 done
005'858 30 S200 after send shards ok
005'858 35 S200 num 8 move [6] is done yet
005'858 35 S200 num 8 sending shards [0 5] to group 100
005'861 35 S202 move delete propose num 8 shards [0 5] as leader?
005'860 35 S101 current config num 8 done
005'861 30 S202 after send shards ok
005'865 35 S100 num 8 handle num 8 move rpc [0 5]
005'865 35 S100 num 8 move [0 5] is done yet
005'866 35 S202 move delete propose num 8 shards [0 5] as leader?
005'867 35 S300 num 8 handle num 8 move rpc [6]
005'867 35 S300 num 8 move [6] is done yet
005'868 30 S202 after send shards ok
005'869 35 S202 move delete propose num 8 shards [0 5] as leader?
005'869 30 S202 after send shards ok
005'869 35 S202 num 8 move [6] is done yet
005'870 30 S202 apply index 43 key num 0 type 5   lastApplied 42
005'871 35 S202 apply num 8 migration [6]
005'871 31 S202 used size: 1517 / 300 
005'871 29 S202 do snapshot for raft 43 43,size 534
005'872 27 S2 raft apply snapshot offset 43 ,lastApplied 46,total log 49, size 1411,log cap:7
005'872 27 S2 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83"}, NextSeq:map[int64]int{1679014388048817729:25, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:6}}}}, Num:8}, Num:0}}
005'873 31 S202 after snap shot size1411 534
005'873 30 S202 apply index 44 key num 0 type 5   lastApplied 43
005'873 35 S202 apply num 8 migration [0 5]
005'873 30 S202 safely delete shard 0
005'873 30 S202 safely delete shard 5
005'873 28 S100 do request args:Key 7 type 3 num 9 Client 2972145661651991667 Seq 6 
005'873 28 S100 [667--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
005'873 31 S202 used size: 1411 / 300 
005'873 29 S202 do snapshot for raft 44 44,size 454
005'874 30 S201 after send shards ok
005'874 35 S201 move delete propose not leader
005'874 27 S2 raft apply snapshot offset 44 ,lastApplied 46,total log 49, size 1245,log cap:6
005'875 27 S2 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83"}, NextSeq:map[int64]int{1679014388048817729:25, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:6}}}}, Num:8}, Num:0}}
005'875 31 S202 after snap shot size1245 454
005'876 35 S100 num 8 handle num 8 move rpc [0 5]
005'876 35 S100 num 8 move [0 5] is done yet
005'877 30 S200 after send shards ok
005'877 35 S200 move delete propose not leader
005'880 35 S202 current config num 8 done
005'880 30 S202 apply index 45 key num 0 type 5   lastApplied 44
005'880 35 S202 apply num 8 migration [0 5]
005'880 31 S202 used size: 1245 / 300 
005'881 29 S202 do snapshot for raft 45 45,size 454
005'881 27 S2 raft apply snapshot offset 45 ,lastApplied 46,total log 49, size 1079,log cap:5
005'882 27 S2 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83"}, NextSeq:map[int64]int{1679014388048817729:25, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:6}}}}, Num:8}, Num:0}}
005'882 31 S202 after snap shot size1079 454
005'882 30 S202 apply index 46 key num 0 type 5   lastApplied 45
005'882 35 S202 apply num 8 migration [0 5]
005'882 31 S202 used size: 1079 / 300 
005'882 29 S202 do snapshot for raft 46 46,size 454
005'884 27 S2 raft apply snapshot offset 46 ,lastApplied 46,total log 49, size 913,log cap:4
005'885 31 S202 after snap shot size913 454
005'885 35 S201 num 8 sending shards [0 5] to group 100
005'891 35 S301 current config num 8 done
005'891 35 S200 num 8 sending shards [0 5] to group 100
005'897 34 S301 check new config wanted 9
005'897 34 S101 check new config wanted 9
005'899 35 S300 current config num 8 done
005'904 30 S201 apply index 44 key num 0 type 5   lastApplied 43
005'904 35 S201 apply num 8 migration [0 5]
005'904 30 S201 safely delete shard 0
005'904 30 S201 safely delete shard 5
005'904 31 S201 used size: 1411 / 300 
005'904 29 S201 do snapshot for raft 44 44,size 454
005'905 27 S1 raft apply snapshot offset 44 ,lastApplied 46,total log 49, size 1245,log cap:6
005'905 27 S1 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83"}, NextSeq:map[int64]int{1679014388048817729:25, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:6}}}}, Num:8}, Num:0}}
005'906 31 S201 after snap shot size1245 454
005'906 30 S201 apply index 45 key num 0 type 5   lastApplied 44
005'906 35 S201 apply num 8 migration [0 5]
005'906 31 S201 used size: 1245 / 300 
005'906 29 S201 do snapshot for raft 45 45,size 454
005'907 27 S1 raft apply snapshot offset 45 ,lastApplied 46,total log 49, size 1079,log cap:5
005'907 27 S1 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83"}, NextSeq:map[int64]int{1679014388048817729:25, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:6}}}}, Num:8}, Num:0}}
005'907 31 S201 after snap shot size1079 454
005'907 30 S201 apply index 46 key num 0 type 5   lastApplied 45
005'907 35 S201 apply num 8 migration [0 5]
005'907 31 S201 used size: 1079 / 300 
005'908 35 S302 current config num 8 done
005'908 29 S201 do snapshot for raft 46 46,size 454
005'909 27 S1 raft apply snapshot offset 46 ,lastApplied 46,total log 49, size 913,log cap:4
005'909 31 S201 after snap shot size913 454
005'909 30 S202 apply index 47 key num 0 type 5   lastApplied 46
005'909 35 S202 apply num 8 migration [0 5]
005'909 31 S202 used size: 913 / 300 
005'909 29 S202 do snapshot for raft 47 47,size 454
005'910 27 S2 raft apply snapshot offset 47 ,lastApplied 49,total log 49, size 747,log cap:3
005'910 27 S2 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83"}, NextSeq:map[int64]int{1679014388048817729:25, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:6}}}}, Num:8}, Num:0}}
005'910 31 S202 after snap shot size747 454
005'910 30 S202 apply index 48 key num 0 type 5   lastApplied 47
005'910 35 S202 apply num 8 migration [0 5]
005'910 31 S202 used size: 747 / 300 
005'912 35 S100 num 8 handle num 8 move rpc [0 5]
005'912 35 S100 num 8 move [0 5] is done yet
005'913 30 S200 after send shards ok
005'913 35 S200 move delete propose not leader
005'913 35 S101 current config num 8 done
005'913 35 S100 current config num 8 done
005'914 29 S202 do snapshot for raft 48 48,size 454
005'915 27 S2 raft apply snapshot offset 48 ,lastApplied 49,total log 49, size 581,log cap:2
005'916 27 S2 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83"}, NextSeq:map[int64]int{1679014388048817729:25, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:6}}}}, Num:8}, Num:0}}
005'916 31 S202 after snap shot size581 454
005'916 30 S202 apply index 49 key num 0 type 5   lastApplied 48
005'916 35 S202 apply num 8 migration [0 5]
005'916 31 S202 used size: 581 / 300 
005'916 30 S200 apply index 44 key num 0 type 5   lastApplied 43
005'916 35 S200 apply num 8 migration [0 5]
005'916 30 S200 safely delete shard 0
005'916 30 S200 safely delete shard 5
005'916 31 S200 used size: 1411 / 300 
005'916 29 S202 do snapshot for raft 49 49,size 454
005'917 29 S200 do snapshot for raft 44 44,size 454
005'917 27 S2 raft apply snapshot offset 49 ,lastApplied 49,total log 49, size 82,log cap:1
005'917 31 S202 after snap shot size82 454
005'917 35 S102 num 9 waiting [1 2 3 4 6] shards 
005'918 27 S0 raft apply snapshot offset 44 ,lastApplied 46,total log 49, size 1245,log cap:6
005'918 27 S0 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83"}, NextSeq:map[int64]int{1679014388048817729:25, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:6}}}}, Num:8}, Num:0}}
005'918 31 S200 after snap shot size1245 454
005'918 30 S200 apply index 45 key num 0 type 5   lastApplied 44
005'918 35 S200 apply num 8 migration [0 5]
005'918 31 S200 used size: 1245 / 300 
005'918 29 S200 do snapshot for raft 45 45,size 454
005'919 27 S0 raft apply snapshot offset 45 ,lastApplied 46,total log 49, size 1079,log cap:5
005'919 27 S0 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83"}, NextSeq:map[int64]int{1679014388048817729:25, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:6}}}}, Num:8}, Num:0}}
005'920 31 S200 after snap shot size1079 454
005'920 30 S200 apply index 46 key num 0 type 5   lastApplied 45
005'920 35 S200 apply num 8 migration [0 5]
005'920 31 S200 used size: 1079 / 300 
005'920 29 S200 do snapshot for raft 46 46,size 454
005'925 27 S0 raft apply snapshot offset 46 ,lastApplied 46,total log 49, size 913,log cap:4
005'925 31 S200 after snap shot size913 454
005'925 35 S100 num 8 handle num 8 move rpc [0 5]
005'926 35 S100 num 8 move [0 5] is done yet
005'927 30 S202 after send shards ok
005'927 35 S202 num 8 move [0 5] is done yet
005'927 35 S100 num 8 handle num 8 move rpc [0 5]
005'927 35 S100 num 8 move [0 5] is done yet
005'927 30 S201 after send shards ok
005'928 35 S201 num 8 move [0 5] is done yet
005'928 35 S201 current config num 8 done
005'945 35 S202 current config num 8 done
005'946 30 S201 apply index 47 key num 0 type 5   lastApplied 46
005'946 35 S201 apply num 8 migration [0 5]
005'946 31 S201 used size: 913 / 300 
005'946 29 S201 do snapshot for raft 47 47,size 454
005'947 27 S1 raft apply snapshot offset 47 ,lastApplied 49,total log 49, size 747,log cap:3
005'947 27 S1 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83"}, NextSeq:map[int64]int{1679014388048817729:25, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:6}}}}, Num:8}, Num:0}}
005'947 31 S201 after snap shot size747 454
005'947 30 S201 apply index 48 key num 0 type 5   lastApplied 47
005'947 35 S201 apply num 8 migration [0 5]
005'947 31 S201 used size: 747 / 300 
005'948 29 S201 do snapshot for raft 48 48,size 454
005'950 27 S1 raft apply snapshot offset 48 ,lastApplied 49,total log 49, size 581,log cap:2
005'950 27 S1 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83"}, NextSeq:map[int64]int{1679014388048817729:25, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:6}}}}, Num:8}, Num:0}}
005'950 31 S201 after snap shot size581 454
005'950 30 S201 apply index 49 key num 0 type 5   lastApplied 48
005'950 35 S201 apply num 8 migration [0 5]
005'951 31 S201 used size: 581 / 300 
005'952 35 S300 current config num 8 done
005'955 35 S101 num 8 handle num 8 move rpc [0 5]
005'955 35 S101 num 8 move [0 5] is done yet
005'956 30 S202 after send shards ok
005'956 35 S202 num 8 move [0 5] is done yet
005'958 29 S201 do snapshot for raft 49 49,size 454
005'958 35 S302 current config num 8 done
005'958 27 S1 raft apply snapshot offset 49 ,lastApplied 49,total log 49, size 82,log cap:1
005'958 31 S201 after snap shot size82 454
005'961 35 S100 num 8 handle num 8 move rpc [0 5]
005'961 35 S100 num 8 move [0 5] is done yet
005'967 35 S100 current config num 8 done
005'967 35 S102 num 9 waiting [1 2 3 4 6] shards 
005'971 35 S101 current config num 8 done
005'982 35 S201 current config num 8 done
005'956 35 S200 current config num 8 done
005'986 30 S200 after send shards ok
005'986 35 S200 num 8 move [0 5] is done yet
005'956 35 S301 current config num 8 done
005'987 30 S200 apply index 47 key num 0 type 5   lastApplied 46
005'987 35 S200 apply num 8 migration [0 5]
005'987 31 S200 used size: 913 / 300 
005'987 29 S200 do snapshot for raft 47 47,size 454
005'993 27 S0 raft apply snapshot offset 47 ,lastApplied 49,total log 49, size 747,log cap:3
005'993 27 S0 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83"}, NextSeq:map[int64]int{1679014388048817729:25, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:6}}}}, Num:8}, Num:0}}
005'993 31 S200 after snap shot size747 454
005'993 30 S200 apply index 48 key num 0 type 5   lastApplied 47
005'993 35 S200 apply num 8 migration [0 5]
005'993 31 S200 used size: 747 / 300 
005'993 29 S200 do snapshot for raft 48 48,size 454
005'994 27 S0 raft apply snapshot offset 48 ,lastApplied 49,total log 49, size 581,log cap:2
005'994 27 S0 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83"}, NextSeq:map[int64]int{1679014388048817729:25, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:6}}}}, Num:8}, Num:0}}
005'994 31 S200 after snap shot size581 454
005'994 30 S200 apply index 49 key num 0 type 5   lastApplied 48
005'994 35 S200 apply num 8 migration [0 5]
005'994 31 S200 used size: 581 / 300 
005'995 29 S200 do snapshot for raft 49 49,size 454
005'995 27 S0 raft apply snapshot offset 49 ,lastApplied 49,total log 49, size 82,log cap:1
005'995 31 S200 after snap shot size82 454
005'995 35 S202 current config num 8 done
006'001 30 S101 apply index 111 key num 0 type 4   lastApplied 110
006'001 34 S101 apply new config num 9 :&{9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
006'001 34 S101 inited need send [],need recv [1 2 3 4 6]
006'001 31 S101 used size: 418 / 300 
006'002 29 S101 do snapshot for raft 111 111,size 603
006'002 27 S1 raft apply snapshot offset 111 ,lastApplied 111,total log 111, size 84,log cap:1
006'002 31 S101 after snap shot size84 603
006'002 30 S100 apply index 111 key num 0 type 4   lastApplied 110
006'002 34 S100 apply new config num 9 :&{9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
006'003 34 S100 inited need send [],need recv [1 2 3 4 6]
006'003 31 S100 used size: 418 / 300 
006'003 29 S100 do snapshot for raft 111 111,size 603
006'003 27 S0 raft apply snapshot offset 111 ,lastApplied 111,total log 111, size 84,log cap:1
006'004 31 S100 after snap shot size84 603
006'004 35 S300 current config num 8 done
006'011 35 S302 current config num 8 done
006'020 35 S100 num 9 waiting [1 2 3 4 6] shards 
006'020 35 S102 num 9 waiting [1 2 3 4 6] shards 
006'021 35 S101 num 9 waiting [1 2 3 4 6] shards 
006'036 35 S201 current config num 8 done
006'049 35 S200 current config num 8 done
006'050 35 S301 current config num 8 done
006'050 35 S202 current config num 8 done
006'056 35 S300 current config num 8 done
006'074 35 S101 num 9 waiting [1 2 3 4 6] shards 
006'074 35 S302 current config num 8 done
006'074 35 S102 num 9 waiting [1 2 3 4 6] shards 
006'076 35 S100 num 9 waiting [1 2 3 4 6] shards 
join &{map[102:[server-102-0 server-102-1 server-102-2]] 1074585914363486070 9}
006'095 35 S201 current config num 8 done
join &{map[102:[server-102-0 server-102-1 server-102-2]] 1074585914363486070 9}
006'100 35 S202 current config num 8 done
006'101 35 S200 current config num 8 done
006'101 35 S301 current config num 8 done
006'109 35 S300 current config num 8 done
006'124 35 S101 num 9 waiting [1 2 3 4 6] shards 
006'124 35 S302 current config num 8 done
006'124 35 S102 num 9 waiting [1 2 3 4 6] shards 
006'130 35 S100 num 9 waiting [1 2 3 4 6] shards 
006'146 35 S201 current config num 8 done
006'151 35 S202 current config num 8 done
006'151 35 S200 current config num 8 done
006'152 35 S301 current config num 8 done
006'162 35 S300 current config num 8 done
006'180 35 S100 num 9 waiting [1 2 3 4 6] shards 
006'182 35 S302 current config num 8 done
006'182 35 S102 num 9 waiting [1 2 3 4 6] shards 
006'182 35 S101 num 9 waiting [1 2 3 4 6] shards 
006'197 35 S201 current config num 8 done
006'202 35 S202 current config num 8 done
006'202 35 S200 current config num 8 done
006'202 35 S301 current config num 8 done
006'218 35 S300 current config num 8 done
006'240 34 S300 got new config {9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 8
006'242 35 S102 num 9 waiting [1 2 3 4 6] shards 
006'242 35 S100 num 9 waiting [1 2 3 4 6] shards 
006'242 35 S302 current config num 8 done
006'242 35 S101 num 9 waiting [1 2 3 4 6] shards 
006'248 35 S201 current config num 8 done
006'251 28 S100 do request args:Key 6 type 3 num 9 Client 542732653461723544 Seq 4 
006'251 28 S100 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'253 28 S101 do request args:Key 6 type 3 num 9 Client 542732653461723544 Seq 4 
006'253 28 S101 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'253 35 S301 current config num 8 done
006'253 35 S202 current config num 8 done
006'253 35 S200 current config num 8 done
006'254 28 S102 do request args:Key 6 type 3 num 9 Client 542732653461723544 Seq 4 
006'254 28 S102 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'268 35 S300 current config num 8 done
join &{map[102:[server-102-0 server-102-1 server-102-2]] 1074585914363486070 9}
006'296 35 S302 current config num 8 done
006'296 35 S102 num 9 waiting [1 2 3 4 6] shards 
006'296 35 S100 num 9 waiting [1 2 3 4 6] shards 
006'296 35 S101 num 9 waiting [1 2 3 4 6] shards 
006'298 35 S201 current config num 8 done
006'306 34 S200 got new config {8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 7
006'307 35 S200 current config num 8 done
006'307 35 S202 current config num 8 done
006'307 35 S301 current config num 8 done
006'309 28 S100 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 17 
006'309 28 S100 declined [479--17] for not leader
006'309 28 S100 [479--17] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'310 28 S101 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 17 
006'310 28 S101 declined [479--17] for not leader
006'310 28 S101 [479--17] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'310 28 S100 do request args:Key 9 type 3 num 9 Client 3620950086299709532 Seq 10 
006'310 28 S100 declined [532--10] for not leader
006'310 28 S100 [532--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'311 34 S101 got new config {9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 8
006'312 34 S301 got new config {9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 8
006'312 28 S100 do request args:Key 7 type 3 num 9 Client 2972145661651991667 Seq 6 
006'312 28 S100 declined [667--6] for not leader
006'312 28 S100 [667--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'313 28 S102 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 17 
006'313 33 S102 start [479--17] as leader?
006'312 28 S101 do request args:Key 9 type 3 num 9 Client 3620950086299709532 Seq 10 
006'314 28 S101 declined [532--10] for not leader
006'314 28 S101 [532--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'315 28 S102 do request args:Key 9 type 3 num 9 Client 3620950086299709532 Seq 10 
006'316 33 S102 start [532--10] as leader?
006'316 28 S101 do request args:Key 7 type 3 num 9 Client 2972145661651991667 Seq 6 
006'317 28 S101 declined [667--6] for not leader
006'317 28 S101 [667--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'321 35 S300 current config num 8 done
006'322 28 S102 do request args:Key 7 type 3 num 9 Client 2972145661651991667 Seq 6 
006'323 33 S102 start [667--6] as leader?
006'325 30 S102 apply index 112 key1 num 9 type 3   lastApplied 111
006'325 31 S102 used size: 350 / 300 
006'325 29 S102 do snapshot for raft 112 112,size 604
006'326 27 S2 raft apply snapshot offset 112 ,lastApplied 113,total log 114, size 287,log cap:3
006'326 27 S2 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"9", ClientID:3620950086299709532, Seq:10, OptType:3, Opt:"k", Num:9}}
006'326 31 S102 after snap shot size287 604
006'326 30 S102 apply index 113 key9 num 9 type 3   lastApplied 112
006'326 28 S102 [479--17] successed
006'326 28 S102 [479--17] ok 
006'326 28 S102 [479--17] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
006'326 28 S102 [532--10] successed
006'327 28 S102 [532--10] ok 
006'327 28 S102 [532--10] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
006'327 36 S532 [10] clerk putAppend okkkkk
006'328 28 S100 do request args:Key 9 type 3 num 9 Client 3620950086299709532 Seq 11 
006'328 28 S100 declined [532--11] for not leader
006'328 28 S100 [532--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'333 28 S100 do request args:Key 3 type 3 num 9 Client 2238025532150463055 Seq 8 
006'333 28 S100 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'338 28 S100 do request args:Key 4 type 3 num 9 Client 132246879705026825 Seq 6 
006'338 28 S100 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'339 28 S101 do request args:Key 4 type 3 num 9 Client 132246879705026825 Seq 6 
006'339 28 S101 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'341 28 S102 do request args:Key 4 type 3 num 9 Client 132246879705026825 Seq 6 
006'341 28 S102 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'341 34 S300 check new config wanted 9
006'352 28 S101 do request args:Key 3 type 3 num 9 Client 2238025532150463055 Seq 8 
006'352 28 S101 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'353 28 S102 do request args:Key 3 type 3 num 9 Client 2238025532150463055 Seq 8 
006'353 28 S102 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'354 35 S201 current config num 8 done
006'354 35 S102 num 9 waiting [1 2 3 4 6] shards 
006'354 35 S100 num 9 waiting [1 2 3 4 6] shards 
006'358 44 S2 ctrler change to config &{10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
006'359 36 S479 [17] clerk putAppend okkkkk
006'361 35 S101 num 9 waiting [1 2 3 4 6] shards 
006'362 28 S100 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 18 
006'362 28 S100 declined [479--18] for not leader
006'362 28 S100 [479--18] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'364 28 S101 do request args:Key 9 type 3 num 9 Client 3620950086299709532 Seq 11 
006'364 28 S101 declined [532--11] for not leader
006'364 28 S101 [532--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'366 30 S101 apply index 112 key1 num 9 type 3   lastApplied 111
006'366 31 S101 used size: 350 / 300 
006'367 29 S101 do snapshot for raft 112 112,size 604
006'367 35 S200 current config num 8 done
006'367 35 S202 current config num 8 done
006'367 35 S301 current config num 8 done
006'369 27 S1 raft apply snapshot offset 112 ,lastApplied 113,total log 114, size 287,log cap:3
006'369 27 S1 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"9", ClientID:3620950086299709532, Seq:10, OptType:3, Opt:"k", Num:9}}
006'369 31 S101 after snap shot size287 604
006'369 30 S101 apply index 113 key9 num 9 type 3   lastApplied 112
join &{map[101:[server-101-0 server-101-1 server-101-2]] 1074585914363486070 10}
006'370 30 S102 apply index 114 key7 num 9 type 3   lastApplied 113
006'371 28 S102 [667--6] successed
006'371 28 S102 [667--6] ok 
006'371 28 S102 [667--6] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
006'354 35 S302 current config num 8 done
006'377 28 S101 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 18 
006'377 28 S101 declined [479--18] for not leader
006'377 28 S101 [479--18] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'377 36 S667 [6] clerk putAppend okkkkk
006'377 35 S300 current config num 8 done
006'378 30 S100 apply index 112 key1 num 9 type 3   lastApplied 111
006'378 31 S100 used size: 350 / 300 
006'379 29 S100 do snapshot for raft 112 112,size 604
006'380 27 S0 raft apply snapshot offset 112 ,lastApplied 113,total log 114, size 287,log cap:3
006'380 27 S0 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"9", ClientID:3620950086299709532, Seq:10, OptType:3, Opt:"k", Num:9}}
006'380 31 S100 after snap shot size287 604
006'380 30 S100 apply index 113 key9 num 9 type 3   lastApplied 112
006'381 28 S102 do request args:Key 9 type 3 num 9 Client 3620950086299709532 Seq 11 
006'381 33 S102 start [532--11] as leader?
join &{map[101:[server-101-0 server-101-1 server-101-2]] 1074585914363486070 10}
006'383 28 S102 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 18 
006'383 28 S100 do request args:Key 7 type 3 num 9 Client 2972145661651991667 Seq 7 
006'383 28 S100 declined [667--7] for not leader
006'383 28 S100 [667--7] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'383 33 S102 start [479--18] as leader?
006'387 28 S101 do request args:Key 7 type 3 num 9 Client 2972145661651991667 Seq 7 
006'387 28 S101 declined [667--7] for not leader
006'387 28 S101 [667--7] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'388 28 S102 do request args:Key 7 type 3 num 9 Client 2972145661651991667 Seq 7 
006'389 33 S102 start [667--7] as leader?
006'390 30 S100 apply index 114 key7 num 9 type 3   lastApplied 113
006'390 31 S100 used size: 412 / 300 
006'391 29 S100 do snapshot for raft 114 114,size 606
006'391 27 S0 raft apply snapshot offset 114 ,lastApplied 114,total log 116, size 287,log cap:3
006'391 31 S100 after snap shot size287 606
006'392 30 S102 apply index 115 key9 num 9 type 3   lastApplied 114
006'392 31 S102 used size: 475 / 300 
006'392 29 S102 do snapshot for raft 115 115,size 607
006'393 27 S2 raft apply snapshot offset 115 ,lastApplied 116,total log 117, size 287,log cap:3
006'393 27 S2 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"1", ClientID:418781717203629479, Seq:18, OptType:3, Opt:"V", Num:9}}
006'393 31 S102 after snap shot size287 607
006'393 30 S102 apply index 116 key1 num 9 type 3   lastApplied 115
006'393 28 S102 [479--18] successed
006'393 28 S102 [479--18] ok 
006'393 28 S102 [479--18] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
006'393 36 S479 [18] clerk putAppend okkkkk
006'394 28 S102 [532--11] successed
006'394 28 S102 [532--11] ok 
006'394 28 S102 [532--11] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
006'394 30 S101 apply index 114 key7 num 9 type 3   lastApplied 113
006'394 31 S101 used size: 412 / 300 
006'395 28 S100 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 19 
006'395 28 S100 declined [479--19] for not leader
006'395 28 S100 [479--19] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'395 29 S101 do snapshot for raft 114 114,size 606
006'395 36 S532 [11] clerk putAppend okkkkk
006'395 27 S1 raft apply snapshot offset 114 ,lastApplied 114,total log 116, size 287,log cap:3
006'395 31 S101 after snap shot size287 606
006'400 28 S100 do request args:Key 9 type 3 num 9 Client 3620950086299709532 Seq 12 
006'400 28 S100 declined [532--12] for not leader
006'400 28 S100 [532--12] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'404 28 S100 do request args:Key 8 type 3 num 9 Client 2953714763196401582 Seq 2 
006'404 28 S100 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'406 28 S101 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 19 
006'406 28 S101 declined [479--19] for not leader
006'406 28 S101 [479--19] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'406 34 S200 check new config wanted 9
006'407 29 S101 recv Installsnapshot 115 114
006'408 35 S102 num 9 waiting [1 2 3 4 6] shards 
006'408 35 S201 current config num 8 done
006'408 35 S100 num 9 waiting [1 2 3 4 6] shards 
006'408 34 S102 check new config wanted 10
006'410 30 S102 apply index 117 key7 num 9 type 3   lastApplied 116
006'410 28 S102 [667--7] successed
006'410 28 S102 [667--7] ok 
006'410 28 S102 [667--7] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
006'412 28 S102 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 19 
join &{map[101:[server-101-0 server-101-1 server-101-2]] 1074585914363486070 10}
006'414 30 S100 apply index 115 key9 num 9 type 3   lastApplied 114
006'414 31 S100 used size: 350 / 300 
006'415 29 S100 do snapshot for raft 115 115,size 607
006'415 27 S0 raft apply snapshot offset 115 ,lastApplied 116,total log 117, size 287,log cap:3
006'415 27 S0 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"1", ClientID:418781717203629479, Seq:18, OptType:3, Opt:"V", Num:9}}
006'415 31 S100 after snap shot size287 607
006'415 30 S100 apply index 116 key1 num 9 type 3   lastApplied 115
006'416 36 S667 [7] clerk putAppend okkkkk
006'416 27 S1 raft apply snapshot offset 115 ,lastApplied 115,total log 116, size 225,log cap:2
006'416 29 S101 decide Installsnapshot 115 <- 114
006'418 30 S101 install snap index 115,config {9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 pending shards [false true true true true false true false false false]
006'419 28 S101 do request args:Key 9 type 3 num 9 Client 3620950086299709532 Seq 12 
006'420 28 S101 declined [532--12] for not leader
006'420 28 S101 [532--12] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'421 28 S101 do request args:Key 8 type 3 num 9 Client 2953714763196401582 Seq 2 
006'421 28 S101 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'422 34 S302 got new config {9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 8
006'423 35 S101 num 9 waiting [1 2 3 4 6] shards 
006'424 34 S101 check new config wanted 10
006'425 35 S301 current config num 8 done
006'425 34 S301 check new config wanted 9
006'425 35 S202 current config num 8 done
006'425 35 S200 current config num 8 done
006'428 34 S302 propose new config 9
006'431 33 S102 start [479--19] as leader?
006'432 34 S100 got new config {8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 7
006'433 35 S302 current config num 8 done
006'434 28 S102 do request args:Key 8 type 3 num 9 Client 2953714763196401582 Seq 2 
006'434 28 S102 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'434 28 S100 do request args:Key 2 type 3 num 9 Client 1679014388048817729 Seq 25 
006'434 28 S100 declined [729--25] for not leader
006'434 28 S100 [729--25] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'440 35 S300 current config num 8 done
006'440 28 S100 do request args:Key 7 type 3 num 9 Client 2972145661651991667 Seq 8 
006'440 28 S100 declined [667--8] for not leader
006'440 28 S100 [667--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'441 34 S202 got new config {9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 8
006'441 34 S202 propose new config 9
006'453 28 S102 do request args:Key 9 type 3 num 9 Client 3620950086299709532 Seq 12 
006'454 33 S102 start [532--12] as leader?
006'467 44 S0 ctrler change to config &{10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
006'475 35 S301 current config num 8 done
006'475 35 S202 current config num 8 done
006'475 35 S200 current config num 8 done
006'481 35 S101 num 9 waiting [1 2 3 4 6] shards 
006'484 35 S102 num 9 waiting [1 2 3 4 6] shards 
006'459 35 S201 current config num 8 done
006'483 44 S1 ctrler change to config &{10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
006'488 30 S102 apply index 118 key1 num 9 type 3   lastApplied 117
006'489 31 S102 used size: 412 / 300 
006'490 35 S300 current config num 8 done
006'496 35 S302 current config num 8 done
006'502 30 S302 apply index 22 key num 0 type 4   lastApplied 21
006'503 34 S302 apply new config num 9 :&{9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
006'503 34 S302 inited need send [1 2 3 4 6],need recv []
006'503 31 S302 used size: 416 / 300 
006'503 29 S302 do snapshot for raft 22 22,size 558
006'504 27 S2 raft apply snapshot offset 22 ,lastApplied 22,total log 22, size 82,log cap:1
006'504 31 S302 after snap shot size82 558
006'505 34 S201 got new config {8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 7
006'505 28 S101 do request args:Key 7 type 3 num 9 Client 2972145661651991667 Seq 8 
006'506 28 S101 declined [667--8] for not leader
006'506 28 S101 [667--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'507 44 S2 ctrler change to config &{11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
006'484 35 S100 num 9 waiting [1 2 3 4 6] shards 
006'512 28 S100 do request args:Key 5 type 3 num 9 Client 3482757038087095369 Seq 5 
006'512 28 S100 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'512 30 S101 apply index 116 key1 num 9 type 3   lastApplied 115
006'512 31 S101 used size: 412 / 300 
006'512 30 S100 apply index 117 key7 num 9 type 3   lastApplied 116
006'512 31 S100 used size: 350 / 300 
006'519 30 S202 apply index 50 key num 0 type 4   lastApplied 49
006'519 34 S202 apply new config num 9 :&{9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
006'519 34 S202 inited need send [],need recv []
006'519 31 S202 used size: 416 / 300 
006'520 29 S202 do snapshot for raft 50 50,size 412
006'520 27 S2 raft apply snapshot offset 50 ,lastApplied 50,total log 50, size 82,log cap:1
006'520 31 S202 after snap shot size82 412
006'523 44 S0 ctrler change to config &{11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
006'525 35 S301 current config num 8 done
006'525 35 S202 current config num 9 done
006'525 35 S200 current config num 8 done
006'527 29 S100 do snapshot for raft 117 117,size 609
006'527 27 S0 raft apply snapshot offset 117 ,lastApplied 117,total log 119, size 287,log cap:3
006'527 31 S100 after snap shot size287 609
006'528 29 S102 do snapshot for raft 118 118,size 610
006'529 27 S2 raft apply snapshot offset 118 ,lastApplied 119,total log 119, size 225,log cap:2
006'529 27 S2 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"9", ClientID:3620950086299709532, Seq:12, OptType:3, Opt:"x", Num:9}}
006'529 31 S102 after snap shot size225 610
006'529 30 S102 apply index 119 key9 num 9 type 3   lastApplied 118
006'529 28 S102 do request args:Key 7 type 3 num 9 Client 2972145661651991667 Seq 8 
006'530 33 S102 start [667--8] as leader?
006'530 28 S102 [479--19] successed
006'530 28 S102 [479--19] ok 
006'530 28 S102 [479--19] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
006'532 28 S102 [532--12] successed
006'532 28 S102 [532--12] ok 
006'532 28 S102 [532--12] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
006'533 34 S302 check new config wanted 10
006'533 36 S479 [19] clerk putAppend okkkkk
006'534 36 S532 [12] clerk putAppend okkkkk
006'534 28 S100 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 20 
006'534 28 S100 declined [479--20] for not leader
006'534 28 S100 [479--20] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'535 29 S101 do snapshot for raft 116 116,size 608
006'536 34 S300 got new config {9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 8
006'536 27 S1 raft apply snapshot offset 116 ,lastApplied 117,total log 119, size 350,log cap:4
006'536 27 S1 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:7, OptType:3, Opt:"P", Num:9}}
006'536 31 S101 after snap shot size350 608
006'536 30 S101 apply index 117 key7 num 9 type 3   lastApplied 116
006'536 31 S101 used size: 350 / 300 
006'537 29 S101 do snapshot for raft 117 117,size 609
006'537 27 S1 raft apply snapshot offset 117 ,lastApplied 117,total log 119, size 287,log cap:3
006'537 31 S101 after snap shot size287 609
006'537 28 S101 do request args:Key 2 type 3 num 9 Client 1679014388048817729 Seq 25 
006'537 28 S101 declined [729--25] for not leader
006'537 28 S101 [729--25] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'538 28 S101 do request args:Key 5 type 3 num 9 Client 3482757038087095369 Seq 5 
006'538 28 S101 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'538 34 S100 check new config wanted 10
006'538 35 S101 num 9 waiting [1 2 3 4 6] shards 
006'538 35 S102 num 9 waiting [1 2 3 4 6] shards 
006'538 35 S201 current config num 8 done
006'540 35 S300 current config num 8 done
006'541 30 S101 apply index 118 key1 num 9 type 3   lastApplied 117
006'541 31 S101 used size: 350 / 300 
006'541 28 S100 do request args:Key 0 type 3 num 10 Client 940626237948413081 Seq 10 
006'541 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
006'541 29 S101 do snapshot for raft 118 118,size 610
006'542 34 S202 check new config wanted 10
006'542 27 S1 raft apply snapshot offset 118 ,lastApplied 119,total log 120, size 287,log cap:3
006'542 27 S1 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"9", ClientID:3620950086299709532, Seq:12, OptType:3, Opt:"x", Num:9}}
006'542 31 S101 after snap shot size287 610
006'542 30 S101 apply index 119 key9 num 9 type 3   lastApplied 118
006'548 44 S1 ctrler change to config &{11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
006'548 34 S101 got new config {10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 9
006'550 35 S302 num 9 sending shards [1 2 3 4 6] to group 100
006'555 28 S100 do request args:Key 9 type 3 num 9 Client 3620950086299709532 Seq 13 
006'556 28 S100 declined [532--13] for not leader
006'556 28 S100 [532--13] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'557 28 S101 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 20 
006'557 28 S101 declined [479--20] for not leader
006'557 28 S101 [479--20] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'558 28 S300 do request args:Key 6 type 3 num 11 Client 542732653461723544 Seq 4 
006'558 28 S300 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
006'559 35 S100 num 9 handle num 9 move rpc [1 2 3 4 6]
006'559 35 S100 move handle not leader
006'561 29 S301 recv Installsnapshot 22 21
006'561 27 S1 raft apply snapshot offset 22 ,lastApplied 22,total log 22, size 82,log cap:1
006'561 29 S301 decide Installsnapshot 22 <- 21
006'562 30 S301 install snap index 22,config {9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 pending shards [false true true true true false true false false false]
006'564 30 S100 apply index 118 key1 num 9 type 3   lastApplied 117
006'564 31 S100 used size: 350 / 300 
006'565 29 S100 do snapshot for raft 118 118,size 610
006'566 27 S0 raft apply snapshot offset 118 ,lastApplied 119,total log 120, size 287,log cap:3
006'566 27 S0 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"9", ClientID:3620950086299709532, Seq:12, OptType:3, Opt:"x", Num:9}}
006'566 31 S100 after snap shot size287 610
006'566 30 S100 apply index 119 key9 num 9 type 3   lastApplied 118
006'566 35 S100 num 9 waiting [1 2 3 4 6] shards 
006'567 28 S102 do request args:Key 2 type 3 num 9 Client 1679014388048817729 Seq 25 
006'567 33 S102 start [729--25] as leader?
006'568 30 S102 apply index 120 key7 num 9 type 3   lastApplied 119
006'568 31 S102 used size: 350 / 300 
006'569 29 S102 do snapshot for raft 120 120,size 612
006'569 27 S2 raft apply snapshot offset 120 ,lastApplied 120,total log 121, size 225,log cap:2
006'569 31 S102 after snap shot size225 612
006'569 28 S102 [667--8] successed
006'569 28 S102 [667--8] ok 
006'569 28 S102 [667--8] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
006'571 28 S102 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 20 
006'571 28 S101 do request args:Key 9 type 3 num 9 Client 3620950086299709532 Seq 13 
006'571 28 S101 declined [532--13] for not leader
006'571 33 S102 start [479--20] as leader?
006'576 28 S102 do request args:Key 5 type 3 num 9 Client 3482757038087095369 Seq 5 
006'576 28 S102 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'579 30 S100 apply index 120 key7 num 9 type 3   lastApplied 119
006'579 31 S100 used size: 412 / 300 
006'580 29 S100 do snapshot for raft 120 120,size 612
006'571 28 S101 [532--13] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'580 30 S102 apply index 121 key2 num 9 type 3   lastApplied 120
006'580 30 S102 apply index 122 key1 num 9 type 3   lastApplied 121
006'581 35 S101 num 9 handle num 9 move rpc [1 2 3 4 6]
006'571 30 S201 apply index 50 key num 0 type 4   lastApplied 49
006'582 28 S102 [729--25] successed
006'582 28 S102 [729--25] ok 
006'582 34 S201 apply new config num 9 :&{9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
006'582 28 S102 [729--25] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
006'582 34 S201 inited need send [],need recv []
006'582 31 S201 used size: 416 / 300 
006'582 28 S102 [479--20] successed
006'582 28 S102 [479--20] ok 
006'582 28 S102 [479--20] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
006'582 35 S101 move handle not leader
006'583 29 S201 do snapshot for raft 50 50,size 412
006'583 27 S1 raft apply snapshot offset 50 ,lastApplied 50,total log 50, size 82,log cap:1
006'583 31 S201 after snap shot size82 412
006'584 28 S102 do request args:Key 9 type 3 num 9 Client 3620950086299709532 Seq 13 
006'584 33 S102 start [532--13] as leader?
006'584 30 S200 apply index 50 key num 0 type 4   lastApplied 49
006'585 34 S200 apply new config num 9 :&{9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
006'585 34 S200 inited need send [],need recv []
006'585 31 S200 used size: 416 / 300 
006'585 29 S200 do snapshot for raft 50 50,size 412
006'585 30 S300 apply index 22 key num 0 type 4   lastApplied 21
006'585 27 S0 raft apply snapshot offset 50 ,lastApplied 50,total log 50, size 82,log cap:1
006'586 31 S200 after snap shot size82 412
006'585 34 S300 apply new config num 9 :&{9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{8 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
006'586 34 S300 inited need send [1 2 3 4 6],need recv []
006'586 31 S300 used size: 416 / 300 
006'572 36 S667 [8] clerk putAppend okkkkk
006'586 29 S300 do snapshot for raft 22 22,size 558
006'587 27 S0 raft apply snapshot offset 22 ,lastApplied 22,total log 22, size 82,log cap:1
006'587 31 S300 after snap shot size82 558
006'587 30 S101 apply index 120 key7 num 9 type 3   lastApplied 119
006'587 31 S101 used size: 412 / 300 
006'580 27 S0 raft apply snapshot offset 120 ,lastApplied 120,total log 122, size 287,log cap:3
006'587 31 S100 after snap shot size287 612
006'587 29 S101 do snapshot for raft 120 120,size 612
006'588 27 S1 raft apply snapshot offset 120 ,lastApplied 120,total log 122, size 287,log cap:3
006'588 31 S101 after snap shot size287 612
006'590 35 S202 current config num 9 done
006'590 35 S301 num 9 sending shards [1 2 3 4 6] to group 100
006'590 35 S200 current config num 9 done
006'590 35 S302 num 9 sending shards [1 2 3 4 6] to group 100
006'591 35 S100 num 9 handle num 9 move rpc [1 2 3 4 6]
006'591 35 S100 move handle not leader
006'595 28 S100 do request args:Key 7 type 3 num 9 Client 2972145661651991667 Seq 9 
006'595 28 S100 declined [667--9] for not leader
006'595 28 S100 [667--9] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'597 35 S101 num 9 waiting [1 2 3 4 6] shards 
006'598 35 S201 current config num 9 done
006'599 30 S102 apply index 123 key9 num 9 type 3   lastApplied 122
006'599 31 S102 used size: 350 / 300 
006'599 29 S102 do snapshot for raft 123 123,size 615
006'600 27 S2 raft apply snapshot offset 123 ,lastApplied 123,total log 123, size 84,log cap:1
006'600 31 S102 after snap shot size84 615
006'600 28 S102 [532--13] successed
006'600 28 S102 [532--13] ok 
006'600 28 S102 [532--13] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
006'600 30 S100 apply index 121 key2 num 9 type 3   lastApplied 120
006'600 30 S100 apply index 122 key1 num 9 type 3   lastApplied 121
006'601 30 S101 apply index 121 key2 num 9 type 3   lastApplied 120
006'601 31 S101 used size: 350 / 300 
006'601 29 S101 do snapshot for raft 121 121,size 613
006'602 27 S1 raft apply snapshot offset 121 ,lastApplied 122,total log 123, size 287,log cap:3
006'602 27 S1 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"1", ClientID:418781717203629479, Seq:20, OptType:3, Opt:"D", Num:9}}
006'602 31 S101 after snap shot size287 613
006'602 30 S101 apply index 122 key1 num 9 type 3   lastApplied 121
006'602 36 S532 [13] clerk putAppend okkkkk
006'605 35 S101 num 9 handle num 9 move rpc [1 2 3 4 6]
006'605 35 S101 move handle not leader
006'605 34 S201 check new config wanted 10
006'607 28 S101 do request args:Key 7 type 3 num 9 Client 2972145661651991667 Seq 9 
006'608 28 S101 declined [667--9] for not leader
006'608 28 S101 [667--9] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'608 28 S100 do request args:Key 9 type 3 num 9 Client 3620950086299709532 Seq 14 
006'608 28 S100 declined [532--14] for not leader
006'608 28 S100 [532--14] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'612 35 S102 num 9 handle num 9 move rpc [1 2 3 4 6]
006'613 35 S102 move handle num 9 shards [1 2 3 4 6] as leader?
006'614 35 S102 num 9 waiting [1 2 3 4 6] shards 
006'615 35 S102 num 9 handle num 9 move rpc [1 2 3 4 6]
006'615 35 S100 num 9 handle num 9 move rpc [1 2 3 4 6]
006'615 35 S100 move handle not leader
006'616 35 S300 num 9 sending shards [1 2 3 4 6] to group 100
006'617 35 S101 num 9 handle num 9 move rpc [1 2 3 4 6]
006'617 35 S101 move handle not leader
006'618 35 S100 num 9 handle num 9 move rpc [1 2 3 4 6]
006'618 35 S100 move handle not leader
006'619 35 S102 move handle num 9 shards [1 2 3 4 6] as leader?
006'620 36 S479 [20] clerk putAppend okkkkk
006'620 35 S100 num 9 waiting [1 2 3 4 6] shards 
006'620 35 S102 num 9 handle num 9 move rpc [1 2 3 4 6]
006'621 35 S102 move handle num 9 shards [1 2 3 4 6] as leader?
006'623 36 S729 [25] clerk putAppend okkkkk
006'623 28 S102 do request args:Key 7 type 3 num 9 Client 2972145661651991667 Seq 9 
006'624 33 S102 start [667--9] as leader?
006'628 35 S301 num 9 sending shards [1 2 3 4 6] to group 100
006'631 35 S302 num 9 sending shards [1 2 3 4 6] to group 100
006'636 35 S101 num 9 handle num 9 move rpc [1 2 3 4 6]
006'636 35 S101 move handle not leader
006'636 34 S300 check new config wanted 10
006'640 28 S100 do request args:Key 2 type 3 num 9 Client 1679014388048817729 Seq 26 
006'640 28 S100 declined [729--26] for not leader
006'640 28 S100 [729--26] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'640 28 S101 do request args:Key 9 type 3 num 9 Client 3620950086299709532 Seq 14 
006'640 28 S101 declined [532--14] for not leader
006'640 28 S101 [532--14] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'647 35 S102 num 9 handle num 9 move rpc [1 2 3 4 6]
006'648 35 S102 move handle num 9 shards [1 2 3 4 6] as leader?
006'648 35 S201 current config num 9 done
006'648 35 S101 num 9 waiting [1 2 3 4 6] shards 
006'649 28 S100 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 21 
006'649 28 S100 declined [479--21] for not leader
006'649 28 S100 [479--21] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'651 35 S100 num 9 handle num 9 move rpc [1 2 3 4 6]
006'658 30 S101 apply index 123 key9 num 9 type 3   lastApplied 122
006'658 31 S101 used size: 1390 / 300 
006'659 29 S101 do snapshot for raft 123 123,size 615
006'659 30 S102 apply index 124 key num 0 type 5   lastApplied 123
006'659 35 S102 apply num 9 migration [1 2 3 4 6]
006'659 30 S102 safely recv and decided shard 1
006'659 30 S102 safely recv and decided shard 2
006'659 30 S102 safely recv and decided shard 3
006'659 30 S102 safely recv and decided shard 4
006'659 30 S102 safely recv and decided shard 6
006'659 35 S300 num 9 sending shards [1 2 3 4 6] to group 100
006'650 35 S202 current config num 9 done
006'650 35 S200 current config num 9 done
006'667 35 S100 move handle not leader
006'667 30 S100 apply index 123 key9 num 9 type 3   lastApplied 122
006'667 31 S100 used size: 1452 / 300 
006'668 29 S100 do snapshot for raft 123 123,size 615
006'669 27 S0 raft apply snapshot offset 123 ,lastApplied 123,total log 127, size 1266,log cap:5
006'669 31 S100 after snap shot size1266 615
006'670 35 S100 num 9 handle num 9 move rpc [1 2 3 4 6]
006'670 35 S100 move handle not leader
006'672 35 S100 num 9 handle num 9 move rpc [1 2 3 4 6]
006'672 35 S100 move handle not leader
006'676 35 S301 num 9 sending shards [1 2 3 4 6] to group 100
006'659 31 S102 used size: 1529 / 300 
006'681 29 S102 do snapshot for raft 124 124,size 761
006'682 27 S2 raft apply snapshot offset 124 ,lastApplied 127,total log 128, size 1267,log cap:5
006'682 27 S2 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:9, OptType:3, Opt:"z", Num:9}}
006'682 31 S102 after snap shot size1267 761
006'682 30 S102 apply index 125 key num 0 type 5   lastApplied 124
006'682 35 S102 apply num 9 migration [1 2 3 4 6]
006'682 31 S102 used size: 1267 / 300 
006'683 29 S102 do snapshot for raft 125 125,size 761
006'684 27 S2 raft apply snapshot offset 125 ,lastApplied 127,total log 128, size 1005,log cap:4
006'684 27 S2 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:9, OptType:3, Opt:"z", Num:9}}
006'684 31 S102 after snap shot size1005 761
006'684 30 S102 apply index 126 key num 0 type 5   lastApplied 125
006'684 35 S102 apply num 9 migration [1 2 3 4 6]
006'684 31 S102 used size: 1005 / 300 
006'688 29 S102 do snapshot for raft 126 126,size 761
006'689 27 S2 raft apply snapshot offset 126 ,lastApplied 127,total log 128, size 743,log cap:3
006'689 27 S2 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:9, OptType:3, Opt:"z", Num:9}}
006'689 31 S102 after snap shot size743 761
006'689 30 S102 apply index 127 key7 num 9 type 3   lastApplied 126
006'689 31 S102 used size: 743 / 300 
006'690 29 S102 do snapshot for raft 127 127,size 762
006'690 27 S2 raft apply snapshot offset 127 ,lastApplied 127,total log 128, size 681,log cap:2
006'690 31 S102 after snap shot size681 762
006'690 28 S102 [667--9] successed
006'690 28 S102 [667--9] ok 
006'690 28 S102 [667--9] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
006'691 35 S102 num 9 move [1 2 3 4 6] is done yet
006'691 30 S301 after send shards ok
006'691 35 S301 move delete propose not leader
006'679 35 S100 num 9 waiting [1 2 3 4 6] shards 
006'680 35 S302 num 9 sending shards [1 2 3 4 6] to group 100
006'691 27 S1 raft apply snapshot offset 123 ,lastApplied 123,total log 128, size 1529,log cap:6
006'691 35 S102 num 9 move [1 2 3 4 6] is done yet
006'691 31 S101 after snap shot size1529 615
006'692 35 S102 num 9 move [1 2 3 4 6] is done yet
006'692 34 S101 check new config wanted 10
006'693 30 S302 after send shards ok
006'694 30 S102 apply index 128 key num 0 type 5   lastApplied 127
006'694 35 S102 apply num 9 migration [1 2 3 4 6]
006'694 31 S102 used size: 681 / 300 
006'694 35 S302 move delete propose num 9 shards [1 2 3 4 6] as leader?
006'694 29 S102 do snapshot for raft 128 128,size 763
006'695 27 S2 raft apply snapshot offset 128 ,lastApplied 128,total log 128, size 86,log cap:1
006'695 31 S102 after snap shot size86 763
006'695 30 S302 after send shards ok
006'696 35 S302 move delete propose num 9 shards [1 2 3 4 6] as leader?
006'696 36 S667 [9] clerk putAppend okkkkk
006'700 35 S300 num 9 sending shards [1 2 3 4 6] to group 100
006'695 28 S102 do request args:Key 9 type 3 num 9 Client 3620950086299709532 Seq 14 
006'701 33 S102 start [532--14] as leader?
006'702 35 S102 current config num 9 done
006'704 35 S102 num 9 move [1 2 3 4 6] is done yet
006'707 30 S300 after send shards ok
006'707 35 S300 move delete propose not leader
006'708 35 S101 num 9 waiting [1 2 3 4 6] shards 
006'709 35 S201 current config num 9 done
006'710 28 S101 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 21 
006'710 28 S101 declined [479--21] for not leader
006'710 28 S101 [479--21] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'700 28 S100 do request args:Key 7 type 3 num 9 Client 2972145661651991667 Seq 10 
006'710 28 S100 declined [667--10] for not leader
006'710 28 S100 [667--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'710 28 S101 do request args:Key 2 type 3 num 9 Client 1679014388048817729 Seq 26 
006'710 28 S101 declined [729--26] for not leader
006'711 28 S101 [729--26] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'712 35 S101 num 9 handle num 9 move rpc [1 2 3 4 6]
006'712 35 S101 move handle not leader
006'714 35 S101 num 9 handle num 9 move rpc [1 2 3 4 6]
006'714 35 S101 move handle not leader
006'716 35 S301 num 9 sending shards [1 2 3 4 6] to group 100
006'728 30 S302 apply index 23 key num 0 type 5   lastApplied 22
006'728 35 S302 apply num 9 migration [1 2 3 4 6]
006'729 30 S302 safely delete shard 1
006'729 30 S302 safely delete shard 2
006'729 30 S302 safely delete shard 3
006'729 30 S302 safely delete shard 4
006'729 30 S302 safely delete shard 6
006'729 31 S302 used size: 940 / 300 
006'729 29 S302 do snapshot for raft 23 23,size 412
006'730 27 S2 raft apply snapshot offset 23 ,lastApplied 24,total log 24, size 678,log cap:2
006'730 27 S2 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:9}, Num:0}}
006'730 31 S302 after snap shot size678 412
006'731 30 S302 apply index 24 key num 0 type 5   lastApplied 23
006'731 35 S302 apply num 9 migration [1 2 3 4 6]
006'731 31 S302 used size: 678 / 300 
006'731 29 S302 do snapshot for raft 24 24,size 412
006'731 27 S2 raft apply snapshot offset 24 ,lastApplied 24,total log 24, size 82,log cap:1
006'731 31 S302 after snap shot size82 412
006'734 35 S100 num 9 handle num 9 move rpc [1 2 3 4 6]
006'734 35 S100 move handle not leader
006'747 28 S102 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 21 
006'735 35 S302 current config num 9 done
006'762 33 S102 start [479--21] as leader?
006'762 30 S101 apply index 124 key num 0 type 5   lastApplied 123
006'762 35 S101 apply num 9 migration [1 2 3 4 6]
006'762 30 S101 safely recv and decided shard 1
006'762 30 S101 safely recv and decided shard 2
006'762 30 S101 safely recv and decided shard 3
006'762 30 S101 safely recv and decided shard 4
006'762 30 S101 safely recv and decided shard 6
006'762 31 S101 used size: 1591 / 300 
006'762 30 S102 apply index 129 key9 num 9 type 3   lastApplied 128
006'763 28 S102 [532--14] successed
006'763 28 S102 [532--14] ok 
006'763 28 S102 [532--14] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
006'763 29 S101 do snapshot for raft 124 124,size 761
006'764 36 S532 [14] clerk putAppend okkkkk
006'764 27 S1 raft apply snapshot offset 124 ,lastApplied 128,total log 129, size 1329,log cap:6
006'764 27 S1 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:9}, Num:0}}
006'765 31 S101 after snap shot size1329 761
006'765 30 S101 apply index 125 key num 0 type 5   lastApplied 124
006'765 35 S101 apply num 9 migration [1 2 3 4 6]
006'765 31 S101 used size: 1329 / 300 
006'767 29 S101 do snapshot for raft 125 125,size 761
006'768 27 S1 raft apply snapshot offset 125 ,lastApplied 128,total log 129, size 1067,log cap:5
006'768 27 S1 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:9}, Num:0}}
006'768 31 S101 after snap shot size1067 761
006'768 30 S101 apply index 126 key num 0 type 5   lastApplied 125
006'768 35 S101 apply num 9 migration [1 2 3 4 6]
006'769 31 S101 used size: 1067 / 300 
006'771 29 S101 do snapshot for raft 126 126,size 761
006'772 27 S1 raft apply snapshot offset 126 ,lastApplied 128,total log 129, size 805,log cap:4
006'772 27 S1 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:9}, Num:0}}
006'772 31 S101 after snap shot size805 761
006'772 30 S101 apply index 127 key7 num 9 type 3   lastApplied 126
006'772 31 S101 used size: 805 / 300 
006'775 35 S102 num 9 handle num 9 move rpc [1 2 3 4 6]
006'775 35 S102 num 9 move [1 2 3 4 6] is done yet
006'775 28 S102 do request args:Key 2 type 3 num 9 Client 1679014388048817729 Seq 26 
006'775 35 S201 current config num 9 done
006'775 33 S102 start [729--26] as leader?
006'776 35 S102 current config num 9 done
006'748 35 S202 current config num 9 done
006'748 35 S200 current config num 9 done
006'782 35 S100 num 9 handle num 9 move rpc [1 2 3 4 6]
006'782 35 S100 move handle not leader
006'782 29 S101 do snapshot for raft 127 127,size 762
006'782 35 S100 num 9 waiting [1 2 3 4 6] shards 
006'782 35 S300 num 9 sending shards [1 2 3 4 6] to group 100
006'783 35 S100 num 9 handle num 9 move rpc [1 2 3 4 6]
006'783 35 S100 move handle not leader
006'783 29 S100 recv Installsnapshot 128 123
006'783 30 S100 apply index 124 key num 0 type 5   lastApplied 123
006'783 35 S100 apply num 9 migration [1 2 3 4 6]
006'783 30 S100 safely recv and decided shard 1
006'783 30 S100 safely recv and decided shard 2
006'784 30 S100 safely recv and decided shard 3
006'784 30 S100 safely recv and decided shard 4
006'784 30 S100 safely recv and decided shard 6
006'784 31 S100 used size: 1715 / 300 
006'784 29 S100 do snapshot for raft 124 124,size 761
006'786 27 S0 raft apply snapshot offset 124 ,lastApplied 129,total log 131, size 1453,log cap:8
006'786 27 S0 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"9", ClientID:3620950086299709532, Seq:14, OptType:3, Opt:"l", Num:9}}
006'786 31 S100 after snap shot size1453 761
006'786 30 S100 apply index 125 key num 0 type 5   lastApplied 124
006'786 35 S100 apply num 9 migration [1 2 3 4 6]
006'786 31 S100 used size: 1453 / 300 
006'786 29 S100 do snapshot for raft 125 125,size 761
006'787 27 S0 raft apply snapshot offset 125 ,lastApplied 129,total log 131, size 1191,log cap:7
006'787 27 S0 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"9", ClientID:3620950086299709532, Seq:14, OptType:3, Opt:"l", Num:9}}
006'788 31 S100 after snap shot size1191 761
006'788 30 S100 apply index 126 key num 0 type 5   lastApplied 125
006'788 35 S100 apply num 9 migration [1 2 3 4 6]
006'788 31 S100 used size: 1191 / 300 
006'788 29 S100 do snapshot for raft 126 126,size 761
006'789 27 S0 raft apply snapshot offset 126 ,lastApplied 129,total log 131, size 929,log cap:6
006'789 27 S0 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"9", ClientID:3620950086299709532, Seq:14, OptType:3, Opt:"l", Num:9}}
006'789 31 S100 after snap shot size929 761
006'789 30 S100 apply index 127 key7 num 9 type 3   lastApplied 126
006'789 31 S100 used size: 929 / 300 
006'790 29 S100 do snapshot for raft 127 127,size 762
006'791 27 S0 raft apply snapshot offset 127 ,lastApplied 129,total log 131, size 867,log cap:5
006'791 27 S0 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"9", ClientID:3620950086299709532, Seq:14, OptType:3, Opt:"l", Num:9}}
006'791 31 S100 after snap shot size867 762
006'791 30 S100 apply index 128 key num 0 type 5   lastApplied 127
006'791 35 S100 apply num 9 migration [1 2 3 4 6]
006'791 31 S100 used size: 867 / 300 
006'792 29 S100 do snapshot for raft 128 128,size 763
006'793 27 S0 raft apply snapshot offset 128 ,lastApplied 129,total log 131, size 352,log cap:4
006'793 27 S0 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"9", ClientID:3620950086299709532, Seq:14, OptType:3, Opt:"l", Num:9}}
006'793 31 S100 after snap shot size352 763
006'793 30 S100 apply index 129 key9 num 9 type 3   lastApplied 128
006'793 31 S100 used size: 352 / 300 
006'794 29 S100 do snapshot for raft 129 129,size 764
006'794 27 S0 raft apply snapshot offset 129 ,lastApplied 129,total log 131, size 289,log cap:3
006'794 31 S100 after snap shot size289 764
006'795 28 S100 do request args:Key 9 type 3 num 9 Client 3620950086299709532 Seq 15 
006'795 28 S100 declined [532--15] for not leader
006'795 28 S100 [532--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'795 35 S301 num 9 sending shards [1 2 3 4 6] to group 100
006'796 30 S301 after send shards ok
006'796 35 S301 move delete propose not leader
006'796 35 S100 num 9 handle num 9 move rpc [1 2 3 4 6]
006'797 35 S100 num 9 move [1 2 3 4 6] is done yet
006'798 35 S100 num 9 handle num 9 move rpc [1 2 3 4 6]
006'798 35 S100 num 9 move [1 2 3 4 6] is done yet
006'798 30 S102 apply index 130 key1 num 9 type 3   lastApplied 129
006'799 31 S102 used size: 352 / 300 
006'800 29 S102 do snapshot for raft 130 130,size 765
006'800 27 S2 raft apply snapshot offset 130 ,lastApplied 131,total log 131, size 227,log cap:2
006'801 27 S2 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"2", ClientID:1679014388048817729, Seq:26, OptType:3, Opt:"B", Num:9}}
006'801 31 S102 after snap shot size227 765
006'801 30 S102 apply index 131 key2 num 9 type 3   lastApplied 130
006'801 28 S102 [729--26] successed
006'801 28 S102 [729--26] ok 
006'801 28 S102 [729--26] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
006'801 36 S729 [26] clerk putAppend okkkkk
006'806 35 S302 current config num 9 done
006'806 28 S102 [479--21] successed
006'806 28 S102 [479--21] ok 
006'806 28 S102 [479--21] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
006'807 36 S479 [21] clerk putAppend okkkkk
006'808 28 S100 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 22 
006'808 28 S100 declined [479--22] for not leader
006'808 28 S100 [479--22] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'809 35 S102 num 9 handle num 9 move rpc [1 2 3 4 6]
006'809 35 S102 num 9 move [1 2 3 4 6] is done yet
006'810 28 S100 do request args:Key 2 type 3 num 9 Client 1679014388048817729 Seq 27 
006'810 28 S100 declined [729--27] for not leader
006'810 28 S100 [729--27] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'812 35 S100 num 9 handle num 9 move rpc [1 2 3 4 6]
006'812 35 S100 num 9 move [1 2 3 4 6] is done yet
006'809 30 S300 after send shards ok
006'812 35 S300 move delete propose not leader
006'826 35 S201 current config num 9 done
006'826 35 S301 num 9 sending shards [1 2 3 4 6] to group 100
006'828 35 S100 num 9 handle num 9 move rpc [1 2 3 4 6]
006'828 35 S100 num 9 move [1 2 3 4 6] is done yet
006'829 30 S301 after send shards ok
006'829 35 S301 move delete propose not leader
006'829 35 S102 current config num 9 done
006'831 30 S301 after send shards ok
006'831 35 S301 move delete propose not leader
006'841 35 S202 current config num 9 done
006'841 35 S200 current config num 9 done
006'841 35 S100 current config num 9 done
006'844 30 S301 apply index 23 key num 0 type 5   lastApplied 22
006'844 35 S301 apply num 9 migration [1 2 3 4 6]
006'844 30 S301 safely delete shard 1
006'844 30 S301 safely delete shard 2
006'844 30 S301 safely delete shard 3
006'844 30 S301 safely delete shard 4
006'844 30 S301 safely delete shard 6
006'844 31 S301 used size: 940 / 300 
006'845 29 S301 do snapshot for raft 23 23,size 412
006'845 27 S1 raft apply snapshot offset 23 ,lastApplied 24,total log 24, size 678,log cap:2
006'845 27 S1 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:9}, Num:0}}
006'846 31 S301 after snap shot size678 412
006'846 30 S301 apply index 24 key num 0 type 5   lastApplied 23
006'846 35 S301 apply num 9 migration [1 2 3 4 6]
006'846 31 S301 used size: 678 / 300 
006'847 29 S301 do snapshot for raft 24 24,size 412
006'847 27 S1 raft apply snapshot offset 24 ,lastApplied 24,total log 24, size 82,log cap:1
006'847 31 S301 after snap shot size82 412
006'856 27 S1 raft apply snapshot offset 127 ,lastApplied 128,total log 129, size 743,log cap:3
006'856 27 S1 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:9}, Num:0}}
006'856 31 S101 after snap shot size743 762
006'856 30 S101 apply index 128 key num 0 type 5   lastApplied 127
006'856 35 S101 apply num 9 migration [1 2 3 4 6]
006'856 31 S101 used size: 743 / 300 
006'856 35 S302 current config num 9 done
006'818 30 S300 after send shards ok
006'857 35 S300 move delete propose not leader
006'857 35 S300 num 9 sending shards [1 2 3 4 6] to group 100
006'857 30 S300 after send shards ok
006'858 35 S300 move delete propose not leader
006'858 30 S300 apply index 23 key num 0 type 5   lastApplied 22
006'858 35 S300 apply num 9 migration [1 2 3 4 6]
006'858 30 S300 safely delete shard 1
006'858 30 S300 safely delete shard 2
006'858 30 S300 safely delete shard 3
006'858 30 S300 safely delete shard 4
006'858 30 S300 safely delete shard 6
006'858 31 S300 used size: 940 / 300 
006'858 35 S301 current config num 9 done
006'865 29 S101 do snapshot for raft 128 128,size 763
006'868 27 S1 raft apply snapshot offset 128 ,lastApplied 129,total log 131, size 352,log cap:4
006'868 27 S1 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"9", ClientID:3620950086299709532, Seq:14, OptType:3, Opt:"l", Num:9}}
006'868 31 S101 after snap shot size352 763
006'868 35 S101 current config num 9 done
006'870 35 S101 num 9 handle num 9 move rpc [1 2 3 4 6]
006'870 35 S101 num 9 move [1 2 3 4 6] is done yet
006'870 35 S101 num 9 handle num 9 move rpc [1 2 3 4 6]
006'870 35 S101 num 9 move [1 2 3 4 6] is done yet
006'870 28 S101 do request args:Key 7 type 3 num 9 Client 2972145661651991667 Seq 10 
006'870 28 S101 declined [667--10] for not leader
006'871 35 S101 num 9 handle num 9 move rpc [1 2 3 4 6]
006'871 35 S101 num 9 move [1 2 3 4 6] is done yet
006'871 28 S101 [667--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'872 28 S102 do request args:Key 7 type 3 num 9 Client 2972145661651991667 Seq 10 
006'873 33 S102 start [667--10] as leader?
006'875 28 S101 do request args:Key 9 type 3 num 9 Client 3620950086299709532 Seq 15 
006'875 28 S101 declined [532--15] for not leader
006'875 30 S101 apply index 129 key9 num 9 type 3   lastApplied 128
006'875 31 S101 used size: 352 / 300 
006'875 29 S101 do snapshot for raft 129 129,size 764
006'876 27 S1 raft apply snapshot offset 129 ,lastApplied 129,total log 131, size 289,log cap:3
006'876 31 S101 after snap shot size289 764
006'876 28 S101 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 22 
006'876 28 S101 declined [479--22] for not leader
006'876 35 S101 num 9 handle num 9 move rpc [1 2 3 4 6]
006'876 35 S101 num 9 move [1 2 3 4 6] is done yet
006'876 28 S101 do request args:Key 2 type 3 num 9 Client 1679014388048817729 Seq 27 
006'876 28 S101 declined [729--27] for not leader
006'876 28 S101 [729--27] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'877 28 S101 [532--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'877 28 S101 [479--22] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'882 35 S102 current config num 9 done
006'883 35 S201 current config num 9 done
006'889 29 S300 do snapshot for raft 23 23,size 412
006'889 27 S0 raft apply snapshot offset 23 ,lastApplied 24,total log 24, size 678,log cap:2
006'890 27 S0 last applied not snapshoted raft.LogEntry{Term:3, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:9}, Num:0}}
006'890 31 S300 after snap shot size678 412
006'890 30 S300 apply index 24 key num 0 type 5   lastApplied 23
006'890 35 S300 apply num 9 migration [1 2 3 4 6]
006'890 31 S300 used size: 678 / 300 
006'891 29 S300 do snapshot for raft 24 24,size 412
006'891 27 S0 raft apply snapshot offset 24 ,lastApplied 24,total log 24, size 82,log cap:1
006'891 31 S300 after snap shot size82 412
006'895 35 S202 current config num 9 done
006'895 35 S200 current config num 9 done
006'895 35 S100 current config num 9 done
006'895 35 S300 current config num 9 done
006'875 30 S301 after send shards ok
006'895 35 S301 num 9 move [1 2 3 4 6] is done yet
006'897 28 S102 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 22 
006'898 33 S102 start [479--22] as leader?
006'899 30 S302 after send shards ok
006'899 35 S302 num 9 move [1 2 3 4 6] is done yet
006'913 35 S100 num 9 handle num 9 move rpc [1 2 3 4 6]
006'914 35 S100 num 9 move [1 2 3 4 6] is done yet
006'914 30 S100 apply index 130 key1 num 9 type 3   lastApplied 129
006'919 31 S100 used size: 414 / 300 
006'907 35 S302 current config num 9 done
006'920 30 S302 after send shards ok
006'920 35 S302 num 9 move [1 2 3 4 6] is done yet
006'909 35 S301 current config num 9 done
006'921 30 S301 after send shards ok
006'921 35 S301 num 9 move [1 2 3 4 6] is done yet
006'921 29 S101 recv Installsnapshot 130 129
006'923 29 S100 do snapshot for raft 130 130,size 765
006'924 30 S102 apply index 132 key7 num 9 type 3   lastApplied 131
006'924 31 S102 used size: 352 / 300 
006'925 27 S0 raft apply snapshot offset 130 ,lastApplied 131,total log 133, size 352,log cap:4
006'926 27 S0 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"2", ClientID:1679014388048817729, Seq:26, OptType:3, Opt:"B", Num:9}}
006'926 31 S100 after snap shot size352 765
006'926 30 S100 apply index 131 key2 num 9 type 3   lastApplied 130
006'926 31 S100 used size: 352 / 300 
006'926 29 S100 do snapshot for raft 131 131,size 766
006'927 27 S0 raft apply snapshot offset 131 ,lastApplied 131,total log 133, size 289,log cap:3
006'927 31 S100 after snap shot size289 766
006'936 35 S201 current config num 9 done
006'945 35 S202 current config num 9 done
006'947 35 S100 current config num 9 done
006'947 35 S200 current config num 9 done
006'947 35 S300 current config num 9 done
006'948 34 S201 got new config {10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 9
006'950 27 S1 raft apply snapshot offset 130 ,lastApplied 130,total log 131, size 227,log cap:2
006'950 29 S101 decide Installsnapshot 130 <- 129
006'951 30 S101 install snap index 130,config {9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 pending shards [false false false false false false false false false false]
006'953 28 S300 do request args:Key 6 type 3 num 11 Client 542732653461723544 Seq 4 
006'957 28 S300 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
006'962 35 S101 current config num 9 done
006'964 30 S101 apply index 131 key2 num 9 type 3   lastApplied 130
006'964 31 S101 used size: 352 / 300 
006'964 29 S101 do snapshot for raft 131 131,size 766
006'965 27 S1 raft apply snapshot offset 131 ,lastApplied 131,total log 133, size 289,log cap:3
006'965 31 S101 after snap shot size289 766
006'968 34 S200 got new config {9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 8
006'970 34 S202 got new config {10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 9
006'971 34 S202 propose new config 10
006'972 34 S100 got new config {10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 9
006'975 35 S302 current config num 9 done
006'976 35 S301 current config num 9 done
006'976 34 S302 got new config {10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 9
006'977 34 S302 propose new config 10
006'982 30 S300 after send shards ok
006'982 35 S300 num 9 move [1 2 3 4 6] is done yet
006'982 29 S102 do snapshot for raft 132 132,size 767
006'983 27 S2 raft apply snapshot offset 132 ,lastApplied 133,total log 133, size 227,log cap:2
006'983 27 S2 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"1", ClientID:418781717203629479, Seq:22, OptType:3, Opt:"G", Num:9}}
006'983 31 S102 after snap shot size227 767
006'983 30 S102 apply index 133 key1 num 9 type 3   lastApplied 132
006'983 35 S102 current config num 9 done
006'988 34 S102 got new config {10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 9
006'988 28 S102 [667--10] successed
006'988 28 S102 [667--10] ok 
006'988 35 S201 current config num 9 done
006'988 28 S102 [479--22] successed
006'988 28 S102 [479--22] ok 
006'988 28 S102 [479--22] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
006'988 36 S479 [22] clerk putAppend okkkkk
006'989 28 S102 do request args:Key 9 type 3 num 9 Client 3620950086299709532 Seq 15 
006'989 33 S102 start [532--15] as leader?
006'989 28 S102 do request args:Key 2 type 3 num 9 Client 1679014388048817729 Seq 27 
006'990 33 S102 start [729--27] as leader?
006'991 34 S102 propose new config 10
006'991 28 S100 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 23 
006'991 28 S100 declined [479--23] for not leader
006'991 28 S100 [479--23] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'993 28 S101 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 23 
006'993 28 S101 declined [479--23] for not leader
006'993 28 S101 [479--23] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'994 28 S102 do request args:Key 1 type 3 num 9 Client 418781717203629479 Seq 23 
006'995 33 S102 start [479--23] as leader?
006'988 28 S102 [667--10] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
006'996 36 S667 [10] clerk putAppend okkkkk
006'996 28 S200 do request args:Key 8 type 3 num 11 Client 2953714763196401582 Seq 2 
006'996 28 S200 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
006'997 35 S202 current config num 9 done
006'998 28 S100 do request args:Key 7 type 3 num 9 Client 2972145661651991667 Seq 11 
006'998 28 S100 declined [667--11] for not leader
006'998 28 S100 [667--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
006'999 28 S101 do request args:Key 7 type 3 num 9 Client 2972145661651991667 Seq 11 
006'999 28 S101 declined [667--11] for not leader
006'999 28 S101 [667--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongLeader"}
007'001 28 S102 do request args:Key 7 type 3 num 9 Client 2972145661651991667 Seq 11 
007'001 33 S102 start [667--11] as leader?
007'005 35 S200 current config num 9 done
007'005 35 S100 current config num 9 done
007'005 35 S300 current config num 9 done
007'018 30 S101 apply index 132 key7 num 9 type 3   lastApplied 131
007'018 31 S101 used size: 835 / 300 
007'026 30 S100 apply index 132 key7 num 9 type 3   lastApplied 131
007'026 31 S100 used size: 835 / 300 
007'027 29 S100 do snapshot for raft 132 132,size 767
007'028 27 S0 raft apply snapshot offset 132 ,lastApplied 133,total log 138, size 773,log cap:7
007'028 27 S0 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"1", ClientID:418781717203629479, Seq:22, OptType:3, Opt:"G", Num:9}}
007'028 31 S100 after snap shot size773 767
007'028 30 S100 apply index 133 key1 num 9 type 3   lastApplied 132
007'028 31 S100 used size: 773 / 300 
007'029 29 S100 do snapshot for raft 133 133,size 768
007'029 27 S0 raft apply snapshot offset 133 ,lastApplied 133,total log 138, size 711,log cap:6
007'029 31 S100 after snap shot size711 768
007'031 30 S302 apply index 25 key num 0 type 4   lastApplied 24
007'031 34 S302 apply new config num 10 :&{10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
007'031 34 S302 inited need send [],need recv [0 1 2 3 4]
007'031 31 S302 used size: 459 / 300 
007'031 29 S302 do snapshot for raft 25 25,size 454
007'032 27 S2 raft apply snapshot offset 25 ,lastApplied 25,total log 25, size 82,log cap:1
007'032 31 S302 after snap shot size82 454
007'033 35 S102 current config num 9 done
007'040 30 S202 apply index 51 key num 0 type 4   lastApplied 50
007'040 34 S202 apply new config num 10 :&{10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
007'040 34 S202 inited need send [],need recv []
007'040 31 S202 used size: 459 / 300 
007'040 29 S202 do snapshot for raft 51 51,size 454
007'041 27 S2 raft apply snapshot offset 51 ,lastApplied 51,total log 51, size 82,log cap:1
007'041 31 S202 after snap shot size82 454
007'047 34 S301 got new config {9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 8
007'047 30 S102 apply index 134 key9 num 9 type 3   lastApplied 133
007'047 31 S102 used size: 773 / 300 
007'048 29 S101 do snapshot for raft 132 132,size 767
007'049 27 S1 raft apply snapshot offset 132 ,lastApplied 133,total log 138, size 773,log cap:7
007'049 27 S1 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"1", ClientID:418781717203629479, Seq:22, OptType:3, Opt:"G", Num:9}}
007'049 31 S101 after snap shot size773 767
007'049 30 S101 apply index 133 key1 num 9 type 3   lastApplied 132
007'049 31 S101 used size: 773 / 300 
007'049 35 S302 num 10 waiting [0 1 2 3 4] shards 
007'050 35 S301 current config num 9 done
007'050 29 S101 do snapshot for raft 133 133,size 768
007'051 27 S1 raft apply snapshot offset 133 ,lastApplied 133,total log 138, size 711,log cap:6
007'051 31 S101 after snap shot size711 768
007'052 29 S102 do snapshot for raft 134 134,size 769
007'052 27 S2 raft apply snapshot offset 134 ,lastApplied 138,total log 138, size 649,log cap:5
007'052 27 S2 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:11, OptType:3, Opt:"B", Num:9}}
007'052 31 S102 after snap shot size649 769
007'052 30 S102 apply index 135 key2 num 9 type 3   lastApplied 134
007'053 31 S102 used size: 649 / 300 
007'054 35 S202 current config num 10 done
007'055 35 S201 current config num 9 done
007'055 34 S201 check new config wanted 10
007'055 35 S200 current config num 9 done
007'056 35 S100 current config num 9 done
007'056 35 S300 current config num 9 done
007'058 35 S101 current config num 9 done
007'060 29 S102 do snapshot for raft 135 135,size 770
007'061 27 S2 raft apply snapshot offset 135 ,lastApplied 138,total log 138, size 587,log cap:4
007'061 27 S2 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:11, OptType:3, Opt:"B", Num:9}}
007'061 31 S102 after snap shot size587 770
007'061 30 S102 apply index 136 key num 0 type 4   lastApplied 135
007'061 34 S102 apply new config num 10 :&{10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
007'061 34 S102 inited need send [0 1 2 3 4],need recv []
007'061 31 S102 used size: 587 / 300 
007'062 29 S102 do snapshot for raft 136 136,size 812
007'066 27 S2 raft apply snapshot offset 136 ,lastApplied 138,total log 138, size 289,log cap:3
007'066 27 S2 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:11, OptType:3, Opt:"B", Num:9}}
007'066 31 S102 after snap shot size289 812
007'066 30 S102 apply index 137 key1 num 9 type 3   lastApplied 136
007'066 30 S102 apply index 138 key7 num 9 type 3   lastApplied 137
007'067 28 S102 [729--27] failed applied ava false
007'067 28 S102 [729--27] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
007'067 28 S102 [479--23] failed applied ava false
007'067 28 S102 [479--23] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
007'067 28 S102 [532--15] failed applied ava false
007'067 28 S102 [532--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
007'068 28 S102 [667--11] failed applied ava false
007'068 28 S102 [667--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
007'074 34 S202 check new config wanted 11
007'075 34 S200 check new config wanted 10
007'085 35 S102 num 10 sending shards [0 1 2 3 4] to group 102
007'086 35 S300 num 9 handle num 10 move rpc [0 1 2 3 4]
007'102 34 S102 check new config wanted 11
007'105 35 S202 current config num 10 done
007'105 35 S201 current config num 9 done
007'105 35 S301 current config num 9 done
007'106 35 S300 current config num 9 done
007'106 35 S200 current config num 9 done
007'108 35 S301 num 9 handle num 10 move rpc [0 1 2 3 4]
007'115 35 S102 num 10 sending shards [0 1 2 3 4] to group 102
007'117 35 S300 num 9 handle num 10 move rpc [0 1 2 3 4]
007'075 34 S100 check new config wanted 10
007'119 35 S100 current config num 9 done
007'079 34 S302 check new config wanted 11
007'129 35 S302 num 10 waiting [0 1 2 3 4] shards 
007'129 35 S302 num 10 handle num 10 move rpc [0 1 2 3 4]
007'130 35 S302 move handle num 10 shards [0 1 2 3 4] as leader?
007'135 28 S300 do request args:Key 4 type 3 num 11 Client 132246879705026825 Seq 6 
007'135 28 S300 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
007'137 35 S101 current config num 9 done
007'152 34 S301 check new config wanted 10
007'153 30 S300 apply index 25 key num 0 type 4   lastApplied 24
007'153 34 S300 apply new config num 10 :&{10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
007'153 34 S300 inited need send [],need recv [0 1 2 3 4]
007'153 31 S300 used size: 998 / 300 
007'154 29 S300 do snapshot for raft 25 25,size 454
007'154 35 S102 num 10 sending shards [0 1 2 3 4] to group 102
007'155 30 S301 apply index 25 key num 0 type 4   lastApplied 24
007'155 34 S301 apply new config num 10 :&{10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
007'155 34 S301 inited need send [],need recv [0 1 2 3 4]
007'155 31 S301 used size: 998 / 300 
007'155 30 S302 apply index 26 key num 0 type 5   lastApplied 25
007'155 35 S302 apply num 10 migration [0 1 2 3 4]
007'155 30 S302 safely recv and decided shard 0
007'155 30 S302 safely recv and decided shard 1
007'155 30 S302 safely recv and decided shard 2
007'155 30 S302 safely recv and decided shard 3
007'155 30 S302 safely recv and decided shard 4
007'155 31 S302 used size: 702 / 300 
007'156 35 S202 current config num 10 done
007'156 35 S201 current config num 9 done
007'156 35 S200 current config num 9 done
007'164 27 S0 raft apply snapshot offset 25 ,lastApplied 25,total log 26, size 702,log cap:2
007'164 31 S300 after snap shot size702 454
007'164 35 S300 num 10 waiting [0 1 2 3 4] shards 
007'165 28 S300 do request args:Key 3 type 3 num 11 Client 2238025532150463055 Seq 8 
007'165 28 S300 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
007'179 35 S300 num 10 handle num 10 move rpc [0 1 2 3 4]
007'180 35 S300 move handle not leader
007'188 35 S102 num 10 sending shards [0 1 2 3 4] to group 102
007'188 35 S100 current config num 9 done
007'190 35 S300 num 10 handle num 10 move rpc [0 1 2 3 4]
007'196 35 S300 move handle not leader
007'192 35 S101 current config num 9 done
007'193 30 S200 apply index 51 key num 0 type 4   lastApplied 50
007'198 34 S200 apply new config num 10 :&{10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
007'198 34 S200 inited need send [],need recv []
007'198 31 S200 used size: 459 / 300 
007'199 29 S200 do snapshot for raft 51 51,size 454
007'199 27 S0 raft apply snapshot offset 51 ,lastApplied 51,total log 51, size 82,log cap:1
007'199 31 S200 after snap shot size82 454
007'193 29 S301 do snapshot for raft 25 25,size 454
007'195 29 S302 do snapshot for raft 26 26,size 626
007'201 27 S2 raft apply snapshot offset 26 ,lastApplied 26,total log 26, size 82,log cap:1
007'201 31 S302 after snap shot size82 626
007'202 35 S302 num 10 move [0 1 2 3 4] is done yet
007'202 35 S302 current config num 10 done
007'204 30 S102 after send shards ok
007'205 35 S102 move delete propose num 10 shards [0 1 2 3 4] as leader?
007'207 35 S200 current config num 10 done
007'207 30 S201 apply index 51 key num 0 type 4   lastApplied 50
007'207 34 S201 apply new config num 10 :&{10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
007'207 34 S201 inited need send [],need recv []
007'207 35 S202 current config num 10 done
007'207 31 S201 used size: 459 / 300 
007'207 29 S201 do snapshot for raft 51 51,size 454
007'208 27 S1 raft apply snapshot offset 51 ,lastApplied 51,total log 51, size 82,log cap:1
007'208 31 S201 after snap shot size82 454
007'208 35 S201 current config num 10 done
007'217 30 S300 apply index 26 key num 0 type 5   lastApplied 25
007'217 35 S300 apply num 10 migration [0 1 2 3 4]
007'217 30 S300 safely recv and decided shard 0
007'217 30 S300 safely recv and decided shard 1
007'217 30 S300 safely recv and decided shard 2
007'217 30 S300 safely recv and decided shard 3
007'217 30 S300 safely recv and decided shard 4
007'217 31 S300 used size: 702 / 300 
007'219 30 S101 apply index 134 key9 num 9 type 3   lastApplied 133
007'219 31 S101 used size: 711 / 300 
007'219 35 S102 num 10 sending shards [0 1 2 3 4] to group 102
007'221 29 S300 do snapshot for raft 26 26,size 626
007'221 27 S0 raft apply snapshot offset 26 ,lastApplied 26,total log 26, size 82,log cap:1
007'221 31 S300 after snap shot size82 626
007'221 35 S300 current config num 10 done
007'228 27 S1 raft apply snapshot offset 25 ,lastApplied 25,total log 26, size 702,log cap:2
007'228 31 S301 after snap shot size702 454
007'228 35 S301 num 10 waiting [0 1 2 3 4] shards 
007'232 30 S301 apply index 26 key num 0 type 5   lastApplied 25
007'232 35 S301 apply num 10 migration [0 1 2 3 4]
007'232 30 S301 safely recv and decided shard 0
007'232 30 S301 safely recv and decided shard 1
007'233 30 S301 safely recv and decided shard 2
007'233 30 S301 safely recv and decided shard 3
007'233 30 S301 safely recv and decided shard 4
007'233 31 S301 used size: 702 / 300 
007'233 29 S301 do snapshot for raft 26 26,size 626
007'233 27 S1 raft apply snapshot offset 26 ,lastApplied 26,total log 26, size 82,log cap:1
007'233 31 S301 after snap shot size82 626
007'234 35 S301 num 10 handle num 10 move rpc [0 1 2 3 4]
007'234 35 S301 num 10 move [0 1 2 3 4] is done yet
007'234 29 S101 do snapshot for raft 134 134,size 769
007'235 27 S1 raft apply snapshot offset 134 ,lastApplied 138,total log 138, size 649,log cap:5
007'235 27 S1 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:11, OptType:3, Opt:"B", Num:9}}
007'235 31 S101 after snap shot size649 769
007'235 30 S101 apply index 135 key2 num 9 type 3   lastApplied 134
007'235 31 S101 used size: 649 / 300 
007'243 35 S100 current config num 9 done
007'243 35 S301 num 10 handle num 10 move rpc [0 1 2 3 4]
007'243 35 S301 num 10 move [0 1 2 3 4] is done yet
007'244 30 S102 after send shards ok
007'245 29 S101 do snapshot for raft 135 135,size 770
007'245 27 S1 raft apply snapshot offset 135 ,lastApplied 138,total log 138, size 587,log cap:4
007'245 27 S1 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:11, OptType:3, Opt:"B", Num:9}}
007'245 31 S101 after snap shot size587 770
007'245 30 S101 apply index 136 key num 0 type 4   lastApplied 135
007'245 34 S101 apply new config num 10 :&{10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
007'246 34 S101 inited need send [0 1 2 3 4],need recv []
007'246 31 S101 used size: 587 / 300 
007'246 35 S102 move delete propose num 10 shards [0 1 2 3 4] as leader?
007'246 35 S301 num 10 handle num 10 move rpc [0 1 2 3 4]
007'246 35 S301 num 10 move [0 1 2 3 4] is done yet
007'246 29 S101 do snapshot for raft 136 136,size 812
007'246 30 S102 after send shards ok
007'247 27 S1 raft apply snapshot offset 136 ,lastApplied 138,total log 138, size 289,log cap:3
007'247 27 S1 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:11, OptType:3, Opt:"B", Num:9}}
007'247 31 S101 after snap shot size289 812
007'247 30 S101 apply index 137 key1 num 9 type 3   lastApplied 136
007'247 30 S101 apply index 138 key7 num 9 type 3   lastApplied 137
007'257 35 S300 num 10 handle num 10 move rpc [0 1 2 3 4]
007'257 35 S300 num 10 move [0 1 2 3 4] is done yet
007'257 30 S100 apply index 134 key9 num 9 type 3   lastApplied 133
007'258 31 S100 used size: 711 / 300 
007'260 35 S200 current config num 10 done
007'260 35 S302 current config num 10 done
007'260 35 S101 num 10 sending shards [0 1 2 3 4] to group 102
007'262 29 S100 do snapshot for raft 134 134,size 769
007'263 27 S0 raft apply snapshot offset 134 ,lastApplied 138,total log 138, size 649,log cap:5
007'263 27 S0 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:11, OptType:3, Opt:"B", Num:9}}
007'263 31 S100 after snap shot size649 769
007'263 30 S100 apply index 135 key2 num 9 type 3   lastApplied 134
007'263 31 S100 used size: 649 / 300 
007'264 29 S100 do snapshot for raft 135 135,size 770
007'264 27 S0 raft apply snapshot offset 135 ,lastApplied 138,total log 138, size 587,log cap:4
007'265 27 S0 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:11, OptType:3, Opt:"B", Num:9}}
007'265 31 S100 after snap shot size587 770
007'265 30 S100 apply index 136 key num 0 type 4   lastApplied 135
007'265 34 S100 apply new config num 10 :&{10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{9 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
007'265 34 S100 inited need send [0 1 2 3 4],need recv []
007'265 31 S100 used size: 587 / 300 
007'265 29 S100 do snapshot for raft 136 136,size 812
007'266 27 S0 raft apply snapshot offset 136 ,lastApplied 138,total log 138, size 289,log cap:3
007'266 27 S0 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:11, OptType:3, Opt:"B", Num:9}}
007'266 31 S100 after snap shot size289 812
007'266 30 S100 apply index 137 key1 num 9 type 3   lastApplied 136
007'266 30 S100 apply index 138 key7 num 9 type 3   lastApplied 137
007'266 35 S102 move delete propose num 10 shards [0 1 2 3 4] as leader?
007'270 35 S202 current config num 10 done
007'271 35 S300 num 10 handle num 10 move rpc [0 1 2 3 4]
007'271 35 S300 num 10 move [0 1 2 3 4] is done yet
007'271 30 S101 after send shards ok
007'271 35 S101 move delete propose not leader
007'272 35 S201 current config num 10 done
007'274 35 S300 current config num 10 done
007'275 30 S102 apply index 139 key num 0 type 5   lastApplied 138
007'276 35 S102 apply num 10 migration [0 1 2 3 4]
007'276 30 S102 safely delete shard 0
007'276 30 S102 safely delete shard 1
007'276 30 S102 safely delete shard 2
007'276 30 S102 safely delete shard 3
007'276 30 S102 safely delete shard 4
007'276 31 S102 used size: 1404 / 300 
007'281 29 S102 do snapshot for raft 139 139,size 640
007'296 35 S100 num 10 sending shards [0 1 2 3 4] to group 102
007'297 27 S2 raft apply snapshot offset 139 ,lastApplied 139,total log 141, size 993,log cap:3
007'297 31 S102 after snap shot size993 640
007'309 35 S300 num 10 handle num 10 move rpc [0 1 2 3 4]
007'310 35 S300 num 10 move [0 1 2 3 4] is done yet
007'310 35 S101 num 10 sending shards [0 1 2 3 4] to group 102
007'297 30 S102 after send shards ok
007'311 35 S102 num 10 move [0 1 2 3 4] is done yet
007'311 35 S300 num 10 handle num 10 move rpc [0 1 2 3 4]
007'311 35 S300 num 10 move [0 1 2 3 4] is done yet
007'312 30 S101 after send shards ok
007'312 35 S101 move delete propose not leader
007'313 30 S100 after send shards ok
007'313 30 S101 apply index 139 key num 0 type 5   lastApplied 138
007'313 35 S101 apply num 10 migration [0 1 2 3 4]
007'313 30 S101 safely delete shard 0
007'313 30 S101 safely delete shard 1
007'313 30 S101 safely delete shard 2
007'313 30 S101 safely delete shard 3
007'313 35 S302 current config num 10 done
007'313 30 S101 safely delete shard 4
007'313 31 S101 used size: 1404 / 300 
007'314 29 S101 do snapshot for raft 139 139,size 640
007'298 35 S301 current config num 10 done
007'315 27 S1 raft apply snapshot offset 139 ,lastApplied 139,total log 141, size 993,log cap:3
007'315 31 S101 after snap shot size993 640
007'313 35 S200 current config num 10 done
007'315 30 S101 apply index 140 key num 0 type 5   lastApplied 139
007'315 35 S101 apply num 10 migration [0 1 2 3 4]
007'315 31 S101 used size: 993 / 300 
007'315 35 S100 move delete propose not leader
007'315 30 S100 apply index 139 key num 0 type 5   lastApplied 138
007'315 35 S100 apply num 10 migration [0 1 2 3 4]
007'315 30 S100 safely delete shard 0
007'315 30 S100 safely delete shard 1
007'315 30 S100 safely delete shard 2
007'316 30 S100 safely delete shard 3
007'316 30 S100 safely delete shard 4
007'316 31 S100 used size: 1404 / 300 
007'316 29 S101 do snapshot for raft 140 140,size 640
007'316 29 S100 do snapshot for raft 139 139,size 640
007'316 27 S1 raft apply snapshot offset 140 ,lastApplied 141,total log 141, size 706,log cap:2
007'316 27 S1 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:10}, Num:0}}
007'317 31 S101 after snap shot size706 640
007'317 30 S101 apply index 141 key num 0 type 5   lastApplied 140
007'317 35 S101 apply num 10 migration [0 1 2 3 4]
007'317 31 S101 used size: 706 / 300 
007'317 27 S0 raft apply snapshot offset 139 ,lastApplied 139,total log 141, size 993,log cap:3
007'317 31 S100 after snap shot size993 640
007'318 29 S101 do snapshot for raft 141 141,size 640
007'318 27 S1 raft apply snapshot offset 141 ,lastApplied 141,total log 141, size 86,log cap:1
007'318 31 S101 after snap shot size86 640
007'313 30 S102 after send shards ok
007'319 35 S102 num 10 move [0 1 2 3 4] is done yet
007'319 35 S102 current config num 10 done
007'319 30 S102 apply index 140 key num 0 type 5   lastApplied 139
007'319 35 S102 apply num 10 migration [0 1 2 3 4]
007'319 31 S102 used size: 993 / 300 
007'328 35 S100 current config num 10 done
007'339 35 S201 current config num 10 done
007'339 35 S202 current config num 10 done
007'341 29 S102 do snapshot for raft 140 140,size 640
007'341 27 S2 raft apply snapshot offset 140 ,lastApplied 141,total log 141, size 706,log cap:2
007'342 27 S2 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:10}, Num:0}}
007'342 31 S102 after snap shot size706 640
007'342 30 S102 apply index 141 key num 0 type 5   lastApplied 140
007'342 35 S102 apply num 10 migration [0 1 2 3 4]
007'342 31 S102 used size: 706 / 300 
007'343 29 S102 do snapshot for raft 141 141,size 640
007'343 27 S2 raft apply snapshot offset 141 ,lastApplied 141,total log 141, size 86,log cap:1
007'343 31 S102 after snap shot size86 640
007'343 35 S300 current config num 10 done
007'344 35 S101 current config num 10 done
007'344 32 S100 server killed######
007'344 32 S101 server killed######
007'344 32 S102 server killed######
007'344 32 S200 server killed######
007'344 32 S201 server killed######
007'344 32 S202 server killed######
007'344 32 S300 server killed######
007'344 32 S301 server killed######
007'344 32 S302 server killed######
007'345 30 S100 install snap index 139,config {10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
007'348 30 S101 install snap index 141,config {10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
007'354 30 S102 install snap index 141,config {10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
007'356 30 S200 install snap index 51,config {10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
007'366 35 S200 current config num 10 done
007'366 34 S100 check new config wanted 11
007'366 35 S101 current config num 10 done
007'368 34 S101 check new config wanted 11
007'368 35 S100 current config num 10 done
007'366 34 S102 check new config wanted 11
007'372 35 S102 current config num 10 done
007'366 34 S200 check new config wanted 11
007'384 30 S201 install snap index 51,config {10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
007'385 34 S201 check new config wanted 11
007'385 35 S201 current config num 10 done
007'388 30 S202 install snap index 51,config {10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
007'390 30 S300 install snap index 26,config {10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
007'391 34 S202 check new config wanted 11
007'400 35 S202 current config num 10 done
007'400 34 S300 check new config wanted 11
007'419 35 S100 current config num 10 done
007'419 35 S101 current config num 10 done
007'430 30 S301 install snap index 26,config {10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
007'432 35 S300 current config num 10 done
007'432 35 S200 current config num 10 done
007'439 35 S102 current config num 10 done
007'451 30 S302 install snap index 26,config {10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
007'454 35 S302 current config num 10 done
007'454 34 S302 check new config wanted 11
007'457 35 S301 current config num 10 done
007'457 34 S301 check new config wanted 11
007'459 35 S201 current config num 10 done
007'460 35 S202 current config num 10 done
007'478 35 S101 current config num 10 done
007'478 35 S100 current config num 10 done
007'483 35 S200 current config num 10 done
007'484 35 S300 current config num 10 done
007'492 35 S102 current config num 10 done
007'504 35 S302 current config num 10 done
007'510 35 S301 current config num 10 done
007'518 35 S201 current config num 10 done
007'518 35 S202 current config num 10 done
007'531 28 S200 do request args:Key 2 type 3 num 11 Client 1679014388048817729 Seq 27 
007'531 28 S200 [729--27] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
007'532 28 S100 do request args:Key 0 type 3 num 11 Client 940626237948413081 Seq 10 
007'532 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
007'532 28 S200 do request args:Key 7 type 3 num 11 Client 2972145661651991667 Seq 11 
007'532 28 S200 [667--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
007'533 28 S100 do request args:Key 1 type 3 num 11 Client 418781717203629479 Seq 23 
007'533 28 S100 [479--23] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
007'534 35 S300 current config num 10 done
007'534 35 S200 current config num 10 done
007'534 35 S101 current config num 10 done
007'556 35 S100 current config num 10 done
007'559 35 S102 current config num 10 done
007'559 35 S302 current config num 10 done
007'574 30 S200 nop apply <nil>
007'563 35 S301 current config num 10 done
007'568 35 S201 current config num 10 done
007'569 35 S202 current config num 10 done
007'593 35 S300 current config num 10 done
007'593 35 S200 current config num 10 done
007'593 35 S101 current config num 10 done
007'594 28 S300 do request args:Key 5 type 3 num 11 Client 3482757038087095369 Seq 5 
007'594 28 S300 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
007'616 35 S100 current config num 10 done
007'628 35 S302 current config num 10 done
007'643 35 S301 current config num 10 done
007'643 35 S202 current config num 10 done
007'643 35 S201 current config num 10 done
007'649 35 S102 current config num 10 done
007'665 35 S300 current config num 10 done
007'665 35 S101 current config num 10 done
007'666 35 S200 current config num 10 done
007'667 35 S100 current config num 10 done
007'696 30 S301 nop apply <nil>
007'698 35 S302 current config num 10 done
007'700 35 S102 current config num 10 done
007'701 35 S202 current config num 10 done
007'701 35 S301 current config num 10 done
007'701 35 S201 current config num 10 done
007'716 35 S101 current config num 10 done
007'716 35 S300 current config num 10 done
007'716 35 S200 current config num 10 done
007'720 35 S100 current config num 10 done
007'749 35 S302 current config num 10 done
007'754 35 S201 current config num 10 done
007'771 35 S102 current config num 10 done
007'771 35 S301 current config num 10 done
007'771 35 S202 current config num 10 done
007'771 35 S100 current config num 10 done
007'772 35 S300 current config num 10 done
007'780 28 S300 do request args:Key 6 type 3 num 11 Client 542732653461723544 Seq 4 
007'780 28 S300 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
007'772 35 S101 current config num 10 done
007'772 35 S200 current config num 10 done
007'802 35 S302 current config num 10 done
007'822 35 S201 current config num 10 done
007'829 35 S100 current config num 10 done
007'829 35 S102 current config num 10 done
007'829 35 S301 current config num 10 done
007'829 35 S202 current config num 10 done
007'846 35 S300 current config num 10 done
007'846 35 S101 current config num 10 done
007'846 35 S200 current config num 10 done
007'848 34 S200 got new config {11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 10
007'860 35 S302 current config num 10 done
007'868 28 S200 do request args:Key 8 type 3 num 11 Client 2953714763196401582 Seq 2 
007'868 28 S200 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
007'873 28 S100 do request args:Key 9 type 3 num 11 Client 3620950086299709532 Seq 15 
007'873 28 S100 [532--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
leave &{[101] 1074585914363486070 11}
007'873 35 S201 current config num 10 done
007'865 30 S202 nop apply <nil>
007'880 35 S100 current config num 10 done
007'880 35 S102 current config num 10 done
007'880 35 S301 current config num 10 done
007'880 35 S202 current config num 10 done
leave &{[101] 1074585914363486070 11}
007'887 34 S200 propose new config 11
007'887 30 S201 nop apply <nil>
007'896 30 S200 apply index 53 key num 0 type 4   lastApplied 52
007'896 34 S200 apply new config num 11 :&{11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
007'896 34 S200 inited need send [],need recv [0 5 6]
007'896 31 S200 used size: 506 / 300 
007'896 29 S200 do snapshot for raft 53 53,size 497
007'897 27 S0 raft apply snapshot offset 53 ,lastApplied 53,total log 53, size 82,log cap:1
007'897 31 S200 after snap shot size82 497
007'898 35 S300 current config num 10 done
007'898 35 S101 current config num 10 done
007'921 35 S302 current config num 10 done
007'925 35 S201 current config num 10 done
007'925 35 S200 num 11 waiting [0 5 6] shards 
007'935 35 S102 current config num 10 done
007'935 35 S100 current config num 10 done
007'935 35 S301 current config num 10 done
007'935 35 S202 current config num 10 done
007'949 35 S101 current config num 10 done
007'949 35 S300 current config num 10 done
007'972 35 S302 current config num 10 done
007'979 35 S201 current config num 10 done
007'979 35 S200 num 11 waiting [0 5 6] shards 
007'982 34 S100 got new config {11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 10
007'984 28 S300 do request args:Key 3 type 3 num 11 Client 2238025532150463055 Seq 8 
007'984 28 S300 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
007'985 28 S300 do request args:Key 4 type 3 num 11 Client 132246879705026825 Seq 6 
007'985 28 S300 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
007'986 34 S101 got new config {11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 10
leave &{[101] 1074585914363486070 11}
008'010 34 S202 got new config {11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 10
008'011 34 S102 got new config {11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 10
008'012 34 S201 got new config {11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 10
008'012 34 S200 check new config wanted 12
008'026 35 S102 current config num 10 done
008'026 35 S100 current config num 10 done
008'026 35 S301 current config num 10 done
008'026 35 S202 current config num 10 done
008'027 35 S101 current config num 10 done
008'027 35 S300 current config num 10 done
008'030 30 S302 nop apply <nil>
008'031 30 S300 nop apply <nil>
008'033 35 S200 num 11 waiting [0 5 6] shards 
008'033 35 S302 current config num 10 done
008'033 35 S201 current config num 10 done
008'044 28 S100 do request args:Key 1 type 3 num 11 Client 418781717203629479 Seq 23 
008'044 28 S100 [479--23] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
008'077 35 S301 current config num 10 done
008'077 35 S300 current config num 10 done
008'077 35 S102 current config num 10 done
008'078 35 S100 current config num 10 done
008'078 35 S202 current config num 10 done
008'078 35 S101 current config num 10 done
008'080 34 S300 got new config {11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 10
008'081 34 S301 got new config {11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 10
008'082 44 S2 ctrler change to config &{12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
008'087 34 S100 check new config wanted 11
008'087 34 S101 check new config wanted 11
008'090 34 S301 propose new config 11
008'091 28 S100 do request args:Key 0 type 3 num 11 Client 940626237948413081 Seq 10 
008'091 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
008'093 28 S100 do request args:Key 2 type 3 num 12 Client 1679014388048817729 Seq 27 
008'093 28 S100 [729--27] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
008'100 30 S301 apply index 28 key num 0 type 4   lastApplied 27
008'100 34 S301 apply new config num 11 :&{11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
008'101 34 S301 inited need send [0],need recv []
008'101 31 S301 used size: 506 / 300 
008'101 29 S301 do snapshot for raft 28 28,size 669
008'102 27 S1 raft apply snapshot offset 28 ,lastApplied 28,total log 28, size 82,log cap:1
008'102 31 S301 after snap shot size82 669
008'104 28 S100 do request args:Key 7 type 3 num 12 Client 2972145661651991667 Seq 11 
008'104 28 S100 [667--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
008'105 35 S302 current config num 10 done
008'105 28 S300 do request args:Key 5 type 3 num 12 Client 3482757038087095369 Seq 5 
008'105 28 S300 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
008'105 35 S201 current config num 10 done
008'105 35 S200 num 11 waiting [0 5 6] shards 
008'108 44 S1 ctrler change to config &{12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
008'114 34 S302 got new config {11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 10
008'114 34 S201 check new config wanted 11
008'114 34 S202 check new config wanted 11
008'115 34 S102 check new config wanted 11
008'123 44 S0 ctrler change to config &{12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
leave &{[102] 1074585914363486070 12}
008'128 35 S202 current config num 10 done
008'128 35 S301 num 11 sending shards [0] to group 101
008'128 35 S300 current config num 10 done
008'128 35 S102 current config num 10 done
008'128 35 S100 current config num 10 done
008'128 35 S101 current config num 10 done
008'136 35 S200 num 11 handle num 11 move rpc [0]
008'137 35 S200 move handle num 11 shards [0] as leader?
008'138 28 S300 do request args:Key 6 type 3 num 12 Client 542732653461723544 Seq 4 
008'138 28 S300 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
008'156 35 S200 num 11 waiting [0 5 6] shards 
008'156 35 S201 current config num 10 done
008'156 35 S302 current config num 10 done
008'156 30 S202 apply index 53 key num 0 type 4   lastApplied 52
008'156 34 S202 apply new config num 11 :&{11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
008'157 34 S202 inited need send [],need recv [0 5 6]
008'157 31 S202 used size: 888 / 300 
008'158 30 S201 apply index 53 key num 0 type 4   lastApplied 52
008'158 34 S201 apply new config num 11 :&{11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
008'158 35 S301 num 11 sending shards [0] to group 101
008'158 34 S201 inited need send [],need recv [0 5 6]
008'158 31 S201 used size: 888 / 300 
008'160 30 S200 apply index 54 key num 0 type 5   lastApplied 53
008'160 35 S200 apply num 11 migration [0]
008'160 30 S200 safely recv and decided shard 0
008'160 31 S200 used size: 545 / 300 
008'172 29 S202 do snapshot for raft 53 53,size 497
008'173 27 S2 raft apply snapshot offset 53 ,lastApplied 53,total log 54, size 545,log cap:2
008'173 31 S202 after snap shot size545 497
leave &{[102] 1074585914363486070 12}
008'194 35 S301 num 11 sending shards [0] to group 101
008'204 34 S301 check new config wanted 12
008'208 35 S202 num 11 waiting [0 5 6] shards 
008'209 29 S201 do snapshot for raft 53 53,size 497
008'210 27 S1 raft apply snapshot offset 53 ,lastApplied 53,total log 54, size 545,log cap:2
008'210 31 S201 after snap shot size545 497
008'210 35 S201 num 11 waiting [0 5 6] shards 
008'210 29 S200 do snapshot for raft 54 54,size 549
008'211 27 S0 raft apply snapshot offset 54 ,lastApplied 54,total log 54, size 82,log cap:1
008'211 31 S200 after snap shot size82 549
008'211 35 S200 num 11 move [0] is done yet
008'211 30 S301 after send shards ok
008'212 35 S301 move delete propose num 11 shards [0] as leader?
008'212 35 S102 current config num 10 done
008'212 35 S300 current config num 10 done
008'212 35 S101 current config num 10 done
008'212 35 S100 current config num 10 done
008'220 35 S200 num 11 handle num 11 move rpc [0]
008'220 35 S200 num 11 move [0] is done yet
008'221 30 S301 after send shards ok
008'222 35 S301 move delete propose num 11 shards [0] as leader?
008'223 34 S300 check new config wanted 11
008'231 34 S302 check new config wanted 11
008'238 30 S300 apply index 28 key num 0 type 4   lastApplied 27
008'238 34 S300 apply new config num 11 :&{11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
008'238 34 S300 inited need send [0],need recv []
008'238 31 S300 used size: 1017 / 300 
008'239 29 S300 do snapshot for raft 28 28,size 669
008'244 35 S200 num 11 waiting [5 6] shards 
008'244 35 S302 current config num 10 done
008'255 35 S200 num 11 handle num 11 move rpc [0]
008'255 35 S200 num 11 move [0] is done yet
008'260 35 S201 num 11 waiting [0 5 6] shards 
008'262 35 S102 current config num 10 done
008'262 35 S100 current config num 10 done
008'263 35 S101 current config num 10 done
008'266 27 S0 raft apply snapshot offset 28 ,lastApplied 28,total log 30, size 674,log cap:3
008'266 31 S300 after snap shot size674 669
008'268 35 S300 num 11 sending shards [0] to group 101
008'269 35 S200 num 11 handle num 11 move rpc [0]
008'269 35 S200 num 11 move [0] is done yet
008'270 30 S300 after send shards ok
008'270 35 S300 move delete propose not leader
008'270 35 S301 num 11 sending shards [0] to group 101
008'270 30 S301 apply index 29 key num 0 type 5   lastApplied 28
008'270 35 S301 apply num 11 migration [0]
008'271 30 S301 safely delete shard 0
008'271 31 S301 used size: 674 / 300 
008'288 35 S202 num 11 waiting [0 5 6] shards 
008'288 30 S302 apply index 28 key num 0 type 4   lastApplied 27
008'288 34 S302 apply new config num 11 :&{11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
008'289 34 S302 inited need send [0],need recv []
008'289 31 S302 used size: 1017 / 300 
008'289 29 S301 do snapshot for raft 29 29,size 617
008'292 27 S1 raft apply snapshot offset 29 ,lastApplied 30,total log 30, size 545,log cap:2
008'292 27 S1 last applied not snapshoted raft.LogEntry{Term:5, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}}, Num:11}, Num:0}}
008'292 31 S301 after snap shot size545 617
008'292 30 S301 apply index 30 key num 0 type 5   lastApplied 29
008'292 35 S301 apply num 11 migration [0]
008'293 31 S301 used size: 545 / 300 
008'293 29 S301 do snapshot for raft 30 30,size 617
008'293 27 S1 raft apply snapshot offset 30 ,lastApplied 30,total log 30, size 82,log cap:1
008'293 31 S301 after snap shot size82 617
008'294 30 S301 after send shards ok
008'294 35 S301 num 11 move [0] is done yet
008'295 35 S200 num 11 handle num 11 move rpc [0]
008'295 35 S200 num 11 move [0] is done yet
008'296 30 S301 after send shards ok
008'296 35 S301 num 11 move [0] is done yet
008'302 35 S301 current config num 11 done
008'303 29 S302 do snapshot for raft 28 28,size 669
008'304 27 S2 raft apply snapshot offset 28 ,lastApplied 28,total log 30, size 674,log cap:3
008'304 31 S302 after snap shot size674 669
008'305 35 S302 num 11 sending shards [0] to group 101
008'308 35 S300 num 11 sending shards [0] to group 101
008'308 35 S200 num 11 waiting [5 6] shards 
008'313 35 S200 num 11 handle num 11 move rpc [0]
008'313 35 S200 num 11 move [0] is done yet
008'319 35 S101 current config num 10 done
008'319 35 S201 num 11 waiting [0 5 6] shards 
008'320 35 S102 current config num 10 done
008'320 35 S100 current config num 10 done
leave &{[102] 1074585914363486070 12}
008'327 30 S302 after send shards ok
008'327 35 S302 move delete propose not leader
008'329 35 S200 num 11 handle num 11 move rpc [0]
008'329 35 S200 num 11 move [0] is done yet
008'352 35 S302 num 11 sending shards [0] to group 101
008'353 30 S302 apply index 29 key num 0 type 5   lastApplied 28
008'353 35 S302 apply num 11 migration [0]
008'353 30 S302 safely delete shard 0
008'353 31 S302 used size: 674 / 300 
008'354 35 S200 num 11 handle num 11 move rpc [0]
008'354 29 S302 do snapshot for raft 29 29,size 617
008'363 35 S300 num 11 sending shards [0] to group 101
008'363 30 S300 apply index 29 key num 0 type 5   lastApplied 28
008'364 35 S300 apply num 11 migration [0]
008'364 30 S300 safely delete shard 0
008'364 31 S300 used size: 674 / 300 
008'364 35 S301 current config num 11 done
008'364 29 S300 do snapshot for raft 29 29,size 617
008'364 35 S202 num 11 waiting [0 5 6] shards 
008'365 27 S0 raft apply snapshot offset 29 ,lastApplied 30,total log 30, size 545,log cap:2
008'365 27 S0 last applied not snapshoted raft.LogEntry{Term:5, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}}, Num:11}, Num:0}}
008'365 31 S300 after snap shot size545 617
008'365 30 S300 apply index 30 key num 0 type 5   lastApplied 29
008'365 35 S300 apply num 11 migration [0]
008'365 31 S300 used size: 545 / 300 
008'368 29 S300 do snapshot for raft 30 30,size 617
008'368 27 S0 raft apply snapshot offset 30 ,lastApplied 30,total log 30, size 82,log cap:1
008'368 31 S300 after snap shot size82 617
008'368 30 S300 after send shards ok
008'368 35 S300 num 11 move [0] is done yet
008'370 35 S102 current config num 10 done
008'370 35 S101 current config num 10 done
008'370 35 S201 num 11 waiting [0 5 6] shards 
008'370 35 S100 current config num 10 done
008'354 35 S200 num 11 move [0] is done yet
008'372 35 S200 num 11 waiting [5 6] shards 
008'373 35 S200 num 11 handle num 11 move rpc [0]
008'373 35 S200 num 11 move [0] is done yet
008'385 27 S2 raft apply snapshot offset 29 ,lastApplied 30,total log 30, size 545,log cap:2
008'385 27 S2 last applied not snapshoted raft.LogEntry{Term:5, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}}, Num:11}, Num:0}}
008'385 31 S302 after snap shot size545 617
008'385 30 S302 apply index 30 key num 0 type 5   lastApplied 29
008'385 35 S302 apply num 11 migration [0]
008'385 31 S302 used size: 545 / 300 
008'386 29 S302 do snapshot for raft 30 30,size 617
008'386 27 S2 raft apply snapshot offset 30 ,lastApplied 30,total log 30, size 82,log cap:1
008'386 31 S302 after snap shot size82 617
008'386 30 S302 after send shards ok
008'386 35 S302 num 11 move [0] is done yet
008'387 30 S300 after send shards ok
008'387 35 S300 num 11 move [0] is done yet
008'388 35 S302 current config num 11 done
008'396 35 S300 current config num 11 done
008'423 35 S200 num 11 waiting [5 6] shards 
008'423 35 S201 num 11 waiting [0 5 6] shards 
008'423 35 S202 num 11 waiting [0 5 6] shards 
008'423 35 S301 current config num 11 done
008'424 35 S102 current config num 10 done
008'424 35 S101 current config num 10 done
008'424 35 S100 current config num 10 done
008'442 35 S302 current config num 11 done
008'447 35 S300 current config num 11 done
008'452 28 S300 do request args:Key 8 type 3 num 12 Client 2953714763196401582 Seq 2 
008'452 28 S300 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
008'464 30 S202 apply index 54 key num 0 type 5   lastApplied 53
008'464 35 S202 apply num 11 migration [0]
008'464 30 S202 safely recv and decided shard 0
008'464 31 S202 used size: 545 / 300 
008'464 29 S202 do snapshot for raft 54 54,size 549
008'465 27 S2 raft apply snapshot offset 54 ,lastApplied 54,total log 54, size 82,log cap:1
008'465 31 S202 after snap shot size82 549
008'471 30 S201 apply index 54 key num 0 type 5   lastApplied 53
008'472 35 S201 apply num 11 migration [0]
008'472 30 S201 safely recv and decided shard 0
008'472 31 S201 used size: 545 / 300 
008'472 29 S201 do snapshot for raft 54 54,size 549
008'473 27 S1 raft apply snapshot offset 54 ,lastApplied 54,total log 54, size 82,log cap:1
008'473 31 S201 after snap shot size82 549
008'473 34 S200 got new config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 11
008'474 34 S200 propose new config 12
008'486 30 S200 apply index 55 key num 0 type 4   lastApplied 54
008'486 34 S200 apply new config num 12 failed, for old num 11 still pending:[false false false false false true true false false false]
008'486 31 S200 used size: 459 / 300 
008'487 29 S200 do snapshot for raft 55 55,size 549
008'487 27 S0 raft apply snapshot offset 55 ,lastApplied 55,total log 55, size 82,log cap:1
008'487 31 S200 after snap shot size82 549
008'495 35 S101 current config num 10 done
008'498 35 S302 current config num 11 done
008'508 35 S201 num 11 waiting [5 6] shards 
008'508 35 S200 num 11 waiting [5 6] shards 
008'509 35 S202 num 11 waiting [5 6] shards 
008'509 35 S102 current config num 10 done
008'509 35 S301 current config num 11 done
008'509 35 S300 current config num 11 done
008'513 30 S100 apply index 140 key num 0 type 5   lastApplied 139
008'513 35 S100 apply num 10 migration [0 1 2 3 4]
008'513 31 S100 used size: 996 / 300 
008'514 29 S100 do snapshot for raft 140 140,size 640
008'515 27 S0 raft apply snapshot offset 140 ,lastApplied 142,total log 142, size 709,log cap:3
008'515 27 S0 last applied not snapshoted raft.LogEntry{Term:6, Command:interface {}(nil)}
008'515 31 S100 after snap shot size709 640
008'515 30 S100 apply index 141 key num 0 type 5   lastApplied 140
008'520 44 S1 ctrler change to config &{13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
008'515 35 S100 apply num 10 migration [0 1 2 3 4]
008'521 31 S100 used size: 709 / 300 
008'524 29 S100 do snapshot for raft 141 141,size 640
008'524 27 S0 raft apply snapshot offset 141 ,lastApplied 142,total log 142, size 89,log cap:2
008'524 27 S0 last applied not snapshoted raft.LogEntry{Term:6, Command:interface {}(nil)}
008'524 31 S100 after snap shot size89 640
008'524 30 S100 nop apply <nil>
008'525 35 S100 current config num 10 done
008'529 44 S0 ctrler change to config &{13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
008'550 35 S302 current config num 11 done
008'550 35 S101 current config num 10 done
008'561 35 S301 current config num 11 done
008'562 35 S201 num 11 waiting [5 6] shards 
008'562 35 S200 num 11 waiting [5 6] shards 
008'562 35 S202 num 11 waiting [5 6] shards 
008'562 35 S102 current config num 10 done
008'562 35 S300 current config num 11 done
008'574 34 S200 check new config wanted 12
008'575 35 S100 current config num 10 done
008'601 35 S101 current config num 10 done
008'602 35 S302 current config num 11 done
008'613 35 S300 current config num 11 done
008'613 35 S301 current config num 11 done
008'613 35 S201 num 11 waiting [5 6] shards 
008'613 35 S200 num 11 waiting [5 6] shards 
008'613 35 S202 num 11 waiting [5 6] shards 
008'613 35 S102 current config num 10 done
008'625 35 S100 current config num 10 done
008'663 35 S301 current config num 11 done
008'663 35 S101 current config num 10 done
008'663 35 S202 num 11 waiting [5 6] shards 
008'663 35 S102 current config num 10 done
008'663 35 S302 current config num 11 done
008'664 35 S300 current config num 11 done
008'664 35 S201 num 11 waiting [5 6] shards 
008'664 35 S200 num 11 waiting [5 6] shards 
008'678 35 S100 current config num 10 done
008'725 35 S300 current config num 11 done
008'725 35 S101 current config num 10 done
008'725 35 S202 num 11 waiting [5 6] shards 
008'726 35 S301 current config num 11 done
008'726 35 S102 current config num 10 done
008'726 35 S302 current config num 11 done
008'739 35 S201 num 11 waiting [5 6] shards 
008'739 35 S200 num 11 waiting [5 6] shards 
008'732 35 S100 current config num 10 done
008'743 44 S2 ctrler change to config &{13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
008'751 34 S300 got new config {11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 10
008'754 34 S302 got new config {11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 10
008'755 28 S100 do request args:Key 7 type 3 num 13 Client 2972145661651991667 Seq 11 
008'755 28 S100 [667--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
008'756 28 S100 do request args:Key 6 type 3 num 13 Client 542732653461723544 Seq 4 
008'756 28 S100 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
008'760 28 S100 do request args:Key 5 type 3 num 13 Client 3482757038087095369 Seq 5 
008'760 28 S100 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
008'762 28 S100 do request args:Key 0 type 3 num 13 Client 940626237948413081 Seq 10 
008'762 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
008'767 34 S200 got new config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 11
008'768 34 S200 propose new config 12
008'769 28 S100 do request args:Key 9 type 3 num 13 Client 3620950086299709532 Seq 15 
008'769 28 S100 [532--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
008'776 30 S200 apply index 56 key num 0 type 4   lastApplied 55
008'776 34 S200 apply new config num 12 failed, for old num 11 still pending:[false false false false false true true false false false]
008'776 31 S200 used size: 459 / 300 
008'777 29 S200 do snapshot for raft 56 56,size 549
008'777 27 S0 raft apply snapshot offset 56 ,lastApplied 56,total log 56, size 82,log cap:1
008'777 31 S200 after snap shot size82 549
008'778 30 S202 apply index 55 key num 0 type 4   lastApplied 54
008'778 34 S202 apply new config num 12 failed, for old num 11 still pending:[false false false false false true true false false false]
008'778 31 S202 used size: 632 / 300 
008'779 29 S202 do snapshot for raft 55 55,size 549
008'780 27 S2 raft apply snapshot offset 55 ,lastApplied 55,total log 56, size 459,log cap:2
008'780 31 S202 after snap shot size459 549
008'780 30 S201 apply index 55 key num 0 type 4   lastApplied 54
008'780 34 S201 apply new config num 12 failed, for old num 11 still pending:[false false false false false true true false false false]
008'780 31 S201 used size: 632 / 300 
008'780 29 S201 do snapshot for raft 55 55,size 549
008'781 30 S202 apply index 56 key num 0 type 4   lastApplied 55
008'781 34 S202 apply new config num 12 failed, for old num 11 still pending:[false false false false false true true false false false]
008'781 31 S202 used size: 459 / 300 
008'781 27 S1 raft apply snapshot offset 55 ,lastApplied 55,total log 56, size 459,log cap:2
008'781 31 S201 after snap shot size459 549
008'781 29 S202 do snapshot for raft 56 56,size 549
008'782 27 S2 raft apply snapshot offset 56 ,lastApplied 56,total log 56, size 82,log cap:1
008'782 31 S202 after snap shot size82 549
008'783 30 S201 apply index 56 key num 0 type 4   lastApplied 55
008'783 34 S201 apply new config num 12 failed, for old num 11 still pending:[false false false false false true true false false false]
008'783 31 S201 used size: 459 / 300 
008'783 34 S201 got new config {11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 10
008'783 29 S201 do snapshot for raft 56 56,size 549
008'784 27 S1 raft apply snapshot offset 56 ,lastApplied 56,total log 56, size 82,log cap:1
008'784 31 S201 after snap shot size82 549
008'785 34 S100 got new config {11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 10
008'786 34 S101 got new config {11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 10
008'786 34 S100 propose new config 11
008'786 35 S102 current config num 10 done
008'786 35 S300 current config num 11 done
008'787 35 S101 current config num 10 done
008'787 35 S202 num 11 waiting [5 6] shards 
008'787 35 S302 current config num 11 done
008'788 28 S100 do request args:Key 8 type 3 num 13 Client 2953714763196401582 Seq 2 
008'788 28 S100 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
008'789 35 S201 num 11 waiting [5 6] shards 
008'791 35 S100 current config num 10 done
008'792 35 S200 num 11 waiting [5 6] shards 
008'793 30 S101 nop apply <nil>
008'794 31 S101 used size: 510 / 300 
008'794 29 S101 do snapshot for raft 142 142,size 640
008'795 27 S1 raft apply snapshot offset 142 ,lastApplied 142,total log 143, size 507,log cap:2
008'795 31 S101 after snap shot size507 640
008'795 30 S102 nop apply <nil>
008'795 31 S102 used size: 510 / 300 
008'795 30 S100 apply index 143 key num 0 type 4   lastApplied 142
008'795 34 S100 apply new config num 11 :&{11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
008'796 29 S102 do snapshot for raft 142 142,size 640
leave &{[102] 1074585914363486070 12}
008'826 27 S2 raft apply snapshot offset 142 ,lastApplied 143,total log 143, size 507,log cap:2
008'796 34 S100 inited need send [5 6],need recv []
008'826 31 S100 used size: 510 / 300 
008'826 27 S2 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:4, Opt:shardctrler.Config{Num:11, Shards:[10]int{101, 102, 102, 102, 102, 101, 101, 100, 100, 100}, Groups:map[int][]string{100:[]string{"server-100-0", "server-100-1", "server-100-2"}, 101:[]string{"server-101-0", "server-101-1", "server-101-2"}, 102:[]string{"server-102-0", "server-102-1", "server-102-2"}}}, Num:0}}
008'826 31 S102 after snap shot size507 640
008'826 30 S102 apply index 143 key num 0 type 4   lastApplied 142
008'826 34 S102 apply new config num 11 :&{11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
008'827 34 S102 inited need send [5 6],need recv []
008'827 31 S102 used size: 507 / 300 
008'827 29 S100 do snapshot for raft 143 143,size 683
008'827 27 S0 raft apply snapshot offset 143 ,lastApplied 143,total log 143, size 86,log cap:1
008'827 31 S100 after snap shot size86 683
008'806 30 S101 apply index 143 key num 0 type 4   lastApplied 142
008'827 29 S102 do snapshot for raft 143 143,size 683
008'827 34 S101 apply new config num 11 :&{11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{10 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
008'827 34 S101 inited need send [5 6],need recv []
008'827 31 S101 used size: 507 / 300 
008'828 27 S2 raft apply snapshot offset 143 ,lastApplied 143,total log 143, size 86,log cap:1
008'828 31 S102 after snap shot size86 683
008'828 28 S100 do request args:Key 1 type 3 num 13 Client 418781717203629479 Seq 23 
008'828 28 S100 [479--23] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
008'828 29 S101 do snapshot for raft 143 143,size 683
008'786 35 S301 current config num 11 done
008'828 27 S1 raft apply snapshot offset 143 ,lastApplied 143,total log 143, size 86,log cap:1
008'828 31 S101 after snap shot size86 683
008'839 35 S201 num 11 waiting [5 6] shards 
008'841 35 S302 current config num 11 done
008'841 35 S300 current config num 11 done
008'841 35 S101 num 11 sending shards [5 6] to group 101
008'842 35 S202 num 11 waiting [5 6] shards 
008'842 35 S100 num 11 sending shards [5 6] to group 101
008'844 35 S200 num 11 handle num 11 move rpc [5 6]
008'845 35 S200 move handle num 11 shards [5 6] as leader?
008'848 35 S102 num 11 sending shards [5 6] to group 101
008'851 35 S200 num 11 waiting [5 6] shards 
008'851 35 S200 num 11 handle num 11 move rpc [5 6]
008'852 35 S200 move handle num 11 shards [5 6] as leader?
008'853 34 S102 got new config {11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 10
008'855 28 S100 do request args:Key 2 type 3 num 13 Client 1679014388048817729 Seq 27 
008'855 28 S100 [729--27] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
008'855 28 S100 do request args:Key 4 type 3 num 13 Client 132246879705026825 Seq 6 
008'855 28 S100 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
008'855 34 S302 check new config wanted 12
008'855 35 S200 num 11 handle num 11 move rpc [5 6]
008'857 35 S200 move handle num 11 shards [5 6] as leader?
008'858 34 S202 got new config {11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 10
008'861 28 S100 do request args:Key 3 type 3 num 13 Client 2238025532150463055 Seq 8 
008'861 28 S100 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
008'862 34 S301 got new config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 11
008'862 34 S300 check new config wanted 12
008'865 34 S301 propose new config 12
008'865 30 S200 apply index 57 key num 0 type 5   lastApplied 56
008'865 35 S200 apply num 11 migration [5 6]
008'865 30 S200 safely recv and decided shard 5
008'865 30 S200 safely recv and decided shard 6
008'866 31 S200 used size: 863 / 300 
008'866 29 S200 do snapshot for raft 57 57,size 611
008'867 27 S0 raft apply snapshot offset 57 ,lastApplied 57,total log 59, size 714,log cap:3
008'867 31 S200 after snap shot size714 611
008'870 35 S200 num 11 move [5 6] is done yet
008'871 30 S100 after send shards ok
008'872 35 S100 move delete propose num 11 shards [5 6] as leader?
008'878 34 S200 check new config wanted 12
008'878 35 S101 num 11 sending shards [5 6] to group 101
008'879 35 S100 num 11 sending shards [5 6] to group 101
008'879 35 S301 current config num 11 done
008'881 30 S200 apply index 58 key num 0 type 5   lastApplied 57
008'884 35 S200 apply num 11 migration [5 6]
008'884 31 S200 used size: 714 / 300 
008'884 35 S102 num 11 sending shards [5 6] to group 101
008'885 34 S201 check new config wanted 12
008'886 29 S200 do snapshot for raft 58 58,size 611
008'887 27 S0 raft apply snapshot offset 58 ,lastApplied 59,total log 59, size 565,log cap:2
008'887 27 S0 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:11}, Num:0}}
008'887 31 S200 after snap shot size565 611
008'887 30 S200 apply index 59 key num 0 type 5   lastApplied 58
008'887 35 S200 apply num 11 migration [5 6]
008'887 31 S200 used size: 565 / 300 
008'888 29 S200 do snapshot for raft 59 59,size 611
008'888 27 S0 raft apply snapshot offset 59 ,lastApplied 59,total log 59, size 82,log cap:1
008'888 31 S200 after snap shot size82 611
008'890 35 S200 num 11 move [5 6] is done yet
008'890 35 S200 num 11 move [5 6] is done yet
008'891 34 S101 check new config wanted 12
008'891 30 S102 after send shards ok
008'892 35 S102 move delete propose not leader
008'894 35 S202 num 11 waiting [5 6] shards 
008'894 34 S100 check new config wanted 12
008'894 35 S302 current config num 11 done
008'894 35 S300 current config num 11 done
008'895 30 S101 after send shards ok
008'895 35 S101 move delete propose not leader
008'901 35 S201 num 11 waiting [5 6] shards 
008'901 30 S100 apply index 144 key num 0 type 5   lastApplied 143
008'901 35 S100 apply num 11 migration [5 6]
008'902 30 S100 safely delete shard 5
008'902 30 S100 safely delete shard 6
008'902 31 S100 used size: 569 / 300 
008'902 35 S200 num 11 handle num 11 move rpc [5 6]
008'902 29 S100 do snapshot for raft 144 144,size 622
008'906 27 S0 raft apply snapshot offset 144 ,lastApplied 144,total log 144, size 86,log cap:1
008'906 31 S100 after snap shot size86 622
008'902 35 S200 num 11 move [5 6] is done yet
008'906 35 S200 current config num 11 done
008'907 30 S101 after send shards ok
008'907 35 S101 move delete propose not leader
008'910 35 S100 current config num 11 done
008'910 35 S101 num 11 sending shards [5 6] to group 101
008'911 30 S301 apply index 31 key num 0 type 4   lastApplied 30
008'911 34 S301 apply new config num 12 :&{12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
008'911 34 S301 inited need send [],need recv [6]
008'911 31 S301 used size: 459 / 300 
008'912 29 S301 do snapshot for raft 31 31,size 574
008'912 27 S1 raft apply snapshot offset 31 ,lastApplied 31,total log 31, size 82,log cap:1
008'912 31 S301 after snap shot size82 574
008'913 35 S200 num 11 handle num 11 move rpc [5 6]
008'913 35 S200 num 11 move [5 6] is done yet
008'913 30 S101 after send shards ok
008'913 35 S101 move delete propose not leader
008'915 35 S200 num 11 handle num 11 move rpc [5 6]
008'915 35 S200 num 11 move [5 6] is done yet
008'916 30 S102 after send shards ok
008'916 35 S102 move delete propose not leader
008'920 35 S200 num 11 handle num 11 move rpc [5 6]
008'920 35 S200 num 11 move [5 6] is done yet
008'924 30 S100 after send shards ok
008'925 35 S100 num 11 move [5 6] is done yet
008'945 35 S102 num 11 sending shards [5 6] to group 101
008'951 35 S201 num 11 waiting [5 6] shards 
008'965 35 S202 num 11 waiting [5 6] shards 
008'966 34 S202 check new config wanted 12
008'966 35 S101 num 11 sending shards [5 6] to group 101
008'945 35 S302 current config num 11 done
008'945 35 S300 current config num 11 done
008'966 29 S302 recv Installsnapshot 31 30
008'966 30 S300 apply index 31 key num 0 type 4   lastApplied 30
008'966 34 S300 apply new config num 12 :&{12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
008'966 34 S300 inited need send [],need recv [6]
008'966 31 S300 used size: 459 / 300 
008'966 35 S301 num 12 waiting [6] shards 
008'967 34 S301 check new config wanted 13
008'953 34 S102 check new config wanted 12
008'967 35 S200 current config num 11 done
008'967 35 S100 current config num 11 done
join &{map[102:[server-102-0 server-102-1 server-102-2]] 1074585914363486070 13}
008'978 34 S302 got new config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 11
join &{map[102:[server-102-0 server-102-1 server-102-2]] 1074585914363486070 13}
008'991 27 S2 raft apply snapshot offset 31 ,lastApplied 31,total log 31, size 82,log cap:1
008'991 29 S302 decide Installsnapshot 31 <- 30
008'992 30 S302 install snap index 31,config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false true false false false]
008'996 35 S200 num 11 handle num 11 move rpc [5 6]
008'996 35 S200 num 11 move [5 6] is done yet
009'003 29 S300 do snapshot for raft 31 31,size 574
009'003 27 S0 raft apply snapshot offset 31 ,lastApplied 31,total log 31, size 82,log cap:1
009'003 31 S300 after snap shot size82 574
009'011 30 S101 after send shards ok
009'011 35 S101 move delete propose not leader
009'013 35 S102 num 11 sending shards [5 6] to group 101
009'024 35 S200 current config num 11 done
009'027 35 S101 num 11 sending shards [5 6] to group 101
009'028 35 S200 num 11 handle num 11 move rpc [5 6]
009'028 35 S200 num 11 move [5 6] is done yet
009'029 30 S102 after send shards ok
009'029 35 S102 move delete propose not leader
009'029 35 S202 num 11 waiting [5 6] shards 
009'030 35 S201 num 11 waiting [5 6] shards 
009'030 35 S302 num 12 waiting [6] shards 
009'030 35 S300 num 12 waiting [6] shards 
009'030 35 S301 num 12 waiting [6] shards 
009'030 35 S100 current config num 11 done
009'031 35 S200 num 11 handle num 11 move rpc [5 6]
009'031 35 S200 num 11 move [5 6] is done yet
009'038 30 S102 after send shards ok
009'038 35 S102 move delete propose not leader
009'043 35 S102 num 11 sending shards [5 6] to group 101
009'057 35 S101 num 11 sending shards [5 6] to group 101
009'065 28 S100 do request args:Key 9 type 3 num 13 Client 3620950086299709532 Seq 15 
009'065 28 S100 [532--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
009'067 28 S100 do request args:Key 0 type 3 num 13 Client 940626237948413081 Seq 10 
009'067 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
009'075 35 S200 current config num 11 done
009'076 35 S102 num 11 sending shards [5 6] to group 101
009'078 35 S200 num 11 handle num 11 move rpc [5 6]
009'078 35 S200 num 11 move [5 6] is done yet
009'078 35 S200 num 11 handle num 11 move rpc [5 6]
009'078 35 S200 num 11 move [5 6] is done yet
009'080 35 S302 num 12 waiting [6] shards 
009'081 30 S101 after send shards ok
009'081 35 S101 move delete propose not leader
009'081 35 S201 num 11 waiting [5 6] shards 
009'081 35 S202 num 11 waiting [5 6] shards 
009'082 35 S300 num 12 waiting [6] shards 
009'082 35 S200 num 11 handle num 11 move rpc [5 6]
009'082 35 S200 num 11 move [5 6] is done yet
009'084 35 S100 current config num 11 done
009'085 35 S301 num 12 waiting [6] shards 
009'085 30 S102 after send shards ok
009'085 35 S102 move delete propose not leader
009'086 30 S102 after send shards ok
009'086 35 S102 move delete propose not leader
009'092 30 S201 apply index 57 key num 0 type 5   lastApplied 56
009'092 35 S201 apply num 11 migration [5 6]
009'092 30 S201 safely recv and decided shard 5
009'092 30 S201 safely recv and decided shard 6
009'092 31 S201 used size: 863 / 300 
009'093 29 S201 do snapshot for raft 57 57,size 611
009'094 27 S1 raft apply snapshot offset 57 ,lastApplied 59,total log 59, size 714,log cap:3
009'094 27 S1 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:11}, Num:0}}
009'094 31 S201 after snap shot size714 611
009'094 30 S201 apply index 58 key num 0 type 5   lastApplied 57
009'094 35 S201 apply num 11 migration [5 6]
009'094 31 S201 used size: 714 / 300 
009'095 29 S201 do snapshot for raft 58 58,size 611
009'096 27 S1 raft apply snapshot offset 58 ,lastApplied 59,total log 59, size 565,log cap:2
009'096 27 S1 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:11}, Num:0}}
009'096 31 S201 after snap shot size565 611
009'096 30 S201 apply index 59 key num 0 type 5   lastApplied 58
009'096 35 S201 apply num 11 migration [5 6]
009'096 31 S201 used size: 565 / 300 
009'097 29 S201 do snapshot for raft 59 59,size 611
009'097 27 S1 raft apply snapshot offset 59 ,lastApplied 59,total log 59, size 82,log cap:1
009'097 31 S201 after snap shot size82 611
009'101 34 S302 check new config wanted 13
009'104 34 S300 got new config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 11
009'107 35 S102 num 11 sending shards [5 6] to group 101
009'108 35 S200 num 11 handle num 11 move rpc [5 6]
009'108 35 S200 num 11 move [5 6] is done yet
009'109 35 S200 num 11 handle num 11 move rpc [5 6]
009'109 35 S200 num 11 move [5 6] is done yet
009'109 30 S102 after send shards ok
009'109 35 S102 move delete propose not leader
009'114 30 S202 apply index 57 key num 0 type 5   lastApplied 56
009'114 35 S202 apply num 11 migration [5 6]
009'114 30 S202 safely recv and decided shard 5
009'114 30 S202 safely recv and decided shard 6
009'114 31 S202 used size: 863 / 300 
009'115 28 S100 do request args:Key 8 type 3 num 13 Client 2953714763196401582 Seq 2 
009'115 28 S100 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
009'115 28 S100 do request args:Key 6 type 3 num 13 Client 542732653461723544 Seq 4 
009'115 28 S100 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
009'116 35 S101 num 11 sending shards [5 6] to group 101
009'116 30 S101 after send shards ok
009'116 35 S101 move delete propose not leader
009'118 30 S102 apply index 144 key num 0 type 5   lastApplied 143
009'118 35 S102 apply num 11 migration [5 6]
009'118 30 S102 safely delete shard 5
009'118 30 S102 safely delete shard 6
009'118 31 S102 used size: 569 / 300 
009'119 29 S102 do snapshot for raft 144 144,size 622
009'119 27 S2 raft apply snapshot offset 144 ,lastApplied 144,total log 144, size 86,log cap:1
009'119 31 S102 after snap shot size86 622
009'120 30 S101 apply index 144 key num 0 type 5   lastApplied 143
009'120 35 S101 apply num 11 migration [5 6]
009'120 30 S101 safely delete shard 5
009'121 30 S101 safely delete shard 6
009'121 31 S101 used size: 569 / 300 
009'121 29 S101 do snapshot for raft 144 144,size 622
009'121 27 S1 raft apply snapshot offset 144 ,lastApplied 144,total log 144, size 86,log cap:1
009'121 31 S101 after snap shot size86 622
009'123 35 S200 num 11 handle num 11 move rpc [5 6]
009'123 35 S200 num 11 move [5 6] is done yet
009'124 30 S101 after send shards ok
009'124 35 S101 num 11 move [5 6] is done yet
009'127 29 S202 do snapshot for raft 57 57,size 611
009'127 27 S2 raft apply snapshot offset 57 ,lastApplied 59,total log 59, size 714,log cap:3
009'127 27 S2 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:11}, Num:0}}
009'128 31 S202 after snap shot size714 611
009'128 30 S202 apply index 58 key num 0 type 5   lastApplied 57
009'128 35 S202 apply num 11 migration [5 6]
009'128 31 S202 used size: 714 / 300 
009'128 29 S202 do snapshot for raft 58 58,size 611
009'129 27 S2 raft apply snapshot offset 58 ,lastApplied 59,total log 59, size 565,log cap:2
009'129 27 S2 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:11}, Num:0}}
009'129 31 S202 after snap shot size565 611
009'129 30 S202 apply index 59 key num 0 type 5   lastApplied 58
009'129 35 S202 apply num 11 migration [5 6]
009'129 31 S202 used size: 565 / 300 
009'130 29 S202 do snapshot for raft 59 59,size 611
009'130 27 S2 raft apply snapshot offset 59 ,lastApplied 59,total log 59, size 82,log cap:1
009'130 31 S202 after snap shot size82 611
009'130 35 S302 num 12 waiting [6] shards 
009'130 35 S200 current config num 11 done
009'134 35 S300 num 12 waiting [6] shards 
009'134 35 S201 current config num 11 done
009'134 35 S202 current config num 11 done
009'134 35 S100 current config num 11 done
009'147 35 S101 current config num 11 done
009'149 35 S301 num 12 waiting [6] shards 
009'149 35 S102 current config num 11 done
009'184 35 S302 num 12 waiting [6] shards 
009'184 35 S200 current config num 11 done
009'186 35 S100 current config num 11 done
009'186 35 S300 num 12 waiting [6] shards 
009'186 35 S202 current config num 11 done
009'186 35 S201 current config num 11 done
009'198 35 S101 current config num 11 done
009'202 35 S102 current config num 11 done
009'202 35 S301 num 12 waiting [6] shards 
009'205 34 S300 check new config wanted 13
join &{map[102:[server-102-0 server-102-1 server-102-2]] 1074585914363486070 13}
009'236 35 S200 current config num 11 done
009'236 35 S100 current config num 11 done
009'236 35 S201 current config num 11 done
009'236 35 S302 num 12 waiting [6] shards 
009'236 35 S300 num 12 waiting [6] shards 
009'236 35 S202 current config num 11 done
009'251 35 S101 current config num 11 done
009'255 35 S301 num 12 waiting [6] shards 
009'256 35 S102 current config num 11 done
009'289 35 S202 current config num 11 done
009'290 35 S100 current config num 11 done
009'290 35 S201 current config num 11 done
009'290 35 S302 num 12 waiting [6] shards 
009'290 35 S200 current config num 11 done
009'290 35 S300 num 12 waiting [6] shards 
009'310 35 S101 current config num 11 done
009'310 35 S301 num 12 waiting [6] shards 
009'310 35 S102 current config num 11 done
009'340 35 S202 current config num 11 done
009'341 35 S201 current config num 11 done
009'341 35 S100 current config num 11 done
009'341 35 S302 num 12 waiting [6] shards 
009'341 35 S200 current config num 11 done
009'341 35 S300 num 12 waiting [6] shards 
009'342 44 S1 ctrler change to config &{14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
009'354 44 S0 ctrler change to config &{14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
009'361 35 S301 num 12 waiting [6] shards 
009'361 35 S101 current config num 11 done
009'361 35 S102 current config num 11 done
009'409 35 S300 num 12 waiting [6] shards 
009'400 35 S202 current config num 11 done
009'400 35 S201 current config num 11 done
009'410 35 S302 num 12 waiting [6] shards 
009'400 35 S100 current config num 11 done
009'400 35 S200 current config num 11 done
009'411 35 S102 current config num 11 done
009'412 35 S301 num 12 waiting [6] shards 
009'412 35 S101 current config num 11 done
009'422 44 S2 ctrler change to config &{14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
009'426 34 S202 got new config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 11
join &{map[101:[server-101-0 server-101-1 server-101-2]] 1074585914363486070 14}
009'429 28 S300 do request args:Key 5 type 3 num 14 Client 3482757038087095369 Seq 5 
009'429 28 S300 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
009'430 34 S301 got new config {13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 12
009'430 28 S100 do request args:Key 1 type 3 num 14 Client 418781717203629479 Seq 23 
009'431 28 S100 [479--23] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
009'431 34 S301 propose new config 13
009'441 30 S301 apply index 32 key num 0 type 4   lastApplied 31
009'444 34 S301 apply new config num 13 failed, for old num 12 still pending:[false false false false false false true false false false]
009'444 31 S301 used size: 416 / 300 
009'445 29 S301 do snapshot for raft 32 32,size 574
009'445 27 S1 raft apply snapshot offset 32 ,lastApplied 32,total log 32, size 82,log cap:1
009'445 31 S301 after snap shot size82 574
009'464 35 S300 num 12 waiting [6] shards 
009'464 35 S202 current config num 11 done
009'464 35 S201 current config num 11 done
009'464 35 S100 current config num 11 done
009'464 35 S302 num 12 waiting [6] shards 
009'464 35 S200 current config num 11 done
009'464 35 S102 current config num 11 done
009'464 35 S301 num 12 waiting [6] shards 
009'464 35 S101 current config num 11 done
009'465 34 S201 got new config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 11
join &{map[101:[server-101-0 server-101-1 server-101-2]] 1074585914363486070 14}
009'521 35 S202 current config num 11 done
009'521 35 S201 current config num 11 done
009'530 34 S202 check new config wanted 12
009'530 35 S300 num 12 waiting [6] shards 
009'521 35 S100 current config num 11 done
009'530 35 S302 num 12 waiting [6] shards 
009'521 35 S200 current config num 11 done
009'521 35 S102 current config num 11 done
009'521 35 S101 current config num 11 done
009'530 35 S301 num 12 waiting [6] shards 
009'544 30 S300 apply index 32 key num 0 type 4   lastApplied 31
009'544 34 S300 apply new config num 13 failed, for old num 12 still pending:[false false false false false false true false false false]
009'544 31 S300 used size: 416 / 300 
009'546 29 S300 do snapshot for raft 32 32,size 574
009'546 27 S0 raft apply snapshot offset 32 ,lastApplied 32,total log 32, size 82,log cap:1
009'546 31 S300 after snap shot size82 574
009'546 34 S301 check new config wanted 13
009'547 30 S302 apply index 32 key num 0 type 4   lastApplied 31
009'547 34 S302 apply new config num 13 failed, for old num 12 still pending:[false false false false false false true false false false]
009'548 31 S302 used size: 416 / 300 
009'550 29 S302 do snapshot for raft 32 32,size 574
009'550 27 S2 raft apply snapshot offset 32 ,lastApplied 32,total log 32, size 82,log cap:1
009'550 31 S302 after snap shot size82 574
009'572 34 S201 check new config wanted 12
009'581 35 S101 current config num 11 done
009'582 35 S202 current config num 11 done
009'582 35 S300 num 12 waiting [6] shards 
009'582 35 S100 current config num 11 done
009'582 35 S302 num 12 waiting [6] shards 
009'582 35 S200 current config num 11 done
009'582 35 S201 current config num 11 done
009'582 35 S102 current config num 11 done
009'582 35 S301 num 12 waiting [6] shards 
009'587 34 S200 got new config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 11
009'588 34 S200 propose new config 12
009'592 34 S102 got new config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 11
009'595 34 S302 got new config {13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 12
009'596 28 S300 do request args:Key 4 type 3 num 14 Client 132246879705026825 Seq 6 
009'596 28 S300 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
join &{map[101:[server-101-0 server-101-1 server-101-2]] 1074585914363486070 14}
009'602 28 S300 do request args:Key 3 type 3 num 14 Client 2238025532150463055 Seq 8 
009'602 28 S300 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
009'602 28 S100 do request args:Key 7 type 3 num 14 Client 2972145661651991667 Seq 11 
009'602 28 S100 [667--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
009'605 28 S100 do request args:Key 9 type 3 num 14 Client 3620950086299709532 Seq 15 
009'605 28 S100 [532--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
009'614 30 S200 apply index 60 key num 0 type 4   lastApplied 59
009'614 34 S200 apply new config num 12 :&{12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
009'614 34 S200 inited need send [0 5 6],need recv []
009'614 31 S200 used size: 459 / 300 
009'615 29 S200 do snapshot for raft 60 60,size 568
009'615 27 S0 raft apply snapshot offset 60 ,lastApplied 60,total log 60, size 82,log cap:1
009'615 31 S200 after snap shot size82 568
009'621 28 S300 do request args:Key 6 type 3 num 14 Client 542732653461723544 Seq 4 
009'621 28 S300 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
009'630 34 S300 got new config {13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 12
009'632 28 S100 do request args:Key 0 type 3 num 14 Client 940626237948413081 Seq 10 
009'632 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
009'633 35 S102 current config num 11 done
009'633 35 S202 current config num 11 done
009'633 35 S300 num 12 waiting [6] shards 
009'633 35 S101 current config num 11 done
009'633 35 S100 current config num 11 done
009'633 35 S200 num 12 sending shards [0 5] to group 100
009'633 35 S200 num 12 sending shards [6] to group 102
009'634 35 S302 num 12 waiting [6] shards 
009'634 35 S201 current config num 11 done
009'634 35 S301 num 12 waiting [6] shards 
009'635 35 S100 num 11 handle num 12 move rpc [0 5]
009'636 35 S300 num 12 handle num 12 move rpc [6]
009'636 35 S300 move handle not leader
009'642 34 S100 got new config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 11
009'643 34 S100 propose new config 12
009'644 34 S101 got new config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 11
009'654 35 S301 num 12 handle num 12 move rpc [6]
009'654 35 S301 move handle num 12 shards [6] as leader?
009'655 35 S101 num 11 handle num 12 move rpc [0 5]
009'656 28 S300 do request args:Key 2 type 3 num 14 Client 1679014388048817729 Seq 27 
009'656 28 S300 [729--27] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
009'661 35 S102 num 11 handle num 12 move rpc [0 5]
009'661 30 S100 apply index 145 key num 0 type 4   lastApplied 144
009'661 34 S100 apply new config num 12 :&{12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
009'661 34 S100 inited need send [],need recv [0 5]
009'661 31 S100 used size: 463 / 300 
009'662 29 S100 do snapshot for raft 145 145,size 579
009'662 27 S0 raft apply snapshot offset 145 ,lastApplied 145,total log 145, size 86,log cap:1
009'662 31 S100 after snap shot size86 579
009'665 30 S301 apply index 33 key num 0 type 5   lastApplied 32
009'665 35 S301 apply num 12 migration [6]
009'665 30 S301 safely recv and decided shard 6
009'665 31 S301 used size: 521 / 300 
009'666 29 S301 do snapshot for raft 33 33,size 600
009'666 27 S1 raft apply snapshot offset 33 ,lastApplied 33,total log 33, size 82,log cap:1
009'666 31 S301 after snap shot size82 600
009'666 35 S301 num 12 move [6] is done yet
009'667 30 S200 after send shards ok
009'668 35 S200 move delete propose num 12 shards [6] as leader?
009'669 35 S200 num 12 sending shards [0 5] to group 100
009'669 35 S200 num 12 sending shards [6] to group 102
009'671 35 S100 num 12 handle num 12 move rpc [0 5]
009'672 35 S100 move handle num 12 shards [0 5] as leader?
009'674 35 S300 num 12 handle num 12 move rpc [6]
009'674 35 S300 move handle not leader
009'675 35 S301 num 12 handle num 12 move rpc [6]
009'675 35 S301 num 12 move [6] is done yet
009'677 30 S200 after send shards ok
009'678 35 S200 move delete propose num 12 shards [6] as leader?
009'678 30 S201 apply index 60 key num 0 type 4   lastApplied 59
009'678 34 S201 apply new config num 12 :&{12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
009'678 34 S201 inited need send [0 5 6],need recv []
009'678 31 S201 used size: 817 / 300 
009'679 30 S200 apply index 61 key num 0 type 5   lastApplied 60
009'679 35 S200 apply num 12 migration [6]
009'680 30 S200 safely delete shard 6
009'680 31 S200 used size: 626 / 300 
009'682 29 S200 do snapshot for raft 61 61,size 542
009'683 35 S102 current config num 11 done
009'683 35 S202 current config num 11 done
009'684 35 S101 current config num 11 done
009'684 35 S100 num 12 waiting [0 5] shards 
009'684 35 S302 num 12 waiting [6] shards 
009'684 35 S301 current config num 12 done
009'685 30 S202 apply index 60 key num 0 type 4   lastApplied 59
009'686 34 S202 apply new config num 12 :&{12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
009'686 34 S202 inited need send [0 5 6],need recv []
009'686 31 S202 used size: 817 / 300 
009'686 29 S202 do snapshot for raft 60 60,size 568
009'684 35 S300 num 12 waiting [6] shards 
009'679 29 S201 do snapshot for raft 60 60,size 568
009'689 27 S2 raft apply snapshot offset 60 ,lastApplied 60,total log 61, size 521,log cap:2
009'689 31 S202 after snap shot size521 568
009'693 34 S102 check new config wanted 12
009'697 34 S302 check new config wanted 13
009'701 27 S1 raft apply snapshot offset 60 ,lastApplied 60,total log 61, size 521,log cap:2
009'702 31 S201 after snap shot size521 568
009'702 35 S201 num 12 sending shards [0 5] to group 100
009'702 35 S201 num 12 sending shards [6] to group 102
009'703 35 S300 num 12 handle num 12 move rpc [6]
009'703 35 S300 move handle not leader
009'705 35 S100 num 12 handle num 12 move rpc [0 5]
009'705 27 S0 raft apply snapshot offset 61 ,lastApplied 61,total log 62, size 521,log cap:2
009'705 31 S200 after snap shot size521 542
009'705 34 S200 check new config wanted 13
009'706 35 S301 num 12 handle num 12 move rpc [6]
009'706 35 S301 num 12 move [6] is done yet
009'706 35 S200 num 12 sending shards [0 5] to group 100
009'706 30 S201 after send shards ok
009'706 35 S201 move delete propose not leader
009'711 35 S100 move handle num 12 shards [0 5] as leader?
009'711 35 S100 num 12 handle num 12 move rpc [0 5]
009'712 29 S202 recv Installsnapshot 61 60
009'712 27 S2 raft apply snapshot offset 61 ,lastApplied 61,total log 61, size 82,log cap:1
009'712 35 S100 move handle num 12 shards [0 5] as leader?
009'712 29 S202 decide Installsnapshot 61 <- 60
009'713 30 S202 install snap index 61,config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [true false false false false true false false false false]
009'716 30 S101 apply index 145 key num 0 type 4   lastApplied 144
009'716 34 S101 apply new config num 12 :&{12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
009'716 34 S101 inited need send [],need recv [0 5]
009'716 31 S101 used size: 889 / 300 
009'717 29 S101 do snapshot for raft 145 145,size 579
009'717 27 S1 raft apply snapshot offset 145 ,lastApplied 145,total log 146, size 593,log cap:2
009'717 31 S101 after snap shot size593 579
009'720 30 S100 apply index 146 key num 0 type 5   lastApplied 145
009'720 35 S100 apply num 12 migration [0 5]
009'720 30 S100 safely recv and decided shard 0
009'720 30 S100 safely recv and decided shard 5
009'720 31 S100 used size: 941 / 300 
009'723 29 S100 do snapshot for raft 146 146,size 667
009'725 27 S0 raft apply snapshot offset 146 ,lastApplied 146,total log 148, size 767,log cap:3
009'725 31 S100 after snap shot size767 667
009'726 35 S100 num 12 move [0 5] is done yet
009'727 30 S200 after send shards ok
009'729 35 S200 move delete propose num 12 shards [0 5] as leader?
009'737 35 S200 num 12 sending shards [0 5] to group 100
009'737 34 S300 check new config wanted 13
009'739 35 S300 num 12 waiting [6] shards 
009'741 35 S201 num 12 sending shards [0 5] to group 100
009'741 35 S201 num 12 sending shards [6] to group 102
009'745 35 S300 num 12 handle num 12 move rpc [6]
009'745 35 S300 move handle not leader
009'746 30 S100 apply index 147 key num 0 type 5   lastApplied 146
009'746 35 S100 apply num 12 migration [0 5]
009'746 31 S100 used size: 767 / 300 
009'746 29 S100 do snapshot for raft 147 147,size 667
009'747 27 S0 raft apply snapshot offset 147 ,lastApplied 148,total log 148, size 593,log cap:2
009'747 27 S0 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:12}, Num:0}}
009'747 31 S100 after snap shot size593 667
009'747 30 S100 apply index 148 key num 0 type 5   lastApplied 147
009'747 35 S100 apply num 12 migration [0 5]
009'747 31 S100 used size: 593 / 300 
009'748 34 S101 check new config wanted 13
009'749 30 S201 apply index 61 key num 0 type 5   lastApplied 60
009'749 35 S201 apply num 12 migration [6]
009'749 30 S201 safely delete shard 6
009'749 31 S201 used size: 800 / 300 
009'750 29 S201 do snapshot for raft 61 61,size 542
009'751 27 S1 raft apply snapshot offset 61 ,lastApplied 61,total log 63, size 695,log cap:3
009'751 31 S201 after snap shot size695 542
009'751 30 S200 apply index 62 key num 0 type 5   lastApplied 61
009'751 35 S200 apply num 12 migration [6]
009'751 31 S200 used size: 695 / 300 
009'752 29 S100 do snapshot for raft 148 148,size 667
009'753 27 S0 raft apply snapshot offset 148 ,lastApplied 148,total log 148, size 86,log cap:1
009'753 31 S100 after snap shot size86 667
009'753 35 S100 num 12 handle num 12 move rpc [0 5]
009'753 35 S100 num 12 move [0 5] is done yet
009'754 29 S200 do snapshot for raft 62 62,size 542
009'755 35 S302 num 12 waiting [6] shards 
009'756 35 S102 current config num 11 done
009'756 35 S202 num 12 sending shards [0 5] to group 100
009'756 35 S101 num 12 waiting [0 5] shards 
009'756 35 S100 current config num 12 done
009'757 35 S301 current config num 12 done
009'757 35 S100 num 12 move [0 5] is done yet
009'757 34 S100 check new config wanted 13
009'757 35 S100 num 12 move [0 5] is done yet
009'760 30 S201 after send shards ok
009'760 35 S201 move delete propose not leader
009'761 30 S101 apply index 146 key num 0 type 5   lastApplied 145
009'761 35 S101 apply num 12 migration [0 5]
009'761 30 S101 safely recv and decided shard 0
009'761 30 S101 safely recv and decided shard 5
009'761 31 S101 used size: 941 / 300 
009'762 29 S101 do snapshot for raft 146 146,size 667
009'762 35 S100 num 12 handle num 12 move rpc [0 5]
009'762 35 S100 num 12 move [0 5] is done yet
009'762 27 S1 raft apply snapshot offset 146 ,lastApplied 146,total log 148, size 767,log cap:3
009'762 31 S101 after snap shot size767 667
009'763 27 S0 raft apply snapshot offset 62 ,lastApplied 63,total log 63, size 589,log cap:2
009'764 27 S0 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:12}, Num:0}}
009'764 31 S200 after snap shot size589 542
009'764 30 S200 apply index 63 key num 0 type 5   lastApplied 62
009'764 35 S200 apply num 12 migration [0 5]
009'764 30 S200 safely delete shard 0
009'764 30 S200 safely delete shard 5
009'764 31 S200 used size: 589 / 300 
009'765 29 S200 do snapshot for raft 63 63,size 454
009'765 27 S0 raft apply snapshot offset 63 ,lastApplied 63,total log 63, size 82,log cap:1
009'765 31 S200 after snap shot size82 454
009'765 30 S200 after send shards ok
009'765 35 S200 num 12 move [0 5] is done yet
009'765 30 S102 apply index 145 key num 0 type 4   lastApplied 144
009'765 34 S102 apply new config num 12 :&{12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{11 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
009'765 34 S102 inited need send [],need recv [0 5]
009'765 31 S102 used size: 1237 / 300 
009'769 35 S301 num 12 handle num 12 move rpc [6]
009'769 35 S301 num 12 move [6] is done yet
009'776 29 S102 do snapshot for raft 145 145,size 579
009'777 27 S2 raft apply snapshot offset 145 ,lastApplied 145,total log 148, size 941,log cap:4
009'777 31 S102 after snap shot size941 579
009'777 29 S102 recv Installsnapshot 146 145
009'779 27 S2 raft apply snapshot offset 146 ,lastApplied 146,total log 148, size 767,log cap:3
009'779 29 S102 decide Installsnapshot 146 <- 145
009'780 30 S102 install snap index 146,config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
009'782 30 S200 after send shards ok
009'782 35 S200 num 12 move [0 5] is done yet
009'783 30 S201 after send shards ok
009'783 35 S201 move delete propose not leader
009'783 35 S200 current config num 12 done
009'792 35 S300 num 12 waiting [6] shards 
009'796 35 S201 num 12 sending shards [0 5] to group 100
009'811 35 S202 num 12 sending shards [0 5] to group 100
009'815 35 S302 num 12 waiting [6] shards 
009'806 35 S102 current config num 12 done
009'807 35 S101 current config num 12 done
009'807 35 S100 current config num 12 done
009'815 35 S100 num 12 handle num 12 move rpc [0 5]
009'816 35 S100 num 12 move [0 5] is done yet
009'807 35 S301 current config num 12 done
009'817 35 S100 num 12 handle num 12 move rpc [0 5]
009'817 35 S100 num 12 move [0 5] is done yet
009'818 35 S100 num 12 handle num 12 move rpc [0 5]
009'818 35 S100 num 12 move [0 5] is done yet
009'818 30 S202 after send shards ok
009'818 35 S202 move delete propose not leader
009'819 30 S202 after send shards ok
009'819 35 S202 move delete propose not leader
009'812 30 S201 after send shards ok
009'819 35 S201 num 12 move [6] is done yet
009'820 30 S201 after send shards ok
009'820 35 S201 move delete propose not leader
009'834 35 S200 current config num 12 done
009'837 35 S201 num 12 sending shards [0 5] to group 100
009'842 35 S100 num 12 handle num 12 move rpc [0 5]
009'842 35 S100 num 12 move [0 5] is done yet
009'842 35 S300 num 12 waiting [6] shards 
009'843 30 S201 after send shards ok
009'843 35 S201 move delete propose not leader
009'843 35 S202 num 12 sending shards [0 5] to group 100
009'846 35 S100 num 12 handle num 12 move rpc [0 5]
009'846 35 S100 num 12 move [0 5] is done yet
009'846 30 S202 after send shards ok
009'846 35 S202 move delete propose not leader
009'848 30 S302 apply index 33 key num 0 type 5   lastApplied 32
009'848 35 S302 apply num 12 migration [6]
009'848 30 S302 safely recv and decided shard 6
009'848 31 S302 used size: 521 / 300 
009'849 29 S302 do snapshot for raft 33 33,size 600
009'849 27 S2 raft apply snapshot offset 33 ,lastApplied 33,total log 33, size 82,log cap:1
009'849 31 S302 after snap shot size82 600
009'850 30 S300 apply index 33 key num 0 type 5   lastApplied 32
009'850 35 S300 apply num 12 migration [6]
009'850 30 S300 safely recv and decided shard 6
009'850 31 S300 used size: 521 / 300 
009'851 29 S300 do snapshot for raft 33 33,size 600
009'851 27 S0 raft apply snapshot offset 33 ,lastApplied 33,total log 33, size 82,log cap:1
009'851 31 S300 after snap shot size82 600
009'866 35 S100 current config num 12 done
009'866 35 S102 current config num 12 done
009'866 35 S101 current config num 12 done
009'866 35 S302 current config num 12 done
009'871 35 S201 num 12 sending shards [0 5] to group 100
009'872 35 S301 current config num 12 done
009'877 35 S100 num 12 handle num 12 move rpc [0 5]
009'877 35 S100 num 12 move [0 5] is done yet
009'877 30 S201 after send shards ok
009'877 35 S201 move delete propose not leader
009'877 35 S202 num 12 sending shards [0 5] to group 100
009'879 35 S100 num 12 handle num 12 move rpc [0 5]
009'879 35 S100 num 12 move [0 5] is done yet
009'880 30 S202 after send shards ok
009'880 35 S202 move delete propose not leader
009'885 35 S200 current config num 12 done
009'890 44 S2 ctrler change to config &{15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
009'892 34 S202 got new config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 11
009'896 35 S300 current config num 12 done
009'903 35 S201 num 12 sending shards [0 5] to group 100
009'904 35 S100 num 12 handle num 12 move rpc [0 5]
009'904 35 S100 num 12 move [0 5] is done yet
009'905 30 S201 after send shards ok
009'905 35 S201 move delete propose not leader
009'913 44 S0 ctrler change to config &{15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
009'915 35 S202 num 12 sending shards [0 5] to group 100
009'916 35 S101 current config num 12 done
009'916 35 S100 current config num 12 done
009'916 35 S102 current config num 12 done
009'916 35 S302 current config num 12 done
009'916 35 S100 num 12 handle num 12 move rpc [0 5]
009'916 35 S100 num 12 move [0 5] is done yet
009'917 30 S202 after send shards ok
009'917 35 S202 move delete propose not leader
009'934 35 S301 current config num 12 done
009'935 35 S201 num 12 sending shards [0 5] to group 100
009'937 35 S100 num 12 handle num 12 move rpc [0 5]
009'937 35 S100 num 12 move [0 5] is done yet
009'937 30 S201 after send shards ok
009'937 35 S201 move delete propose not leader
009'938 35 S200 current config num 12 done
009'946 35 S202 num 12 sending shards [0 5] to group 100
009'947 35 S100 num 12 handle num 12 move rpc [0 5]
009'948 35 S100 num 12 move [0 5] is done yet
009'948 30 S202 after send shards ok
009'948 35 S202 move delete propose not leader
009'948 35 S300 current config num 12 done
009'954 44 S1 ctrler change to config &{15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
009'968 35 S102 current config num 12 done
009'968 35 S201 num 12 sending shards [0 5] to group 100
009'974 35 S101 current config num 12 done
009'974 35 S100 current config num 12 done
009'974 35 S302 current config num 12 done
009'976 35 S100 num 12 handle num 12 move rpc [0 5]
009'976 35 S100 num 12 move [0 5] is done yet
009'977 30 S201 after send shards ok
009'977 35 S201 move delete propose not leader
009'985 35 S202 num 12 sending shards [0 5] to group 100
009'987 35 S100 num 12 handle num 12 move rpc [0 5]
009'987 35 S100 num 12 move [0 5] is done yet
009'987 35 S301 current config num 12 done
009'987 30 S202 after send shards ok
009'987 35 S202 move delete propose not leader
009'991 35 S200 current config num 12 done
009'997 34 S202 check new config wanted 13
009'998 35 S300 current config num 12 done
010'005 35 S201 num 12 sending shards [0 5] to group 100
010'008 30 S201 apply index 62 key num 0 type 5   lastApplied 61
010'008 35 S201 apply num 12 migration [6]
010'008 31 S201 used size: 695 / 300 
010'008 29 S201 do snapshot for raft 62 62,size 542
010'009 27 S1 raft apply snapshot offset 62 ,lastApplied 63,total log 63, size 589,log cap:2
010'009 27 S1 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:12}, Num:0}}
010'009 31 S201 after snap shot size589 542
010'009 30 S201 apply index 63 key num 0 type 5   lastApplied 62
010'009 35 S201 apply num 12 migration [0 5]
010'009 30 S201 safely delete shard 0
010'009 30 S201 safely delete shard 5
010'009 31 S201 used size: 589 / 300 
010'010 29 S201 do snapshot for raft 63 63,size 454
010'010 27 S1 raft apply snapshot offset 63 ,lastApplied 63,total log 63, size 82,log cap:1
010'010 31 S201 after snap shot size82 454
010'012 30 S202 apply index 62 key num 0 type 5   lastApplied 61
010'012 35 S100 num 12 handle num 12 move rpc [0 5]
010'012 35 S202 apply num 12 migration [6]
010'012 35 S100 num 12 move [0 5] is done yet
010'012 31 S202 used size: 695 / 300 
010'012 30 S201 after send shards ok
010'012 29 S202 do snapshot for raft 62 62,size 542
010'012 35 S201 num 12 move [0 5] is done yet
010'013 27 S2 raft apply snapshot offset 62 ,lastApplied 63,total log 63, size 589,log cap:2
010'013 27 S2 last applied not snapshoted raft.LogEntry{Term:4, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:12}, Num:0}}
010'013 31 S202 after snap shot size589 542
010'013 30 S202 apply index 63 key num 0 type 5   lastApplied 62
010'013 35 S202 apply num 12 migration [0 5]
010'013 30 S202 safely delete shard 0
010'013 30 S202 safely delete shard 5
010'013 31 S202 used size: 589 / 300 
010'014 29 S202 do snapshot for raft 63 63,size 454
010'014 27 S2 raft apply snapshot offset 63 ,lastApplied 63,total log 63, size 82,log cap:1
010'014 31 S202 after snap shot size82 454
010'016 35 S202 current config num 12 done
010'029 35 S102 current config num 12 done
010'029 35 S101 current config num 12 done
010'029 35 S100 current config num 12 done
010'029 35 S302 current config num 12 done
010'039 35 S301 current config num 12 done
010'039 35 S201 current config num 12 done
010'043 35 S200 current config num 12 done
010'045 30 S102 apply index 147 key num 0 type 5   lastApplied 146
010'045 35 S102 apply num 12 migration [0 5]
010'045 31 S102 used size: 767 / 300 
010'046 29 S102 do snapshot for raft 147 147,size 667
010'046 27 S2 raft apply snapshot offset 147 ,lastApplied 148,total log 148, size 593,log cap:2
010'046 27 S2 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:12}, Num:0}}
010'047 31 S102 after snap shot size593 667
010'047 30 S102 apply index 148 key num 0 type 5   lastApplied 147
010'047 35 S102 apply num 12 migration [0 5]
010'047 31 S102 used size: 593 / 300 
010'047 29 S102 do snapshot for raft 148 148,size 667
010'048 27 S2 raft apply snapshot offset 148 ,lastApplied 148,total log 148, size 86,log cap:1
010'048 31 S102 after snap shot size86 667
010'049 30 S101 apply index 147 key num 0 type 5   lastApplied 146
010'049 35 S101 apply num 12 migration [0 5]
010'050 31 S101 used size: 767 / 300 
010'051 29 S101 do snapshot for raft 147 147,size 667
010'052 27 S1 raft apply snapshot offset 147 ,lastApplied 148,total log 148, size 593,log cap:2
010'052 27 S1 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:12}, Num:0}}
010'052 31 S101 after snap shot size593 667
010'052 30 S101 apply index 148 key num 0 type 5   lastApplied 147
010'052 35 S101 apply num 12 migration [0 5]
010'052 31 S101 used size: 593 / 300 
010'053 29 S101 do snapshot for raft 148 148,size 667
010'053 27 S1 raft apply snapshot offset 148 ,lastApplied 148,total log 148, size 86,log cap:1
010'053 31 S101 after snap shot size86 667
010'054 35 S300 current config num 12 done
010'084 35 S302 current config num 12 done
010'084 35 S102 current config num 12 done
010'084 35 S100 current config num 12 done
010'084 35 S101 current config num 12 done
010'069 35 S202 current config num 12 done
010'092 35 S201 current config num 12 done
010'092 35 S301 current config num 12 done
010'097 35 S200 current config num 12 done
010'105 35 S300 current config num 12 done
010'134 35 S102 current config num 12 done
010'134 35 S302 current config num 12 done
010'135 35 S100 current config num 12 done
010'135 35 S101 current config num 12 done
010'135 35 S202 current config num 12 done
010'148 35 S200 current config num 12 done
010'148 35 S301 current config num 12 done
010'148 35 S201 current config num 12 done
010'158 35 S300 current config num 12 done
010'185 28 S200 do request args:Key 8 type 3 num 15 Client 2953714763196401582 Seq 2 
010'185 28 S200 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
010'186 35 S202 current config num 12 done
010'186 35 S102 current config num 12 done
010'186 35 S302 current config num 12 done
010'186 35 S101 current config num 12 done
010'186 35 S100 current config num 12 done
010'198 35 S200 current config num 12 done
010'198 35 S301 current config num 12 done
010'198 35 S201 current config num 12 done
010'229 35 S300 current config num 12 done
010'238 35 S102 current config num 12 done
010'238 35 S302 current config num 12 done
010'238 35 S101 current config num 12 done
010'238 35 S100 current config num 12 done
010'238 35 S202 current config num 12 done
010'248 35 S201 current config num 12 done
010'248 35 S200 current config num 12 done
010'248 35 S301 current config num 12 done
010'287 34 S301 got new config {13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 12
010'288 34 S301 propose new config 13
010'288 34 S200 got new config {13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 12
010'289 34 S200 propose new config 13
010'292 35 S100 current config num 12 done
010'292 35 S300 current config num 12 done
010'293 35 S102 current config num 12 done
010'293 35 S302 current config num 12 done
010'293 35 S101 current config num 12 done
010'293 35 S202 current config num 12 done
010'300 35 S201 current config num 12 done
010'300 35 S200 current config num 12 done
010'300 35 S301 current config num 12 done
010'307 32 S100 server killed######
010'307 32 S101 server killed######
010'315 32 S102 server killed######
010'315 32 S200 server killed######
010'315 32 S201 server killed######
010'315 32 S202 server killed######
010'315 32 S300 server killed######
010'315 32 S301 server killed######
010'315 32 S302 server killed######
010'316 30 S100 install snap index 148,config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
010'318 30 S101 install snap index 148,config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
010'320 30 S102 install snap index 148,config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
010'323 30 S200 install snap index 63,config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
010'349 35 S200 current config num 12 done
010'350 34 S100 check new config wanted 13
010'352 30 S201 install snap index 63,config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
010'354 30 S202 install snap index 63,config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
010'357 34 S200 check new config wanted 13
010'351 35 S100 current config num 12 done
010'371 28 S100 do request args:Key 9 type 3 num 15 Client 3620950086299709532 Seq 15 
010'371 28 S100 [532--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
010'351 35 S101 current config num 12 done
010'374 34 S202 check new config wanted 13
010'375 35 S202 current config num 12 done
010'376 30 S300 install snap index 33,config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
010'377 35 S300 current config num 12 done
010'377 34 S300 check new config wanted 13
010'379 30 S301 install snap index 33,config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
010'380 34 S301 check new config wanted 13
010'381 35 S301 current config num 12 done
010'382 30 S302 install snap index 33,config {12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
010'383 35 S302 current config num 12 done
010'383 34 S302 check new config wanted 13
010'386 28 S301 do request args:Key 3 type 3 num 15 Client 2238025532150463055 Seq 8 
010'386 28 S301 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
010'358 34 S201 check new config wanted 13
010'387 35 S201 current config num 12 done
010'389 34 S101 check new config wanted 13
010'351 34 S102 check new config wanted 13
010'395 35 S102 current config num 12 done
010'402 28 S200 do request args:Key 7 type 3 num 15 Client 2972145661651991667 Seq 11 
010'402 28 S200 [667--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
010'403 28 S100 do request args:Key 1 type 3 num 15 Client 418781717203629479 Seq 23 
010'403 28 S100 [479--23] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
010'417 28 S300 do request args:Key 4 type 3 num 15 Client 132246879705026825 Seq 6 
010'417 28 S300 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
010'419 28 S300 do request args:Key 5 type 3 num 15 Client 3482757038087095369 Seq 5 
010'419 28 S300 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
010'420 28 S300 do request args:Key 6 type 3 num 15 Client 542732653461723544 Seq 4 
010'420 28 S300 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
010'425 28 S100 do request args:Key 0 type 3 num 15 Client 940626237948413081 Seq 10 
010'425 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
010'426 35 S100 current config num 12 done
010'426 35 S101 current config num 12 done
010'426 35 S202 current config num 12 done
010'428 35 S300 current config num 12 done
010'429 28 S200 do request args:Key 2 type 3 num 15 Client 1679014388048817729 Seq 27 
010'429 28 S200 [729--27] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
010'430 35 S200 current config num 12 done
010'431 35 S301 current config num 12 done
010'435 35 S302 current config num 12 done
010'438 35 S201 current config num 12 done
010'446 35 S102 current config num 12 done
010'477 35 S202 current config num 12 done
010'477 35 S100 current config num 12 done
010'477 35 S101 current config num 12 done
010'478 35 S300 current config num 12 done
010'480 35 S200 current config num 12 done
010'482 35 S301 current config num 12 done
010'490 35 S201 current config num 12 done
010'492 30 S202 nop apply <nil>
010'498 35 S102 current config num 12 done
010'502 35 S302 current config num 12 done
010'528 35 S101 current config num 12 done
010'528 35 S300 current config num 12 done
010'530 35 S200 current config num 12 done
010'531 35 S100 current config num 12 done
010'537 35 S202 current config num 12 done
010'548 35 S301 current config num 12 done
010'551 35 S102 current config num 12 done
010'553 35 S302 current config num 12 done
010'578 35 S101 current config num 12 done
010'587 30 S300 nop apply <nil>
010'588 35 S202 current config num 12 done
010'556 35 S201 current config num 12 done
010'606 35 S301 current config num 12 done
010'608 35 S200 current config num 12 done
010'608 35 S300 current config num 12 done
010'608 35 S100 current config num 12 done
010'608 30 S100 nop apply <nil>
010'622 35 S102 current config num 12 done
010'633 35 S302 current config num 12 done
010'633 35 S101 current config num 12 done
010'641 35 S202 current config num 12 done
010'654 35 S201 current config num 12 done
010'658 35 S300 current config num 12 done
010'659 35 S200 current config num 12 done
010'659 35 S100 current config num 12 done
010'659 35 S301 current config num 12 done
010'672 35 S102 current config num 12 done
010'688 35 S101 current config num 12 done
010'688 35 S302 current config num 12 done
010'699 35 S202 current config num 12 done
010'709 35 S100 current config num 12 done
010'709 35 S201 current config num 12 done
010'709 35 S200 current config num 12 done
010'709 35 S300 current config num 12 done
010'710 35 S301 current config num 12 done
010'732 35 S102 current config num 12 done
010'740 35 S302 current config num 12 done
010'740 35 S101 current config num 12 done
010'749 35 S202 current config num 12 done
010'761 35 S300 current config num 12 done
010'761 35 S100 current config num 12 done
010'761 35 S201 current config num 12 done
010'761 35 S200 current config num 12 done
010'761 35 S301 current config num 12 done
010'776 34 S202 got new config {13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 12
010'779 28 S200 do request args:Key 8 type 3 num 15 Client 2953714763196401582 Seq 2 
010'779 28 S200 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
010'781 34 S102 got new config {13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 12
010'782 34 S300 got new config {13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 12
010'782 34 S300 propose new config 13
010'784 34 S200 got new config {13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 12
010'827 34 S302 got new config {13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 12
010'809 35 S302 current config num 12 done
010'809 35 S101 current config num 12 done
010'809 35 S202 current config num 12 done
010'809 35 S102 current config num 12 done
010'816 35 S201 current config num 12 done
010'842 30 S302 nop apply <nil>
010'842 31 S302 used size: 419 / 300 
010'816 35 S100 current config num 12 done
010'816 35 S300 current config num 12 done
010'843 30 S300 apply index 35 key num 0 type 4   lastApplied 34
010'843 34 S300 apply new config num 13 :&{13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
010'843 34 S300 inited need send [1 2 3 4 6],need recv []
010'843 31 S300 used size: 419 / 300 
010'816 35 S200 current config num 12 done
010'816 35 S301 current config num 12 done
010'845 30 S301 nop apply <nil>
010'845 31 S301 used size: 419 / 300 
010'845 30 S102 nop apply <nil>
010'845 29 S301 do snapshot for raft 34 34,size 600
010'846 27 S1 raft apply snapshot offset 34 ,lastApplied 34,total log 35, size 416,log cap:2
010'846 31 S301 after snap shot size416 600
010'847 34 S201 got new config {13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 12
010'853 30 S101 nop apply <nil>
010'860 29 S300 do snapshot for raft 35 35,size 558
010'863 27 S0 raft apply snapshot offset 35 ,lastApplied 35,total log 35, size 82,log cap:1
010'863 31 S300 after snap shot size82 558
010'863 28 S300 do request args:Key 5 type 3 num 15 Client 3482757038087095369 Seq 5 
010'863 28 S300 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
010'843 29 S302 do snapshot for raft 34 34,size 600
010'864 27 S2 raft apply snapshot offset 34 ,lastApplied 34,total log 35, size 416,log cap:2
010'864 31 S302 after snap shot size416 600
010'869 30 S301 apply index 35 key num 0 type 4   lastApplied 34
010'869 34 S301 apply new config num 13 :&{13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
010'869 34 S301 inited need send [1 2 3 4 6],need recv []
010'870 31 S301 used size: 416 / 300 
010'870 29 S301 do snapshot for raft 35 35,size 558
010'870 27 S1 raft apply snapshot offset 35 ,lastApplied 35,total log 35, size 82,log cap:1
010'870 31 S301 after snap shot size82 558
010'873 30 S302 apply index 35 key num 0 type 4   lastApplied 34
010'873 34 S302 apply new config num 13 :&{13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
010'873 34 S302 inited need send [1 2 3 4 6],need recv []
010'873 31 S302 used size: 416 / 300 
010'874 29 S302 do snapshot for raft 35 35,size 558
010'874 27 S2 raft apply snapshot offset 35 ,lastApplied 35,total log 35, size 82,log cap:1
010'874 31 S302 after snap shot size82 558
010'877 34 S202 check new config wanted 13
010'882 34 S102 check new config wanted 13
010'883 34 S300 check new config wanted 14
010'890 34 S301 got new config {13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 12
010'891 34 S200 check new config wanted 13
010'892 35 S202 current config num 12 done
010'892 35 S101 current config num 12 done
010'892 35 S201 current config num 12 done
010'895 35 S302 num 13 sending shards [1 2 3 4 6] to group 100
010'897 35 S100 num 12 handle num 13 move rpc [1 2 3 4 6]
010'900 35 S102 current config num 12 done
010'902 35 S101 num 12 handle num 13 move rpc [1 2 3 4 6]
010'903 35 S100 current config num 12 done
010'904 35 S300 num 13 sending shards [1 2 3 4 6] to group 100
010'906 35 S100 num 12 handle num 13 move rpc [1 2 3 4 6]
010'907 35 S200 current config num 12 done
010'907 35 S301 num 13 sending shards [1 2 3 4 6] to group 100
010'911 35 S100 num 12 handle num 13 move rpc [1 2 3 4 6]
010'924 35 S101 num 12 handle num 13 move rpc [1 2 3 4 6]
010'926 35 S302 num 13 sending shards [1 2 3 4 6] to group 100
010'926 35 S102 num 12 handle num 13 move rpc [1 2 3 4 6]
010'935 35 S300 num 13 sending shards [1 2 3 4 6] to group 100
010'939 35 S101 num 12 handle num 13 move rpc [1 2 3 4 6]
010'941 35 S301 num 13 sending shards [1 2 3 4 6] to group 100
010'942 35 S102 num 12 handle num 13 move rpc [1 2 3 4 6]
010'943 35 S202 current config num 12 done
010'943 35 S101 current config num 12 done
010'944 35 S201 current config num 12 done
010'963 34 S302 check new config wanted 14
010'963 35 S102 current config num 12 done
010'963 34 S201 check new config wanted 13
010'963 35 S302 num 13 sending shards [1 2 3 4 6] to group 100
010'968 34 S100 got new config {13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 12
010'968 34 S100 propose new config 13
010'969 35 S100 num 12 handle num 13 move rpc [1 2 3 4 6]
010'972 35 S301 num 13 sending shards [1 2 3 4 6] to group 100
010'972 34 S101 got new config {13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 12
010'972 35 S200 current config num 12 done
010'973 35 S300 num 13 sending shards [1 2 3 4 6] to group 100
010'975 35 S102 num 12 handle num 13 move rpc [1 2 3 4 6]
010'978 35 S100 num 12 handle num 13 move rpc [1 2 3 4 6]
010'980 35 S101 num 12 handle num 13 move rpc [1 2 3 4 6]
010'983 35 S100 num 12 handle num 13 move rpc [1 2 3 4 6]
010'983 35 S102 num 12 handle num 13 move rpc [1 2 3 4 6]
010'985 35 S101 num 12 handle num 13 move rpc [1 2 3 4 6]
010'986 35 S102 num 12 handle num 13 move rpc [1 2 3 4 6]
010'989 35 S100 current config num 12 done
010'994 35 S101 current config num 12 done
010'994 35 S201 current config num 12 done
011'006 30 S100 apply index 150 key num 0 type 4   lastApplied 149
011'006 34 S100 apply new config num 13 :&{13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
011'007 34 S100 inited need send [],need recv [1 2 3 4 6]
011'007 31 S100 used size: 423 / 300 
011'007 29 S100 do snapshot for raft 150 150,size 625
011'007 27 S0 raft apply snapshot offset 150 ,lastApplied 150,total log 150, size 86,log cap:1
011'007 31 S100 after snap shot size86 625
011'008 35 S202 current config num 12 done
011'014 35 S100 num 13 handle num 13 move rpc [1 2 3 4 6]
011'017 35 S100 move handle num 13 shards [1 2 3 4 6] as leader?
011'020 34 S301 check new config wanted 14
011'020 35 S302 num 13 sending shards [1 2 3 4 6] to group 100
011'024 35 S101 num 12 handle num 13 move rpc [1 2 3 4 6]
011'025 35 S100 num 13 handle num 13 move rpc [1 2 3 4 6]
011'026 35 S100 move handle num 13 shards [1 2 3 4 6] as leader?
011'028 35 S100 num 13 handle num 13 move rpc [1 2 3 4 6]
011'029 35 S100 move handle num 13 shards [1 2 3 4 6] as leader?
011'031 35 S100 num 13 handle num 13 move rpc [1 2 3 4 6]
011'033 35 S300 num 13 sending shards [1 2 3 4 6] to group 100
011'030 35 S200 current config num 12 done
011'034 35 S301 num 13 sending shards [1 2 3 4 6] to group 100
011'030 35 S102 current config num 12 done
011'043 35 S100 move handle num 13 shards [1 2 3 4 6] as leader?
011'048 35 S100 num 13 handle num 13 move rpc [1 2 3 4 6]
011'049 35 S100 move handle num 13 shards [1 2 3 4 6] as leader?
011'052 35 S302 num 13 sending shards [1 2 3 4 6] to group 100
011'053 30 S101 apply index 150 key num 0 type 4   lastApplied 149
011'053 34 S101 apply new config num 13 :&{13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
011'053 34 S101 inited need send [],need recv [1 2 3 4 6]
011'053 31 S101 used size: 1463 / 300 
011'054 29 S101 do snapshot for raft 150 150,size 625
011'055 27 S1 raft apply snapshot offset 150 ,lastApplied 150,total log 153, size 1206,log cap:4
011'055 31 S101 after snap shot size1206 625
011'055 30 S100 apply index 151 key num 0 type 5   lastApplied 150
011'055 35 S100 apply num 13 migration [1 2 3 4 6]
011'055 30 S100 safely recv and decided shard 1
011'055 30 S100 safely recv and decided shard 2
011'055 30 S100 safely recv and decided shard 3
011'055 30 S100 safely recv and decided shard 4
011'055 30 S100 safely recv and decided shard 6
011'055 31 S100 used size: 1730 / 300 
011'056 29 S100 do snapshot for raft 151 151,size 770
011'057 27 S0 raft apply snapshot offset 151 ,lastApplied 153,total log 155, size 1468,log cap:5
011'057 27 S0 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:13}, Num:0}}
011'058 31 S100 after snap shot size1468 770
011'058 30 S100 apply index 152 key num 0 type 5   lastApplied 151
011'058 35 S100 apply num 13 migration [1 2 3 4 6]
011'058 31 S100 used size: 1468 / 300 
011'058 29 S100 do snapshot for raft 152 152,size 770
011'059 27 S0 raft apply snapshot offset 152 ,lastApplied 153,total log 155, size 1206,log cap:4
011'060 27 S0 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:13}, Num:0}}
011'060 31 S100 after snap shot size1206 770
011'060 30 S100 apply index 153 key num 0 type 5   lastApplied 152
011'060 35 S100 apply num 13 migration [1 2 3 4 6]
011'060 31 S100 used size: 1206 / 300 
011'061 29 S100 do snapshot for raft 153 153,size 770
011'061 27 S0 raft apply snapshot offset 153 ,lastApplied 153,total log 155, size 944,log cap:3
011'062 31 S100 after snap shot size944 770
011'062 35 S100 num 13 move [1 2 3 4 6] is done yet
011'062 35 S100 num 13 move [1 2 3 4 6] is done yet
011'063 30 S300 after send shards ok
011'064 35 S300 move delete propose num 13 shards [1 2 3 4 6] as leader?
011'064 35 S100 current config num 13 done
011'064 35 S300 num 13 sending shards [1 2 3 4 6] to group 100
011'064 35 S100 num 13 move [1 2 3 4 6] is done yet
011'064 30 S301 after send shards ok
011'065 35 S301 move delete propose not leader
011'065 30 S302 after send shards ok
011'067 35 S302 move delete propose not leader
011'065 35 S100 num 13 handle num 13 move rpc [1 2 3 4 6]
011'067 35 S100 num 13 move [1 2 3 4 6] is done yet
011'065 35 S201 current config num 12 done
011'067 30 S300 after send shards ok
011'068 35 S300 move delete propose num 13 shards [1 2 3 4 6] as leader?
011'065 35 S101 num 13 waiting [1 2 3 4 6] shards 
011'068 34 S100 check new config wanted 14
011'068 35 S202 current config num 12 done
011'066 35 S102 num 12 handle num 13 move rpc [1 2 3 4 6]
011'074 35 S301 num 13 sending shards [1 2 3 4 6] to group 100
011'074 30 S102 apply index 150 key num 0 type 4   lastApplied 149
011'074 34 S102 apply new config num 13 :&{13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
011'074 34 S102 inited need send [],need recv [1 2 3 4 6]
011'075 31 S102 used size: 1463 / 300 
011'077 34 S101 check new config wanted 14
011'079 35 S100 num 13 handle num 13 move rpc [1 2 3 4 6]
011'079 35 S100 num 13 move [1 2 3 4 6] is done yet
011'085 35 S100 num 13 handle num 13 move rpc [1 2 3 4 6]
011'085 35 S100 num 13 move [1 2 3 4 6] is done yet
011'085 30 S302 after send shards ok
011'085 35 S302 move delete propose not leader
011'086 35 S200 current config num 12 done
011'086 30 S301 after send shards ok
011'086 35 S301 move delete propose not leader
011'088 35 S302 num 13 sending shards [1 2 3 4 6] to group 100
011'089 29 S102 do snapshot for raft 150 150,size 625
011'094 27 S2 raft apply snapshot offset 150 ,lastApplied 153,total log 155, size 1730,log cap:6
011'094 27 S2 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:13}, Num:0}}
011'094 31 S102 after snap shot size1730 625
011'094 30 S102 apply index 151 key num 0 type 5   lastApplied 150
011'095 35 S102 apply num 13 migration [1 2 3 4 6]
011'095 30 S102 safely recv and decided shard 1
011'095 30 S102 safely recv and decided shard 2
leave &{[101] 1074585914363486070 15}
011'095 30 S102 safely recv and decided shard 3
011'095 30 S102 safely recv and decided shard 4
011'095 30 S102 safely recv and decided shard 6
011'095 31 S102 used size: 1730 / 300 
011'095 29 S102 do snapshot for raft 151 151,size 770
011'097 27 S2 raft apply snapshot offset 151 ,lastApplied 153,total log 155, size 1468,log cap:5
011'097 27 S2 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:13}, Num:0}}
011'097 31 S102 after snap shot size1468 770
011'097 30 S102 apply index 152 key num 0 type 5   lastApplied 151
011'097 35 S102 apply num 13 migration [1 2 3 4 6]
011'097 31 S102 used size: 1468 / 300 
011'098 29 S102 do snapshot for raft 152 152,size 770
leave &{[101] 1074585914363486070 15}
011'099 27 S2 raft apply snapshot offset 152 ,lastApplied 153,total log 155, size 1206,log cap:4
011'099 27 S2 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:13}, Num:0}}
011'100 31 S102 after snap shot size1206 770
011'100 30 S102 apply index 153 key num 0 type 5   lastApplied 152
011'100 35 S102 apply num 13 migration [1 2 3 4 6]
011'100 31 S102 used size: 1206 / 300 
011'101 29 S102 do snapshot for raft 153 153,size 770
011'101 27 S2 raft apply snapshot offset 153 ,lastApplied 153,total log 155, size 944,log cap:3
011'102 31 S102 after snap shot size944 770
011'102 35 S102 current config num 13 done
011'104 35 S300 num 13 sending shards [1 2 3 4 6] to group 100
011'106 35 S301 num 13 sending shards [1 2 3 4 6] to group 100
011'111 35 S100 num 13 handle num 13 move rpc [1 2 3 4 6]
011'112 35 S100 num 13 move [1 2 3 4 6] is done yet
011'119 30 S300 after send shards ok
011'121 35 S300 move delete propose num 13 shards [1 2 3 4 6] as leader?
011'121 35 S101 num 13 waiting [1 2 3 4 6] shards 
011'122 35 S201 current config num 12 done
011'127 30 S101 apply index 151 key num 0 type 5   lastApplied 150
011'128 35 S101 apply num 13 migration [1 2 3 4 6]
011'128 30 S101 safely recv and decided shard 1
011'128 30 S101 safely recv and decided shard 2
011'128 30 S101 safely recv and decided shard 3
011'128 30 S101 safely recv and decided shard 4
011'128 30 S101 safely recv and decided shard 6
011'128 31 S101 used size: 1730 / 300 
011'128 29 S101 do snapshot for raft 151 151,size 770
011'130 27 S1 raft apply snapshot offset 151 ,lastApplied 153,total log 155, size 1468,log cap:5
011'130 27 S1 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:13}, Num:0}}
011'130 31 S101 after snap shot size1468 770
011'130 30 S101 apply index 152 key num 0 type 5   lastApplied 151
011'130 35 S101 apply num 13 migration [1 2 3 4 6]
011'130 31 S101 used size: 1468 / 300 
011'132 29 S101 do snapshot for raft 152 152,size 770
011'133 27 S1 raft apply snapshot offset 152 ,lastApplied 153,total log 155, size 1206,log cap:4
011'133 27 S1 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:13}, Num:0}}
011'133 31 S101 after snap shot size1206 770
011'133 30 S101 apply index 153 key num 0 type 5   lastApplied 152
011'133 35 S101 apply num 13 migration [1 2 3 4 6]
011'133 31 S101 used size: 1206 / 300 
011'134 29 S101 do snapshot for raft 153 153,size 770
011'135 27 S1 raft apply snapshot offset 153 ,lastApplied 153,total log 155, size 944,log cap:3
011'135 31 S101 after snap shot size944 770
011'135 35 S300 num 13 sending shards [1 2 3 4 6] to group 100
011'136 35 S301 num 13 sending shards [1 2 3 4 6] to group 100
011'116 35 S100 current config num 13 done
011'146 30 S100 apply index 154 key num 0 type 5   lastApplied 153
011'146 35 S100 apply num 13 migration [1 2 3 4 6]
011'146 31 S100 used size: 944 / 300 
011'147 29 S100 do snapshot for raft 154 154,size 770
011'151 30 S300 apply index 36 key num 0 type 5   lastApplied 35
011'152 35 S300 apply num 13 migration [1 2 3 4 6]
011'152 30 S300 safely delete shard 1
011'152 30 S300 safely delete shard 2
011'152 30 S300 safely delete shard 3
011'152 30 S300 safely delete shard 4
011'152 30 S300 safely delete shard 6
011'152 31 S300 used size: 1202 / 300 
011'152 29 S300 do snapshot for raft 36 36,size 412
011'124 35 S202 current config num 12 done
011'155 35 S302 num 13 sending shards [1 2 3 4 6] to group 100
011'136 35 S200 current config num 12 done
011'159 27 S0 raft apply snapshot offset 154 ,lastApplied 155,total log 155, size 682,log cap:2
011'159 27 S0 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:13}, Num:0}}
011'160 31 S100 after snap shot size682 770
011'160 30 S100 apply index 155 key num 0 type 5   lastApplied 154
011'160 35 S100 apply num 13 migration [1 2 3 4 6]
011'160 31 S100 used size: 682 / 300 
011'160 29 S100 do snapshot for raft 155 155,size 770
011'161 27 S0 raft apply snapshot offset 155 ,lastApplied 155,total log 155, size 86,log cap:1
011'161 31 S100 after snap shot size86 770
011'162 35 S100 num 13 move [1 2 3 4 6] is done yet
011'163 30 S302 after send shards ok
011'163 35 S302 move delete propose not leader
011'163 35 S100 num 13 handle num 13 move rpc [1 2 3 4 6]
011'163 35 S100 num 13 move [1 2 3 4 6] is done yet
011'163 35 S100 num 13 move [1 2 3 4 6] is done yet
011'164 30 S102 apply index 154 key num 0 type 5   lastApplied 153
011'164 35 S102 apply num 13 migration [1 2 3 4 6]
011'164 31 S102 used size: 944 / 300 
011'165 29 S102 do snapshot for raft 154 154,size 770
011'166 27 S2 raft apply snapshot offset 154 ,lastApplied 155,total log 155, size 682,log cap:2
011'168 27 S0 raft apply snapshot offset 36 ,lastApplied 37,total log 38, size 940,log cap:3
011'168 27 S0 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:13}, Num:0}}
011'168 31 S300 after snap shot size940 412
011'168 30 S300 apply index 37 key num 0 type 5   lastApplied 36
011'168 35 S300 apply num 13 migration [1 2 3 4 6]
011'168 31 S300 used size: 940 / 300 
011'169 29 S300 do snapshot for raft 37 37,size 412
011'170 27 S0 raft apply snapshot offset 37 ,lastApplied 37,total log 38, size 678,log cap:2
011'170 31 S300 after snap shot size678 412
011'173 35 S201 current config num 12 done
011'173 30 S302 apply index 36 key num 0 type 5   lastApplied 35
011'173 35 S302 apply num 13 migration [1 2 3 4 6]
011'173 30 S302 safely delete shard 1
011'173 30 S302 safely delete shard 2
011'173 30 S302 safely delete shard 3
011'173 30 S302 safely delete shard 4
011'173 30 S302 safely delete shard 6
011'173 31 S302 used size: 1202 / 300 
011'174 29 S302 do snapshot for raft 36 36,size 412
011'175 27 S2 raft apply snapshot offset 36 ,lastApplied 37,total log 38, size 940,log cap:3
011'175 27 S2 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:13}, Num:0}}
011'175 31 S302 after snap shot size940 412
011'175 30 S302 apply index 37 key num 0 type 5   lastApplied 36
011'175 35 S302 apply num 13 migration [1 2 3 4 6]
011'175 31 S302 used size: 940 / 300 
011'176 29 S302 do snapshot for raft 37 37,size 412
011'177 27 S2 raft apply snapshot offset 37 ,lastApplied 37,total log 38, size 678,log cap:2
011'177 31 S302 after snap shot size678 412
011'177 35 S101 current config num 13 done
011'177 30 S300 apply index 38 key num 0 type 5   lastApplied 37
011'177 35 S300 apply num 13 migration [1 2 3 4 6]
011'177 31 S300 used size: 678 / 300 
011'181 35 S100 num 13 handle num 13 move rpc [1 2 3 4 6]
011'181 35 S100 num 13 move [1 2 3 4 6] is done yet
011'181 35 S100 num 13 handle num 13 move rpc [1 2 3 4 6]
011'181 35 S100 num 13 move [1 2 3 4 6] is done yet
011'182 30 S302 after send shards ok
011'182 35 S302 num 13 move [1 2 3 4 6] is done yet
011'182 30 S101 apply index 154 key num 0 type 5   lastApplied 153
011'182 35 S101 apply num 13 migration [1 2 3 4 6]
011'182 31 S101 used size: 944 / 300 
011'183 29 S101 do snapshot for raft 154 154,size 770
011'183 30 S301 apply index 36 key num 0 type 5   lastApplied 35
011'183 35 S301 apply num 13 migration [1 2 3 4 6]
011'183 30 S301 safely delete shard 1
011'183 30 S301 safely delete shard 2
011'183 30 S301 safely delete shard 3
011'183 30 S301 safely delete shard 4
011'183 30 S301 safely delete shard 6
011'183 31 S301 used size: 1202 / 300 
011'183 27 S1 raft apply snapshot offset 154 ,lastApplied 155,total log 155, size 682,log cap:2
011'184 29 S301 do snapshot for raft 36 36,size 412
011'184 27 S1 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:13}, Num:0}}
011'184 31 S101 after snap shot size682 770
011'184 30 S101 apply index 155 key num 0 type 5   lastApplied 154
011'184 35 S101 apply num 13 migration [1 2 3 4 6]
011'184 31 S101 used size: 682 / 300 
011'185 27 S1 raft apply snapshot offset 36 ,lastApplied 37,total log 38, size 940,log cap:3
011'185 27 S1 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:13}, Num:0}}
011'185 31 S301 after snap shot size940 412
011'185 30 S301 apply index 37 key num 0 type 5   lastApplied 36
011'185 35 S301 apply num 13 migration [1 2 3 4 6]
011'185 31 S301 used size: 940 / 300 
011'186 29 S301 do snapshot for raft 37 37,size 412
011'186 27 S1 raft apply snapshot offset 37 ,lastApplied 37,total log 38, size 678,log cap:2
011'186 31 S301 after snap shot size678 412
011'166 27 S2 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:13}, Num:0}}
011'187 31 S102 after snap shot size682 770
011'187 30 S102 apply index 155 key num 0 type 5   lastApplied 154
011'187 35 S102 apply num 13 migration [1 2 3 4 6]
011'187 31 S102 used size: 682 / 300 
011'188 29 S102 do snapshot for raft 155 155,size 770
011'188 27 S2 raft apply snapshot offset 155 ,lastApplied 155,total log 155, size 86,log cap:1
011'195 31 S102 after snap shot size86 770
011'189 29 S300 do snapshot for raft 38 38,size 412
011'195 27 S0 raft apply snapshot offset 38 ,lastApplied 38,total log 38, size 82,log cap:1
011'195 31 S300 after snap shot size82 412
011'195 35 S102 current config num 13 done
011'190 35 S301 current config num 13 done
011'196 30 S301 after send shards ok
011'196 35 S301 num 13 move [1 2 3 4 6] is done yet
011'196 35 S300 current config num 13 done
011'196 35 S100 num 13 handle num 13 move rpc [1 2 3 4 6]
011'196 35 S100 num 13 move [1 2 3 4 6] is done yet
011'197 35 S100 num 13 handle num 13 move rpc [1 2 3 4 6]
011'197 35 S100 num 13 move [1 2 3 4 6] is done yet
011'197 30 S301 after send shards ok
011'197 35 S301 num 13 move [1 2 3 4 6] is done yet
011'198 35 S100 num 13 handle num 13 move rpc [1 2 3 4 6]
011'198 35 S100 num 13 move [1 2 3 4 6] is done yet
011'198 30 S302 after send shards ok
011'198 35 S302 num 13 move [1 2 3 4 6] is done yet
011'199 30 S300 after send shards ok
011'199 35 S300 num 13 move [1 2 3 4 6] is done yet
011'201 30 S301 after send shards ok
011'201 35 S301 num 13 move [1 2 3 4 6] is done yet
011'202 30 S300 after send shards ok
011'202 35 S300 num 13 move [1 2 3 4 6] is done yet
011'185 29 S101 do snapshot for raft 155 155,size 770
011'210 35 S200 current config num 12 done
011'210 35 S302 current config num 13 done
011'211 35 S202 current config num 12 done
011'211 35 S100 current config num 13 done
011'216 30 S302 apply index 38 key num 0 type 5   lastApplied 37
011'216 35 S302 apply num 13 migration [1 2 3 4 6]
011'216 31 S302 used size: 678 / 300 
011'217 29 S302 do snapshot for raft 38 38,size 412
011'217 27 S2 raft apply snapshot offset 38 ,lastApplied 38,total log 38, size 82,log cap:1
011'217 31 S302 after snap shot size82 412
011'218 27 S1 raft apply snapshot offset 155 ,lastApplied 155,total log 155, size 86,log cap:1
011'218 31 S101 after snap shot size86 770
011'222 30 S301 apply index 38 key num 0 type 5   lastApplied 37
011'222 35 S301 apply num 13 migration [1 2 3 4 6]
011'223 31 S301 used size: 678 / 300 
011'223 29 S301 do snapshot for raft 38 38,size 412
011'223 27 S1 raft apply snapshot offset 38 ,lastApplied 38,total log 38, size 82,log cap:1
011'223 31 S301 after snap shot size82 412
011'225 35 S201 current config num 12 done
011'230 35 S101 current config num 13 done
011'246 35 S300 current config num 13 done
011'246 35 S102 current config num 13 done
011'246 35 S301 current config num 13 done
011'272 35 S100 current config num 13 done
011'273 35 S200 current config num 12 done
011'273 35 S302 current config num 13 done
011'273 35 S202 current config num 12 done
011'278 35 S201 current config num 12 done
011'280 35 S101 current config num 13 done
011'306 35 S301 current config num 13 done
011'306 35 S300 current config num 13 done
011'306 35 S102 current config num 13 done
011'323 35 S200 current config num 12 done
011'323 35 S100 current config num 13 done
011'323 35 S302 current config num 13 done
011'323 35 S202 current config num 12 done
011'331 35 S201 current config num 12 done
011'333 35 S101 current config num 13 done
011'362 35 S301 current config num 13 done
011'362 35 S300 current config num 13 done
011'362 35 S102 current config num 13 done
011'378 35 S200 current config num 12 done
011'378 35 S100 current config num 13 done
011'379 35 S302 current config num 13 done
011'379 35 S202 current config num 12 done
011'389 35 S201 current config num 12 done
011'390 35 S101 current config num 13 done
011'422 35 S301 current config num 13 done
011'422 35 S300 current config num 13 done
011'422 35 S102 current config num 13 done
011'439 35 S201 current config num 12 done
011'440 35 S101 current config num 13 done
011'440 35 S200 current config num 12 done
011'440 35 S100 current config num 13 done
011'441 35 S202 current config num 12 done
011'441 35 S302 current config num 13 done
011'478 35 S301 current config num 13 done
011'478 35 S300 current config num 13 done
011'478 35 S102 current config num 13 done
011'486 30 S201 nop apply <nil>
011'486 30 S201 nop apply <nil>
011'493 35 S302 current config num 13 done
011'493 35 S201 current config num 12 done
011'498 35 S101 current config num 13 done
011'499 35 S200 current config num 12 done
011'499 35 S100 current config num 13 done
011'499 35 S202 current config num 12 done
011'529 35 S300 current config num 13 done
011'530 35 S301 current config num 13 done
011'530 35 S102 current config num 13 done
011'547 35 S302 current config num 13 done
011'547 35 S201 current config num 12 done
leave &{[101] 1074585914363486070 15}
011'573 35 S101 current config num 13 done
011'575 35 S200 current config num 12 done
011'575 35 S100 current config num 13 done
011'575 35 S202 current config num 12 done
011'580 28 S100 do request args:Key 9 type 3 num 15 Client 3620950086299709532 Seq 15 
011'580 28 S100 [532--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
011'580 35 S300 current config num 13 done
011'580 35 S102 current config num 13 done
011'580 35 S301 current config num 13 done
011'599 35 S302 current config num 13 done
011'599 35 S201 current config num 12 done
011'636 44 S2 ctrler change to config &{16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
011'638 35 S102 current config num 13 done
011'640 35 S300 current config num 13 done
011'640 35 S301 current config num 13 done
011'642 34 S302 got new config {14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 13
011'642 34 S301 got new config {14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 13
leave &{[102] 1074585914363486070 16}
011'643 34 S201 got new config {13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 12
011'644 34 S201 propose new config 13
011'644 34 S100 got new config {14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 13
011'645 34 S100 propose new config 14
leave &{[102] 1074585914363486070 16}
011'646 28 S100 do request args:Key 1 type 3 num 15 Client 418781717203629479 Seq 23 
011'646 28 S100 [479--23] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
011'646 35 S101 current config num 13 done
011'646 35 S100 current config num 13 done
011'646 35 S200 current config num 12 done
011'646 34 S101 got new config {14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 13
011'647 35 S202 current config num 12 done
011'652 35 S201 current config num 12 done
011'652 35 S302 current config num 13 done
leave &{[102] 1074585914363486070 16}
011'657 30 S201 apply index 66 key num 0 type 4   lastApplied 65
011'657 34 S201 apply new config num 13 :&{13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
011'657 34 S201 inited need send [],need recv []
011'657 31 S201 used size: 423 / 300 
011'658 29 S201 do snapshot for raft 66 66,size 413
011'658 27 S1 raft apply snapshot offset 66 ,lastApplied 66,total log 66, size 84,log cap:1
011'658 31 S201 after snap shot size84 413
011'658 30 S202 nop apply <nil>
011'658 31 S202 used size: 423 / 300 
011'659 29 S202 do snapshot for raft 65 65,size 455
011'659 27 S2 raft apply snapshot offset 65 ,lastApplied 65,total log 66, size 418,log cap:2
011'659 31 S202 after snap shot size418 455
011'661 30 S200 nop apply <nil>
011'661 31 S200 used size: 423 / 300 
011'662 29 S200 do snapshot for raft 64 64,size 455
011'663 27 S0 raft apply snapshot offset 64 ,lastApplied 65,total log 66, size 421,log cap:3
011'663 27 S0 last applied not snapshoted raft.LogEntry{Term:8, Command:interface {}(nil)}
011'663 31 S200 after snap shot size421 455
011'663 30 S200 nop apply <nil>
011'663 31 S200 used size: 421 / 300 
011'663 29 S200 do snapshot for raft 65 65,size 455
011'664 27 S0 raft apply snapshot offset 65 ,lastApplied 65,total log 66, size 418,log cap:2
011'664 31 S200 after snap shot size418 455
011'667 30 S100 apply index 156 key num 0 type 4   lastApplied 155
011'667 34 S100 apply new config num 14 :&{14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
011'667 34 S100 inited need send [0 1 2 3 4],need recv []
011'667 31 S100 used size: 463 / 300 
011'668 29 S100 do snapshot for raft 156 156,size 812
011'668 27 S0 raft apply snapshot offset 156 ,lastApplied 156,total log 156, size 86,log cap:1
011'668 31 S100 after snap shot size86 812
011'692 35 S301 current config num 13 done
011'693 35 S300 current config num 13 done
011'693 35 S102 current config num 13 done
011'696 28 S200 do request args:Key 2 type 3 num 15 Client 1679014388048817729 Seq 27 
011'696 28 S200 [729--27] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
011'696 35 S101 current config num 13 done
011'696 35 S100 num 14 sending shards [0 1 2 3 4] to group 102
011'697 35 S200 current config num 12 done
011'697 35 S202 current config num 12 done
011'698 35 S300 num 13 handle num 14 move rpc [0 1 2 3 4]
011'700 35 S301 num 13 handle num 14 move rpc [0 1 2 3 4]
011'702 35 S302 num 13 handle num 14 move rpc [0 1 2 3 4]
011'702 35 S302 current config num 13 done
011'704 35 S201 current config num 13 done
011'723 44 S2 ctrler change to config &{17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
011'726 44 S0 ctrler change to config &{16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
011'726 44 S1 ctrler change to config &{16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
011'729 35 S100 num 14 sending shards [0 1 2 3 4] to group 102
011'731 35 S300 num 13 handle num 14 move rpc [0 1 2 3 4]
011'736 28 S100 do request args:Key 0 type 3 num 16 Client 940626237948413081 Seq 10 
011'737 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
011'739 35 S301 num 13 handle num 14 move rpc [0 1 2 3 4]
011'740 28 S300 do request args:Key 6 type 3 num 16 Client 542732653461723544 Seq 4 
011'740 28 S300 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
011'743 28 S300 do request args:Key 3 type 3 num 16 Client 2238025532150463055 Seq 8 
011'743 28 S300 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
011'746 34 S301 check new config wanted 14
011'746 30 S101 apply index 156 key num 0 type 4   lastApplied 155
011'746 34 S101 apply new config num 14 :&{14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
011'746 34 S101 inited need send [0 1 2 3 4],need recv []
011'746 31 S101 used size: 463 / 300 
011'747 29 S101 do snapshot for raft 156 156,size 812
011'747 27 S1 raft apply snapshot offset 156 ,lastApplied 156,total log 156, size 86,log cap:1
011'747 31 S101 after snap shot size86 812
011'747 35 S202 current config num 12 done
011'747 34 S201 check new config wanted 14
011'749 34 S102 got new config {13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 12
011'752 34 S100 check new config wanted 15
011'753 35 S302 current config num 13 done
011'753 34 S302 check new config wanted 14
011'753 35 S302 num 13 handle num 14 move rpc [0 1 2 3 4]
011'754 28 S300 do request args:Key 8 type 3 num 16 Client 2953714763196401582 Seq 2 
011'754 28 S300 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
011'755 35 S200 current config num 12 done
011'755 35 S101 num 14 sending shards [0 1 2 3 4] to group 102
011'756 28 S300 do request args:Key 4 type 3 num 16 Client 132246879705026825 Seq 6 
011'756 28 S300 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
011'758 35 S301 current config num 13 done
011'759 34 S300 got new config {14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 13
011'759 35 S102 current config num 13 done
011'760 35 S100 num 14 sending shards [0 1 2 3 4] to group 102
011'761 34 S300 propose new config 14
011'762 35 S300 num 13 handle num 14 move rpc [0 1 2 3 4]
011'763 35 S300 current config num 13 done
011'765 28 S300 do request args:Key 5 type 3 num 16 Client 3482757038087095369 Seq 5 
011'765 28 S300 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
011'768 34 S101 check new config wanted 15
011'768 35 S201 current config num 13 done
011'774 30 S200 apply index 66 key num 0 type 4   lastApplied 65
011'774 34 S200 apply new config num 13 :&{13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
011'774 34 S200 inited need send [],need recv []
011'774 31 S200 used size: 418 / 300 
011'776 35 S300 num 13 handle num 14 move rpc [0 1 2 3 4]
011'779 34 S202 got new config {13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 12
011'780 30 S102 apply index 156 key num 0 type 4   lastApplied 155
011'781 34 S102 apply new config num 14 :&{14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
011'781 34 S102 inited need send [0 1 2 3 4],need recv []
011'781 31 S102 used size: 463 / 300 
011'781 29 S102 do snapshot for raft 156 156,size 812
011'782 27 S2 raft apply snapshot offset 156 ,lastApplied 156,total log 156, size 86,log cap:1
011'782 31 S102 after snap shot size86 812
011'782 34 S200 got new config {13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 12
011'784 35 S301 num 13 handle num 14 move rpc [0 1 2 3 4]
011'792 29 S200 do snapshot for raft 66 66,size 413
011'793 27 S0 raft apply snapshot offset 66 ,lastApplied 66,total log 66, size 84,log cap:1
011'793 31 S200 after snap shot size84 413
011'793 30 S202 apply index 66 key num 0 type 4   lastApplied 65
011'793 34 S202 apply new config num 13 :&{13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{12 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
011'793 34 S202 inited need send [],need recv []
011'793 31 S202 used size: 418 / 300 
011'794 29 S202 do snapshot for raft 66 66,size 413
011'794 27 S2 raft apply snapshot offset 66 ,lastApplied 66,total log 66, size 84,log cap:1
011'794 31 S202 after snap shot size84 413
011'801 35 S301 num 13 handle num 14 move rpc [0 1 2 3 4]
011'809 35 S302 current config num 13 done
011'809 35 S100 num 14 sending shards [0 1 2 3 4] to group 102
011'809 35 S202 current config num 13 done
011'810 35 S301 current config num 13 done
011'814 44 S1 ctrler change to config &{17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
011'815 35 S300 current config num 13 done
011'826 35 S101 num 14 sending shards [0 1 2 3 4] to group 102
011'827 35 S302 num 13 handle num 14 move rpc [0 1 2 3 4]
011'827 35 S200 current config num 13 done
011'827 35 S102 num 14 sending shards [0 1 2 3 4] to group 102
011'829 44 S0 ctrler change to config &{17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
011'831 35 S201 current config num 13 done
011'832 35 S300 num 13 handle num 14 move rpc [0 1 2 3 4]
011'833 35 S302 num 13 handle num 14 move rpc [0 1 2 3 4]
011'834 35 S301 num 13 handle num 14 move rpc [0 1 2 3 4]
011'837 35 S302 num 13 handle num 14 move rpc [0 1 2 3 4]
011'839 30 S300 apply index 39 key num 0 type 4   lastApplied 38
011'839 28 S100 do request args:Key 7 type 3 num 16 Client 2972145661651991667 Seq 11 
011'839 28 S100 [667--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
011'839 34 S300 apply new config num 14 :&{14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
011'839 34 S300 inited need send [],need recv [0 1 2 3 4]
011'839 31 S300 used size: 459 / 300 
011'840 29 S300 do snapshot for raft 39 39,size 454
011'842 27 S0 raft apply snapshot offset 39 ,lastApplied 39,total log 39, size 82,log cap:1
011'842 31 S300 after snap shot size82 454
011'846 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
011'857 35 S300 move handle num 14 shards [0 1 2 3 4] as leader?
011'857 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
011'859 35 S101 num 14 sending shards [0 1 2 3 4] to group 102
011'860 35 S102 num 14 sending shards [0 1 2 3 4] to group 102
011'872 35 S300 move handle num 14 shards [0 1 2 3 4] as leader?
011'880 34 S300 check new config wanted 15
011'881 35 S300 num 14 waiting [0 1 2 3 4] shards 
011'884 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
011'886 35 S300 move handle num 14 shards [0 1 2 3 4] as leader?
011'886 35 S100 num 14 sending shards [0 1 2 3 4] to group 102
011'887 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
011'889 35 S300 move handle num 14 shards [0 1 2 3 4] as leader?
011'893 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
011'893 35 S101 num 14 sending shards [0 1 2 3 4] to group 102
011'860 34 S102 check new config wanted 15
011'895 35 S102 num 14 sending shards [0 1 2 3 4] to group 102
011'860 35 S302 current config num 13 done
011'860 35 S202 current config num 13 done
011'860 35 S301 current config num 13 done
011'897 34 S202 check new config wanted 14
011'899 35 S300 move handle num 14 shards [0 1 2 3 4] as leader?
011'899 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
011'884 35 S201 current config num 13 done
011'903 30 S302 apply index 39 key num 0 type 4   lastApplied 38
011'903 34 S302 apply new config num 14 :&{14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
011'903 34 S302 inited need send [],need recv [0 1 2 3 4]
011'904 31 S302 used size: 1859 / 300 
011'904 29 S302 do snapshot for raft 39 39,size 454
011'905 27 S2 raft apply snapshot offset 39 ,lastApplied 39,total log 43, size 1563,log cap:5
011'905 31 S302 after snap shot size1563 454
011'915 30 S301 apply index 39 key num 0 type 4   lastApplied 38
011'915 34 S301 apply new config num 14 :&{14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
011'915 34 S301 inited need send [],need recv [0 1 2 3 4]
011'915 31 S301 used size: 1285 / 300 
011'916 29 S301 do snapshot for raft 39 39,size 454
011'916 27 S1 raft apply snapshot offset 39 ,lastApplied 39,total log 41, size 989,log cap:3
011'916 35 S100 num 14 sending shards [0 1 2 3 4] to group 102
011'916 31 S301 after snap shot size989 454
011'879 35 S200 current config num 13 done
011'918 34 S200 check new config wanted 14
011'938 35 S101 num 14 sending shards [0 1 2 3 4] to group 102
011'941 35 S300 move handle num 14 shards [0 1 2 3 4] as leader?
011'942 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
011'945 35 S300 move handle num 14 shards [0 1 2 3 4] as leader?
011'945 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
011'951 35 S300 move handle num 14 shards [0 1 2 3 4] as leader?
011'955 35 S100 num 14 sending shards [0 1 2 3 4] to group 102
011'950 35 S201 current config num 13 done
011'967 35 S301 num 14 waiting [0 1 2 3 4] shards 
011'967 35 S102 num 14 sending shards [0 1 2 3 4] to group 102
011'968 35 S302 num 14 waiting [0 1 2 3 4] shards 
011'952 35 S202 current config num 13 done
011'968 35 S200 current config num 13 done
011'968 35 S300 num 14 waiting [0 1 2 3 4] shards 
011'968 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
011'970 35 S300 move handle num 14 shards [0 1 2 3 4] as leader?
011'971 30 S300 apply index 40 key num 0 type 5   lastApplied 39
011'971 35 S300 apply num 14 migration [0 1 2 3 4]
011'971 30 S300 safely recv and decided shard 0
011'971 30 S300 safely recv and decided shard 1
011'971 30 S300 safely recv and decided shard 2
011'971 30 S300 safely recv and decided shard 3
011'971 30 S300 safely recv and decided shard 4
011'971 31 S300 used size: 2998 / 300 
011'972 29 S300 do snapshot for raft 40 40,size 626
011'974 27 S0 raft apply snapshot offset 40 ,lastApplied 43,total log 48, size 2711,log cap:9
011'990 27 S0 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:14}, Num:0}}
011'991 31 S300 after snap shot size2711 626
011'991 30 S300 apply index 41 key num 0 type 5   lastApplied 40
011'991 35 S300 apply num 14 migration [0 1 2 3 4]
011'991 31 S300 used size: 2711 / 300 
011'991 29 S300 do snapshot for raft 41 41,size 626
011'993 27 S0 raft apply snapshot offset 41 ,lastApplied 43,total log 48, size 2424,log cap:8
011'993 27 S0 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:14}, Num:0}}
011'994 31 S300 after snap shot size2424 626
011'994 30 S300 apply index 42 key num 0 type 5   lastApplied 41
011'994 35 S300 apply num 14 migration [0 1 2 3 4]
011'994 31 S300 used size: 2424 / 300 
011'994 29 S300 do snapshot for raft 42 42,size 626
011'974 35 S101 num 14 sending shards [0 1 2 3 4] to group 102
011'976 30 S301 apply index 40 key num 0 type 5   lastApplied 39
011'997 35 S301 apply num 14 migration [0 1 2 3 4]
011'997 30 S301 safely recv and decided shard 0
011'997 30 S301 safely recv and decided shard 1
011'998 30 S301 safely recv and decided shard 2
011'998 30 S301 safely recv and decided shard 3
011'998 30 S301 safely recv and decided shard 4
011'998 31 S301 used size: 2711 / 300 
011'998 29 S301 do snapshot for raft 40 40,size 626
012'003 27 S1 raft apply snapshot offset 40 ,lastApplied 43,total log 47, size 2424,log cap:8
012'007 27 S1 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:14}, Num:0}}
012'007 31 S301 after snap shot size2424 626
012'007 30 S301 apply index 41 key num 0 type 5   lastApplied 40
012'007 35 S301 apply num 14 migration [0 1 2 3 4]
012'007 31 S301 used size: 2424 / 300 
012'008 29 S301 do snapshot for raft 41 41,size 626
012'010 27 S1 raft apply snapshot offset 41 ,lastApplied 43,total log 47, size 2137,log cap:7
012'010 27 S1 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:14}, Num:0}}
012'010 31 S301 after snap shot size2137 626
012'011 27 S0 raft apply snapshot offset 42 ,lastApplied 43,total log 48, size 2137,log cap:7
012'011 27 S0 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:14}, Num:0}}
012'011 31 S300 after snap shot size2137 626
012'011 30 S300 apply index 43 key num 0 type 5   lastApplied 42
012'011 35 S300 apply num 14 migration [0 1 2 3 4]
012'011 31 S300 used size: 2137 / 300 
012'012 29 S300 do snapshot for raft 43 43,size 626
012'013 27 S0 raft apply snapshot offset 43 ,lastApplied 43,total log 48, size 1850,log cap:6
012'013 31 S300 after snap shot size1850 626
011'978 30 S302 apply index 40 key num 0 type 5   lastApplied 39
011'986 35 S100 num 14 sending shards [0 1 2 3 4] to group 102
012'016 35 S301 num 14 handle num 14 move rpc [0 1 2 3 4]
012'016 35 S301 num 14 move [0 1 2 3 4] is done yet
012'016 30 S301 apply index 42 key num 0 type 5   lastApplied 41
012'016 35 S301 apply num 14 migration [0 1 2 3 4]
012'017 31 S301 used size: 2137 / 300 
012'017 29 S301 do snapshot for raft 42 42,size 626
012'018 27 S1 raft apply snapshot offset 42 ,lastApplied 43,total log 47, size 1850,log cap:6
012'019 27 S1 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:14}, Num:0}}
012'019 31 S301 after snap shot size1850 626
012'019 30 S301 apply index 43 key num 0 type 5   lastApplied 42
012'019 35 S301 apply num 14 migration [0 1 2 3 4]
012'019 31 S301 used size: 1850 / 300 
012'020 29 S301 do snapshot for raft 43 43,size 626
012'020 35 S202 current config num 13 done
012'020 35 S200 current config num 13 done
012'020 35 S302 apply num 14 migration [0 1 2 3 4]
012'020 30 S302 safely recv and decided shard 0
012'020 30 S302 safely recv and decided shard 1
012'020 30 S302 safely recv and decided shard 2
012'020 30 S302 safely recv and decided shard 3
012'020 30 S302 safely recv and decided shard 4
012'020 31 S302 used size: 2711 / 300 
012'021 27 S1 raft apply snapshot offset 43 ,lastApplied 43,total log 47, size 1563,log cap:5
012'021 31 S301 after snap shot size1563 626
012'021 29 S302 do snapshot for raft 40 40,size 626
012'021 35 S301 current config num 14 done
012'023 27 S2 raft apply snapshot offset 40 ,lastApplied 43,total log 47, size 2424,log cap:8
012'023 27 S2 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:14}, Num:0}}
012'023 31 S302 after snap shot size2424 626
012'023 30 S302 apply index 41 key num 0 type 5   lastApplied 40
012'023 35 S302 apply num 14 migration [0 1 2 3 4]
012'023 31 S302 used size: 2424 / 300 
012'024 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
012'024 35 S300 num 14 move [0 1 2 3 4] is done yet
012'024 29 S302 do snapshot for raft 41 41,size 626
012'026 27 S2 raft apply snapshot offset 41 ,lastApplied 43,total log 47, size 2137,log cap:7
012'026 27 S2 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:14}, Num:0}}
012'026 31 S302 after snap shot size2137 626
012'026 30 S302 apply index 42 key num 0 type 5   lastApplied 41
012'026 35 S302 apply num 14 migration [0 1 2 3 4]
012'026 31 S302 used size: 2137 / 300 
012'027 29 S302 do snapshot for raft 42 42,size 626
012'030 27 S2 raft apply snapshot offset 42 ,lastApplied 43,total log 47, size 1850,log cap:6
012'030 27 S2 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:14}, Num:0}}
012'031 31 S302 after snap shot size1850 626
012'031 30 S302 apply index 43 key num 0 type 5   lastApplied 42
012'031 35 S302 apply num 14 migration [0 1 2 3 4]
012'031 31 S302 used size: 1850 / 300 
012'031 29 S302 do snapshot for raft 43 43,size 626
012'033 27 S2 raft apply snapshot offset 43 ,lastApplied 43,total log 47, size 1563,log cap:5
012'033 31 S302 after snap shot size1563 626
012'033 35 S302 current config num 14 done
012'038 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
012'038 35 S300 num 14 move [0 1 2 3 4] is done yet
012'039 30 S100 after send shards ok
012'040 35 S100 move delete propose num 14 shards [0 1 2 3 4] as leader?
012'040 35 S300 num 14 move [0 1 2 3 4] is done yet
012'040 30 S101 after send shards ok
012'040 35 S101 move delete propose not leader
012'041 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
012'041 35 S300 num 14 move [0 1 2 3 4] is done yet
012'071 30 S100 after send shards ok
012'072 35 S301 current config num 14 done
012'073 35 S100 move delete propose num 14 shards [0 1 2 3 4] as leader?
012'073 35 S202 current config num 13 done
012'073 35 S200 current config num 13 done
012'073 35 S100 num 14 sending shards [0 1 2 3 4] to group 102
012'041 35 S300 num 14 move [0 1 2 3 4] is done yet
012'077 30 S101 after send shards ok
012'077 35 S101 move delete propose not leader
012'013 35 S201 current config num 13 done
012'077 35 S101 num 14 sending shards [0 1 2 3 4] to group 102
012'079 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
012'079 35 S300 num 14 move [0 1 2 3 4] is done yet
012'079 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
012'079 35 S300 num 14 move [0 1 2 3 4] is done yet
012'081 35 S300 num 14 move [0 1 2 3 4] is done yet
012'081 35 S300 num 14 move [0 1 2 3 4] is done yet
012'081 35 S300 current config num 14 done
012'082 35 S300 num 14 move [0 1 2 3 4] is done yet
012'082 35 S300 num 14 move [0 1 2 3 4] is done yet
012'082 35 S300 num 14 move [0 1 2 3 4] is done yet
012'091 35 S302 current config num 14 done
012'091 35 S300 num 14 move [0 1 2 3 4] is done yet
012'092 35 S102 num 14 sending shards [0 1 2 3 4] to group 102
012'093 30 S102 after send shards ok
012'093 35 S102 move delete propose not leader
012'094 30 S300 apply index 44 key num 0 type 5   lastApplied 43
012'094 35 S300 apply num 14 migration [0 1 2 3 4]
012'094 31 S300 used size: 1850 / 300 
012'095 30 S102 after send shards ok
012'095 35 S102 move delete propose not leader
012'097 30 S101 after send shards ok
012'097 35 S101 move delete propose not leader
012'098 30 S100 apply index 157 key num 0 type 5   lastApplied 156
012'098 35 S100 apply num 14 migration [0 1 2 3 4]
012'098 30 S100 safely delete shard 0
012'098 30 S100 safely delete shard 1
012'098 30 S100 safely delete shard 2
012'098 30 S100 safely delete shard 3
012'098 30 S100 safely delete shard 4
012'098 31 S100 used size: 993 / 300 
012'099 29 S100 do snapshot for raft 157 157,size 640
012'100 27 S0 raft apply snapshot offset 157 ,lastApplied 158,total log 158, size 706,log cap:2
012'100 27 S0 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:14}, Num:0}}
012'100 31 S100 after snap shot size706 640
012'100 30 S100 apply index 158 key num 0 type 5   lastApplied 157
012'100 35 S100 apply num 14 migration [0 1 2 3 4]
012'100 31 S100 used size: 706 / 300 
012'101 29 S100 do snapshot for raft 158 158,size 640
012'101 27 S0 raft apply snapshot offset 158 ,lastApplied 158,total log 158, size 86,log cap:1
012'101 31 S100 after snap shot size86 640
012'106 30 S102 after send shards ok
012'108 30 S100 after send shards ok
012'108 35 S100 num 14 move [0 1 2 3 4] is done yet
012'109 35 S101 num 14 sending shards [0 1 2 3 4] to group 102
012'110 30 S100 after send shards ok
012'110 35 S100 num 14 move [0 1 2 3 4] is done yet
012'111 30 S101 after send shards ok
012'111 35 S101 move delete propose not leader
012'112 30 S100 after send shards ok
012'112 35 S100 num 14 move [0 1 2 3 4] is done yet
012'113 35 S100 current config num 14 done
012'114 30 S101 after send shards ok
012'114 35 S101 move delete propose not leader
012'135 35 S102 move delete propose not leader
012'135 30 S102 after send shards ok
012'135 35 S102 move delete propose not leader
012'135 35 S102 num 14 sending shards [0 1 2 3 4] to group 102
012'125 35 S202 current config num 13 done
012'125 35 S200 current config num 13 done
012'129 35 S201 current config num 13 done
012'142 35 S101 num 14 sending shards [0 1 2 3 4] to group 102
012'135 35 S301 current config num 14 done
012'152 35 S302 current config num 14 done
012'170 35 S102 num 14 sending shards [0 1 2 3 4] to group 102
012'180 29 S300 do snapshot for raft 44 44,size 626
012'182 27 S0 raft apply snapshot offset 44 ,lastApplied 47,total log 48, size 1563,log cap:5
012'182 27 S0 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:14}, Num:0}}
012'184 31 S300 after snap shot size1563 626
012'184 30 S300 apply index 45 key num 0 type 5   lastApplied 44
012'184 35 S300 apply num 14 migration [0 1 2 3 4]
012'184 31 S300 used size: 1563 / 300 
012'185 29 S300 do snapshot for raft 45 45,size 626
012'186 27 S0 raft apply snapshot offset 45 ,lastApplied 47,total log 48, size 1276,log cap:4
012'186 27 S0 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:14}, Num:0}}
012'186 31 S300 after snap shot size1276 626
012'186 30 S300 apply index 46 key num 0 type 5   lastApplied 45
012'186 35 S300 apply num 14 migration [0 1 2 3 4]
012'187 31 S300 used size: 1276 / 300 
012'187 29 S300 do snapshot for raft 46 46,size 626
012'188 35 S101 num 14 sending shards [0 1 2 3 4] to group 102
012'190 35 S100 current config num 14 done
012'198 27 S0 raft apply snapshot offset 46 ,lastApplied 47,total log 48, size 989,log cap:3
012'198 27 S0 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:14}, Num:0}}
012'199 31 S300 after snap shot size989 626
012'199 30 S300 apply index 47 key num 0 type 5   lastApplied 46
012'199 35 S300 apply num 14 migration [0 1 2 3 4]
012'199 31 S300 used size: 989 / 300 
012'199 29 S300 do snapshot for raft 47 47,size 626
012'200 27 S0 raft apply snapshot offset 47 ,lastApplied 47,total log 48, size 702,log cap:2
012'200 31 S300 after snap shot size702 626
012'208 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
012'208 35 S300 num 14 move [0 1 2 3 4] is done yet
012'209 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
012'209 35 S300 num 14 move [0 1 2 3 4] is done yet
012'209 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
012'209 35 S300 num 14 move [0 1 2 3 4] is done yet
012'211 30 S101 after send shards ok
012'212 35 S101 move delete propose not leader
012'212 30 S101 after send shards ok
012'212 35 S101 move delete propose not leader
012'213 30 S101 after send shards ok
012'213 35 S101 move delete propose not leader
012'210 35 S300 current config num 14 done
012'240 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
012'240 35 S300 num 14 move [0 1 2 3 4] is done yet
012'241 30 S300 apply index 48 key num 0 type 5   lastApplied 47
012'241 35 S300 apply num 14 migration [0 1 2 3 4]
012'241 31 S300 used size: 702 / 300 
012'242 29 S300 do snapshot for raft 48 48,size 626
012'243 27 S0 raft apply snapshot offset 48 ,lastApplied 48,total log 48, size 82,log cap:1
012'243 31 S300 after snap shot size82 626
012'210 35 S202 current config num 13 done
012'243 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
012'243 35 S300 num 14 move [0 1 2 3 4] is done yet
012'243 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
012'243 35 S300 num 14 move [0 1 2 3 4] is done yet
012'210 35 S201 current config num 13 done
012'210 35 S200 current config num 13 done
012'210 35 S301 current config num 14 done
012'246 35 S102 num 14 sending shards [0 1 2 3 4] to group 102
012'246 30 S102 after send shards ok
012'246 35 S102 move delete propose not leader
012'210 35 S302 current config num 14 done
012'247 30 S102 after send shards ok
012'247 35 S102 move delete propose not leader
012'249 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
012'249 35 S300 num 14 move [0 1 2 3 4] is done yet
012'249 30 S302 apply index 44 key num 0 type 5   lastApplied 43
012'249 35 S302 apply num 14 migration [0 1 2 3 4]
012'249 31 S302 used size: 1850 / 300 
012'250 30 S301 apply index 44 key num 0 type 5   lastApplied 43
012'250 35 S301 apply num 14 migration [0 1 2 3 4]
012'250 31 S301 used size: 1850 / 300 
012'251 29 S301 do snapshot for raft 44 44,size 626
012'252 27 S1 raft apply snapshot offset 44 ,lastApplied 47,total log 48, size 1563,log cap:5
012'252 27 S1 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:14}, Num:0}}
012'253 31 S301 after snap shot size1563 626
012'253 30 S301 apply index 45 key num 0 type 5   lastApplied 44
012'253 35 S301 apply num 14 migration [0 1 2 3 4]
012'253 31 S301 used size: 1563 / 300 
012'253 29 S301 do snapshot for raft 45 45,size 626
012'254 27 S1 raft apply snapshot offset 45 ,lastApplied 47,total log 48, size 1276,log cap:4
012'254 27 S1 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:14}, Num:0}}
012'255 31 S301 after snap shot size1276 626
012'255 30 S301 apply index 46 key num 0 type 5   lastApplied 45
012'255 35 S301 apply num 14 migration [0 1 2 3 4]
012'255 31 S301 used size: 1276 / 300 
012'255 29 S301 do snapshot for raft 46 46,size 626
012'256 27 S1 raft apply snapshot offset 46 ,lastApplied 47,total log 48, size 989,log cap:3
012'256 27 S1 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:14}, Num:0}}
012'256 31 S301 after snap shot size989 626
012'256 30 S301 apply index 47 key num 0 type 5   lastApplied 46
012'256 35 S301 apply num 14 migration [0 1 2 3 4]
012'256 31 S301 used size: 989 / 300 
012'257 29 S301 do snapshot for raft 47 47,size 626
012'258 27 S1 raft apply snapshot offset 47 ,lastApplied 47,total log 48, size 702,log cap:2
012'258 31 S301 after snap shot size702 626
012'258 29 S302 do snapshot for raft 44 44,size 626
012'259 27 S2 raft apply snapshot offset 44 ,lastApplied 47,total log 48, size 1563,log cap:5
012'259 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
012'259 35 S300 num 14 move [0 1 2 3 4] is done yet
012'259 27 S2 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:14}, Num:0}}
012'260 31 S302 after snap shot size1563 626
012'260 30 S302 apply index 45 key num 0 type 5   lastApplied 44
012'260 35 S302 apply num 14 migration [0 1 2 3 4]
012'260 31 S302 used size: 1563 / 300 
012'261 29 S302 do snapshot for raft 45 45,size 626
012'261 30 S102 after send shards ok
012'261 35 S102 move delete propose not leader
012'262 27 S2 raft apply snapshot offset 45 ,lastApplied 47,total log 48, size 1276,log cap:4
012'263 35 S100 current config num 14 done
012'264 30 S102 after send shards ok
012'264 35 S102 move delete propose not leader
012'265 35 S101 num 14 sending shards [0 1 2 3 4] to group 102
012'267 30 S101 after send shards ok
012'267 35 S101 move delete propose not leader
012'262 27 S2 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:14}, Num:0}}
012'275 31 S302 after snap shot size1276 626
012'275 30 S302 apply index 46 key num 0 type 5   lastApplied 45
012'276 35 S302 apply num 14 migration [0 1 2 3 4]
012'276 31 S302 used size: 1276 / 300 
012'276 29 S302 do snapshot for raft 46 46,size 626
012'277 27 S2 raft apply snapshot offset 46 ,lastApplied 47,total log 48, size 989,log cap:3
012'277 27 S2 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:14}, Num:0}}
012'277 31 S302 after snap shot size989 626
012'277 30 S302 apply index 47 key num 0 type 5   lastApplied 46
012'278 35 S302 apply num 14 migration [0 1 2 3 4]
012'278 31 S302 used size: 989 / 300 
012'278 29 S302 do snapshot for raft 47 47,size 626
012'279 27 S2 raft apply snapshot offset 47 ,lastApplied 47,total log 48, size 702,log cap:2
012'279 31 S302 after snap shot size702 626
012'281 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
012'281 35 S300 num 14 move [0 1 2 3 4] is done yet
012'282 30 S101 after send shards ok
012'282 35 S101 move delete propose not leader
join &{map[102:[server-102-0 server-102-1 server-102-2]] 1074585914363486070 17}
012'284 35 S102 num 14 sending shards [0 1 2 3 4] to group 102
012'285 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
012'285 35 S300 num 14 move [0 1 2 3 4] is done yet
012'294 30 S102 after send shards ok
012'294 35 S102 move delete propose not leader
012'297 35 S101 num 14 sending shards [0 1 2 3 4] to group 102
012'299 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
012'299 35 S300 num 14 move [0 1 2 3 4] is done yet
012'300 30 S101 after send shards ok
012'300 35 S101 move delete propose not leader
012'311 35 S301 current config num 14 done
join &{map[102:[server-102-0 server-102-1 server-102-2]] 1074585914363486070 17}
012'311 35 S202 current config num 13 done
012'311 35 S300 current config num 14 done
012'311 35 S200 current config num 13 done
012'311 35 S201 current config num 13 done
012'311 35 S302 current config num 14 done
012'314 35 S100 current config num 14 done
012'316 35 S102 num 14 sending shards [0 1 2 3 4] to group 102
012'319 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
012'319 35 S300 num 14 move [0 1 2 3 4] is done yet
012'322 30 S102 after send shards ok
012'322 35 S102 move delete propose not leader
012'328 35 S101 num 14 sending shards [0 1 2 3 4] to group 102
012'330 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
012'330 35 S300 num 14 move [0 1 2 3 4] is done yet
012'330 30 S101 after send shards ok
012'330 35 S101 move delete propose not leader
012'353 35 S102 num 14 sending shards [0 1 2 3 4] to group 102
012'355 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
012'355 35 S300 num 14 move [0 1 2 3 4] is done yet
012'355 30 S102 after send shards ok
012'355 35 S102 move delete propose not leader
012'368 35 S100 current config num 14 done
012'368 35 S101 num 14 sending shards [0 1 2 3 4] to group 102
012'369 35 S301 current config num 14 done
012'369 35 S202 current config num 13 done
012'369 35 S300 current config num 14 done
012'369 35 S200 current config num 13 done
012'369 35 S201 current config num 13 done
012'369 35 S302 current config num 14 done
012'377 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
012'378 35 S300 num 14 move [0 1 2 3 4] is done yet
012'378 30 S101 after send shards ok
012'378 35 S101 move delete propose not leader
012'390 30 S101 apply index 157 key num 0 type 5   lastApplied 156
012'390 35 S101 apply num 14 migration [0 1 2 3 4]
012'390 30 S101 safely delete shard 0
012'390 30 S101 safely delete shard 1
012'390 30 S101 safely delete shard 2
012'390 30 S101 safely delete shard 3
012'390 30 S101 safely delete shard 4
012'390 31 S101 used size: 993 / 300 
012'391 29 S101 do snapshot for raft 157 157,size 640
012'391 27 S1 raft apply snapshot offset 157 ,lastApplied 158,total log 158, size 706,log cap:2
012'391 27 S1 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:14}, Num:0}}
012'392 31 S101 after snap shot size706 640
012'392 30 S101 apply index 158 key num 0 type 5   lastApplied 157
012'392 35 S101 apply num 14 migration [0 1 2 3 4]
012'392 31 S101 used size: 706 / 300 
012'393 29 S101 do snapshot for raft 158 158,size 640
012'393 27 S1 raft apply snapshot offset 158 ,lastApplied 158,total log 158, size 86,log cap:1
012'393 31 S101 after snap shot size86 640
012'394 35 S102 num 14 sending shards [0 1 2 3 4] to group 102
012'394 30 S102 apply index 157 key num 0 type 5   lastApplied 156
012'394 35 S102 apply num 14 migration [0 1 2 3 4]
012'394 30 S102 safely delete shard 0
012'394 30 S102 safely delete shard 1
012'394 30 S102 safely delete shard 2
012'394 30 S102 safely delete shard 3
012'394 30 S102 safely delete shard 4
012'394 31 S102 used size: 993 / 300 
012'395 29 S102 do snapshot for raft 157 157,size 640
012'396 27 S2 raft apply snapshot offset 157 ,lastApplied 158,total log 158, size 706,log cap:2
012'399 30 S301 apply index 48 key num 0 type 5   lastApplied 47
012'399 35 S301 apply num 14 migration [0 1 2 3 4]
012'399 31 S301 used size: 702 / 300 
012'400 29 S301 do snapshot for raft 48 48,size 626
012'400 27 S1 raft apply snapshot offset 48 ,lastApplied 48,total log 48, size 82,log cap:1
012'400 31 S301 after snap shot size82 626
012'405 35 S101 current config num 14 done
012'413 30 S302 apply index 48 key num 0 type 5   lastApplied 47
012'413 35 S302 apply num 14 migration [0 1 2 3 4]
012'413 31 S302 used size: 702 / 300 
012'414 29 S302 do snapshot for raft 48 48,size 626
012'414 27 S2 raft apply snapshot offset 48 ,lastApplied 48,total log 48, size 82,log cap:1
012'414 31 S302 after snap shot size82 626
012'415 35 S300 num 14 handle num 14 move rpc [0 1 2 3 4]
012'415 35 S300 num 14 move [0 1 2 3 4] is done yet
012'396 27 S2 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}}, Num:14}, Num:0}}
012'418 31 S102 after snap shot size706 640
012'418 30 S102 apply index 158 key num 0 type 5   lastApplied 157
012'418 35 S102 apply num 14 migration [0 1 2 3 4]
012'418 31 S102 used size: 706 / 300 
012'418 29 S102 do snapshot for raft 158 158,size 640
012'418 27 S2 raft apply snapshot offset 158 ,lastApplied 158,total log 158, size 86,log cap:1
012'419 31 S102 after snap shot size86 640
012'419 30 S102 after send shards ok
012'419 35 S102 num 14 move [0 1 2 3 4] is done yet
012'419 35 S202 current config num 13 done
012'419 35 S301 current config num 14 done
012'419 35 S100 current config num 14 done
012'419 35 S200 current config num 13 done
012'419 35 S300 current config num 14 done
012'424 35 S302 current config num 14 done
012'424 35 S201 current config num 13 done
012'430 35 S102 current config num 14 done
012'480 35 S102 current config num 14 done
012'474 35 S202 current config num 13 done
012'474 35 S301 current config num 14 done
012'474 35 S100 current config num 14 done
012'474 35 S200 current config num 13 done
012'474 35 S300 current config num 14 done
012'474 35 S101 current config num 14 done
012'478 35 S201 current config num 13 done
012'478 35 S302 current config num 14 done
012'490 28 S100 do request args:Key 0 type 3 num 17 Client 940626237948413081 Seq 10 
012'490 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
012'509 34 S201 got new config {14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 13
012'510 34 S201 propose new config 14
012'514 34 S302 got new config {14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 13
012'521 30 S201 apply index 67 key num 0 type 4   lastApplied 66
012'521 34 S201 apply new config num 14 :&{14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
012'521 34 S201 inited need send [],need recv []
012'521 31 S201 used size: 461 / 300 
012'523 29 S201 do snapshot for raft 67 67,size 455
012'523 27 S1 raft apply snapshot offset 67 ,lastApplied 67,total log 67, size 84,log cap:1
012'523 31 S201 after snap shot size84 455
012'532 35 S102 current config num 14 done
012'534 34 S301 got new config {14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 13
012'550 34 S101 got new config {15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 14
012'551 34 S100 got new config {15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 14
012'537 35 S101 current config num 14 done
012'537 35 S301 current config num 14 done
012'537 35 S202 current config num 13 done
012'537 35 S100 current config num 14 done
012'537 35 S200 current config num 13 done
012'537 35 S300 current config num 14 done
012'537 35 S201 current config num 14 done
012'537 35 S302 current config num 14 done
012'552 34 S100 propose new config 15
join &{map[102:[server-102-0 server-102-1 server-102-2]] 1074585914363486070 17}
012'555 28 S100 do request args:Key 2 type 3 num 17 Client 1679014388048817729 Seq 27 
012'555 28 S100 [729--27] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
012'575 30 S100 apply index 159 key num 0 type 4   lastApplied 158
012'575 34 S100 apply new config num 15 :&{15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
012'576 34 S100 inited need send [5 6],need recv []
012'576 31 S100 used size: 507 / 300 
012'576 29 S100 do snapshot for raft 159 159,size 683
012'576 27 S0 raft apply snapshot offset 159 ,lastApplied 159,total log 159, size 86,log cap:1
012'576 31 S100 after snap shot size86 683
012'588 28 S100 do request args:Key 9 type 3 num 17 Client 3620950086299709532 Seq 15 
012'588 28 S100 [532--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
012'589 35 S102 current config num 14 done
012'602 35 S200 current config num 13 done
012'602 35 S101 current config num 14 done
012'602 35 S301 current config num 14 done
012'602 35 S100 num 15 sending shards [5 6] to group 101
012'602 35 S202 current config num 13 done
012'602 35 S300 current config num 14 done
012'602 35 S201 current config num 14 done
012'602 35 S302 current config num 14 done
012'608 34 S300 got new config {15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 14
012'609 34 S300 propose new config 15
012'613 28 S100 do request args:Key 6 type 3 num 17 Client 542732653461723544 Seq 4 
012'613 28 S100 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
012'614 34 S102 got new config {15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 14
012'615 34 S202 got new config {14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 13
012'615 34 S201 check new config wanted 15
012'619 28 S100 do request args:Key 4 type 3 num 17 Client 132246879705026825 Seq 6 
012'619 28 S100 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
012'624 34 S302 check new config wanted 15
012'625 28 S100 do request args:Key 8 type 3 num 17 Client 2953714763196401582 Seq 2 
012'625 28 S100 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
012'633 35 S100 num 15 sending shards [5 6] to group 101
012'634 35 S200 num 13 handle num 15 move rpc [5 6]
012'636 35 S201 num 14 handle num 15 move rpc [5 6]
012'636 34 S301 check new config wanted 15
012'649 28 S100 do request args:Key 5 type 3 num 17 Client 3482757038087095369 Seq 5 
012'649 28 S100 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
012'650 28 S100 do request args:Key 3 type 3 num 17 Client 2238025532150463055 Seq 8 
012'650 28 S100 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
012'656 35 S201 current config num 14 done
012'656 35 S200 current config num 13 done
012'656 35 S101 current config num 14 done
012'656 34 S100 check new config wanted 16
012'657 35 S202 current config num 13 done
012'657 35 S301 current config num 14 done
012'657 35 S300 current config num 14 done
012'657 35 S302 current config num 14 done
012'658 35 S200 num 13 handle num 15 move rpc [5 6]
012'660 35 S201 num 14 handle num 15 move rpc [5 6]
012'666 28 S100 do request args:Key 1 type 3 num 17 Client 418781717203629479 Seq 23 
012'666 28 S100 [479--23] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
012'672 35 S100 num 15 sending shards [5 6] to group 101
012'674 34 S200 got new config {14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 13
012'675 35 S202 num 13 handle num 15 move rpc [5 6]
012'678 30 S300 apply index 49 key num 0 type 4   lastApplied 48
012'678 34 S300 apply new config num 15 :&{15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
012'678 34 S300 inited need send [0],need recv []
012'678 31 S300 used size: 503 / 300 
012'679 34 S101 check new config wanted 15
012'680 28 S100 do request args:Key 7 type 3 num 17 Client 2972145661651991667 Seq 11 
012'680 28 S100 [667--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
012'691 30 S101 apply index 159 key num 0 type 4   lastApplied 158
012'691 34 S101 apply new config num 15 :&{15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
012'691 34 S101 inited need send [5 6],need recv []
012'691 31 S101 used size: 507 / 300 
012'692 29 S101 do snapshot for raft 159 159,size 683
012'692 27 S1 raft apply snapshot offset 159 ,lastApplied 159,total log 159, size 86,log cap:1
012'692 31 S101 after snap shot size86 683
012'692 30 S202 apply index 67 key num 0 type 4   lastApplied 66
012'692 34 S202 apply new config num 14 :&{14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
012'692 34 S202 inited need send [],need recv []
012'692 31 S202 used size: 461 / 300 
012'693 29 S202 do snapshot for raft 67 67,size 455
012'693 27 S2 raft apply snapshot offset 67 ,lastApplied 67,total log 67, size 84,log cap:1
012'693 31 S202 after snap shot size84 455
012'694 35 S202 num 14 handle num 15 move rpc [5 6]
012'640 35 S102 current config num 14 done
012'696 30 S102 apply index 159 key num 0 type 4   lastApplied 158
012'696 34 S102 apply new config num 15 :&{15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
012'696 34 S102 inited need send [5 6],need recv []
012'696 31 S102 used size: 507 / 300 
012'696 29 S102 do snapshot for raft 159 159,size 683
012'697 27 S2 raft apply snapshot offset 159 ,lastApplied 159,total log 159, size 86,log cap:1
012'697 31 S102 after snap shot size86 683
012'698 44 S2 ctrler change to config &{18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
012'675 35 S200 num 13 handle num 15 move rpc [5 6]
012'702 35 S100 num 15 sending shards [5 6] to group 101
012'704 30 S200 apply index 67 key num 0 type 4   lastApplied 66
012'704 34 S200 apply new config num 14 :&{14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{13 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
012'705 34 S200 inited need send [],need recv []
012'705 31 S200 used size: 461 / 300 
012'705 29 S200 do snapshot for raft 67 67,size 455
012'706 27 S0 raft apply snapshot offset 67 ,lastApplied 67,total log 67, size 84,log cap:1
012'706 31 S200 after snap shot size84 455
012'707 35 S302 current config num 14 done
012'708 35 S201 current config num 14 done
012'708 35 S200 current config num 14 done
012'708 35 S101 num 15 sending shards [5 6] to group 101
012'709 35 S301 current config num 14 done
012'709 35 S202 current config num 14 done
012'710 35 S200 num 14 handle num 15 move rpc [5 6]
012'712 29 S300 do snapshot for raft 49 49,size 669
012'712 27 S0 raft apply snapshot offset 49 ,lastApplied 49,total log 49, size 82,log cap:1
012'713 31 S300 after snap shot size82 669
012'713 35 S300 num 15 sending shards [0] to group 101
012'714 35 S200 num 14 handle num 15 move rpc [0]
012'716 35 S201 num 14 handle num 15 move rpc [5 6]
012'717 35 S200 num 14 handle num 15 move rpc [5 6]
012'718 34 S300 check new config wanted 16
012'719 34 S202 check new config wanted 15
012'719 34 S102 check new config wanted 16
012'726 35 S202 num 14 handle num 15 move rpc [5 6]
012'728 35 S201 num 14 handle num 15 move rpc [5 6]
012'731 30 S301 apply index 49 key num 0 type 4   lastApplied 48
012'731 34 S301 apply new config num 15 :&{15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
012'731 34 S301 inited need send [0],need recv []
012'731 31 S301 used size: 503 / 300 
012'731 35 S202 num 14 handle num 15 move rpc [5 6]
012'732 29 S301 do snapshot for raft 49 49,size 669
012'732 27 S1 raft apply snapshot offset 49 ,lastApplied 49,total log 49, size 82,log cap:1
012'732 31 S301 after snap shot size82 669
012'733 35 S201 num 14 handle num 15 move rpc [0]
012'733 35 S100 num 15 sending shards [5 6] to group 101
012'734 30 S302 apply index 49 key num 0 type 4   lastApplied 48
012'734 34 S302 apply new config num 15 :&{15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
012'734 34 S302 inited need send [0],need recv []
012'734 31 S302 used size: 503 / 300 
012'735 35 S200 num 14 handle num 15 move rpc [5 6]
012'735 29 S302 do snapshot for raft 49 49,size 669
012'736 27 S2 raft apply snapshot offset 49 ,lastApplied 49,total log 49, size 82,log cap:1
012'736 31 S302 after snap shot size82 669
012'736 35 S201 num 14 handle num 15 move rpc [5 6]
012'737 35 S201 num 14 handle num 15 move rpc [5 6]
012'739 35 S101 num 15 sending shards [5 6] to group 101
012'750 35 S102 num 15 sending shards [5 6] to group 101
012'751 35 S202 num 14 handle num 15 move rpc [5 6]
012'775 35 S200 num 14 handle num 15 move rpc [5 6]
join &{map[101:[server-101-0 server-101-1 server-101-2]] 1074585914363486070 18}
012'783 35 S100 num 15 sending shards [5 6] to group 101
012'788 35 S101 num 15 sending shards [5 6] to group 101
012'789 28 S100 do request args:Key 0 type 3 num 18 Client 940626237948413081 Seq 10 
012'789 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
012'790 35 S300 num 15 sending shards [0] to group 101
012'790 35 S302 num 15 sending shards [0] to group 101
012'791 35 S200 current config num 14 done
012'793 34 S200 check new config wanted 15
012'793 35 S202 num 14 handle num 15 move rpc [5 6]
012'794 35 S200 num 14 handle num 15 move rpc [5 6]
012'796 35 S202 current config num 14 done
012'796 35 S201 current config num 14 done
012'802 35 S102 num 15 sending shards [5 6] to group 101
012'791 35 S301 num 15 sending shards [0] to group 101
012'815 35 S100 num 15 sending shards [5 6] to group 101
012'819 35 S200 num 14 handle num 15 move rpc [5 6]
012'820 35 S201 num 14 handle num 15 move rpc [5 6]
012'822 35 S101 num 15 sending shards [5 6] to group 101
012'822 35 S300 num 15 sending shards [0] to group 101
012'823 35 S302 num 15 sending shards [0] to group 101
012'824 35 S200 num 14 handle num 15 move rpc [0]
012'826 35 S200 num 14 handle num 15 move rpc [0]
012'828 35 S202 num 14 handle num 15 move rpc [5 6]
012'830 35 S201 num 14 handle num 15 move rpc [0]
012'834 35 S200 num 14 handle num 15 move rpc [5 6]
012'836 35 S200 num 14 handle num 15 move rpc [5 6]
012'832 35 S202 num 14 handle num 15 move rpc [0]
012'840 35 S201 num 14 handle num 15 move rpc [5 6]
012'845 35 S201 num 14 handle num 15 move rpc [5 6]
012'846 35 S200 num 14 handle num 15 move rpc [5 6]
012'861 35 S200 num 14 handle num 15 move rpc [5 6]
012'861 35 S200 current config num 14 done
012'847 44 S0 ctrler change to config &{18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
012'848 35 S102 num 15 sending shards [5 6] to group 101
012'851 34 S201 got new config {15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 14
012'863 35 S100 num 15 sending shards [5 6] to group 101
012'865 35 S200 num 14 handle num 15 move rpc [5 6]
012'873 35 S200 num 14 handle num 15 move rpc [0]
012'876 35 S200 num 14 handle num 15 move rpc [0]
012'877 35 S200 num 14 handle num 15 move rpc [0]
012'880 35 S301 num 15 sending shards [0] to group 101
012'857 35 S202 current config num 14 done
012'883 35 S202 num 14 handle num 15 move rpc [0]
012'886 35 S200 num 14 handle num 15 move rpc [0]
012'857 35 S201 current config num 14 done
012'887 35 S300 num 15 sending shards [0] to group 101
012'890 34 S201 propose new config 15
012'890 35 S101 num 15 sending shards [5 6] to group 101
012'890 35 S302 num 15 sending shards [0] to group 101
012'890 35 S201 num 14 handle num 15 move rpc [0]
012'892 35 S201 num 14 handle num 15 move rpc [5 6]
join &{map[101:[server-101-0 server-101-1 server-101-2]] 1074585914363486070 18}
012'896 35 S102 num 15 sending shards [5 6] to group 101
012'898 44 S1 ctrler change to config &{18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
012'898 35 S201 num 14 handle num 15 move rpc [5 6]
012'898 35 S201 num 14 handle num 15 move rpc [5 6]
012'898 35 S201 num 14 handle num 15 move rpc [0]
012'900 35 S201 num 14 handle num 15 move rpc [0]
012'903 35 S201 num 14 handle num 15 move rpc [0]
012'918 35 S300 num 15 sending shards [0] to group 101
012'919 35 S301 num 15 sending shards [0] to group 101
012'921 35 S202 num 14 handle num 15 move rpc [5 6]
012'923 35 S101 num 15 sending shards [5 6] to group 101
012'923 35 S302 num 15 sending shards [0] to group 101
012'927 35 S102 num 15 sending shards [5 6] to group 101
012'927 35 S100 num 15 sending shards [5 6] to group 101
012'928 35 S201 num 14 handle num 15 move rpc [0]
012'909 35 S200 num 14 handle num 15 move rpc [0]
012'939 35 S200 num 14 handle num 15 move rpc [5 6]
012'941 35 S201 current config num 14 done
012'942 35 S202 current config num 14 done
012'942 35 S202 num 14 handle num 15 move rpc [0]
012'954 35 S302 num 15 sending shards [0] to group 101
012'959 35 S100 num 15 sending shards [5 6] to group 101
012'959 35 S200 num 14 handle num 15 move rpc [5 6]
012'960 35 S200 num 14 handle num 15 move rpc [5 6]
012'960 35 S200 num 14 handle num 15 move rpc [0]
012'961 35 S200 current config num 14 done
012'964 35 S200 num 14 handle num 15 move rpc [0]
012'965 35 S202 num 14 handle num 15 move rpc [5 6]
012'965 35 S200 num 14 handle num 15 move rpc [0]
012'966 35 S202 num 14 handle num 15 move rpc [5 6]
012'968 35 S202 num 14 handle num 15 move rpc [5 6]
012'968 35 S200 num 14 handle num 15 move rpc [5 6]
012'970 35 S202 num 14 handle num 15 move rpc [0]
012'970 35 S200 num 14 handle num 15 move rpc [5 6]
012'972 35 S200 num 14 handle num 15 move rpc [5 6]
012'972 35 S200 num 14 handle num 15 move rpc [5 6]
012'954 30 S201 apply index 68 key num 0 type 4   lastApplied 67
012'972 34 S201 apply new config num 15 :&{15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
012'973 34 S201 inited need send [],need recv [0 5 6]
012'973 31 S201 used size: 505 / 300 
012'973 29 S201 do snapshot for raft 68 68,size 498
012'973 27 S1 raft apply snapshot offset 68 ,lastApplied 68,total log 68, size 84,log cap:1
012'974 31 S201 after snap shot size84 498
012'974 35 S201 num 15 handle num 15 move rpc [5 6]
012'975 35 S201 move handle num 15 shards [5 6] as leader?
012'975 35 S201 num 15 handle num 15 move rpc [0]
012'976 35 S200 num 14 handle num 15 move rpc [0]
012'976 35 S201 move handle num 15 shards [0] as leader?
012'976 35 S201 num 15 handle num 15 move rpc [5 6]
012'978 35 S202 num 14 handle num 15 move rpc [5 6]
012'978 35 S202 num 14 handle num 15 move rpc [0]
012'979 35 S202 num 14 handle num 15 move rpc [0]
012'980 35 S202 num 14 handle num 15 move rpc [0]
012'981 35 S201 move handle num 15 shards [5 6] as leader?
012'984 35 S201 num 15 handle num 15 move rpc [0]
012'985 35 S201 move handle num 15 shards [0] as leader?
012'985 30 S200 apply index 68 key num 0 type 4   lastApplied 67
012'985 34 S200 apply new config num 15 :&{15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
012'986 34 S200 inited need send [],need recv [0 5 6]
012'986 31 S200 used size: 1185 / 300 
012'986 29 S200 do snapshot for raft 68 68,size 498
012'986 35 S300 num 15 sending shards [0] to group 101
012'987 35 S301 num 15 sending shards [0] to group 101
012'988 35 S101 num 15 sending shards [5 6] to group 101
012'990 27 S0 raft apply snapshot offset 68 ,lastApplied 68,total log 71, size 845,log cap:4
012'990 31 S200 after snap shot size845 498
012'990 34 S201 check new config wanted 16
012'991 35 S201 num 15 handle num 15 move rpc [5 6]
012'992 35 S100 num 15 sending shards [5 6] to group 101
012'993 35 S201 move handle num 15 shards [5 6] as leader?
012'994 35 S201 num 15 waiting [0 5 6] shards 
012'994 35 S302 num 15 sending shards [0] to group 101
012'994 35 S201 num 15 handle num 15 move rpc [5 6]
013'003 35 S200 num 15 handle num 15 move rpc [5 6]
013'003 35 S200 move handle not leader
013'005 35 S202 current config num 14 done
013'006 35 S200 num 15 handle num 15 move rpc [0]
013'006 35 S200 move handle not leader
013'014 35 S201 move handle num 15 shards [5 6] as leader?
013'014 35 S201 num 15 handle num 15 move rpc [0]
013'015 35 S201 move handle num 15 shards [0] as leader?
013'015 35 S201 num 15 handle num 15 move rpc [0]
013'016 35 S201 move handle num 15 shards [0] as leader?
013'016 30 S201 apply index 69 key num 0 type 5   lastApplied 68
013'016 35 S201 apply num 15 migration [5 6]
013'016 30 S201 safely recv and decided shard 5
013'016 30 S201 safely recv and decided shard 6
013'016 31 S201 used size: 1530 / 300 
013'017 29 S201 do snapshot for raft 69 69,size 559
013'018 27 S1 raft apply snapshot offset 69 ,lastApplied 71,total log 76, size 1381,log cap:8
013'018 27 S1 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:15}, Num:0}}
013'018 31 S201 after snap shot size1381 559
013'018 30 S201 apply index 70 key num 0 type 5   lastApplied 69
013'018 35 S201 apply num 15 migration [0]
013'018 30 S201 safely recv and decided shard 0
013'018 31 S201 used size: 1381 / 300 
013'019 29 S201 do snapshot for raft 70 70,size 612
013'020 27 S1 raft apply snapshot offset 70 ,lastApplied 71,total log 76, size 1252,log cap:7
013'020 27 S1 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:15}, Num:0}}
013'020 31 S201 after snap shot size1252 612
013'020 30 S201 apply index 71 key num 0 type 5   lastApplied 70
013'020 35 S201 apply num 15 migration [5 6]
013'020 31 S201 used size: 1252 / 300 
013'021 29 S201 do snapshot for raft 71 71,size 612
013'023 35 S101 num 15 sending shards [5 6] to group 101
013'028 35 S200 num 15 handle num 15 move rpc [0]
013'028 35 S200 move handle not leader
013'037 35 S302 num 15 sending shards [0] to group 101
013'037 35 S100 num 15 sending shards [5 6] to group 101
013'044 35 S300 num 15 sending shards [0] to group 101
013'045 35 S301 num 15 sending shards [0] to group 101
013'022 27 S1 raft apply snapshot offset 71 ,lastApplied 71,total log 76, size 1103,log cap:6
013'046 31 S201 after snap shot size1103 612
013'047 35 S201 num 15 handle num 15 move rpc [5 6]
013'047 35 S201 num 15 move [5 6] is done yet
013'048 35 S200 num 15 handle num 15 move rpc [0]
013'048 35 S200 move handle not leader
013'049 35 S201 num 15 handle num 15 move rpc [0]
013'049 35 S201 num 15 move [0] is done yet
013'049 35 S200 num 15 handle num 15 move rpc [0]
013'050 35 S200 move handle not leader
013'050 30 S200 apply index 69 key num 0 type 5   lastApplied 68
013'050 35 S200 apply num 15 migration [5 6]
013'050 30 S200 safely recv and decided shard 5
013'050 30 S200 safely recv and decided shard 6
013'050 31 S200 used size: 1272 / 300 
013'051 29 S200 do snapshot for raft 69 69,size 559
013'052 27 S0 raft apply snapshot offset 69 ,lastApplied 71,total log 74, size 1123,log cap:6
013'052 27 S0 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:15}, Num:0}}
013'052 31 S200 after snap shot size1123 559
013'052 30 S200 apply index 70 key num 0 type 5   lastApplied 69
013'052 35 S200 apply num 15 migration [0]
013'053 30 S200 safely recv and decided shard 0
013'053 31 S200 used size: 1123 / 300 
013'053 29 S200 do snapshot for raft 70 70,size 612
013'054 27 S0 raft apply snapshot offset 70 ,lastApplied 71,total log 74, size 994,log cap:5
013'054 27 S0 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:15}, Num:0}}
013'055 31 S200 after snap shot size994 612
013'055 30 S200 apply index 71 key num 0 type 5   lastApplied 70
013'055 35 S200 apply num 15 migration [5 6]
013'055 31 S200 used size: 994 / 300 
013'056 35 S202 current config num 14 done
013'058 29 S200 do snapshot for raft 71 71,size 612
013'059 30 S202 apply index 68 key num 0 type 4   lastApplied 67
013'059 34 S202 apply new config num 15 :&{15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{14 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
013'059 27 S0 raft apply snapshot offset 71 ,lastApplied 71,total log 74, size 845,log cap:4
013'066 31 S200 after snap shot size845 612
013'059 34 S202 inited need send [],need recv [0 5 6]
013'066 31 S202 used size: 1612 / 300 
013'066 35 S101 num 15 sending shards [5 6] to group 101
013'066 35 S200 num 15 handle num 15 move rpc [0]
013'066 35 S200 num 15 move [0] is done yet
013'059 35 S201 num 15 move [5 6] is done yet
013'062 35 S102 num 15 sending shards [5 6] to group 101
013'067 35 S200 current config num 15 done
013'067 35 S200 num 15 handle num 15 move rpc [5 6]
013'067 35 S200 num 15 move [5 6] is done yet
013'067 35 S201 num 15 handle num 15 move rpc [5 6]
013'067 35 S201 num 15 move [5 6] is done yet
013'067 35 S201 num 15 move [5 6] is done yet
013'067 35 S201 num 15 move [0] is done yet
013'068 35 S201 num 15 handle num 15 move rpc [0]
013'068 35 S201 num 15 move [0] is done yet
013'068 35 S201 current config num 15 done
013'068 30 S201 apply index 72 key num 0 type 5   lastApplied 71
013'068 35 S201 apply num 15 migration [0]
013'068 31 S201 used size: 1103 / 300 
013'069 35 S302 num 15 sending shards [0] to group 101
013'070 35 S100 num 15 sending shards [5 6] to group 101
013'072 35 S200 num 15 handle num 15 move rpc [5 6]
013'072 35 S200 num 15 move [5 6] is done yet
013'073 30 S100 after send shards ok
013'074 35 S100 move delete propose num 15 shards [5 6] as leader?
013'075 35 S301 num 15 sending shards [0] to group 101
013'087 35 S300 num 15 sending shards [0] to group 101
013'094 35 S200 num 15 handle num 15 move rpc [0]
013'094 35 S200 num 15 move [0] is done yet
013'096 30 S301 after send shards ok
013'096 35 S301 move delete propose not leader
013'098 29 S202 do snapshot for raft 68 68,size 498
013'099 27 S2 raft apply snapshot offset 68 ,lastApplied 71,total log 74, size 1272,log cap:7
013'099 27 S2 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:15}, Num:0}}
013'099 31 S202 after snap shot size1272 498
013'099 30 S202 apply index 69 key num 0 type 5   lastApplied 68
013'099 35 S202 apply num 15 migration [5 6]
013'099 30 S202 safely recv and decided shard 5
013'099 30 S202 safely recv and decided shard 6
013'099 31 S202 used size: 1272 / 300 
013'100 29 S202 do snapshot for raft 69 69,size 559
013'101 35 S101 num 15 sending shards [5 6] to group 101
013'101 27 S2 raft apply snapshot offset 69 ,lastApplied 71,total log 74, size 1123,log cap:6
013'101 27 S2 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:15}, Num:0}}
013'101 31 S202 after snap shot size1123 559
013'101 30 S202 apply index 70 key num 0 type 5   lastApplied 69
013'101 35 S202 apply num 15 migration [0]
013'101 30 S202 safely recv and decided shard 0
013'101 31 S202 used size: 1123 / 300 
013'102 29 S202 do snapshot for raft 70 70,size 612
013'103 27 S2 raft apply snapshot offset 70 ,lastApplied 71,total log 74, size 994,log cap:5
013'103 27 S2 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:15}, Num:0}}
013'103 31 S202 after snap shot size994 612
013'103 30 S202 apply index 71 key num 0 type 5   lastApplied 70
013'103 35 S202 apply num 15 migration [5 6]
013'103 31 S202 used size: 994 / 300 
013'104 29 S202 do snapshot for raft 71 71,size 612
013'104 27 S2 raft apply snapshot offset 71 ,lastApplied 71,total log 74, size 845,log cap:4
013'104 31 S202 after snap shot size845 612
013'105 35 S102 num 15 sending shards [5 6] to group 101
013'106 35 S200 num 15 handle num 15 move rpc [0]
013'107 35 S200 num 15 move [0] is done yet
013'107 30 S301 after send shards ok
013'107 35 S301 move delete propose not leader
013'109 35 S200 num 15 handle num 15 move rpc [5 6]
013'109 35 S200 num 15 move [5 6] is done yet
013'111 30 S302 after send shards ok
013'111 35 S302 move delete propose not leader
013'111 30 S101 after send shards ok
013'111 35 S101 move delete propose not leader
013'117 30 S101 after send shards ok
013'117 35 S101 move delete propose not leader
013'119 30 S100 after send shards ok
013'120 35 S100 move delete propose num 15 shards [5 6] as leader?
013'121 30 S302 after send shards ok
013'121 35 S302 move delete propose not leader
013'121 30 S100 after send shards ok
013'123 35 S100 move delete propose num 15 shards [5 6] as leader?
013'135 29 S201 do snapshot for raft 72 72,size 612
013'135 30 S300 after send shards ok
013'136 35 S300 move delete propose num 15 shards [0] as leader?
013'138 27 S1 raft apply snapshot offset 72 ,lastApplied 76,total log 76, size 974,log cap:5
013'139 27 S1 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}}, Num:15}, Num:0}}
013'139 31 S201 after snap shot size974 612
013'139 30 S201 apply index 73 key num 0 type 5   lastApplied 72
013'139 35 S201 apply num 15 migration [5 6]
013'139 31 S201 used size: 974 / 300 
013'139 29 S201 do snapshot for raft 73 73,size 612
013'140 27 S1 raft apply snapshot offset 73 ,lastApplied 76,total log 76, size 825,log cap:4
013'140 27 S1 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}}, Num:15}, Num:0}}
013'140 31 S201 after snap shot size825 612
013'140 30 S201 apply index 74 key num 0 type 5   lastApplied 73
013'140 35 S201 apply num 15 migration [5 6]
013'141 31 S201 used size: 825 / 300 
013'141 29 S201 do snapshot for raft 74 74,size 612
013'142 27 S1 raft apply snapshot offset 74 ,lastApplied 76,total log 76, size 676,log cap:3
013'123 35 S200 current config num 15 done
013'143 35 S302 num 15 sending shards [0] to group 101
013'143 35 S200 num 15 handle num 15 move rpc [5 6]
013'143 35 S200 num 15 move [5 6] is done yet
013'123 35 S202 current config num 15 done
013'145 35 S200 num 15 handle num 15 move rpc [0]
013'145 35 S200 num 15 move [0] is done yet
013'145 30 S302 after send shards ok
013'145 35 S302 move delete propose not leader
013'146 35 S200 num 15 handle num 15 move rpc [0]
013'146 35 S200 num 15 move [0] is done yet
013'147 30 S300 after send shards ok
013'148 35 S300 move delete propose num 15 shards [0] as leader?
013'150 35 S300 num 15 sending shards [0] to group 101
013'152 35 S200 num 15 handle num 15 move rpc [0]
013'152 35 S200 num 15 move [0] is done yet
013'142 27 S1 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}}, Num:15}, Num:0}}
013'157 31 S201 after snap shot size676 612
013'157 35 S201 num 15 move [0] is done yet
013'157 35 S201 num 15 move [5 6] is done yet
013'157 30 S300 apply index 50 key num 0 type 5   lastApplied 49
013'157 35 S300 apply num 15 migration [0]
013'157 30 S300 safely delete shard 0
013'157 31 S300 used size: 674 / 300 
013'158 29 S300 do snapshot for raft 50 50,size 617
013'158 35 S200 num 15 handle num 15 move rpc [0]
013'158 35 S200 num 15 move [0] is done yet
013'159 27 S0 raft apply snapshot offset 50 ,lastApplied 51,total log 51, size 545,log cap:2
013'159 27 S0 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}}, Num:15}, Num:0}}
013'159 31 S300 after snap shot size545 617
013'159 30 S300 apply index 51 key num 0 type 5   lastApplied 50
013'159 35 S300 apply num 15 migration [0]
013'159 31 S300 used size: 545 / 300 
013'159 29 S300 do snapshot for raft 51 51,size 617
013'160 27 S0 raft apply snapshot offset 51 ,lastApplied 51,total log 51, size 82,log cap:1
013'160 30 S302 after send shards ok
013'160 35 S302 move delete propose not leader
013'161 35 S200 num 15 handle num 15 move rpc [5 6]
013'161 35 S200 num 15 move [5 6] is done yet
013'165 31 S300 after snap shot size82 617
013'165 35 S201 num 15 move [5 6] is done yet
013'165 35 S201 num 15 move [0] is done yet
013'165 35 S201 num 15 move [0] is done yet
013'165 35 S201 current config num 15 done
013'166 30 S300 after send shards ok
013'166 35 S300 num 15 move [0] is done yet
013'167 35 S201 num 15 handle num 15 move rpc [5 6]
013'167 35 S201 num 15 move [5 6] is done yet
013'167 30 S302 after send shards ok
013'167 35 S302 move delete propose not leader
013'179 35 S302 num 15 sending shards [0] to group 101
013'180 35 S200 num 15 handle num 15 move rpc [5 6]
013'180 35 S200 num 15 move [5 6] is done yet
013'181 35 S200 num 15 handle num 15 move rpc [5 6]
013'181 35 S200 num 15 move [5 6] is done yet
013'181 35 S100 num 15 sending shards [5 6] to group 101
013'184 35 S301 num 15 sending shards [0] to group 101
013'184 30 S100 after send shards ok
013'185 35 S100 move delete propose num 15 shards [5 6] as leader?
013'185 30 S301 after send shards ok
013'186 35 S301 move delete propose not leader
013'186 30 S100 after send shards ok
013'187 35 S201 num 15 handle num 15 move rpc [0]
013'187 35 S201 num 15 move [0] is done yet
013'187 30 S201 apply index 75 key num 0 type 5   lastApplied 74
013'187 35 S201 apply num 15 migration [0]
013'187 31 S201 used size: 676 / 300 
013'188 35 S100 move delete propose num 15 shards [5 6] as leader?
013'188 29 S201 do snapshot for raft 75 75,size 612
013'188 30 S100 apply index 160 key num 0 type 5   lastApplied 159
013'188 35 S100 apply num 15 migration [5 6]
013'188 30 S100 safely delete shard 5
013'188 30 S100 safely delete shard 6
013'188 31 S100 used size: 1165 / 300 
013'189 27 S1 raft apply snapshot offset 75 ,lastApplied 76,total log 76, size 547,log cap:2
013'189 27 S1 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}}, Num:15}, Num:0}}
013'189 31 S201 after snap shot size547 612
013'189 29 S100 do snapshot for raft 160 160,size 622
013'189 35 S201 num 15 handle num 15 move rpc [5 6]
013'189 35 S201 num 15 move [5 6] is done yet
013'190 27 S0 raft apply snapshot offset 160 ,lastApplied 160,total log 164, size 1016,log cap:5
013'190 31 S100 after snap shot size1016 622
013'190 30 S302 after send shards ok
013'190 35 S302 move delete propose not leader
013'190 35 S201 num 15 handle num 15 move rpc [5 6]
013'191 35 S201 num 15 move [5 6] is done yet
013'191 30 S201 apply index 76 key num 0 type 5   lastApplied 75
013'191 35 S201 apply num 15 migration [0]
013'191 31 S201 used size: 547 / 300 
013'191 29 S201 do snapshot for raft 76 76,size 612
013'192 27 S1 raft apply snapshot offset 76 ,lastApplied 76,total log 76, size 84,log cap:1
013'192 31 S201 after snap shot size84 612
013'194 30 S300 after send shards ok
013'194 35 S300 num 15 move [0] is done yet
013'194 35 S300 current config num 15 done
013'197 30 S300 after send shards ok
013'197 35 S300 num 15 move [0] is done yet
013'203 35 S200 num 15 handle num 15 move rpc [5 6]
013'203 35 S200 num 15 move [5 6] is done yet
013'209 35 S201 num 15 handle num 15 move rpc [5 6]
013'209 35 S201 num 15 move [5 6] is done yet
013'211 35 S200 current config num 15 done
013'211 35 S202 current config num 15 done
013'211 35 S302 num 15 sending shards [0] to group 101
013'212 35 S200 num 15 handle num 15 move rpc [0]
013'212 35 S200 num 15 move [0] is done yet
013'214 30 S300 after send shards ok
013'214 35 S300 num 15 move [0] is done yet
013'220 30 S100 after send shards ok
013'220 35 S100 num 15 move [5 6] is done yet
013'222 35 S200 num 15 handle num 15 move rpc [0]
013'222 35 S200 num 15 move [0] is done yet
013'223 35 S200 num 15 handle num 15 move rpc [5 6]
013'223 35 S200 num 15 move [5 6] is done yet
013'231 35 S102 num 15 sending shards [5 6] to group 101
013'232 30 S102 after send shards ok
013'232 35 S102 move delete propose not leader
013'232 30 S102 after send shards ok
013'232 35 S102 move delete propose not leader
013'232 30 S102 after send shards ok
013'232 35 S102 move delete propose not leader
013'233 30 S102 after send shards ok
013'233 35 S102 move delete propose not leader
013'233 30 S102 after send shards ok
013'233 35 S102 move delete propose not leader
013'233 30 S102 apply index 160 key num 0 type 5   lastApplied 159
013'233 35 S102 apply num 15 migration [5 6]
013'233 30 S102 safely delete shard 5
013'233 30 S102 safely delete shard 6
013'233 31 S102 used size: 1165 / 300 
013'234 29 S102 do snapshot for raft 160 160,size 622
013'234 27 S2 raft apply snapshot offset 160 ,lastApplied 160,total log 164, size 1016,log cap:5
013'235 31 S102 after snap shot size1016 622
013'238 35 S200 num 15 handle num 15 move rpc [5 6]
013'238 35 S200 num 15 move [5 6] is done yet
013'239 35 S200 num 15 handle num 15 move rpc [0]
013'239 35 S200 num 15 move [0] is done yet
013'241 35 S302 num 15 sending shards [0] to group 101
013'247 35 S200 num 15 handle num 15 move rpc [0]
013'247 35 S200 num 15 move [0] is done yet
013'248 30 S302 after send shards ok
013'248 35 S302 move delete propose not leader
013'250 30 S302 apply index 50 key num 0 type 5   lastApplied 49
013'250 35 S302 apply num 15 migration [0]
013'250 30 S302 safely delete shard 0
013'250 31 S302 used size: 674 / 300 
013'251 29 S302 do snapshot for raft 50 50,size 617
013'251 35 S300 current config num 15 done
013'251 30 S102 after send shards ok
013'251 35 S102 num 15 move [5 6] is done yet
013'251 27 S2 raft apply snapshot offset 50 ,lastApplied 51,total log 51, size 545,log cap:2
013'251 27 S2 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}}, Num:15}, Num:0}}
013'251 31 S302 after snap shot size545 617
013'252 30 S302 apply index 51 key num 0 type 5   lastApplied 50
013'252 35 S302 apply num 15 migration [0]
013'252 31 S302 used size: 545 / 300 
013'252 29 S302 do snapshot for raft 51 51,size 617
013'252 27 S2 raft apply snapshot offset 51 ,lastApplied 51,total log 51, size 82,log cap:1
013'253 31 S302 after snap shot size82 617
013'254 30 S302 after send shards ok
013'254 35 S302 num 15 move [0] is done yet
013'260 35 S200 num 15 handle num 15 move rpc [0]
013'260 35 S200 num 15 move [0] is done yet
013'262 30 S302 after send shards ok
013'262 35 S302 num 15 move [0] is done yet
013'264 35 S101 num 15 sending shards [5 6] to group 101
013'225 35 S100 current config num 15 done
013'266 30 S100 apply index 161 key num 0 type 5   lastApplied 160
013'266 35 S100 apply num 15 migration [5 6]
013'266 31 S100 used size: 1016 / 300 
013'266 29 S100 do snapshot for raft 161 161,size 622
013'267 27 S0 raft apply snapshot offset 161 ,lastApplied 164,total log 164, size 867,log cap:4
013'267 27 S0 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:15}, Num:0}}
013'267 31 S100 after snap shot size867 622
013'267 30 S100 apply index 162 key num 0 type 5   lastApplied 161
013'267 35 S100 apply num 15 migration [5 6]
013'268 31 S100 used size: 867 / 300 
013'268 29 S100 do snapshot for raft 162 162,size 622
013'269 27 S0 raft apply snapshot offset 162 ,lastApplied 164,total log 164, size 718,log cap:3
013'269 27 S0 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:15}, Num:0}}
013'269 31 S100 after snap shot size718 622
013'269 30 S100 apply index 163 key num 0 type 5   lastApplied 162
013'269 35 S100 apply num 15 migration [5 6]
013'269 31 S100 used size: 718 / 300 
013'270 29 S100 do snapshot for raft 163 163,size 622
013'270 35 S200 current config num 15 done
013'270 35 S202 current config num 15 done
013'286 30 S101 after send shards ok
013'286 35 S101 move delete propose not leader
013'287 30 S101 after send shards ok
013'287 35 S101 move delete propose not leader
013'287 30 S101 after send shards ok
013'287 35 S101 move delete propose not leader
013'288 35 S301 num 15 sending shards [0] to group 101
013'289 30 S102 apply index 161 key num 0 type 5   lastApplied 160
013'289 35 S102 apply num 15 migration [5 6]
013'289 30 S101 after send shards ok
013'289 35 S101 move delete propose not leader
013'289 30 S101 after send shards ok
013'289 35 S101 move delete propose not leader
013'290 30 S101 after send shards ok
013'290 35 S101 move delete propose not leader
013'290 35 S302 current config num 15 done
013'294 35 S200 num 15 handle num 15 move rpc [5 6]
013'294 35 S200 num 15 move [5 6] is done yet
013'301 35 S300 current config num 15 done
013'304 27 S0 raft apply snapshot offset 163 ,lastApplied 164,total log 164, size 569,log cap:2
013'304 27 S0 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:15}, Num:0}}
013'305 31 S100 after snap shot size569 622
013'305 30 S100 apply index 164 key num 0 type 5   lastApplied 163
013'305 35 S100 apply num 15 migration [5 6]
013'305 31 S100 used size: 569 / 300 
013'305 29 S100 do snapshot for raft 164 164,size 622
013'306 27 S0 raft apply snapshot offset 164 ,lastApplied 164,total log 164, size 86,log cap:1
013'306 31 S100 after snap shot size86 622
013'311 30 S200 apply index 72 key num 0 type 5   lastApplied 71
013'311 35 S200 apply num 15 migration [0]
013'311 31 S200 used size: 1103 / 300 
013'311 29 S200 do snapshot for raft 72 72,size 612
013'314 27 S0 raft apply snapshot offset 72 ,lastApplied 76,total log 76, size 974,log cap:5
013'314 27 S0 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}}, Num:15}, Num:0}}
013'314 31 S200 after snap shot size974 612
013'314 30 S200 apply index 73 key num 0 type 5   lastApplied 72
013'314 35 S200 apply num 15 migration [5 6]
013'314 31 S200 used size: 974 / 300 
013'315 29 S200 do snapshot for raft 73 73,size 612
013'317 27 S0 raft apply snapshot offset 73 ,lastApplied 76,total log 76, size 825,log cap:4
013'317 27 S0 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}}, Num:15}, Num:0}}
013'317 31 S200 after snap shot size825 612
013'317 30 S200 apply index 74 key num 0 type 5   lastApplied 73
013'317 35 S200 apply num 15 migration [5 6]
013'317 31 S200 used size: 825 / 300 
013'318 29 S200 do snapshot for raft 74 74,size 612
013'319 27 S0 raft apply snapshot offset 74 ,lastApplied 76,total log 76, size 676,log cap:3
013'319 27 S0 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}}, Num:15}, Num:0}}
013'320 31 S200 after snap shot size676 612
013'320 30 S200 apply index 75 key num 0 type 5   lastApplied 74
013'320 35 S200 apply num 15 migration [0]
013'320 31 S200 used size: 676 / 300 
013'320 29 S200 do snapshot for raft 75 75,size 612
013'321 27 S0 raft apply snapshot offset 75 ,lastApplied 76,total log 76, size 547,log cap:2
013'321 27 S0 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}}, Num:15}, Num:0}}
013'321 31 S200 after snap shot size547 612
013'321 30 S200 apply index 76 key num 0 type 5   lastApplied 75
013'321 35 S200 apply num 15 migration [0]
013'321 31 S200 used size: 547 / 300 
013'322 35 S100 current config num 15 done
013'323 35 S202 current config num 15 done
013'324 29 S200 do snapshot for raft 76 76,size 612
013'324 27 S0 raft apply snapshot offset 76 ,lastApplied 76,total log 76, size 84,log cap:1
013'324 31 S200 after snap shot size84 612
013'325 35 S200 current config num 15 done
013'325 30 S301 apply index 50 key num 0 type 5   lastApplied 49
013'325 35 S301 apply num 15 migration [0]
013'325 30 S301 safely delete shard 0
013'325 31 S301 used size: 674 / 300 
013'325 29 S301 do snapshot for raft 50 50,size 617
013'326 35 S200 num 15 handle num 15 move rpc [0]
013'326 35 S200 num 15 move [0] is done yet
013'226 35 S201 current config num 15 done
013'327 35 S201 num 15 handle num 15 move rpc [0]
013'327 35 S201 num 15 move [0] is done yet
013'289 31 S102 used size: 1016 / 300 
013'328 29 S102 do snapshot for raft 161 161,size 622
013'329 27 S2 raft apply snapshot offset 161 ,lastApplied 164,total log 164, size 867,log cap:4
013'329 27 S2 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:15}, Num:0}}
013'329 31 S102 after snap shot size867 622
013'329 27 S1 raft apply snapshot offset 50 ,lastApplied 51,total log 51, size 545,log cap:2
013'330 27 S1 last applied not snapshoted raft.LogEntry{Term:6, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}}, Num:15}, Num:0}}
013'330 31 S301 after snap shot size545 617
013'330 30 S301 apply index 51 key num 0 type 5   lastApplied 50
013'330 35 S301 apply num 15 migration [0]
013'330 31 S301 used size: 545 / 300 
013'331 29 S301 do snapshot for raft 51 51,size 617
013'331 27 S1 raft apply snapshot offset 51 ,lastApplied 51,total log 51, size 82,log cap:1
013'331 31 S301 after snap shot size82 617
013'331 30 S301 after send shards ok
013'331 35 S301 num 15 move [0] is done yet
013'332 30 S301 after send shards ok
013'332 35 S301 num 15 move [0] is done yet
013'329 30 S102 apply index 162 key num 0 type 5   lastApplied 161
013'332 35 S102 apply num 15 migration [5 6]
013'332 31 S102 used size: 867 / 300 
013'332 29 S102 do snapshot for raft 162 162,size 622
013'333 27 S2 raft apply snapshot offset 162 ,lastApplied 164,total log 164, size 718,log cap:3
013'333 27 S2 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:15}, Num:0}}
013'333 31 S102 after snap shot size718 622
013'329 35 S201 num 15 handle num 15 move rpc [0]
013'333 35 S201 num 15 move [0] is done yet
013'334 35 S102 current config num 15 done
013'334 30 S102 apply index 163 key num 0 type 5   lastApplied 162
013'334 35 S102 apply num 15 migration [5 6]
013'334 31 S102 used size: 718 / 300 
013'336 29 S102 do snapshot for raft 163 163,size 622
013'336 27 S2 raft apply snapshot offset 163 ,lastApplied 164,total log 164, size 569,log cap:2
013'336 27 S2 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:15}, Num:0}}
013'337 31 S102 after snap shot size569 622
013'337 30 S102 apply index 164 key num 0 type 5   lastApplied 163
013'337 35 S102 apply num 15 migration [5 6]
013'337 31 S102 used size: 569 / 300 
013'337 29 S102 do snapshot for raft 164 164,size 622
013'337 27 S2 raft apply snapshot offset 164 ,lastApplied 164,total log 164, size 86,log cap:1
013'338 31 S102 after snap shot size86 622
013'330 30 S302 after send shards ok
013'338 35 S302 num 15 move [0] is done yet
013'340 30 S301 after send shards ok
013'340 35 S301 num 15 move [0] is done yet
013'290 30 S101 apply index 160 key num 0 type 5   lastApplied 159
013'340 35 S101 apply num 15 migration [5 6]
013'340 30 S101 safely delete shard 5
013'340 30 S101 safely delete shard 6
013'340 31 S101 used size: 1165 / 300 
013'341 29 S101 do snapshot for raft 160 160,size 622
013'342 27 S1 raft apply snapshot offset 160 ,lastApplied 160,total log 164, size 1016,log cap:5
013'343 31 S101 after snap shot size1016 622
013'343 30 S101 after send shards ok
013'343 35 S101 num 15 move [5 6] is done yet
013'344 35 S101 current config num 15 done
013'344 29 S202 recv Installsnapshot 76 71
013'345 27 S2 raft apply snapshot offset 76 ,lastApplied 76,total log 76, size 84,log cap:1
013'345 29 S202 decide Installsnapshot 76 <- 71
013'345 30 S202 install snap index 76,config {15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
013'347 35 S302 current config num 15 done
013'360 35 S300 current config num 15 done
013'360 35 S301 current config num 15 done
013'368 30 S101 apply index 161 key num 0 type 5   lastApplied 160
013'368 35 S101 apply num 15 migration [5 6]
013'368 31 S101 used size: 1016 / 300 
013'369 29 S101 do snapshot for raft 161 161,size 622
013'370 27 S1 raft apply snapshot offset 161 ,lastApplied 164,total log 164, size 867,log cap:4
013'370 27 S1 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:15}, Num:0}}
013'370 31 S101 after snap shot size867 622
013'371 30 S101 apply index 162 key num 0 type 5   lastApplied 161
013'371 35 S101 apply num 15 migration [5 6]
013'371 31 S101 used size: 867 / 300 
013'372 29 S101 do snapshot for raft 162 162,size 622
013'375 27 S1 raft apply snapshot offset 162 ,lastApplied 164,total log 164, size 718,log cap:3
013'375 27 S1 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:15}, Num:0}}
013'375 31 S101 after snap shot size718 622
013'375 30 S101 apply index 163 key num 0 type 5   lastApplied 162
013'375 35 S101 apply num 15 migration [5 6]
013'375 31 S101 used size: 718 / 300 
013'376 29 S101 do snapshot for raft 163 163,size 622
013'376 27 S1 raft apply snapshot offset 163 ,lastApplied 164,total log 164, size 569,log cap:2
013'376 27 S1 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:15}, Num:0}}
013'376 31 S101 after snap shot size569 622
013'376 30 S101 apply index 164 key num 0 type 5   lastApplied 163
013'376 35 S101 apply num 15 migration [5 6]
013'377 31 S101 used size: 569 / 300 
013'377 29 S101 do snapshot for raft 164 164,size 622
013'377 27 S1 raft apply snapshot offset 164 ,lastApplied 164,total log 164, size 86,log cap:1
013'377 31 S101 after snap shot size86 622
013'379 35 S201 current config num 15 done
013'385 35 S100 current config num 15 done
013'386 35 S202 current config num 15 done
013'388 35 S102 current config num 15 done
013'388 35 S200 current config num 15 done
013'409 35 S302 current config num 15 done
013'411 35 S300 current config num 15 done
013'411 35 S301 current config num 15 done
013'394 35 S101 current config num 15 done
013'429 35 S201 current config num 15 done
013'441 35 S100 current config num 15 done
013'444 35 S202 current config num 15 done
013'456 35 S102 current config num 15 done
013'472 35 S300 current config num 15 done
013'473 35 S200 current config num 15 done
013'473 35 S302 current config num 15 done
013'473 35 S301 current config num 15 done
013'473 35 S101 current config num 15 done
013'480 35 S201 current config num 15 done
013'492 35 S100 current config num 15 done
013'494 35 S202 current config num 15 done
013'531 35 S102 current config num 15 done
013'531 35 S101 current config num 15 done
013'532 35 S201 current config num 15 done
013'532 35 S302 current config num 15 done
013'532 35 S300 current config num 15 done
013'532 35 S200 current config num 15 done
013'531 35 S301 current config num 15 done
013'542 35 S100 current config num 15 done
013'546 35 S202 current config num 15 done
join &{map[101:[server-101-0 server-101-1 server-101-2]] 1074585914363486070 18}
013'583 35 S102 current config num 15 done
013'584 35 S101 current config num 15 done
013'586 35 S301 current config num 15 done
013'586 35 S300 current config num 15 done
013'586 35 S200 current config num 15 done
013'586 35 S201 current config num 15 done
013'586 35 S302 current config num 15 done
013'606 35 S100 current config num 15 done
013'608 35 S202 current config num 15 done
013'634 35 S101 current config num 15 done
013'635 35 S102 current config num 15 done
013'636 35 S301 current config num 15 done
013'636 35 S200 current config num 15 done
013'636 35 S302 current config num 15 done
013'636 35 S201 current config num 15 done
013'636 35 S300 current config num 15 done
013'659 35 S202 current config num 15 done
013'660 35 S100 current config num 15 done
013'685 35 S101 current config num 15 done
013'685 35 S102 current config num 15 done
013'686 35 S301 current config num 15 done
013'686 35 S302 current config num 15 done
013'693 35 S300 current config num 15 done
013'693 35 S200 current config num 15 done
013'693 35 S201 current config num 15 done
013'710 35 S202 current config num 15 done
013'712 35 S100 current config num 15 done
013'738 44 S2 ctrler change to config &{19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
013'740 35 S301 current config num 15 done
013'740 35 S101 current config num 15 done
013'740 35 S102 current config num 15 done
013'743 34 S200 got new config {15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 14
013'743 35 S201 current config num 15 done
013'744 35 S302 current config num 15 done
013'744 35 S300 current config num 15 done
013'744 35 S200 current config num 15 done
013'769 28 S300 do request args:Key 3 type 3 num 19 Client 2238025532150463055 Seq 8 
013'769 28 S300 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
013'777 34 S302 got new config {15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 14
013'790 35 S100 current config num 15 done
013'790 35 S202 current config num 15 done
013'790 35 S301 current config num 15 done
013'790 35 S101 current config num 15 done
013'790 35 S102 current config num 15 done
013'790 44 S0 ctrler change to config &{19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
013'795 35 S200 current config num 15 done
013'795 35 S201 current config num 15 done
013'795 35 S300 current config num 15 done
013'795 35 S302 current config num 15 done
013'810 44 S1 ctrler change to config &{19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
013'823 34 S301 got new config {15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 14
013'840 35 S202 current config num 15 done
013'840 35 S102 current config num 15 done
013'840 35 S100 current config num 15 done
013'841 35 S301 current config num 15 done
013'841 35 S101 current config num 15 done
013'845 35 S200 current config num 15 done
013'845 35 S300 current config num 15 done
013'845 35 S302 current config num 15 done
013'845 35 S201 current config num 15 done
013'851 28 S100 do request args:Key 9 type 3 num 19 Client 3620950086299709532 Seq 15 
013'852 28 S100 [532--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
013'854 34 S200 check new config wanted 16
013'880 28 S300 do request args:Key 5 type 3 num 19 Client 3482757038087095369 Seq 5 
013'880 28 S300 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
013'885 34 S302 check new config wanted 16
013'890 35 S202 current config num 15 done
013'891 28 S100 do request args:Key 0 type 3 num 19 Client 940626237948413081 Seq 10 
013'891 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
013'891 35 S101 current config num 15 done
013'892 35 S102 current config num 15 done
013'892 35 S100 current config num 15 done
013'892 35 S301 current config num 15 done
013'897 34 S101 got new config {15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 14
013'901 34 S300 got new config {16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 15
013'902 34 S300 propose new config 16
013'904 35 S200 current config num 15 done
013'904 35 S302 current config num 15 done
013'904 35 S201 current config num 15 done
013'904 35 S300 current config num 15 done
013'909 34 S102 got new config {16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 15
013'920 28 S300 do request args:Key 4 type 3 num 19 Client 132246879705026825 Seq 6 
013'920 28 S300 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
013'921 34 S100 got new config {16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 15
013'922 34 S100 propose new config 16
013'923 28 S200 do request args:Key 8 type 3 num 19 Client 2953714763196401582 Seq 2 
013'923 28 S200 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
013'939 28 S100 do request args:Key 1 type 3 num 19 Client 418781717203629479 Seq 23 
013'939 28 S100 [479--23] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
013'944 30 S300 apply index 52 key num 0 type 4   lastApplied 51
013'944 34 S300 apply new config num 16 :&{16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
013'945 34 S300 inited need send [],need recv [6]
013'945 31 S300 used size: 459 / 300 
013'945 29 S300 do snapshot for raft 52 52,size 574
013'945 27 S0 raft apply snapshot offset 52 ,lastApplied 52,total log 52, size 82,log cap:1
013'946 31 S300 after snap shot size82 574
013'946 35 S202 current config num 15 done
013'946 35 S101 current config num 15 done
013'946 35 S102 current config num 15 done
013'947 35 S100 current config num 15 done
013'949 30 S100 apply index 165 key num 0 type 4   lastApplied 164
013'949 34 S100 apply new config num 16 :&{16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
013'949 34 S100 inited need send [],need recv [0 5]
013'949 31 S100 used size: 463 / 300 
013'950 29 S100 do snapshot for raft 165 165,size 579
013'950 27 S0 raft apply snapshot offset 165 ,lastApplied 165,total log 165, size 86,log cap:1
013'950 31 S100 after snap shot size86 579
013'952 28 S300 do request args:Key 6 type 3 num 19 Client 542732653461723544 Seq 4 
013'952 28 S300 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
013'929 34 S301 check new config wanted 16
013'953 35 S301 current config num 15 done
013'959 30 S301 apply index 52 key num 0 type 4   lastApplied 51
013'959 34 S301 apply new config num 16 :&{16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
013'959 34 S301 inited need send [],need recv [6]
013'959 31 S301 used size: 459 / 300 
013'966 35 S201 current config num 15 done
013'966 35 S200 current config num 15 done
013'966 35 S302 current config num 15 done
013'966 35 S300 num 16 waiting [6] shards 
013'966 29 S301 do snapshot for raft 52 52,size 574
013'967 27 S1 raft apply snapshot offset 52 ,lastApplied 52,total log 52, size 82,log cap:1
013'967 31 S301 after snap shot size82 574
013'970 30 S302 apply index 52 key num 0 type 4   lastApplied 51
013'970 34 S302 apply new config num 16 :&{16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
013'971 34 S302 inited need send [],need recv [6]
013'971 31 S302 used size: 459 / 300 
013'971 29 S302 do snapshot for raft 52 52,size 574
013'972 27 S2 raft apply snapshot offset 52 ,lastApplied 52,total log 52, size 82,log cap:1
013'972 31 S302 after snap shot size82 574
013'974 34 S202 got new config {15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 14
013'982 34 S201 got new config {16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 15
013'983 34 S201 propose new config 16
013'984 28 S200 do request args:Key 2 type 3 num 19 Client 1679014388048817729 Seq 27 
013'984 28 S200 [729--27] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
013'997 34 S101 check new config wanted 16
014'006 35 S100 num 16 waiting [0 5] shards 
014'007 35 S202 current config num 15 done
014'009 30 S201 apply index 77 key num 0 type 4   lastApplied 76
014'009 34 S201 apply new config num 16 :&{16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
014'009 34 S201 inited need send [0 5 6],need recv []
014'009 31 S201 used size: 461 / 300 
014'010 29 S201 do snapshot for raft 77 77,size 569
014'010 27 S1 raft apply snapshot offset 77 ,lastApplied 77,total log 77, size 84,log cap:1
014'010 31 S201 after snap shot size84 569
014'007 35 S101 current config num 15 done
014'007 35 S102 current config num 15 done
014'008 34 S300 check new config wanted 17
014'028 35 S300 num 16 waiting [6] shards 
014'030 35 S301 num 16 waiting [6] shards 
014'031 35 S201 num 16 sending shards [0 5] to group 100
014'031 35 S201 num 16 sending shards [6] to group 102
014'017 35 S200 current config num 15 done
014'031 35 S302 num 16 waiting [6] shards 
014'034 35 S300 num 16 handle num 16 move rpc [6]
014'022 34 S100 check new config wanted 17
014'035 35 S300 move handle num 16 shards [6] as leader?
014'035 35 S100 num 16 handle num 16 move rpc [0 5]
014'036 35 S100 move handle num 16 shards [0 5] as leader?
014'037 34 S102 check new config wanted 16
014'065 35 S202 current config num 15 done
014'065 35 S100 num 16 waiting [0 5] shards 
014'068 35 S201 num 16 sending shards [0 5] to group 100
014'068 35 S201 num 16 sending shards [6] to group 102
014'070 30 S300 apply index 53 key num 0 type 5   lastApplied 52
014'070 35 S300 apply num 16 migration [6]
014'070 30 S300 safely recv and decided shard 6
014'070 31 S300 used size: 521 / 300 
014'071 29 S300 do snapshot for raft 53 53,size 600
014'076 30 S102 apply index 165 key num 0 type 4   lastApplied 164
014'076 34 S102 apply new config num 16 :&{16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
014'076 34 S102 inited need send [],need recv [0 5]
014'076 31 S102 used size: 889 / 300 
014'076 29 S102 do snapshot for raft 165 165,size 579
014'078 27 S2 raft apply snapshot offset 165 ,lastApplied 165,total log 166, size 593,log cap:2
014'078 31 S102 after snap shot size593 579
014'080 35 S301 num 16 waiting [6] shards 
014'081 34 S202 check new config wanted 16
014'081 35 S102 num 16 waiting [0 5] shards 
014'081 35 S200 current config num 15 done
014'081 35 S302 num 16 waiting [6] shards 
014'081 35 S101 current config num 15 done
014'081 30 S101 apply index 165 key num 0 type 4   lastApplied 164
014'081 34 S101 apply new config num 16 :&{16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
014'082 34 S101 inited need send [],need recv [0 5]
014'082 31 S101 used size: 889 / 300 
014'084 29 S101 do snapshot for raft 165 165,size 579
014'084 27 S1 raft apply snapshot offset 165 ,lastApplied 165,total log 166, size 593,log cap:2
014'084 31 S101 after snap shot size593 579
014'084 27 S0 raft apply snapshot offset 53 ,lastApplied 53,total log 53, size 82,log cap:1
014'085 31 S300 after snap shot size82 600
014'085 35 S300 current config num 16 done
014'085 35 S300 num 16 handle num 16 move rpc [6]
014'085 35 S300 num 16 move [6] is done yet
014'088 30 S201 after send shards ok
014'088 35 S201 move delete propose num 16 shards [6] as leader?
014'089 32 S100 server killed######
014'089 32 S101 server killed######
014'089 32 S102 server killed######
014'089 35 S100 num 16 handle num 16 move rpc [0 5]
014'089 32 S200 server killed######
014'089 35 S100 move handle not leader
014'089 32 S201 server killed######
014'089 32 S202 server killed######
014'089 32 S300 server killed######
014'089 32 S301 server killed######
014'089 32 S302 server killed######
014'092 30 S100 install snap index 165,config {16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [true false false false false true false false false false]
014'095 30 S101 install snap index 165,config {16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [true false false false false true false false false false]
014'097 35 S100 num 16 waiting [0 5] shards 
014'097 35 S300 num 16 move [6] is done yet
014'098 34 S100 check new config wanted 17
014'098 30 S102 install snap index 165,config {16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [true false false false false true false false false false]
014'100 34 S101 check new config wanted 17
014'105 30 S200 install snap index 76,config {15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
014'107 35 S200 current config num 15 done
014'107 34 S200 check new config wanted 16
014'112 30 S201 install snap index 77,config {16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [true false false false false true true false false false]
014'115 34 S201 check new config wanted 17
014'115 35 S201 num 16 sending shards [0 5] to group 100
014'115 35 S201 num 16 sending shards [6] to group 102
014'123 30 S202 install snap index 76,config {15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
014'127 30 S300 install snap index 53,config {16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
014'129 30 S301 install snap index 52,config {16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false true false false false]
014'132 35 S100 num 16 handle num 16 move rpc [0 5]
014'132 35 S100 move handle not leader
014'134 35 S102 num 16 waiting [0 5] shards 
014'135 34 S102 check new config wanted 17
014'136 35 S101 num 16 waiting [0 5] shards 
014'127 35 S202 current config num 15 done
014'128 34 S300 check new config wanted 17
014'130 34 S301 check new config wanted 17
014'141 35 S300 current config num 16 done
014'141 35 S301 num 16 waiting [6] shards 
014'142 34 S202 check new config wanted 16
014'147 30 S302 install snap index 52,config {16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false true false false false]
014'147 35 S100 num 16 waiting [0 5] shards 
014'148 35 S302 num 16 waiting [6] shards 
014'148 34 S302 check new config wanted 17
014'149 35 S101 num 16 handle num 16 move rpc [0 5]
014'149 35 S101 move handle not leader
014'149 35 S201 num 16 sending shards [0 5] to group 100
014'156 35 S201 num 16 sending shards [6] to group 102
014'161 35 S101 num 16 handle num 16 move rpc [0 5]
014'162 35 S101 move handle not leader
014'165 35 S102 num 16 handle num 16 move rpc [0 5]
014'166 35 S102 move handle not leader
014'172 35 S102 num 16 handle num 16 move rpc [0 5]
014'172 35 S102 move handle not leader
014'173 35 S100 num 16 handle num 16 move rpc [0 5]
014'174 35 S100 move handle not leader
014'179 35 S300 num 16 handle num 16 move rpc [6]
014'179 35 S300 num 16 move [6] is done yet
014'185 35 S200 current config num 15 done
014'186 35 S102 num 16 waiting [0 5] shards 
014'194 35 S301 num 16 waiting [6] shards 
014'195 35 S201 num 16 sending shards [0 5] to group 100
014'195 35 S201 num 16 sending shards [6] to group 102
014'195 35 S300 current config num 16 done
014'197 30 S201 after send shards ok
014'197 35 S201 move delete propose not leader
014'198 35 S101 num 16 handle num 16 move rpc [0 5]
014'198 35 S101 move handle not leader
014'198 35 S202 current config num 15 done
014'198 35 S102 num 16 handle num 16 move rpc [0 5]
014'198 35 S101 num 16 waiting [0 5] shards 
014'198 35 S102 move handle not leader
014'199 35 S302 num 16 waiting [6] shards 
014'203 35 S102 num 16 handle num 16 move rpc [0 5]
014'205 35 S102 move handle not leader
014'198 35 S100 num 16 waiting [0 5] shards 
014'221 35 S302 num 16 handle num 16 move rpc [6]
014'221 35 S302 move handle not leader
014'223 35 S100 num 16 handle num 16 move rpc [0 5]
014'223 35 S100 move handle not leader
014'228 35 S301 num 16 handle num 16 move rpc [6]
014'228 35 S301 move handle not leader
014'228 35 S300 num 16 handle num 16 move rpc [6]
014'229 35 S300 num 16 move [6] is done yet
014'229 30 S201 after send shards ok
014'229 35 S201 move delete propose not leader
014'230 35 S101 num 16 handle num 16 move rpc [0 5]
014'230 35 S101 move handle not leader
014'232 35 S302 num 16 handle num 16 move rpc [6]
014'233 35 S302 move handle not leader
014'233 35 S102 num 16 handle num 16 move rpc [0 5]
014'234 35 S102 move handle not leader
014'239 35 S201 num 16 sending shards [0 5] to group 100
014'239 35 S201 num 16 sending shards [6] to group 102
014'241 35 S300 num 16 handle num 16 move rpc [6]
014'242 35 S300 num 16 move [6] is done yet
014'242 35 S100 num 16 handle num 16 move rpc [0 5]
014'242 35 S100 move handle not leader
014'243 30 S201 after send shards ok
014'243 35 S201 move delete propose not leader
014'245 35 S301 num 16 waiting [6] shards 
014'249 35 S202 current config num 15 done
014'249 35 S101 num 16 waiting [0 5] shards 
014'256 35 S100 num 16 waiting [0 5] shards 
014'257 35 S102 num 16 waiting [0 5] shards 
014'258 35 S200 current config num 15 done
014'267 35 S300 current config num 16 done
014'268 35 S302 num 16 waiting [6] shards 
014'269 35 S101 num 16 handle num 16 move rpc [0 5]
014'269 35 S101 move handle not leader
014'273 35 S102 num 16 handle num 16 move rpc [0 5]
014'273 35 S102 move handle not leader
014'278 35 S201 num 16 sending shards [0 5] to group 100
014'278 35 S201 num 16 sending shards [6] to group 102
014'291 30 S100 apply index 166 key num 0 type 5   lastApplied 165
014'292 35 S100 apply num 16 migration [0 5]
014'292 30 S100 safely recv and decided shard 0
014'292 30 S100 safely recv and decided shard 5
014'292 31 S100 used size: 596 / 300 
014'320 29 S100 do snapshot for raft 166 166,size 667
014'320 27 S0 raft apply snapshot offset 166 ,lastApplied 167,total log 167, size 89,log cap:2
014'321 27 S0 last applied not snapshoted raft.LogEntry{Term:8, Command:interface {}(nil)}
014'321 31 S100 after snap shot size89 667
014'321 30 S100 nop apply <nil>
014'328 35 S100 current config num 16 done
014'346 35 S101 num 16 waiting [0 5] shards 
014'328 35 S202 current config num 15 done
014'327 35 S200 current config num 15 done
014'363 35 S302 num 16 waiting [6] shards 
014'364 35 S100 num 16 handle num 16 move rpc [0 5]
014'364 35 S100 num 16 move [0 5] is done yet
014'367 35 S301 num 16 waiting [6] shards 
014'367 35 S102 num 16 waiting [0 5] shards 
014'328 35 S300 current config num 16 done
014'368 35 S201 num 16 sending shards [0 5] to group 100
014'368 35 S201 num 16 sending shards [6] to group 102
014'370 35 S300 num 16 handle num 16 move rpc [6]
014'370 35 S300 num 16 move [6] is done yet
014'373 35 S300 num 16 handle num 16 move rpc [6]
014'373 35 S300 num 16 move [6] is done yet
014'373 30 S201 after send shards ok
014'373 35 S201 move delete propose not leader
014'375 35 S100 num 16 handle num 16 move rpc [0 5]
014'375 35 S100 num 16 move [0 5] is done yet
014'375 30 S201 after send shards ok
014'375 35 S201 move delete propose not leader
014'376 30 S201 after send shards ok
014'376 35 S201 move delete propose not leader
014'389 30 S301 apply index 53 key num 0 type 5   lastApplied 52
014'389 35 S301 apply num 16 migration [6]
014'389 30 S301 safely recv and decided shard 6
014'389 31 S301 used size: 524 / 300 
014'390 35 S100 current config num 16 done
014'397 35 S101 num 16 waiting [0 5] shards 
014'401 29 S301 do snapshot for raft 53 53,size 600
014'402 27 S1 raft apply snapshot offset 53 ,lastApplied 54,total log 54, size 85,log cap:2
014'402 27 S1 last applied not snapshoted raft.LogEntry{Term:7, Command:interface {}(nil)}
014'402 31 S301 after snap shot size85 600
014'402 30 S301 nop apply <nil>
014'404 35 S201 num 16 sending shards [0 5] to group 100
014'404 35 S201 num 16 sending shards [6] to group 102
014'405 35 S202 current config num 15 done
014'415 35 S302 num 16 waiting [6] shards 
014'416 35 S100 num 16 handle num 16 move rpc [0 5]
014'416 35 S100 num 16 move [0 5] is done yet
014'417 30 S201 after send shards ok
014'417 35 S201 move delete propose not leader
014'417 35 S301 current config num 16 done
014'417 35 S102 num 16 waiting [0 5] shards 
014'418 35 S300 current config num 16 done
014'422 35 S200 current config num 15 done
014'433 30 S201 after send shards ok
014'433 35 S201 move delete propose not leader
014'436 35 S201 num 16 sending shards [0 5] to group 100
014'436 35 S201 num 16 sending shards [6] to group 102
014'438 35 S300 num 16 handle num 16 move rpc [6]
014'438 35 S300 num 16 move [6] is done yet
014'452 35 S100 num 16 handle num 16 move rpc [0 5]
014'453 35 S100 num 16 move [0 5] is done yet
014'454 30 S201 after send shards ok
014'455 35 S201 move delete propose num 16 shards [0 5] as leader?
014'470 35 S101 num 16 waiting [0 5] shards 
014'474 35 S300 current config num 16 done
014'478 30 S201 apply index 78 key num 0 type 5   lastApplied 77
014'478 35 S201 apply num 16 migration [6]
014'478 30 S201 safely delete shard 6
014'478 31 S201 used size: 700 / 300 
014'479 29 S201 do snapshot for raft 78 78,size 543
014'479 27 S1 raft apply snapshot offset 78 ,lastApplied 80,total log 80, size 594,log cap:3
014'479 27 S1 last applied not snapshoted raft.LogEntry{Term:10, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:16}, Num:0}}
014'480 31 S201 after snap shot size594 543
014'480 30 S201 nop apply <nil>
014'480 31 S201 used size: 594 / 300 
014'480 29 S201 do snapshot for raft 79 79,size 543
014'481 27 S1 raft apply snapshot offset 79 ,lastApplied 80,total log 80, size 591,log cap:2
014'481 27 S1 last applied not snapshoted raft.LogEntry{Term:10, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:16}, Num:0}}
014'481 31 S201 after snap shot size591 543
014'481 30 S201 apply index 80 key num 0 type 5   lastApplied 79
014'481 35 S201 apply num 16 migration [0 5]
014'481 30 S201 safely delete shard 0
014'481 30 S201 safely delete shard 5
014'481 31 S201 used size: 591 / 300 
014'482 29 S201 do snapshot for raft 80 80,size 455
014'482 27 S1 raft apply snapshot offset 80 ,lastApplied 80,total log 80, size 84,log cap:1
014'482 31 S201 after snap shot size84 455
014'485 30 S201 after send shards ok
014'486 35 S201 num 16 move [6] is done yet
014'487 35 S300 num 16 handle num 16 move rpc [6]
014'488 35 S300 num 16 move [6] is done yet
014'493 35 S302 num 16 waiting [6] shards 
014'493 35 S201 current config num 16 done
014'493 35 S102 num 16 waiting [0 5] shards 
014'493 35 S301 current config num 16 done
014'493 35 S100 current config num 16 done
014'493 30 S200 apply index 77 key num 0 type 4   lastApplied 76
014'493 34 S200 apply new config num 16 :&{16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
014'493 35 S202 current config num 15 done
014'493 34 S200 inited need send [0 5 6],need recv []
014'493 31 S200 used size: 996 / 300 
014'494 30 S202 apply index 77 key num 0 type 4   lastApplied 76
014'494 29 S200 do snapshot for raft 77 77,size 569
014'495 27 S0 raft apply snapshot offset 77 ,lastApplied 77,total log 80, size 700,log cap:4
014'495 31 S200 after snap shot size700 569
014'495 35 S200 num 16 sending shards [0 5] to group 100
014'496 35 S200 num 16 sending shards [6] to group 102
014'494 34 S202 apply new config num 16 :&{16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{15 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
014'496 34 S202 inited need send [0 5 6],need recv []
014'496 31 S202 used size: 996 / 300 
014'497 29 S202 do snapshot for raft 77 77,size 569
014'498 27 S2 raft apply snapshot offset 77 ,lastApplied 77,total log 80, size 700,log cap:4
014'498 31 S202 after snap shot size700 569
014'500 35 S300 num 16 handle num 16 move rpc [6]
014'500 35 S300 num 16 move [6] is done yet
014'501 35 S100 num 16 handle num 16 move rpc [0 5]
014'501 35 S100 num 16 move [0 5] is done yet
014'501 30 S200 after send shards ok
014'501 35 S200 move delete propose not leader
014'502 30 S200 after send shards ok
014'502 35 S200 move delete propose not leader
014'503 30 S201 after send shards ok
014'503 35 S201 num 16 move [6] is done yet
014'524 35 S300 current config num 16 done
014'528 35 S200 num 16 sending shards [0 5] to group 100
014'533 35 S200 num 16 sending shards [6] to group 102
014'546 35 S100 current config num 16 done
014'546 35 S202 num 16 sending shards [6] to group 102
014'549 35 S202 num 16 sending shards [0 5] to group 100
014'559 35 S101 num 16 waiting [0 5] shards 
014'560 35 S302 num 16 waiting [6] shards 
014'549 35 S201 current config num 16 done
014'560 35 S102 num 16 waiting [0 5] shards 
014'561 35 S100 num 16 handle num 16 move rpc [0 5]
014'561 35 S100 num 16 move [0 5] is done yet
014'562 35 S300 num 16 handle num 16 move rpc [6]
014'562 35 S300 num 16 move [6] is done yet
014'549 35 S301 current config num 16 done
014'572 30 S200 after send shards ok
014'572 35 S200 move delete propose not leader
014'573 30 S200 after send shards ok
014'573 35 S200 move delete propose not leader
014'575 35 S300 num 16 handle num 16 move rpc [6]
014'575 35 S300 num 16 move [6] is done yet
014'575 30 S202 after send shards ok
014'576 35 S202 move delete propose not leader
014'576 35 S300 current config num 16 done
014'577 35 S200 num 16 sending shards [0 5] to group 100
014'578 35 S200 num 16 sending shards [6] to group 102
014'596 35 S202 num 16 sending shards [0 5] to group 100
014'596 35 S202 num 16 sending shards [6] to group 102
014'599 35 S100 num 16 handle num 16 move rpc [0 5]
014'599 35 S100 num 16 move [0 5] is done yet
014'600 30 S202 after send shards ok
014'600 35 S202 move delete propose not leader
014'601 35 S300 num 16 handle num 16 move rpc [6]
014'601 35 S300 num 16 move [6] is done yet
014'601 30 S202 after send shards ok
014'601 35 S202 move delete propose not leader
014'604 35 S100 current config num 16 done
014'609 35 S300 num 16 handle num 16 move rpc [6]
014'609 35 S300 num 16 move [6] is done yet
014'610 35 S100 num 16 handle num 16 move rpc [0 5]
014'610 35 S100 num 16 move [0 5] is done yet
014'610 30 S200 after send shards ok
014'611 35 S200 move delete propose not leader
014'611 30 S102 apply index 166 key num 0 type 5   lastApplied 165
014'612 35 S102 apply num 16 migration [0 5]
014'612 30 S102 safely recv and decided shard 0
014'612 30 S102 safely recv and decided shard 5
014'612 31 S102 used size: 596 / 300 
014'612 29 S102 do snapshot for raft 166 166,size 667
014'613 27 S2 raft apply snapshot offset 166 ,lastApplied 167,total log 167, size 89,log cap:2
014'613 27 S2 last applied not snapshoted raft.LogEntry{Term:8, Command:interface {}(nil)}
014'613 31 S102 after snap shot size89 667
014'613 30 S102 nop apply <nil>
014'613 30 S200 after send shards ok
014'613 35 S200 move delete propose not leader
014'614 35 S101 num 16 waiting [0 5] shards 
014'614 35 S201 current config num 16 done
014'614 35 S102 current config num 16 done
014'615 35 S302 num 16 waiting [6] shards 
014'621 35 S100 num 16 handle num 16 move rpc [0 5]
014'621 35 S100 num 16 move [0 5] is done yet
014'622 30 S202 after send shards ok
014'622 35 S202 move delete propose not leader
014'622 35 S200 num 16 sending shards [0 5] to group 100
014'624 30 S101 apply index 166 key num 0 type 5   lastApplied 165
014'624 35 S101 apply num 16 migration [0 5]
014'624 30 S101 safely recv and decided shard 0
014'624 30 S101 safely recv and decided shard 5
014'624 31 S101 used size: 596 / 300 
014'624 29 S101 do snapshot for raft 166 166,size 667
014'625 27 S1 raft apply snapshot offset 166 ,lastApplied 167,total log 167, size 89,log cap:2
014'625 27 S1 last applied not snapshoted raft.LogEntry{Term:8, Command:interface {}(nil)}
014'625 31 S101 after snap shot size89 667
014'625 30 S101 nop apply <nil>
014'626 35 S301 current config num 16 done
014'628 35 S300 current config num 16 done
014'628 35 S202 num 16 sending shards [0 5] to group 100
014'629 35 S202 num 16 sending shards [6] to group 102
014'630 35 S100 num 16 handle num 16 move rpc [0 5]
014'630 35 S100 num 16 move [0 5] is done yet
014'631 35 S300 num 16 handle num 16 move rpc [6]
014'631 35 S300 num 16 move [6] is done yet
014'632 30 S202 after send shards ok
014'632 35 S202 move delete propose not leader
014'632 30 S202 after send shards ok
014'632 35 S202 move delete propose not leader
014'635 35 S100 num 16 handle num 16 move rpc [0 5]
014'635 35 S100 num 16 move [0 5] is done yet
014'636 35 S200 num 16 sending shards [6] to group 102
014'636 30 S200 after send shards ok
014'636 35 S200 move delete propose not leader
014'637 35 S300 num 16 handle num 16 move rpc [6]
014'637 35 S300 num 16 move [6] is done yet
014'638 30 S200 after send shards ok
014'638 35 S200 move delete propose not leader
014'664 35 S102 current config num 16 done
014'666 35 S200 num 16 sending shards [0 5] to group 100
014'666 35 S200 num 16 sending shards [6] to group 102
014'656 35 S100 current config num 16 done
014'676 35 S202 num 16 sending shards [0 5] to group 100
014'676 35 S202 num 16 sending shards [6] to group 102
014'677 35 S100 num 16 handle num 16 move rpc [0 5]
014'677 35 S100 num 16 move [0 5] is done yet
014'678 30 S300 nop apply <nil>
014'685 35 S300 num 16 handle num 16 move rpc [6]
014'685 35 S300 num 16 move [6] is done yet
014'686 30 S200 after send shards ok
014'686 35 S200 move delete propose not leader
014'687 30 S202 after send shards ok
014'687 35 S202 move delete propose not leader
014'688 35 S300 num 16 handle num 16 move rpc [6]
014'688 35 S300 num 16 move [6] is done yet
014'688 30 S202 after send shards ok
014'688 35 S202 move delete propose not leader
014'690 35 S301 current config num 16 done
014'690 35 S300 current config num 16 done
014'692 35 S100 num 16 handle num 16 move rpc [0 5]
014'692 35 S100 num 16 move [0 5] is done yet
014'667 35 S101 current config num 16 done
014'693 30 S200 after send shards ok
014'693 35 S200 move delete propose not leader
014'667 35 S201 current config num 16 done
014'694 35 S302 num 16 waiting [6] shards 
014'697 35 S200 num 16 sending shards [0 5] to group 100
014'697 35 S200 num 16 sending shards [6] to group 102
014'699 35 S100 num 16 handle num 16 move rpc [0 5]
014'699 35 S100 num 16 move [0 5] is done yet
014'699 35 S300 num 16 handle num 16 move rpc [6]
014'699 35 S300 num 16 move [6] is done yet
014'700 30 S200 after send shards ok
014'700 35 S200 move delete propose not leader
014'700 30 S200 after send shards ok
014'700 35 S200 move delete propose not leader
014'706 35 S202 num 16 sending shards [0 5] to group 100
014'706 35 S202 num 16 sending shards [6] to group 102
014'708 35 S300 num 16 handle num 16 move rpc [6]
014'708 35 S300 num 16 move [6] is done yet
014'710 30 S202 after send shards ok
014'711 35 S202 move delete propose not leader
014'711 30 S302 apply index 53 key num 0 type 5   lastApplied 52
014'711 35 S302 apply num 16 migration [6]
014'711 30 S302 safely recv and decided shard 6
014'711 31 S302 used size: 524 / 300 
014'711 35 S100 num 16 handle num 16 move rpc [0 5]
014'711 35 S100 num 16 move [0 5] is done yet
014'712 29 S302 do snapshot for raft 53 53,size 600
014'712 27 S2 raft apply snapshot offset 53 ,lastApplied 54,total log 54, size 85,log cap:2
014'712 27 S2 last applied not snapshoted raft.LogEntry{Term:7, Command:interface {}(nil)}
014'712 31 S302 after snap shot size85 600
014'712 30 S302 nop apply <nil>
014'712 30 S202 after send shards ok
014'713 35 S202 move delete propose not leader
014'715 35 S102 current config num 16 done
014'724 35 S100 current config num 16 done
014'728 35 S200 num 16 sending shards [0 5] to group 100
014'728 35 S200 num 16 sending shards [6] to group 102
014'730 35 S300 num 16 handle num 16 move rpc [6]
014'730 35 S300 num 16 move [6] is done yet
014'731 35 S100 num 16 handle num 16 move rpc [0 5]
014'731 35 S100 num 16 move [0 5] is done yet
014'731 30 S200 after send shards ok
014'731 35 S200 move delete propose not leader
014'732 30 S200 after send shards ok
014'732 35 S200 move delete propose not leader
014'755 35 S202 num 16 sending shards [0 5] to group 100
014'756 35 S202 num 16 sending shards [6] to group 102
014'758 35 S100 num 16 handle num 16 move rpc [0 5]
014'759 35 S100 num 16 move [0 5] is done yet
014'759 30 S202 after send shards ok
014'759 35 S202 move delete propose not leader
014'761 35 S301 current config num 16 done
014'761 35 S300 current config num 16 done
014'779 35 S200 num 16 sending shards [6] to group 102
014'779 35 S200 num 16 sending shards [0 5] to group 100
014'761 35 S101 current config num 16 done
014'782 35 S300 num 16 handle num 16 move rpc [6]
014'782 35 S300 num 16 move [6] is done yet
014'783 30 S202 after send shards ok
014'783 35 S202 move delete propose not leader
014'784 35 S300 num 16 handle num 16 move rpc [6]
014'784 35 S300 num 16 move [6] is done yet
014'761 35 S302 current config num 16 done
014'761 35 S201 current config num 16 done
014'785 30 S200 after send shards ok
014'785 35 S200 move delete propose not leader
014'765 35 S102 current config num 16 done
leave &{[101] 1074585914363486070 19}
014'777 35 S100 current config num 16 done
014'787 35 S100 num 16 handle num 16 move rpc [0 5]
014'787 35 S100 num 16 move [0 5] is done yet
014'788 30 S200 after send shards ok
014'788 35 S200 move delete propose not leader
014'793 30 S200 apply index 78 key num 0 type 5   lastApplied 77
014'793 35 S200 apply num 16 migration [6]
014'793 30 S200 safely delete shard 6
014'794 31 S200 used size: 700 / 300 
014'794 29 S200 do snapshot for raft 78 78,size 543
014'813 35 S301 current config num 16 done
014'813 35 S300 current config num 16 done
014'824 30 S202 apply index 78 key num 0 type 5   lastApplied 77
014'824 35 S202 apply num 16 migration [6]
014'824 30 S202 safely delete shard 6
014'824 31 S202 used size: 700 / 300 
014'825 29 S202 do snapshot for raft 78 78,size 543
014'826 27 S2 raft apply snapshot offset 78 ,lastApplied 80,total log 80, size 594,log cap:3
014'826 27 S2 last applied not snapshoted raft.LogEntry{Term:10, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:16}, Num:0}}
014'827 31 S202 after snap shot size594 543
014'827 30 S202 nop apply <nil>
014'827 31 S202 used size: 594 / 300 
014'828 27 S0 raft apply snapshot offset 78 ,lastApplied 80,total log 80, size 594,log cap:3
014'828 27 S0 last applied not snapshoted raft.LogEntry{Term:10, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:16}, Num:0}}
014'829 31 S200 after snap shot size594 543
014'829 30 S200 nop apply <nil>
014'829 31 S200 used size: 594 / 300 
014'829 29 S202 do snapshot for raft 79 79,size 543
014'830 27 S2 raft apply snapshot offset 79 ,lastApplied 80,total log 80, size 591,log cap:2
014'830 27 S2 last applied not snapshoted raft.LogEntry{Term:10, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:16}, Num:0}}
014'830 31 S202 after snap shot size591 543
014'830 30 S202 apply index 80 key num 0 type 5   lastApplied 79
014'830 35 S202 apply num 16 migration [0 5]
014'830 30 S202 safely delete shard 0
014'830 30 S202 safely delete shard 5
014'830 31 S202 used size: 591 / 300 
014'831 29 S202 do snapshot for raft 80 80,size 455
014'831 27 S2 raft apply snapshot offset 80 ,lastApplied 80,total log 80, size 84,log cap:1
014'831 31 S202 after snap shot size84 455
014'831 35 S202 current config num 16 done
014'832 35 S101 current config num 16 done
leave &{[101] 1074585914363486070 19}
014'853 35 S201 current config num 16 done
014'853 35 S302 current config num 16 done
014'857 29 S200 do snapshot for raft 79 79,size 543
014'859 27 S0 raft apply snapshot offset 79 ,lastApplied 80,total log 80, size 591,log cap:2
014'859 27 S0 last applied not snapshoted raft.LogEntry{Term:10, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:16}, Num:0}}
014'859 31 S200 after snap shot size591 543
014'859 30 S200 apply index 80 key num 0 type 5   lastApplied 79
014'859 35 S200 apply num 16 migration [0 5]
014'859 30 S200 safely delete shard 0
014'864 35 S100 current config num 16 done
014'864 35 S102 current config num 16 done
014'859 30 S200 safely delete shard 5
014'866 31 S200 used size: 591 / 300 
014'866 29 S200 do snapshot for raft 80 80,size 455
014'866 27 S0 raft apply snapshot offset 80 ,lastApplied 80,total log 80, size 84,log cap:1
014'866 31 S200 after snap shot size84 455
014'867 35 S200 current config num 16 done
014'867 35 S301 current config num 16 done
014'867 35 S300 current config num 16 done
014'884 35 S101 current config num 16 done
014'884 35 S202 current config num 16 done
014'903 35 S201 current config num 16 done
014'903 35 S302 current config num 16 done
014'916 35 S100 current config num 16 done
014'916 35 S102 current config num 16 done
014'919 35 S300 current config num 16 done
014'919 35 S200 current config num 16 done
014'919 35 S301 current config num 16 done
014'940 35 S101 current config num 16 done
014'940 35 S202 current config num 16 done
014'957 35 S302 current config num 16 done
014'957 35 S201 current config num 16 done
014'968 35 S100 current config num 16 done
014'968 35 S102 current config num 16 done
014'969 35 S301 current config num 16 done
014'970 35 S300 current config num 16 done
014'970 35 S200 current config num 16 done
014'990 35 S101 current config num 16 done
014'991 35 S202 current config num 16 done
015'008 35 S302 current config num 16 done
015'008 35 S201 current config num 16 done
015'018 35 S100 current config num 16 done
015'018 35 S102 current config num 16 done
015'019 35 S301 current config num 16 done
015'020 35 S200 current config num 16 done
015'020 35 S300 current config num 16 done
015'043 35 S101 current config num 16 done
015'043 35 S202 current config num 16 done
015'058 35 S302 current config num 16 done
015'058 35 S201 current config num 16 done
015'068 35 S100 current config num 16 done
015'069 35 S102 current config num 16 done
015'070 35 S301 current config num 16 done
015'070 35 S200 current config num 16 done
015'071 35 S300 current config num 16 done
015'100 35 S202 current config num 16 done
015'100 35 S101 current config num 16 done
015'117 35 S302 current config num 16 done
015'118 35 S201 current config num 16 done
015'120 34 S202 got new config {16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 15
015'126 35 S100 current config num 16 done
015'131 35 S102 current config num 16 done
015'141 34 S201 got new config {17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 16
015'142 34 S201 propose new config 17
015'159 35 S202 current config num 16 done
015'159 35 S101 current config num 16 done
015'142 35 S301 current config num 16 done
015'142 35 S200 current config num 16 done
015'142 35 S300 current config num 16 done
015'170 35 S302 current config num 16 done
015'171 35 S201 current config num 16 done
015'180 30 S201 apply index 81 key num 0 type 4   lastApplied 80
015'180 34 S201 apply new config num 17 :&{17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
015'181 34 S201 inited need send [],need recv []
015'181 31 S201 used size: 418 / 300 
015'181 29 S201 do snapshot for raft 81 81,size 413
015'181 27 S1 raft apply snapshot offset 81 ,lastApplied 81,total log 81, size 84,log cap:1
015'182 31 S201 after snap shot size84 413
015'182 35 S102 current config num 16 done
015'182 35 S100 current config num 16 done
015'193 34 S301 got new config {17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 16
015'193 28 S100 do request args:Key 9 type 3 num 19 Client 3620950086299709532 Seq 15 
015'193 28 S100 [532--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
015'194 34 S301 propose new config 17
015'196 28 S300 do request args:Key 3 type 3 num 19 Client 2238025532150463055 Seq 8 
015'196 28 S300 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
015'198 28 S200 do request args:Key 7 type 3 num 19 Client 2972145661651991667 Seq 11 
015'198 28 S200 [667--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
015'201 28 S200 do request args:Key 8 type 3 num 19 Client 2953714763196401582 Seq 2 
015'201 28 S200 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
015'211 35 S300 current config num 16 done
015'217 35 S202 current config num 16 done
015'217 35 S301 current config num 16 done
015'217 35 S200 current config num 16 done
015'217 35 S101 current config num 16 done
leave &{[101] 1074585914363486070 19}
015'220 30 S301 apply index 55 key num 0 type 4   lastApplied 54
015'220 34 S301 apply new config num 17 :&{17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
015'220 34 S301 inited need send [1 2 3 4 6],need recv []
015'220 31 S301 used size: 419 / 300 
015'221 35 S302 current config num 16 done
015'221 34 S202 check new config wanted 17
015'221 35 S201 current config num 17 done
015'240 35 S100 current config num 16 done
015'241 35 S102 current config num 16 done
015'242 34 S201 check new config wanted 18
015'244 28 S200 do request args:Key 2 type 3 num 19 Client 1679014388048817729 Seq 27 
015'244 28 S200 [729--27] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
015'240 28 S300 do request args:Key 4 type 3 num 19 Client 132246879705026825 Seq 6 
015'252 28 S300 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
015'252 28 S300 do request args:Key 5 type 3 num 19 Client 3482757038087095369 Seq 5 
015'253 28 S300 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
015'257 29 S301 do snapshot for raft 55 55,size 558
015'257 27 S1 raft apply snapshot offset 55 ,lastApplied 55,total log 55, size 82,log cap:1
015'257 31 S301 after snap shot size82 558
015'265 35 S300 current config num 16 done
015'268 35 S101 current config num 16 done
015'268 35 S202 current config num 16 done
015'268 35 S200 current config num 16 done
015'269 35 S301 num 17 sending shards [1 2 3 4 6] to group 100
015'271 34 S300 got new config {17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 16
015'273 30 S300 apply index 55 key num 0 type 4   lastApplied 54
015'273 34 S300 apply new config num 17 :&{17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
015'273 34 S300 inited need send [1 2 3 4 6],need recv []
015'273 31 S300 used size: 419 / 300 
015'274 29 S300 do snapshot for raft 55 55,size 558
015'274 27 S0 raft apply snapshot offset 55 ,lastApplied 55,total log 55, size 82,log cap:1
015'274 31 S300 after snap shot size82 558
015'277 35 S100 num 16 handle num 17 move rpc [1 2 3 4 6]
015'278 28 S300 do request args:Key 6 type 3 num 19 Client 542732653461723544 Seq 4 
015'278 28 S300 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
015'279 30 S302 apply index 55 key num 0 type 4   lastApplied 54
015'279 34 S302 apply new config num 17 :&{17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
015'279 34 S302 inited need send [1 2 3 4 6],need recv []
015'279 31 S302 used size: 419 / 300 
015'280 29 S302 do snapshot for raft 55 55,size 558
015'281 34 S102 got new config {17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 16
015'283 35 S101 num 16 handle num 17 move rpc [1 2 3 4 6]
015'286 35 S102 num 16 handle num 17 move rpc [1 2 3 4 6]
015'288 28 S100 do request args:Key 0 type 3 num 19 Client 940626237948413081 Seq 10 
015'288 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
015'290 34 S101 got new config {17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 16
015'291 34 S200 got new config {16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 15
015'292 34 S302 got new config {17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 16
015'293 34 S100 got new config {17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 16
015'294 34 S100 propose new config 17
015'294 35 S201 current config num 17 done
015'295 35 S102 current config num 16 done
015'300 34 S301 check new config wanted 18
015'303 27 S2 raft apply snapshot offset 55 ,lastApplied 55,total log 55, size 82,log cap:1
015'303 31 S302 after snap shot size82 558
015'304 35 S302 num 17 sending shards [1 2 3 4 6] to group 100
015'306 35 S100 num 16 handle num 17 move rpc [1 2 3 4 6]
015'308 35 S101 num 16 handle num 17 move rpc [1 2 3 4 6]
015'310 35 S102 num 16 handle num 17 move rpc [1 2 3 4 6]
015'314 35 S100 current config num 16 done
015'314 35 S301 num 17 sending shards [1 2 3 4 6] to group 100
015'316 35 S300 num 17 sending shards [1 2 3 4 6] to group 100
015'335 35 S100 num 16 handle num 17 move rpc [1 2 3 4 6]
015'346 35 S302 num 17 sending shards [1 2 3 4 6] to group 100
015'355 35 S200 current config num 16 done
015'357 35 S301 num 17 sending shards [1 2 3 4 6] to group 100
015'355 35 S202 current config num 16 done
015'355 35 S101 current config num 16 done
015'376 35 S302 num 17 sending shards [1 2 3 4 6] to group 100
015'380 35 S300 num 17 sending shards [1 2 3 4 6] to group 100
015'380 34 S300 check new config wanted 18
015'357 35 S201 current config num 17 done
015'357 35 S102 current config num 16 done
015'364 35 S100 current config num 16 done
015'382 35 S100 num 16 handle num 17 move rpc [1 2 3 4 6]
015'383 30 S100 apply index 168 key num 0 type 4   lastApplied 167
015'383 34 S100 apply new config num 17 :&{17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
015'383 34 S100 inited need send [],need recv [1 2 3 4 6]
015'383 31 S100 used size: 423 / 300 
015'384 29 S100 do snapshot for raft 168 168,size 625
015'384 27 S0 raft apply snapshot offset 168 ,lastApplied 168,total log 168, size 86,log cap:1
015'384 31 S100 after snap shot size86 625
015'384 35 S100 num 17 handle num 17 move rpc [1 2 3 4 6]
015'385 35 S101 num 16 handle num 17 move rpc [1 2 3 4 6]
015'385 35 S100 move handle num 17 shards [1 2 3 4 6] as leader?
015'385 35 S100 num 17 handle num 17 move rpc [1 2 3 4 6]
015'386 35 S100 move handle num 17 shards [1 2 3 4 6] as leader?
015'387 30 S202 apply index 81 key num 0 type 4   lastApplied 80
015'387 34 S202 apply new config num 17 :&{17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
015'387 34 S202 inited need send [],need recv []
015'387 31 S202 used size: 418 / 300 
015'388 29 S202 do snapshot for raft 81 81,size 413
015'388 27 S2 raft apply snapshot offset 81 ,lastApplied 81,total log 81, size 84,log cap:1
015'388 31 S202 after snap shot size84 413
015'388 35 S101 num 16 handle num 17 move rpc [1 2 3 4 6]
015'390 28 S100 do request args:Key 1 type 3 num 19 Client 418781717203629479 Seq 23 
015'390 28 S100 [479--23] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
015'393 34 S102 check new config wanted 17
015'394 34 S101 check new config wanted 17
015'394 34 S200 check new config wanted 17
015'393 35 S100 num 17 handle num 17 move rpc [1 2 3 4 6]
015'404 35 S102 num 16 handle num 17 move rpc [1 2 3 4 6]
015'404 35 S100 move handle num 17 shards [1 2 3 4 6] as leader?
015'404 34 S100 check new config wanted 18
015'404 35 S100 num 17 handle num 17 move rpc [1 2 3 4 6]
015'414 35 S100 move handle num 17 shards [1 2 3 4 6] as leader?
015'418 30 S101 apply index 168 key num 0 type 4   lastApplied 167
015'418 34 S101 apply new config num 17 :&{17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
015'419 34 S101 inited need send [],need recv [1 2 3 4 6]
015'419 31 S101 used size: 1201 / 300 
015'419 29 S101 do snapshot for raft 168 168,size 625
015'420 27 S1 raft apply snapshot offset 168 ,lastApplied 168,total log 170, size 944,log cap:3
015'420 31 S101 after snap shot size944 625
015'428 30 S100 apply index 169 key num 0 type 5   lastApplied 168
015'428 35 S100 apply num 17 migration [1 2 3 4 6]
015'428 30 S100 safely recv and decided shard 1
015'428 30 S100 safely recv and decided shard 2
015'428 30 S100 safely recv and decided shard 3
015'428 30 S100 safely recv and decided shard 4
015'428 30 S100 safely recv and decided shard 6
015'428 31 S100 used size: 1468 / 300 
015'429 35 S102 num 16 handle num 17 move rpc [1 2 3 4 6]
015'429 29 S100 do snapshot for raft 169 169,size 770
015'429 30 S102 apply index 168 key num 0 type 4   lastApplied 167
015'429 34 S102 apply new config num 17 :&{17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
015'430 34 S102 inited need send [],need recv [1 2 3 4 6]
015'430 31 S102 used size: 1201 / 300 
015'430 29 S102 do snapshot for raft 168 168,size 625
015'431 27 S2 raft apply snapshot offset 168 ,lastApplied 168,total log 170, size 944,log cap:3
015'431 31 S102 after snap shot size944 625
015'432 30 S200 apply index 81 key num 0 type 4   lastApplied 80
015'432 34 S200 apply new config num 17 :&{17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{16 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
015'432 34 S200 inited need send [],need recv []
015'432 31 S200 used size: 418 / 300 
015'433 29 S200 do snapshot for raft 81 81,size 413
015'433 27 S0 raft apply snapshot offset 81 ,lastApplied 81,total log 81, size 84,log cap:1
015'433 31 S200 after snap shot size84 413
015'433 35 S301 num 17 sending shards [1 2 3 4 6] to group 100
015'428 35 S101 num 17 waiting [1 2 3 4 6] shards 
015'446 27 S0 raft apply snapshot offset 169 ,lastApplied 170,total log 172, size 1206,log cap:4
015'446 27 S0 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:17}, Num:0}}
015'447 31 S100 after snap shot size1206 770
015'447 30 S100 apply index 170 key num 0 type 5   lastApplied 169
015'447 35 S100 apply num 17 migration [1 2 3 4 6]
015'447 31 S100 used size: 1206 / 300 
015'448 29 S100 do snapshot for raft 170 170,size 770
015'447 35 S200 current config num 17 done
015'453 30 S101 apply index 169 key num 0 type 5   lastApplied 168
015'455 35 S101 apply num 17 migration [1 2 3 4 6]
015'455 30 S101 safely recv and decided shard 1
015'455 30 S101 safely recv and decided shard 2
015'455 30 S101 safely recv and decided shard 3
015'455 30 S101 safely recv and decided shard 4
015'455 30 S101 safely recv and decided shard 6
015'455 31 S101 used size: 1468 / 300 
015'456 29 S101 do snapshot for raft 169 169,size 770
015'457 27 S1 raft apply snapshot offset 169 ,lastApplied 170,total log 172, size 1206,log cap:4
015'457 27 S1 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:17}, Num:0}}
015'457 31 S101 after snap shot size1206 770
015'457 30 S101 apply index 170 key num 0 type 5   lastApplied 169
015'457 35 S101 apply num 17 migration [1 2 3 4 6]
015'457 31 S101 used size: 1206 / 300 
015'458 29 S101 do snapshot for raft 170 170,size 770
015'459 27 S1 raft apply snapshot offset 170 ,lastApplied 170,total log 172, size 944,log cap:3
015'459 31 S101 after snap shot size944 770
015'460 27 S0 raft apply snapshot offset 170 ,lastApplied 170,total log 172, size 944,log cap:3
015'460 31 S100 after snap shot size944 770
015'460 35 S100 num 17 move [1 2 3 4 6] is done yet
015'447 34 S302 check new config wanted 18
015'461 35 S302 num 17 sending shards [1 2 3 4 6] to group 100
015'461 35 S300 num 17 sending shards [1 2 3 4 6] to group 100
015'447 35 S201 current config num 17 done
015'447 35 S202 current config num 17 done
015'462 35 S102 num 17 waiting [1 2 3 4 6] shards 
015'462 35 S100 num 17 move [1 2 3 4 6] is done yet
015'464 35 S100 num 17 handle num 17 move rpc [1 2 3 4 6]
015'464 35 S100 num 17 move [1 2 3 4 6] is done yet
015'464 35 S100 current config num 17 done
015'465 35 S301 num 17 sending shards [1 2 3 4 6] to group 100
015'471 35 S100 num 17 handle num 17 move rpc [1 2 3 4 6]
015'471 35 S100 num 17 move [1 2 3 4 6] is done yet
015'482 35 S100 num 17 handle num 17 move rpc [1 2 3 4 6]
015'482 35 S100 num 17 move [1 2 3 4 6] is done yet
015'483 30 S302 after send shards ok
015'483 35 S302 move delete propose not leader
015'483 30 S300 after send shards ok
015'483 35 S300 move delete propose not leader
015'491 35 S302 num 17 sending shards [1 2 3 4 6] to group 100
015'491 30 S102 apply index 169 key num 0 type 5   lastApplied 168
015'491 35 S102 apply num 17 migration [1 2 3 4 6]
015'491 30 S102 safely recv and decided shard 1
015'491 30 S102 safely recv and decided shard 2
015'491 30 S102 safely recv and decided shard 3
015'491 30 S102 safely recv and decided shard 4
015'491 30 S102 safely recv and decided shard 6
015'491 31 S102 used size: 1468 / 300 
015'492 29 S102 do snapshot for raft 169 169,size 770
015'495 30 S300 after send shards ok
015'495 35 S300 move delete propose not leader
015'497 27 S2 raft apply snapshot offset 169 ,lastApplied 170,total log 172, size 1206,log cap:4
015'497 27 S2 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:17}, Num:0}}
015'498 31 S102 after snap shot size1206 770
015'498 30 S102 apply index 170 key num 0 type 5   lastApplied 169
015'498 35 S102 apply num 17 migration [1 2 3 4 6]
015'498 31 S102 used size: 1206 / 300 
015'499 29 S102 do snapshot for raft 170 170,size 770
015'499 27 S2 raft apply snapshot offset 170 ,lastApplied 170,total log 172, size 944,log cap:3
015'500 31 S102 after snap shot size944 770
015'500 35 S300 num 17 sending shards [1 2 3 4 6] to group 100
015'505 30 S301 after send shards ok
015'505 35 S301 move delete propose num 17 shards [1 2 3 4 6] as leader?
015'506 35 S100 num 17 move [1 2 3 4 6] is done yet
015'509 35 S301 num 17 sending shards [1 2 3 4 6] to group 100
015'510 30 S100 apply index 171 key num 0 type 5   lastApplied 170
015'510 35 S100 apply num 17 migration [1 2 3 4 6]
015'510 31 S100 used size: 944 / 300 
015'510 29 S100 do snapshot for raft 171 171,size 770
015'511 27 S0 raft apply snapshot offset 171 ,lastApplied 172,total log 172, size 682,log cap:2
015'511 27 S0 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:17}, Num:0}}
015'511 31 S100 after snap shot size682 770
015'511 30 S100 apply index 172 key num 0 type 5   lastApplied 171
015'511 35 S100 apply num 17 migration [1 2 3 4 6]
015'511 31 S100 used size: 682 / 300 
015'512 35 S101 current config num 17 done
015'522 29 S100 do snapshot for raft 172 172,size 770
015'523 27 S0 raft apply snapshot offset 172 ,lastApplied 172,total log 172, size 86,log cap:1
015'523 31 S100 after snap shot size86 770
015'523 35 S100 num 17 handle num 17 move rpc [1 2 3 4 6]
015'523 35 S100 num 17 move [1 2 3 4 6] is done yet
015'524 30 S302 after send shards ok
015'524 35 S302 move delete propose not leader
015'523 35 S100 num 17 handle num 17 move rpc [1 2 3 4 6]
015'525 35 S202 current config num 17 done
015'525 35 S200 current config num 17 done
015'527 35 S201 current config num 17 done
015'527 35 S102 current config num 17 done
015'525 35 S100 num 17 move [1 2 3 4 6] is done yet
015'527 35 S100 num 17 handle num 17 move rpc [1 2 3 4 6]
015'527 35 S100 num 17 move [1 2 3 4 6] is done yet
015'527 35 S100 current config num 17 done
015'533 30 S301 after send shards ok
015'534 35 S301 move delete propose num 17 shards [1 2 3 4 6] as leader?
015'553 35 S302 num 17 sending shards [1 2 3 4 6] to group 100
015'558 30 S302 after send shards ok
015'558 35 S302 move delete propose not leader
015'561 35 S100 num 17 move [1 2 3 4 6] is done yet
015'561 35 S300 num 17 sending shards [1 2 3 4 6] to group 100
015'561 35 S100 num 17 handle num 17 move rpc [1 2 3 4 6]
015'562 35 S100 num 17 move [1 2 3 4 6] is done yet
015'562 35 S100 num 17 handle num 17 move rpc [1 2 3 4 6]
015'562 35 S100 num 17 move [1 2 3 4 6] is done yet
015'563 35 S101 current config num 17 done
015'562 30 S300 after send shards ok
015'564 35 S300 move delete propose not leader
015'564 30 S300 after send shards ok
015'564 35 S300 move delete propose not leader
015'564 35 S301 num 17 sending shards [1 2 3 4 6] to group 100
015'564 30 S301 after send shards ok
015'570 30 S302 after send shards ok
015'570 35 S302 move delete propose not leader
015'571 35 S100 num 17 handle num 17 move rpc [1 2 3 4 6]
015'571 35 S100 num 17 move [1 2 3 4 6] is done yet
015'572 30 S300 after send shards ok
015'577 35 S300 move delete propose not leader
015'576 44 S0 ctrler change to config &{20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
015'576 35 S202 current config num 17 done
015'577 35 S200 current config num 17 done
015'577 35 S201 current config num 17 done
015'577 35 S102 current config num 17 done
015'577 35 S100 current config num 17 done
015'580 35 S301 move delete propose num 17 shards [1 2 3 4 6] as leader?
015'580 35 S100 num 17 handle num 17 move rpc [1 2 3 4 6]
015'581 35 S100 num 17 move [1 2 3 4 6] is done yet
015'582 30 S301 after send shards ok
015'583 35 S301 move delete propose num 17 shards [1 2 3 4 6] as leader?
015'586 30 S301 after send shards ok
015'588 35 S301 move delete propose num 17 shards [1 2 3 4 6] as leader?
015'588 30 S301 apply index 56 key num 0 type 5   lastApplied 55
015'588 35 S301 apply num 17 migration [1 2 3 4 6]
015'588 30 S301 safely delete shard 1
015'588 30 S301 safely delete shard 2
015'588 30 S301 safely delete shard 3
015'588 30 S301 safely delete shard 4
015'588 30 S301 safely delete shard 6
015'588 31 S301 used size: 1726 / 300 
015'589 29 S301 do snapshot for raft 56 56,size 412
015'592 35 S300 num 17 sending shards [1 2 3 4 6] to group 100
015'594 35 S100 num 17 handle num 17 move rpc [1 2 3 4 6]
015'594 35 S100 num 17 move [1 2 3 4 6] is done yet
015'594 30 S300 after send shards ok
015'594 35 S300 move delete propose not leader
015'595 27 S1 raft apply snapshot offset 56 ,lastApplied 57,total log 60, size 1464,log cap:5
015'595 27 S1 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:17}, Num:0}}
015'596 31 S301 after snap shot size1464 412
015'596 30 S301 apply index 57 key num 0 type 5   lastApplied 56
015'596 35 S301 apply num 17 migration [1 2 3 4 6]
015'596 31 S301 used size: 1464 / 300 
015'597 29 S301 do snapshot for raft 57 57,size 412
015'598 27 S1 raft apply snapshot offset 57 ,lastApplied 57,total log 60, size 1202,log cap:4
015'598 31 S301 after snap shot size1202 412
015'601 35 S301 current config num 17 done
015'601 35 S302 num 17 sending shards [1 2 3 4 6] to group 100
015'603 35 S100 num 17 handle num 17 move rpc [1 2 3 4 6]
015'603 35 S100 num 17 move [1 2 3 4 6] is done yet
015'604 30 S302 after send shards ok
015'604 35 S302 move delete propose not leader
015'604 30 S301 apply index 58 key num 0 type 5   lastApplied 57
015'604 35 S301 apply num 17 migration [1 2 3 4 6]
015'604 31 S301 used size: 1202 / 300 
015'604 29 S301 do snapshot for raft 58 58,size 412
015'625 35 S101 current config num 17 done
015'629 27 S1 raft apply snapshot offset 58 ,lastApplied 58,total log 60, size 940,log cap:3
015'630 31 S301 after snap shot size940 412
015'633 35 S302 num 17 sending shards [1 2 3 4 6] to group 100
015'636 30 S302 apply index 56 key num 0 type 5   lastApplied 55
015'636 35 S302 apply num 17 migration [1 2 3 4 6]
015'636 30 S302 safely delete shard 1
015'636 30 S302 safely delete shard 2
015'636 30 S302 safely delete shard 3
015'637 30 S302 safely delete shard 4
015'637 30 S302 safely delete shard 6
015'637 31 S302 used size: 1726 / 300 
015'637 29 S302 do snapshot for raft 56 56,size 412
015'638 27 S2 raft apply snapshot offset 56 ,lastApplied 58,total log 60, size 1464,log cap:5
015'638 27 S2 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:17}, Num:0}}
015'639 31 S302 after snap shot size1464 412
015'640 30 S302 apply index 57 key num 0 type 5   lastApplied 56
015'640 35 S302 apply num 17 migration [1 2 3 4 6]
015'640 31 S302 used size: 1464 / 300 
015'641 29 S302 do snapshot for raft 57 57,size 412
015'642 27 S2 raft apply snapshot offset 57 ,lastApplied 58,total log 60, size 1202,log cap:4
015'642 27 S2 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:17}, Num:0}}
015'642 31 S302 after snap shot size1202 412
015'642 30 S302 apply index 58 key num 0 type 5   lastApplied 57
015'642 35 S302 apply num 17 migration [1 2 3 4 6]
015'642 31 S302 used size: 1202 / 300 
015'644 29 S302 do snapshot for raft 58 58,size 412
015'645 27 S2 raft apply snapshot offset 58 ,lastApplied 58,total log 60, size 940,log cap:3
015'645 31 S302 after snap shot size940 412
015'648 30 S301 apply index 59 key num 0 type 5   lastApplied 58
015'648 35 S301 apply num 17 migration [1 2 3 4 6]
015'648 31 S301 used size: 940 / 300 
015'649 29 S301 do snapshot for raft 59 59,size 412
015'650 27 S1 raft apply snapshot offset 59 ,lastApplied 60,total log 60, size 678,log cap:2
015'651 27 S1 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:17}, Num:0}}
015'651 31 S301 after snap shot size678 412
015'651 30 S301 apply index 60 key num 0 type 5   lastApplied 59
015'651 35 S301 apply num 17 migration [1 2 3 4 6]
015'651 31 S301 used size: 678 / 300 
015'651 29 S301 do snapshot for raft 60 60,size 412
015'652 27 S1 raft apply snapshot offset 60 ,lastApplied 60,total log 60, size 82,log cap:1
015'652 31 S301 after snap shot size82 412
015'677 35 S300 num 17 sending shards [1 2 3 4 6] to group 100
015'681 29 S300 recv Installsnapshot 57 55
015'682 30 S300 apply index 56 key num 0 type 5   lastApplied 55
015'682 35 S300 apply num 17 migration [1 2 3 4 6]
015'682 30 S300 safely delete shard 1
015'682 30 S300 safely delete shard 2
015'682 30 S300 safely delete shard 3
015'682 30 S300 safely delete shard 4
015'682 30 S300 safely delete shard 6
015'682 31 S300 used size: 1726 / 300 
015'682 29 S300 do snapshot for raft 56 56,size 412
015'684 27 S0 raft apply snapshot offset 56 ,lastApplied 58,total log 60, size 1464,log cap:5
015'684 27 S0 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:17}, Num:0}}
015'684 31 S300 after snap shot size1464 412
015'684 30 S300 apply index 57 key num 0 type 5   lastApplied 56
015'684 35 S300 apply num 17 migration [1 2 3 4 6]
015'684 31 S300 used size: 1464 / 300 
015'685 29 S300 do snapshot for raft 57 57,size 412
015'686 27 S0 raft apply snapshot offset 57 ,lastApplied 58,total log 60, size 1202,log cap:4
015'686 27 S0 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:17}, Num:0}}
015'686 31 S300 after snap shot size1202 412
015'687 30 S300 apply index 58 key num 0 type 5   lastApplied 57
015'687 35 S300 apply num 17 migration [1 2 3 4 6]
015'687 31 S300 used size: 1202 / 300 
015'695 35 S301 current config num 17 done
015'713 44 S2 ctrler change to config &{20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
015'714 34 S201 got new config {18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 17
015'627 35 S202 current config num 17 done
015'627 35 S200 current config num 17 done
015'627 35 S201 current config num 17 done
015'627 35 S102 current config num 17 done
015'628 35 S100 current config num 17 done
015'736 35 S100 num 17 handle num 17 move rpc [1 2 3 4 6]
015'736 35 S100 num 17 move [1 2 3 4 6] is done yet
015'736 35 S100 num 17 handle num 17 move rpc [1 2 3 4 6]
015'737 35 S100 num 17 move [1 2 3 4 6] is done yet
015'739 35 S302 current config num 17 done
015'739 29 S300 do snapshot for raft 58 58,size 412
015'758 34 S202 got new config {17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 16
015'760 27 S0 raft apply snapshot offset 58 ,lastApplied 58,total log 60, size 940,log cap:3
015'760 31 S300 after snap shot size940 412
015'761 35 S300 current config num 17 done
015'761 30 S300 after send shards ok
015'761 35 S300 num 17 move [1 2 3 4 6] is done yet
015'762 34 S201 propose new config 18
leave &{[101] 1074585914363486070 19}
leave &{[102] 1074585914363486070 20}
015'740 35 S101 current config num 17 done
015'780 44 S1 ctrler change to config &{20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
015'782 30 S302 after send shards ok
015'782 35 S302 num 17 move [1 2 3 4 6] is done yet
015'757 35 S301 current config num 17 done
015'764 35 S200 current config num 17 done
015'764 35 S202 current config num 17 done
015'766 35 S102 current config num 17 done
015'766 35 S201 current config num 17 done
015'798 35 S100 current config num 17 done
015'800 30 S101 apply index 171 key num 0 type 5   lastApplied 170
015'800 35 S101 apply num 17 migration [1 2 3 4 6]
015'800 31 S101 used size: 944 / 300 
015'801 29 S101 do snapshot for raft 171 171,size 770
015'802 27 S1 raft apply snapshot offset 171 ,lastApplied 172,total log 172, size 682,log cap:2
015'802 27 S1 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:17}, Num:0}}
015'802 31 S101 after snap shot size682 770
015'802 30 S101 apply index 172 key num 0 type 5   lastApplied 171
015'802 35 S101 apply num 17 migration [1 2 3 4 6]
015'802 31 S101 used size: 682 / 300 
015'803 29 S101 do snapshot for raft 172 172,size 770
015'803 27 S1 raft apply snapshot offset 172 ,lastApplied 172,total log 172, size 86,log cap:1
015'803 31 S101 after snap shot size86 770
015'804 35 S302 current config num 17 done
015'806 30 S102 apply index 171 key num 0 type 5   lastApplied 170
015'806 35 S102 apply num 17 migration [1 2 3 4 6]
015'806 31 S102 used size: 944 / 300 
leave &{[102] 1074585914363486070 20}
015'806 29 S102 do snapshot for raft 171 171,size 770
015'807 27 S2 raft apply snapshot offset 171 ,lastApplied 172,total log 172, size 682,log cap:2
015'807 27 S2 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:17}, Num:0}}
015'808 31 S102 after snap shot size682 770
015'808 30 S102 apply index 172 key num 0 type 5   lastApplied 171
015'808 35 S102 apply num 17 migration [1 2 3 4 6]
015'808 31 S102 used size: 682 / 300 
015'808 29 S102 do snapshot for raft 172 172,size 770
015'809 27 S2 raft apply snapshot offset 172 ,lastApplied 172,total log 172, size 86,log cap:1
015'809 31 S102 after snap shot size86 770
015'810 30 S201 apply index 82 key num 0 type 4   lastApplied 81
015'810 34 S201 apply new config num 18 :&{18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
015'810 34 S201 inited need send [],need recv []
015'810 31 S201 used size: 461 / 300 
015'811 29 S201 do snapshot for raft 82 82,size 455
015'811 35 S300 current config num 17 done
015'812 27 S1 raft apply snapshot offset 82 ,lastApplied 82,total log 82, size 84,log cap:1
015'812 31 S201 after snap shot size84 455
015'834 35 S301 current config num 17 done
015'840 35 S101 current config num 17 done
015'841 35 S200 current config num 17 done
015'841 35 S102 current config num 17 done
015'841 35 S201 current config num 18 done
015'841 35 S202 current config num 17 done
015'849 35 S100 current config num 17 done
015'869 34 S202 check new config wanted 18
015'873 35 S300 current config num 17 done
015'874 34 S201 check new config wanted 19
015'875 35 S302 current config num 17 done
015'898 35 S301 current config num 17 done
015'902 35 S201 current config num 18 done
015'909 30 S302 apply index 59 key num 0 type 5   lastApplied 58
015'915 35 S302 apply num 17 migration [1 2 3 4 6]
015'915 31 S302 used size: 940 / 300 
015'916 29 S302 do snapshot for raft 59 59,size 412
015'916 35 S100 current config num 17 done
015'930 27 S2 raft apply snapshot offset 59 ,lastApplied 60,total log 60, size 678,log cap:2
015'931 27 S2 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:17}, Num:0}}
015'931 31 S302 after snap shot size678 412
015'931 30 S302 apply index 60 key num 0 type 5   lastApplied 59
015'931 35 S302 apply num 17 migration [1 2 3 4 6]
015'931 31 S302 used size: 678 / 300 
015'932 29 S302 do snapshot for raft 60 60,size 412
015'932 27 S2 raft apply snapshot offset 60 ,lastApplied 60,total log 60, size 82,log cap:1
015'932 31 S302 after snap shot size82 412
015'922 35 S202 current config num 17 done
015'922 35 S102 current config num 17 done
015'922 35 S200 current config num 17 done
015'922 35 S101 current config num 17 done
015'953 35 S301 current config num 17 done
015'932 35 S302 current config num 17 done
015'933 35 S300 current config num 17 done
015'956 34 S102 got new config {17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 16
015'958 30 S300 apply index 59 key num 0 type 5   lastApplied 58
015'959 35 S300 apply num 17 migration [1 2 3 4 6]
015'959 31 S300 used size: 940 / 300 
015'959 29 S300 do snapshot for raft 59 59,size 412
015'960 27 S0 raft apply snapshot offset 59 ,lastApplied 60,total log 60, size 678,log cap:2
015'960 27 S0 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:17}, Num:0}}
015'960 31 S300 after snap shot size678 412
015'960 30 S300 apply index 60 key num 0 type 5   lastApplied 59
015'961 35 S300 apply num 17 migration [1 2 3 4 6]
015'961 31 S300 used size: 678 / 300 
015'961 29 S300 do snapshot for raft 60 60,size 412
015'961 27 S0 raft apply snapshot offset 60 ,lastApplied 60,total log 60, size 82,log cap:1
015'961 31 S300 after snap shot size82 412
015'964 34 S301 got new config {18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 17
015'965 34 S301 propose new config 18
015'967 35 S201 current config num 18 done
015'967 35 S100 current config num 17 done
015'975 30 S301 apply index 61 key num 0 type 4   lastApplied 60
015'975 34 S301 apply new config num 18 :&{18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
015'976 34 S301 inited need send [],need recv [0 1 2 3 4]
015'976 31 S301 used size: 459 / 300 
015'976 29 S301 do snapshot for raft 61 61,size 454
015'976 27 S1 raft apply snapshot offset 61 ,lastApplied 61,total log 61, size 82,log cap:1
015'976 31 S301 after snap shot size82 454
015'999 35 S202 current config num 17 done
015'999 35 S102 current config num 17 done
016'000 30 S202 apply index 82 key num 0 type 4   lastApplied 81
016'000 34 S202 apply new config num 18 :&{18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
016'001 34 S202 inited need send [],need recv []
016'001 31 S202 used size: 461 / 300 
016'001 29 S202 do snapshot for raft 82 82,size 455
016'001 27 S2 raft apply snapshot offset 82 ,lastApplied 82,total log 82, size 84,log cap:1
016'001 31 S202 after snap shot size84 455
016'004 35 S302 current config num 17 done
016'004 35 S301 num 18 waiting [0 1 2 3 4] shards 
016'004 35 S300 current config num 17 done
016'004 30 S200 apply index 82 key num 0 type 4   lastApplied 81
016'004 34 S200 apply new config num 18 :&{18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
016'005 34 S200 inited need send [],need recv []
016'005 31 S200 used size: 461 / 300 
016'005 29 S200 do snapshot for raft 82 82,size 455
016'006 27 S0 raft apply snapshot offset 82 ,lastApplied 82,total log 82, size 84,log cap:1
016'006 31 S200 after snap shot size84 455
016'007 35 S200 current config num 18 done
016'007 35 S101 current config num 17 done
016'020 35 S201 current config num 18 done
016'020 35 S100 current config num 17 done
016'067 35 S102 current config num 17 done
016'067 35 S202 current config num 18 done
016'074 28 S100 do request args:Key 7 type 3 num 20 Client 2972145661651991667 Seq 11 
016'076 28 S100 [667--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
016'076 35 S101 current config num 17 done
016'078 35 S302 current config num 17 done
016'078 35 S301 num 18 waiting [0 1 2 3 4] shards 
016'078 35 S300 current config num 17 done
016'079 34 S102 check new config wanted 18
016'079 35 S200 current config num 18 done
016'079 34 S301 check new config wanted 19
016'084 35 S100 current config num 17 done
016'084 35 S201 current config num 18 done
016'118 35 S102 current config num 17 done
016'118 35 S202 current config num 18 done
016'132 35 S301 num 18 waiting [0 1 2 3 4] shards 
016'132 35 S302 current config num 17 done
016'132 35 S101 current config num 17 done
016'132 35 S300 current config num 17 done
016'132 35 S200 current config num 18 done
016'135 35 S201 current config num 18 done
016'135 35 S100 current config num 17 done
016'170 35 S202 current config num 18 done
016'170 35 S102 current config num 17 done
016'184 35 S300 current config num 17 done
016'191 35 S101 current config num 17 done
016'194 35 S201 current config num 18 done
016'194 35 S100 current config num 17 done
016'207 35 S301 num 18 waiting [0 1 2 3 4] shards 
016'192 35 S302 current config num 17 done
016'192 35 S200 current config num 18 done
016'219 30 S302 apply index 61 key num 0 type 4   lastApplied 60
016'220 34 S302 apply new config num 18 :&{18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
016'220 34 S302 inited need send [],need recv [0 1 2 3 4]
016'220 31 S302 used size: 459 / 300 
016'220 29 S302 do snapshot for raft 61 61,size 454
016'221 27 S2 raft apply snapshot offset 61 ,lastApplied 61,total log 61, size 82,log cap:1
016'221 31 S302 after snap shot size82 454
016'225 35 S202 current config num 18 done
016'225 35 S102 current config num 17 done
016'229 30 S300 apply index 61 key num 0 type 4   lastApplied 60
016'229 34 S300 apply new config num 18 :&{18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
016'229 34 S300 inited need send [],need recv [0 1 2 3 4]
016'229 31 S300 used size: 459 / 300 
016'230 29 S300 do snapshot for raft 61 61,size 454
016'230 27 S0 raft apply snapshot offset 61 ,lastApplied 61,total log 61, size 82,log cap:1
016'230 31 S300 after snap shot size82 454
016'235 35 S300 num 18 waiting [0 1 2 3 4] shards 
016'242 35 S101 current config num 17 done
016'244 35 S201 current config num 18 done
016'244 35 S100 current config num 17 done
016'259 35 S301 num 18 waiting [0 1 2 3 4] shards 
016'259 35 S302 num 18 waiting [0 1 2 3 4] shards 
016'264 35 S200 current config num 18 done
016'276 35 S202 current config num 18 done
016'276 35 S102 current config num 17 done
016'285 35 S300 num 18 waiting [0 1 2 3 4] shards 
leave &{[102] 1074585914363486070 20}
016'292 35 S101 current config num 17 done
016'294 35 S201 current config num 18 done
016'295 35 S100 current config num 17 done
016'309 35 S302 num 18 waiting [0 1 2 3 4] shards 
016'309 35 S301 num 18 waiting [0 1 2 3 4] shards 
016'315 35 S200 current config num 18 done
016'327 35 S102 current config num 17 done
016'327 35 S202 current config num 18 done
016'347 35 S300 num 18 waiting [0 1 2 3 4] shards 
016'351 35 S100 current config num 17 done
016'351 35 S201 current config num 18 done
016'351 35 S101 current config num 17 done
016'386 35 S302 num 18 waiting [0 1 2 3 4] shards 
016'386 35 S200 current config num 18 done
016'387 35 S301 num 18 waiting [0 1 2 3 4] shards 
016'387 35 S102 current config num 17 done
016'387 35 S202 current config num 18 done
016'402 35 S100 current config num 17 done
016'402 35 S101 current config num 17 done
016'402 35 S201 current config num 18 done
016'405 35 S300 num 18 waiting [0 1 2 3 4] shards 
016'442 35 S202 current config num 18 done
016'442 35 S302 num 18 waiting [0 1 2 3 4] shards 
016'443 35 S200 current config num 18 done
016'443 35 S301 num 18 waiting [0 1 2 3 4] shards 
016'443 35 S102 current config num 17 done
016'453 35 S201 current config num 18 done
016'453 35 S100 current config num 17 done
016'453 35 S101 current config num 17 done
016'454 28 S300 do request args:Key 4 type 3 num 20 Client 132246879705026825 Seq 6 
016'454 28 S300 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
016'462 35 S300 num 18 waiting [0 1 2 3 4] shards 
016'512 35 S300 num 18 waiting [0 1 2 3 4] shards 
016'515 44 S1 ctrler change to config &{21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
016'520 44 S0 ctrler change to config &{21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
016'503 35 S202 current config num 18 done
016'521 35 S302 num 18 waiting [0 1 2 3 4] shards 
016'522 35 S301 num 18 waiting [0 1 2 3 4] shards 
016'503 35 S200 current config num 18 done
016'503 35 S102 current config num 17 done
016'504 35 S101 current config num 17 done
016'504 35 S201 current config num 18 done
016'504 35 S100 current config num 17 done
016'526 28 S100 do request args:Key 6 type 3 num 21 Client 542732653461723544 Seq 4 
016'526 28 S100 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
016'533 28 S100 do request args:Key 9 type 3 num 21 Client 3620950086299709532 Seq 15 
016'533 28 S100 [532--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
016'534 34 S300 got new config {18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 17
016'562 35 S300 num 18 waiting [0 1 2 3 4] shards 
016'571 35 S302 num 18 waiting [0 1 2 3 4] shards 
016'571 35 S202 current config num 18 done
016'572 35 S301 num 18 waiting [0 1 2 3 4] shards 
016'573 35 S200 current config num 18 done
016'573 35 S102 current config num 17 done
016'573 35 S101 current config num 17 done
016'574 35 S100 current config num 17 done
016'574 35 S201 current config num 18 done
016'618 44 S2 ctrler change to config &{21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
016'627 34 S301 got new config {19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 18
016'628 35 S100 current config num 17 done
016'628 35 S201 current config num 18 done
016'630 35 S300 num 18 waiting [0 1 2 3 4] shards 
016'631 34 S102 got new config {18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 17
016'631 35 S302 num 18 waiting [0 1 2 3 4] shards 
016'622 35 S202 current config num 18 done
016'623 35 S101 current config num 17 done
016'632 35 S301 num 18 waiting [0 1 2 3 4] shards 
016'634 28 S100 do request args:Key 7 type 3 num 21 Client 2972145661651991667 Seq 11 
016'634 28 S100 [667--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
016'623 35 S200 current config num 18 done
016'635 34 S301 propose new config 19
016'623 35 S102 current config num 17 done
016'638 34 S200 got new config {17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 16
016'639 34 S300 check new config wanted 19
016'647 30 S301 apply index 62 key num 0 type 4   lastApplied 61
016'647 34 S301 apply new config num 19 failed, for old num 18 still pending:[true true true true true false false false false false]
016'647 31 S301 used size: 503 / 300 
016'648 29 S301 do snapshot for raft 62 62,size 454
016'653 27 S1 raft apply snapshot offset 62 ,lastApplied 62,total log 62, size 82,log cap:1
016'653 31 S301 after snap shot size82 454
016'666 28 S100 do request args:Key 4 type 3 num 21 Client 132246879705026825 Seq 6 
016'667 28 S100 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
016'683 35 S201 current config num 18 done
016'684 35 S100 current config num 17 done
016'691 28 S100 do request args:Key 3 type 3 num 21 Client 2238025532150463055 Seq 8 
016'691 28 S100 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
016'693 28 S100 do request args:Key 8 type 3 num 21 Client 2953714763196401582 Seq 2 
016'693 28 S100 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
016'694 35 S301 num 18 waiting [0 1 2 3 4] shards 
016'694 35 S300 num 18 waiting [0 1 2 3 4] shards 
016'694 35 S302 num 18 waiting [0 1 2 3 4] shards 
016'695 35 S101 current config num 17 done
016'695 35 S202 current config num 18 done
016'695 35 S200 current config num 18 done
016'695 35 S102 current config num 17 done
leave &{[102] 1074585914363486070 20}
016'701 34 S101 got new config {17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 16
016'721 28 S100 do request args:Key 5 type 3 num 21 Client 3482757038087095369 Seq 5 
016'721 28 S100 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
016'735 34 S301 check new config wanted 19
016'736 34 S102 check new config wanted 18
016'737 28 S100 do request args:Key 2 type 3 num 21 Client 1679014388048817729 Seq 27 
016'738 28 S100 [729--27] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
016'739 35 S201 current config num 18 done
016'739 35 S100 current config num 17 done
016'743 34 S201 got new config {19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 18
016'744 34 S100 got new config {18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 17
016'744 34 S201 propose new config 19
016'745 34 S100 propose new config 18
016'745 35 S101 current config num 17 done
016'745 35 S300 num 18 waiting [0 1 2 3 4] shards 
016'745 35 S301 num 18 waiting [0 1 2 3 4] shards 
016'745 35 S302 num 18 waiting [0 1 2 3 4] shards 
016'745 35 S202 current config num 18 done
016'745 35 S102 current config num 17 done
016'746 34 S202 got new config {18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 17
016'749 34 S302 got new config {18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 17
016'740 34 S200 check new config wanted 19
016'755 35 S200 current config num 18 done
016'765 28 S100 do request args:Key 1 type 3 num 21 Client 418781717203629479 Seq 23 
016'765 28 S100 [479--23] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
016'769 30 S201 apply index 83 key num 0 type 4   lastApplied 82
016'770 34 S201 apply new config num 19 :&{19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
016'770 34 S201 inited need send [],need recv [0 5 6]
016'770 31 S201 used size: 505 / 300 
016'770 29 S201 do snapshot for raft 83 83,size 498
016'771 27 S1 raft apply snapshot offset 83 ,lastApplied 83,total log 83, size 84,log cap:1
016'771 31 S201 after snap shot size84 498
016'771 30 S100 apply index 173 key num 0 type 4   lastApplied 172
016'771 34 S100 apply new config num 18 :&{18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
016'771 34 S100 inited need send [0 1 2 3 4],need recv []
016'772 31 S100 used size: 463 / 300 
016'772 29 S100 do snapshot for raft 173 173,size 812
016'772 27 S0 raft apply snapshot offset 173 ,lastApplied 173,total log 173, size 86,log cap:1
016'772 31 S100 after snap shot size86 812
016'775 28 S100 do request args:Key 0 type 3 num 21 Client 940626237948413081 Seq 10 
016'775 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
016'789 30 S302 apply index 62 key num 0 type 4   lastApplied 61
016'789 34 S302 apply new config num 19 failed, for old num 18 still pending:[true true true true true false false false false false]
016'790 31 S302 used size: 503 / 300 
016'790 29 S302 do snapshot for raft 62 62,size 454
016'790 27 S2 raft apply snapshot offset 62 ,lastApplied 62,total log 62, size 82,log cap:1
016'790 31 S302 after snap shot size82 454
016'795 35 S301 num 18 waiting [0 1 2 3 4] shards 
016'795 35 S302 num 18 waiting [0 1 2 3 4] shards 
016'795 35 S202 current config num 18 done
016'795 35 S102 current config num 17 done
016'796 35 S101 current config num 17 done
016'796 35 S300 num 18 waiting [0 1 2 3 4] shards 
016'804 35 S201 num 19 waiting [0 5 6] shards 
016'804 35 S100 num 18 sending shards [0 1 2 3 4] to group 102
016'805 35 S200 current config num 18 done
016'805 34 S101 check new config wanted 18
016'812 30 S300 apply index 62 key num 0 type 4   lastApplied 61
016'812 34 S300 apply new config num 19 failed, for old num 18 still pending:[true true true true true false false false false false]
016'812 31 S300 used size: 503 / 300 
016'813 29 S300 do snapshot for raft 62 62,size 454
016'813 27 S0 raft apply snapshot offset 62 ,lastApplied 62,total log 62, size 82,log cap:1
016'813 31 S300 after snap shot size82 454
016'820 35 S300 num 18 handle num 18 move rpc [0 1 2 3 4]
016'820 35 S300 move handle not leader
016'823 35 S301 num 18 handle num 18 move rpc [0 1 2 3 4]
016'824 35 S301 move handle num 18 shards [0 1 2 3 4] as leader?
016'834 30 S301 apply index 63 key num 0 type 5   lastApplied 62
016'835 35 S301 apply num 18 migration [0 1 2 3 4]
016'835 30 S301 safely recv and decided shard 0
016'835 30 S301 safely recv and decided shard 1
016'835 30 S301 safely recv and decided shard 2
016'835 30 S301 safely recv and decided shard 3
016'835 30 S301 safely recv and decided shard 4
016'835 31 S301 used size: 702 / 300 
016'836 29 S301 do snapshot for raft 63 63,size 626
016'836 27 S1 raft apply snapshot offset 63 ,lastApplied 63,total log 63, size 82,log cap:1
016'836 31 S301 after snap shot size82 626
016'836 35 S301 num 18 move [0 1 2 3 4] is done yet
016'837 30 S100 after send shards ok
016'846 35 S100 move delete propose num 18 shards [0 1 2 3 4] as leader?
016'846 34 S201 check new config wanted 20
016'847 34 S202 check new config wanted 19
016'849 34 S302 check new config wanted 19
016'870 34 S100 check new config wanted 19
016'887 30 S100 apply index 174 key num 0 type 5   lastApplied 173
016'887 35 S100 apply num 18 migration [0 1 2 3 4]
016'888 30 S100 safely delete shard 0
016'888 30 S100 safely delete shard 1
016'888 30 S100 safely delete shard 2
016'888 30 S100 safely delete shard 3
016'888 30 S100 safely delete shard 4
016'888 31 S100 used size: 706 / 300 
016'888 30 S102 apply index 173 key num 0 type 4   lastApplied 172
016'888 35 S202 current config num 18 done
016'888 35 S302 num 18 waiting [0 1 2 3 4] shards 
016'888 34 S102 apply new config num 18 :&{18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
016'888 34 S102 inited need send [0 1 2 3 4],need recv []
016'905 31 S102 used size: 1002 / 300 
016'888 35 S301 current config num 18 done
016'888 35 S101 current config num 17 done
016'888 35 S201 num 19 waiting [0 5 6] shards 
016'894 29 S100 do snapshot for raft 174 174,size 640
016'888 35 S300 num 18 waiting [0 1 2 3 4] shards 
016'912 29 S102 do snapshot for raft 173 173,size 812
016'913 27 S2 raft apply snapshot offset 173 ,lastApplied 173,total log 174, size 706,log cap:2
016'913 31 S102 after snap shot size706 812
016'911 35 S200 current config num 18 done
016'923 30 S200 apply index 83 key num 0 type 4   lastApplied 82
016'923 34 S200 apply new config num 19 :&{19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
016'923 34 S200 inited need send [],need recv [0 5 6]
016'923 31 S200 used size: 505 / 300 
016'924 29 S200 do snapshot for raft 83 83,size 498
016'924 27 S0 raft apply snapshot offset 83 ,lastApplied 83,total log 83, size 84,log cap:1
016'924 31 S200 after snap shot size84 498
016'925 30 S202 apply index 83 key num 0 type 4   lastApplied 82
016'925 34 S202 apply new config num 19 :&{19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
016'925 34 S202 inited need send [],need recv [0 5 6]
016'925 31 S202 used size: 505 / 300 
016'926 29 S202 do snapshot for raft 83 83,size 498
016'926 27 S2 raft apply snapshot offset 83 ,lastApplied 83,total log 83, size 84,log cap:1
016'926 31 S202 after snap shot size84 498
016'945 30 S101 apply index 173 key num 0 type 4   lastApplied 172
016'945 34 S101 apply new config num 18 :&{18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{17 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
016'945 34 S101 inited need send [0 1 2 3 4],need recv []
016'945 31 S101 used size: 1002 / 300 
016'946 29 S101 do snapshot for raft 173 173,size 812
016'946 27 S1 raft apply snapshot offset 173 ,lastApplied 173,total log 174, size 706,log cap:2
016'946 31 S101 after snap shot size706 812
016'949 27 S0 raft apply snapshot offset 174 ,lastApplied 174,total log 174, size 86,log cap:1
016'949 31 S100 after snap shot size86 640
016'949 35 S100 current config num 18 done
016'949 35 S102 num 18 sending shards [0 1 2 3 4] to group 102
016'950 35 S302 num 18 waiting [0 1 2 3 4] shards 
016'950 35 S202 num 19 waiting [0 5 6] shards 
016'960 35 S300 num 18 handle num 18 move rpc [0 1 2 3 4]
016'960 35 S300 move handle not leader
016'971 35 S301 current config num 18 done
016'971 35 S101 num 18 sending shards [0 1 2 3 4] to group 102
016'971 35 S201 num 19 waiting [0 5 6] shards 
016'972 35 S200 num 19 waiting [0 5 6] shards 
016'973 34 S102 got new config {18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 17
016'974 34 S300 got new config {19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 18
016'977 35 S301 num 18 handle num 18 move rpc [0 1 2 3 4]
016'977 35 S301 num 18 move [0 1 2 3 4] is done yet
016'978 30 S102 after send shards ok
016'978 35 S102 move delete propose not leader
016'980 35 S102 num 18 sending shards [0 1 2 3 4] to group 102
016'980 34 S301 got new config {19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 18
016'980 34 S301 propose new config 19
016'984 35 S300 num 18 handle num 18 move rpc [0 1 2 3 4]
016'984 35 S300 move handle not leader
016'985 28 S100 do request args:Key 9 type 3 num 21 Client 3620950086299709532 Seq 15 
016'985 28 S100 [532--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
016'994 35 S300 num 18 waiting [0 1 2 3 4] shards 
016'998 35 S301 num 18 handle num 18 move rpc [0 1 2 3 4]
016'998 35 S301 num 18 move [0 1 2 3 4] is done yet
016'998 30 S101 after send shards ok
016'998 35 S101 move delete propose not leader
016'999 35 S300 num 18 handle num 18 move rpc [0 1 2 3 4]
016'999 35 S300 move handle not leader
017'006 35 S302 num 18 waiting [0 1 2 3 4] shards 
017'006 35 S202 num 19 waiting [0 5 6] shards 
017'009 30 S300 apply index 63 key num 0 type 5   lastApplied 62
017'009 35 S300 apply num 18 migration [0 1 2 3 4]
017'009 30 S300 safely recv and decided shard 0
017'009 30 S300 safely recv and decided shard 1
017'009 30 S300 safely recv and decided shard 2
017'009 30 S300 safely recv and decided shard 3
017'009 30 S300 safely recv and decided shard 4
017'009 31 S300 used size: 1043 / 300 
017'010 29 S300 do snapshot for raft 63 63,size 626
017'010 35 S301 num 18 handle num 18 move rpc [0 1 2 3 4]
017'010 35 S301 num 18 move [0 1 2 3 4] is done yet
017'010 35 S101 num 18 sending shards [0 1 2 3 4] to group 102
017'010 30 S102 after send shards ok
017'010 35 S102 move delete propose not leader
017'011 27 S0 raft apply snapshot offset 63 ,lastApplied 63,total log 64, size 504,log cap:2
017'011 31 S300 after snap shot size504 626
017'014 30 S301 apply index 64 key num 0 type 4   lastApplied 63
017'014 34 S301 apply new config num 19 :&{19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
017'014 34 S301 inited need send [0],need recv []
017'014 31 S301 used size: 504 / 300 
017'015 29 S301 do snapshot for raft 64 64,size 670
017'016 35 S300 num 18 handle num 18 move rpc [0 1 2 3 4]
017'016 35 S300 num 18 move [0 1 2 3 4] is done yet
017'017 30 S101 after send shards ok
017'017 35 S101 move delete propose not leader
017'017 30 S302 apply index 63 key num 0 type 5   lastApplied 62
017'018 35 S302 apply num 18 migration [0 1 2 3 4]
017'018 30 S302 safely recv and decided shard 0
017'018 30 S302 safely recv and decided shard 1
017'018 30 S302 safely recv and decided shard 2
017'018 30 S302 safely recv and decided shard 3
017'018 30 S302 safely recv and decided shard 4
017'018 31 S302 used size: 1043 / 300 
017'018 29 S302 do snapshot for raft 63 63,size 626
017'020 35 S100 current config num 18 done
017'020 35 S102 num 18 sending shards [0 1 2 3 4] to group 102
017'023 27 S2 raft apply snapshot offset 63 ,lastApplied 63,total log 64, size 504,log cap:2
017'023 31 S302 after snap shot size504 626
017'023 35 S201 num 19 waiting [0 5 6] shards 
017'023 35 S200 num 19 waiting [0 5 6] shards 
017'026 35 S300 num 18 handle num 18 move rpc [0 1 2 3 4]
017'026 35 S300 num 18 move [0 1 2 3 4] is done yet
017'026 30 S102 after send shards ok
017'027 35 S102 move delete propose not leader
017'027 30 S101 apply index 174 key num 0 type 5   lastApplied 173
017'027 35 S101 apply num 18 migration [0 1 2 3 4]
017'027 30 S101 safely delete shard 0
017'027 30 S101 safely delete shard 1
017'027 30 S101 safely delete shard 2
017'027 30 S101 safely delete shard 3
017'027 30 S101 safely delete shard 4
017'027 31 S101 used size: 706 / 300 
017'027 29 S101 do snapshot for raft 174 174,size 640
017'028 27 S1 raft apply snapshot offset 174 ,lastApplied 174,total log 174, size 86,log cap:1
017'028 31 S101 after snap shot size86 640
017'015 27 S1 raft apply snapshot offset 64 ,lastApplied 64,total log 64, size 84,log cap:1
017'028 31 S301 after snap shot size84 670
017'028 35 S301 num 19 sending shards [0] to group 101
017'035 30 S102 apply index 174 key num 0 type 5   lastApplied 173
017'035 35 S102 apply num 18 migration [0 1 2 3 4]
017'035 30 S102 safely delete shard 0
017'035 30 S102 safely delete shard 1
017'035 30 S102 safely delete shard 2
017'035 30 S102 safely delete shard 3
017'036 30 S102 safely delete shard 4
017'036 31 S102 used size: 706 / 300 
017'036 29 S102 do snapshot for raft 174 174,size 640
017'036 27 S2 raft apply snapshot offset 174 ,lastApplied 174,total log 174, size 86,log cap:1
017'036 31 S102 after snap shot size86 640
017'037 35 S200 num 19 handle num 19 move rpc [0]
017'037 35 S200 move handle not leader
017'039 35 S201 num 19 handle num 19 move rpc [0]
017'040 35 S201 move handle num 19 shards [0] as leader?
017'046 35 S101 current config num 18 done
017'062 35 S300 current config num 18 done
017'072 35 S102 current config num 18 done
017'072 35 S100 current config num 18 done
017'074 35 S200 num 19 waiting [0 5 6] shards 
017'074 35 S201 num 19 waiting [0 5 6] shards 
017'076 35 S302 current config num 18 done
017'089 34 S300 check new config wanted 19
017'089 34 S102 check new config wanted 19
017'096 35 S202 num 19 waiting [0 5 6] shards 
017'097 35 S301 num 19 sending shards [0] to group 101
017'098 34 S301 check new config wanted 20
017'099 35 S200 num 19 handle num 19 move rpc [0]
017'099 35 S200 move handle not leader
017'101 35 S201 num 19 handle num 19 move rpc [0]
017'102 35 S201 move handle num 19 shards [0] as leader?
017'106 30 S201 apply index 84 key num 0 type 5   lastApplied 83
017'106 35 S201 apply num 19 migration [0]
017'106 30 S201 safely recv and decided shard 0
017'106 31 S201 used size: 676 / 300 
017'106 29 S201 do snapshot for raft 84 84,size 550
017'107 27 S1 raft apply snapshot offset 84 ,lastApplied 84,total log 85, size 547,log cap:2
017'107 31 S201 after snap shot size547 550
017'108 35 S201 num 19 move [0] is done yet
017'108 30 S301 after send shards ok
017'110 35 S301 move delete propose num 19 shards [0] as leader?
017'096 35 S101 current config num 18 done
017'119 35 S300 current config num 18 done
017'122 30 S200 apply index 84 key num 0 type 5   lastApplied 83
017'122 35 S200 apply num 19 migration [0]
017'122 30 S200 safely recv and decided shard 0
017'122 31 S200 used size: 676 / 300 
017'124 35 S100 current config num 18 done
017'125 29 S200 do snapshot for raft 84 84,size 550
017'126 35 S102 current config num 18 done
017'126 35 S302 current config num 18 done
017'126 35 S201 num 19 waiting [5 6] shards 
017'128 35 S301 num 19 sending shards [0] to group 101
017'139 30 S302 apply index 64 key num 0 type 4   lastApplied 63
017'139 34 S302 apply new config num 19 :&{19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
017'139 34 S302 inited need send [0],need recv []
017'139 31 S302 used size: 504 / 300 
017'140 29 S302 do snapshot for raft 64 64,size 670
017'140 27 S2 raft apply snapshot offset 64 ,lastApplied 64,total log 64, size 84,log cap:1
017'140 31 S302 after snap shot size84 670
017'145 27 S0 raft apply snapshot offset 84 ,lastApplied 84,total log 85, size 547,log cap:2
017'145 31 S200 after snap shot size547 550
017'147 35 S200 num 19 waiting [5 6] shards 
017'148 30 S201 apply index 85 key num 0 type 5   lastApplied 84
017'148 35 S201 apply num 19 migration [0]
017'148 31 S201 used size: 547 / 300 
017'149 29 S201 do snapshot for raft 85 85,size 550
017'149 27 S1 raft apply snapshot offset 85 ,lastApplied 85,total log 85, size 84,log cap:1
017'149 31 S201 after snap shot size84 550
017'149 35 S201 num 19 move [0] is done yet
017'150 30 S301 after send shards ok
017'151 35 S301 move delete propose num 19 shards [0] as leader?
017'156 28 S100 do request args:Key 4 type 3 num 21 Client 132246879705026825 Seq 6 
017'156 28 S100 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
017'158 35 S202 num 19 waiting [0 5 6] shards 
017'159 35 S301 num 19 sending shards [0] to group 101
017'166 30 S300 apply index 64 key num 0 type 4   lastApplied 63
017'166 34 S300 apply new config num 19 :&{19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
017'166 34 S300 inited need send [0],need recv []
017'166 31 S300 used size: 504 / 300 
017'168 35 S101 current config num 18 done
017'168 29 S300 do snapshot for raft 64 64,size 670
017'168 27 S0 raft apply snapshot offset 64 ,lastApplied 64,total log 64, size 84,log cap:1
017'169 31 S300 after snap shot size84 670
017'176 35 S100 current config num 18 done
017'186 35 S302 num 19 sending shards [0] to group 101
017'193 35 S300 num 19 sending shards [0] to group 101
017'194 35 S301 num 19 sending shards [0] to group 101
017'189 35 S102 current config num 18 done
017'194 35 S201 num 19 waiting [5 6] shards 
017'195 35 S200 num 19 handle num 19 move rpc [0]
017'195 35 S200 num 19 move [0] is done yet
017'196 30 S301 after send shards ok
017'198 35 S200 num 19 handle num 19 move rpc [0]
017'198 35 S200 num 19 move [0] is done yet
017'198 30 S300 after send shards ok
017'198 35 S300 move delete propose not leader
017'198 35 S200 num 19 waiting [5 6] shards 
017'202 35 S200 num 19 handle num 19 move rpc [0]
017'202 35 S200 num 19 move [0] is done yet
017'205 35 S301 move delete propose num 19 shards [0] as leader?
017'205 30 S301 apply index 65 key num 0 type 5   lastApplied 64
017'205 35 S301 apply num 19 migration [0]
017'205 30 S301 safely delete shard 0
017'205 31 S301 used size: 805 / 300 
017'206 29 S301 do snapshot for raft 65 65,size 618
017'235 35 S202 num 19 waiting [0 5 6] shards 
017'254 35 S302 num 19 sending shards [0] to group 101
017'254 35 S201 num 19 waiting [5 6] shards 
017'254 35 S300 num 19 sending shards [0] to group 101
017'254 35 S101 current config num 18 done
017'254 35 S102 current config num 18 done
017'256 35 S200 num 19 waiting [5 6] shards 
017'258 35 S100 current config num 18 done
017'264 27 S1 raft apply snapshot offset 65 ,lastApplied 66,total log 67, size 676,log cap:3
017'264 27 S1 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}}, Num:19}, Num:0}}
017'264 31 S301 after snap shot size676 618
017'264 30 S301 apply index 66 key num 0 type 5   lastApplied 65
017'264 35 S301 apply num 19 migration [0]
017'264 31 S301 used size: 676 / 300 
017'271 29 S301 do snapshot for raft 66 66,size 618
017'272 27 S1 raft apply snapshot offset 66 ,lastApplied 66,total log 67, size 547,log cap:2
017'272 31 S301 after snap shot size547 618
017'272 30 S301 after send shards ok
017'272 35 S301 num 19 move [0] is done yet
017'272 35 S301 current config num 19 done
017'273 30 S202 apply index 84 key num 0 type 5   lastApplied 83
017'273 35 S202 apply num 19 migration [0]
017'274 30 S202 safely recv and decided shard 0
017'274 31 S202 used size: 676 / 300 
017'274 29 S202 do snapshot for raft 84 84,size 550
017'274 35 S200 num 19 handle num 19 move rpc [0]
017'274 35 S200 num 19 move [0] is done yet
017'275 27 S2 raft apply snapshot offset 84 ,lastApplied 85,total log 85, size 547,log cap:2
017'275 27 S2 last applied not snapshoted raft.LogEntry{Term:10, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}}, Num:19}, Num:0}}
017'275 31 S202 after snap shot size547 550
017'275 30 S202 apply index 85 key num 0 type 5   lastApplied 84
017'275 35 S202 apply num 19 migration [0]
017'275 31 S202 used size: 547 / 300 
017'276 35 S200 num 19 handle num 19 move rpc [0]
017'276 35 S200 num 19 move [0] is done yet
017'276 29 S202 do snapshot for raft 85 85,size 550
017'276 27 S2 raft apply snapshot offset 85 ,lastApplied 85,total log 85, size 84,log cap:1
017'276 31 S202 after snap shot size84 550
017'275 30 S302 after send shards ok
017'277 35 S302 move delete propose not leader
017'277 30 S302 after send shards ok
017'277 35 S302 move delete propose not leader
017'280 35 S200 num 19 handle num 19 move rpc [0]
017'280 35 S200 num 19 move [0] is done yet
017'280 30 S301 after send shards ok
017'280 35 S301 num 19 move [0] is done yet
017'287 35 S202 num 19 waiting [5 6] shards 
017'287 30 S200 apply index 85 key num 0 type 5   lastApplied 84
017'287 35 S200 apply num 19 migration [0]
017'287 31 S200 used size: 547 / 300 
017'287 29 S200 do snapshot for raft 85 85,size 550
017'288 27 S0 raft apply snapshot offset 85 ,lastApplied 85,total log 85, size 84,log cap:1
017'288 31 S200 after snap shot size84 550
017'289 35 S300 num 19 sending shards [0] to group 101
017'290 35 S302 num 19 sending shards [0] to group 101
017'298 35 S200 num 19 handle num 19 move rpc [0]
017'298 35 S200 num 19 move [0] is done yet
017'310 35 S200 num 19 handle num 19 move rpc [0]
017'311 35 S200 num 19 move [0] is done yet
017'311 30 S300 after send shards ok
017'311 35 S300 move delete propose not leader
017'311 30 S300 after send shards ok
017'311 35 S300 move delete propose not leader
017'316 30 S302 apply index 65 key num 0 type 5   lastApplied 64
017'316 35 S302 apply num 19 migration [0]
017'316 30 S302 safely delete shard 0
017'316 31 S302 used size: 805 / 300 
017'317 29 S302 do snapshot for raft 65 65,size 618
017'318 27 S2 raft apply snapshot offset 65 ,lastApplied 66,total log 67, size 676,log cap:3
017'318 27 S2 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}}, Num:19}, Num:0}}
017'318 31 S302 after snap shot size676 618
017'318 30 S302 apply index 66 key num 0 type 5   lastApplied 65
017'318 35 S302 apply num 19 migration [0]
017'318 31 S302 used size: 676 / 300 
017'320 29 S302 do snapshot for raft 66 66,size 618
017'339 27 S2 raft apply snapshot offset 66 ,lastApplied 66,total log 67, size 547,log cap:2
017'340 31 S302 after snap shot size547 618
017'343 35 S201 num 19 waiting [5 6] shards 
017'332 35 S101 current config num 18 done
017'332 35 S102 current config num 18 done
017'340 35 S302 current config num 19 done
017'340 30 S300 apply index 65 key num 0 type 5   lastApplied 64
017'366 35 S300 apply num 19 migration [0]
017'366 30 S300 safely delete shard 0
017'366 31 S300 used size: 805 / 300 
017'367 29 S300 do snapshot for raft 65 65,size 618
017'367 27 S0 raft apply snapshot offset 65 ,lastApplied 66,total log 67, size 676,log cap:3
017'367 27 S0 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}}, Num:19}, Num:0}}
017'368 31 S300 after snap shot size676 618
017'368 30 S300 apply index 66 key num 0 type 5   lastApplied 65
017'368 35 S300 apply num 19 migration [0]
017'368 31 S300 used size: 676 / 300 
017'368 29 S300 do snapshot for raft 66 66,size 618
017'340 35 S100 current config num 18 done
017'380 35 S200 num 19 waiting [5 6] shards 
017'340 35 S301 current config num 19 done
017'381 30 S301 apply index 67 key num 0 type 5   lastApplied 66
017'381 35 S301 apply num 19 migration [0]
017'381 31 S301 used size: 547 / 300 
017'382 29 S301 do snapshot for raft 67 67,size 618
017'382 27 S1 raft apply snapshot offset 67 ,lastApplied 67,total log 67, size 84,log cap:1
017'382 31 S301 after snap shot size84 618
017'384 35 S202 num 19 waiting [5 6] shards 
017'384 27 S0 raft apply snapshot offset 66 ,lastApplied 66,total log 67, size 547,log cap:2
017'384 31 S300 after snap shot size547 618
017'385 35 S300 current config num 19 done
017'387 35 S200 num 19 handle num 19 move rpc [0]
017'387 35 S200 num 19 move [0] is done yet
017'388 30 S302 after send shards ok
017'388 35 S302 num 19 move [0] is done yet
017'403 30 S302 apply index 67 key num 0 type 5   lastApplied 66
017'403 35 S302 apply num 19 migration [0]
017'403 31 S302 used size: 547 / 300 
017'406 35 S201 num 19 waiting [5 6] shards 
017'406 35 S101 current config num 18 done
017'409 29 S302 do snapshot for raft 67 67,size 618
017'410 27 S2 raft apply snapshot offset 67 ,lastApplied 67,total log 67, size 84,log cap:1
017'410 31 S302 after snap shot size84 618
017'410 30 S300 apply index 67 key num 0 type 5   lastApplied 66
017'410 35 S300 apply num 19 migration [0]
017'410 31 S300 used size: 547 / 300 
017'411 29 S300 do snapshot for raft 67 67,size 618
017'411 27 S0 raft apply snapshot offset 67 ,lastApplied 67,total log 67, size 84,log cap:1
017'411 31 S300 after snap shot size84 618
017'412 35 S102 current config num 18 done
017'420 35 S302 current config num 19 done
017'458 35 S101 current config num 18 done
017'458 35 S201 num 19 waiting [5 6] shards 
017'490 35 S100 current config num 18 done
017'490 35 S200 num 19 waiting [5 6] shards 
017'492 35 S301 current config num 19 done
017'493 35 S300 current config num 19 done
017'493 35 S202 num 19 waiting [5 6] shards 
017'495 35 S102 current config num 18 done
017'495 35 S302 current config num 19 done
017'510 35 S101 current config num 18 done
017'510 35 S201 num 19 waiting [5 6] shards 
017'545 35 S202 num 19 waiting [5 6] shards 
017'545 35 S302 current config num 19 done
017'545 35 S300 current config num 19 done
017'545 35 S102 current config num 18 done
017'566 35 S301 current config num 19 done
017'566 35 S100 current config num 18 done
017'568 35 S200 num 19 waiting [5 6] shards 
017'566 35 S101 current config num 18 done
017'568 35 S201 num 19 waiting [5 6] shards 
017'598 35 S302 current config num 19 done
017'598 35 S202 num 19 waiting [5 6] shards 
017'598 35 S300 current config num 19 done
017'598 35 S102 current config num 18 done
017'620 35 S201 num 19 waiting [5 6] shards 
017'620 35 S301 current config num 19 done
017'620 35 S100 current config num 18 done
017'620 35 S101 current config num 18 done
017'620 35 S200 num 19 waiting [5 6] shards 
017'657 35 S302 current config num 19 done
017'657 35 S202 num 19 waiting [5 6] shards 
017'657 35 S300 current config num 19 done
017'657 35 S102 current config num 18 done
017'672 35 S200 num 19 waiting [5 6] shards 
017'672 35 S301 current config num 19 done
017'672 35 S201 num 19 waiting [5 6] shards 
017'672 35 S100 current config num 18 done
017'672 35 S101 current config num 18 done
017'715 35 S202 num 19 waiting [5 6] shards 
017'716 35 S302 current config num 19 done
017'716 35 S300 current config num 19 done
017'716 35 S102 current config num 18 done
017'724 35 S101 current config num 18 done
017'724 35 S301 current config num 19 done
017'724 35 S201 num 19 waiting [5 6] shards 
017'724 35 S100 current config num 18 done
017'724 35 S200 num 19 waiting [5 6] shards 
017'771 35 S202 num 19 waiting [5 6] shards 
017'771 35 S302 current config num 19 done
017'771 35 S102 current config num 18 done
017'771 35 S300 current config num 19 done
017'774 35 S100 current config num 18 done
017'790 35 S301 current config num 19 done
017'791 35 S101 current config num 18 done
017'792 35 S201 num 19 waiting [5 6] shards 
017'792 35 S200 num 19 waiting [5 6] shards 
017'825 35 S302 current config num 19 done
017'825 35 S202 num 19 waiting [5 6] shards 
017'825 35 S102 current config num 18 done
017'825 35 S300 current config num 19 done
017'825 35 S100 current config num 18 done
017'861 35 S301 current config num 19 done
017'862 35 S201 num 19 waiting [5 6] shards 
017'862 35 S200 num 19 waiting [5 6] shards 
017'862 35 S101 current config num 18 done
017'875 35 S100 current config num 18 done
017'876 35 S302 current config num 19 done
017'876 35 S202 num 19 waiting [5 6] shards 
017'876 35 S102 current config num 18 done
017'876 35 S300 current config num 19 done
017'924 28 S100 do request args:Key 7 type 3 num 21 Client 2972145661651991667 Seq 11 
017'924 28 S100 [667--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
017'926 34 S200 got new config {19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 18
017'927 34 S100 got new config {19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 18
017'928 34 S100 propose new config 19
017'928 35 S300 current config num 19 done
017'928 35 S100 current config num 18 done
017'928 35 S202 num 19 waiting [5 6] shards 
017'928 35 S302 current config num 19 done
017'928 35 S102 current config num 18 done
017'913 35 S301 current config num 19 done
017'928 35 S201 num 19 waiting [5 6] shards 
017'913 35 S101 current config num 18 done
017'928 35 S200 num 19 waiting [5 6] shards 
017'943 30 S100 apply index 175 key num 0 type 4   lastApplied 174
017'943 34 S100 apply new config num 19 :&{19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
017'943 34 S100 inited need send [5 6],need recv []
017'943 31 S100 used size: 507 / 300 
017'944 29 S100 do snapshot for raft 175 175,size 683
017'944 27 S0 raft apply snapshot offset 175 ,lastApplied 175,total log 175, size 86,log cap:1
017'944 31 S100 after snap shot size86 683
017'979 34 S102 got new config {19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 18
017'980 35 S300 current config num 19 done
017'980 35 S202 num 19 waiting [5 6] shards 
017'980 35 S102 current config num 18 done
017'981 28 S100 do request args:Key 6 type 3 num 21 Client 542732653461723544 Seq 4 
017'981 28 S100 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
017'988 30 S101 apply index 175 key num 0 type 4   lastApplied 174
017'988 34 S101 apply new config num 19 :&{19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
017'988 34 S101 inited need send [5 6],need recv []
017'988 31 S101 used size: 507 / 300 
017'989 29 S101 do snapshot for raft 175 175,size 683
017'989 27 S1 raft apply snapshot offset 175 ,lastApplied 175,total log 175, size 86,log cap:1
017'989 31 S101 after snap shot size86 683
017'989 30 S102 apply index 175 key num 0 type 4   lastApplied 174
017'989 34 S102 apply new config num 19 :&{19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
017'989 34 S102 inited need send [5 6],need recv []
017'989 31 S102 used size: 507 / 300 
017'990 29 S102 do snapshot for raft 175 175,size 683
017'990 27 S2 raft apply snapshot offset 175 ,lastApplied 175,total log 175, size 86,log cap:1
017'990 31 S102 after snap shot size86 683
017'991 35 S200 num 19 waiting [5 6] shards 
017'992 35 S100 num 19 sending shards [5 6] to group 101
017'992 35 S301 current config num 19 done
017'992 35 S201 num 19 waiting [5 6] shards 
017'992 35 S101 num 19 sending shards [5 6] to group 101
017'992 35 S302 current config num 19 done
017'995 35 S200 num 19 handle num 19 move rpc [5 6]
017'995 35 S200 move handle not leader
017'996 35 S200 num 19 handle num 19 move rpc [5 6]
017'996 35 S200 move handle not leader
017'999 35 S201 num 19 handle num 19 move rpc [5 6]
018'000 35 S201 move handle num 19 shards [5 6] as leader?
018'000 35 S201 num 19 handle num 19 move rpc [5 6]
018'002 35 S201 move handle num 19 shards [5 6] as leader?
018'012 30 S201 apply index 86 key num 0 type 5   lastApplied 85
018'012 35 S201 apply num 19 migration [5 6]
018'012 30 S201 safely recv and decided shard 5
018'013 30 S201 safely recv and decided shard 6
018'013 31 S201 used size: 716 / 300 
018'014 29 S201 do snapshot for raft 86 86,size 612
018'014 27 S1 raft apply snapshot offset 86 ,lastApplied 87,total log 87, size 567,log cap:2
018'014 27 S1 last applied not snapshoted raft.LogEntry{Term:10, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:19}, Num:0}}
018'015 31 S201 after snap shot size567 612
018'015 30 S201 apply index 87 key num 0 type 5   lastApplied 86
018'015 35 S201 apply num 19 migration [5 6]
018'015 31 S201 used size: 567 / 300 
018'015 29 S201 do snapshot for raft 87 87,size 612
018'016 27 S1 raft apply snapshot offset 87 ,lastApplied 87,total log 87, size 84,log cap:1
018'016 31 S201 after snap shot size84 612
018'016 35 S201 num 19 move [5 6] is done yet
018'017 35 S201 num 19 move [5 6] is done yet
018'019 30 S101 after send shards ok
018'019 35 S101 move delete propose not leader
018'020 30 S100 after send shards ok
018'026 34 S201 got new config {20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 19
018'027 34 S201 propose new config 20
018'028 35 S101 num 19 sending shards [5 6] to group 101
018'029 35 S100 move delete propose num 19 shards [5 6] as leader?
018'029 28 S100 do request args:Key 3 type 3 num 21 Client 2238025532150463055 Seq 8 
018'029 28 S100 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
018'033 34 S101 got new config {18 [102 102 102 102 102 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 17
018'035 34 S202 got new config {19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 18
018'035 35 S100 num 19 sending shards [5 6] to group 101
018'035 34 S100 check new config wanted 20
018'035 28 S100 do request args:Key 8 type 3 num 21 Client 2953714763196401582 Seq 2 
018'035 28 S100 do request args:Key 5 type 3 num 21 Client 3482757038087095369 Seq 5 
018'035 28 S100 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
018'036 28 S100 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
018'037 34 S302 got new config {19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 18
018'038 28 S100 do request args:Key 1 type 3 num 21 Client 418781717203629479 Seq 23 
018'038 28 S100 [479--23] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
018'039 28 S100 do request args:Key 2 type 3 num 21 Client 1679014388048817729 Seq 27 
018'039 28 S100 [729--27] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
018'031 35 S300 current config num 19 done
018'040 35 S202 num 19 waiting [5 6] shards 
018'045 35 S102 num 19 sending shards [5 6] to group 101
018'032 34 S200 check new config wanted 20
018'049 35 S200 num 19 handle num 19 move rpc [5 6]
018'049 35 S200 move handle not leader
018'050 34 S301 got new config {20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 19
018'050 34 S301 propose new config 20
018'051 34 S300 got new config {19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} old 18
018'055 35 S200 num 19 handle num 19 move rpc [5 6]
018'055 35 S200 move handle not leader
018'072 28 S100 do request args:Key 0 type 3 num 21 Client 940626237948413081 Seq 10 
018'072 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
018'087 30 S202 apply index 86 key num 0 type 5   lastApplied 85
018'091 35 S202 apply num 19 migration [5 6]
018'092 30 S202 safely recv and decided shard 5
018'094 35 S102 num 19 sending shards [5 6] to group 101
018'090 35 S301 current config num 19 done
018'090 35 S201 current config num 19 done
018'090 35 S302 current config num 19 done
018'090 35 S200 num 19 waiting [5 6] shards 
018'090 35 S100 num 19 sending shards [5 6] to group 101
018'097 35 S300 current config num 19 done
018'097 35 S201 num 19 handle num 19 move rpc [5 6]
018'097 35 S201 num 19 move [5 6] is done yet
018'090 35 S101 num 19 sending shards [5 6] to group 101
018'104 30 S202 safely recv and decided shard 6
018'104 31 S202 used size: 1012 / 300 
018'105 29 S202 do snapshot for raft 86 86,size 612
018'106 27 S2 raft apply snapshot offset 86 ,lastApplied 87,total log 88, size 863,log cap:3
018'106 27 S2 last applied not snapshoted raft.LogEntry{Term:10, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:19}, Num:0}}
018'106 31 S202 after snap shot size863 612
018'106 30 S202 apply index 87 key num 0 type 5   lastApplied 86
018'106 35 S202 apply num 19 migration [5 6]
018'106 31 S202 used size: 863 / 300 
018'107 29 S202 do snapshot for raft 87 87,size 612
018'109 27 S2 raft apply snapshot offset 87 ,lastApplied 87,total log 88, size 461,log cap:2
018'109 31 S202 after snap shot size461 612
018'109 35 S202 current config num 19 done
018'097 34 S102 check new config wanted 20
018'097 30 S200 apply index 86 key num 0 type 5   lastApplied 85
018'118 35 S200 apply num 19 migration [5 6]
018'118 30 S200 safely recv and decided shard 5
018'118 30 S200 safely recv and decided shard 6
018'118 31 S200 used size: 1012 / 300 
018'119 29 S200 do snapshot for raft 86 86,size 612
018'120 27 S0 raft apply snapshot offset 86 ,lastApplied 87,total log 88, size 863,log cap:3
018'120 27 S0 last applied not snapshoted raft.LogEntry{Term:10, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:19}, Num:0}}
018'120 31 S200 after snap shot size863 612
018'120 30 S200 apply index 87 key num 0 type 5   lastApplied 86
018'120 35 S200 apply num 19 migration [5 6]
018'120 31 S200 used size: 863 / 300 
018'120 29 S200 do snapshot for raft 87 87,size 612
018'127 28 S100 do request args:Key 9 type 3 num 21 Client 3620950086299709532 Seq 15 
018'127 28 S100 [532--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
018'128 35 S101 num 19 sending shards [5 6] to group 101
018'130 27 S0 raft apply snapshot offset 87 ,lastApplied 87,total log 88, size 461,log cap:2
018'130 31 S200 after snap shot size461 612
018'098 30 S201 apply index 88 key num 0 type 4   lastApplied 87
018'130 34 S201 apply new config num 20 :&{20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
018'130 34 S201 inited need send [0 5 6],need recv []
018'130 31 S201 used size: 461 / 300 
018'131 29 S201 do snapshot for raft 88 88,size 569
018'131 35 S102 num 19 sending shards [5 6] to group 101
018'131 27 S1 raft apply snapshot offset 88 ,lastApplied 88,total log 88, size 84,log cap:1
018'131 31 S201 after snap shot size84 569
018'131 35 S201 num 20 handle num 19 move rpc [5 6]
018'133 35 S200 num 19 handle num 19 move rpc [5 6]
018'133 35 S200 num 19 move [5 6] is done yet
018'133 30 S102 after send shards ok
018'133 35 S102 move delete propose not leader
018'134 30 S101 after send shards ok
018'134 35 S101 move delete propose not leader
018'134 35 S200 num 19 handle num 19 move rpc [5 6]
018'134 35 S200 num 19 move [5 6] is done yet
018'134 35 S200 num 19 handle num 19 move rpc [5 6]
018'135 35 S200 num 19 move [5 6] is done yet
018'135 30 S102 after send shards ok
018'135 35 S102 move delete propose not leader
018'135 34 S201 check new config wanted 21
018'135 30 S102 after send shards ok
018'135 35 S102 move delete propose not leader
018'135 35 S200 num 19 handle num 19 move rpc [5 6]
018'135 35 S200 num 19 move [5 6] is done yet
018'136 30 S100 after send shards ok
018'137 35 S100 move delete propose num 19 shards [5 6] as leader?
018'137 35 S200 num 19 handle num 19 move rpc [5 6]
018'137 35 S200 num 19 move [5 6] is done yet
018'138 34 S101 check new config wanted 20
018'141 34 S202 check new config wanted 20
018'142 30 S100 after send shards ok
018'143 35 S100 move delete propose num 19 shards [5 6] as leader?
018'143 30 S101 after send shards ok
018'143 35 S101 move delete propose not leader
018'143 34 S302 check new config wanted 20
018'149 35 S301 current config num 19 done
018'151 35 S100 num 19 sending shards [5 6] to group 101
018'151 35 S201 num 20 sending shards [0 5] to group 100
018'152 35 S201 num 20 sending shards [6] to group 102
018'155 35 S302 current config num 19 done
018'164 35 S202 current config num 19 done
018'170 35 S102 num 19 sending shards [5 6] to group 101
018'173 35 S200 num 19 handle num 19 move rpc [5 6]
018'173 35 S200 num 19 move [5 6] is done yet
018'176 35 S200 num 19 handle num 19 move rpc [5 6]
018'176 35 S200 num 19 move [5 6] is done yet
018'176 30 S100 after send shards ok
018'177 35 S100 move delete propose num 19 shards [5 6] as leader?
018'184 35 S200 current config num 19 done
018'185 35 S300 current config num 19 done
018'188 35 S201 num 20 sending shards [6] to group 102
018'188 35 S201 num 20 sending shards [0 5] to group 100
018'201 35 S102 num 19 sending shards [5 6] to group 101
018'203 35 S200 num 19 handle num 19 move rpc [5 6]
018'203 35 S200 num 19 move [5 6] is done yet
018'203 30 S102 after send shards ok
018'203 35 S102 move delete propose not leader
018'208 35 S302 current config num 19 done
018'210 34 S100 got new config {20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 19
018'219 35 S201 num 20 sending shards [0 5] to group 100
018'219 35 S201 num 20 sending shards [6] to group 102
018'221 35 S202 current config num 19 done
018'226 35 S200 num 19 handle num 19 move rpc [5 6]
018'226 35 S200 num 19 move [5 6] is done yet
018'227 30 S102 after send shards ok
018'227 35 S102 move delete propose not leader
018'191 34 S301 check new config wanted 20
018'228 30 S301 apply index 68 key num 0 type 4   lastApplied 67
018'229 35 S101 num 19 sending shards [5 6] to group 101
018'191 34 S300 check new config wanted 20
018'232 30 S101 after send shards ok
018'232 35 S101 move delete propose not leader
018'228 34 S301 apply new config num 20 :&{20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
018'233 34 S301 inited need send [],need recv [6]
018'233 31 S301 used size: 461 / 300 
018'234 29 S301 do snapshot for raft 68 68,size 575
018'234 27 S1 raft apply snapshot offset 68 ,lastApplied 68,total log 68, size 84,log cap:1
018'234 31 S301 after snap shot size84 575
018'234 35 S301 num 20 waiting [6] shards 
018'234 35 S102 num 19 sending shards [5 6] to group 101
018'235 35 S200 num 19 handle num 19 move rpc [5 6]
018'235 35 S200 num 19 move [5 6] is done yet
018'235 30 S101 after send shards ok
018'235 35 S101 move delete propose not leader
018'241 35 S300 num 19 handle num 20 move rpc [6]
018'241 35 S300 num 19 handle num 20 move rpc [6]
018'254 35 S301 num 20 handle num 20 move rpc [6]
018'254 35 S301 move handle num 20 shards [6] as leader?
018'258 30 S202 apply index 88 key num 0 type 4   lastApplied 87
018'258 34 S202 apply new config num 20 :&{20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
018'258 34 S202 inited need send [0 5 6],need recv []
018'258 31 S202 used size: 461 / 300 
018'258 29 S202 do snapshot for raft 88 88,size 569
018'259 27 S2 raft apply snapshot offset 88 ,lastApplied 88,total log 88, size 84,log cap:1
018'259 31 S202 after snap shot size84 569
018'259 35 S301 num 20 handle num 20 move rpc [6]
018'260 35 S301 move handle num 20 shards [6] as leader?
018'260 35 S101 num 19 sending shards [5 6] to group 101
018'263 35 S200 num 19 handle num 19 move rpc [5 6]
018'263 35 S200 num 19 move [5 6] is done yet
018'264 30 S102 after send shards ok
018'264 35 S102 move delete propose not leader
018'268 35 S200 current config num 19 done
018'268 35 S300 current config num 19 done
018'271 35 S201 num 20 sending shards [0 5] to group 100
018'271 35 S201 num 20 sending shards [6] to group 102
018'272 35 S102 num 19 sending shards [5 6] to group 101
018'272 35 S302 current config num 19 done
018'277 35 S300 num 19 handle num 20 move rpc [6]
018'294 35 S301 num 20 waiting [6] shards 
018'308 35 S201 num 20 sending shards [0 5] to group 100
018'308 35 S201 num 20 sending shards [6] to group 102
018'308 35 S102 num 19 sending shards [5 6] to group 101
018'323 35 S100 num 19 sending shards [5 6] to group 101
018'324 35 S302 current config num 19 done
018'325 28 S100 do request args:Key 4 type 3 num 21 Client 132246879705026825 Seq 6 
018'325 28 S100 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
018'328 34 S100 propose new config 20
018'328 30 S100 apply index 176 key num 0 type 5   lastApplied 175
018'328 35 S100 apply num 19 migration [5 6]
018'328 30 S100 safely delete shard 5
018'328 30 S100 safely delete shard 6
018'328 31 S100 used size: 1312 / 300 
018'337 29 S100 do snapshot for raft 176 176,size 622
018'338 27 S0 raft apply snapshot offset 176 ,lastApplied 179,total log 180, size 1163,log cap:5
018'338 27 S0 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:19}, Num:0}}
018'338 31 S100 after snap shot size1163 622
018'338 30 S100 apply index 177 key num 0 type 5   lastApplied 176
018'338 35 S100 apply num 19 migration [5 6]
018'338 31 S100 used size: 1163 / 300 
018'339 29 S100 do snapshot for raft 177 177,size 622
018'340 27 S0 raft apply snapshot offset 177 ,lastApplied 179,total log 180, size 1014,log cap:4
018'340 27 S0 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:19}, Num:0}}
018'340 31 S100 after snap shot size1014 622
018'340 30 S100 apply index 178 key num 0 type 5   lastApplied 177
018'340 35 S100 apply num 19 migration [5 6]
018'340 31 S100 used size: 1014 / 300 
018'344 29 S100 do snapshot for raft 178 178,size 622
018'345 27 S0 raft apply snapshot offset 178 ,lastApplied 179,total log 180, size 865,log cap:3
018'345 27 S0 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:19}, Num:0}}
018'345 31 S100 after snap shot size865 622
018'345 30 S100 apply index 179 key num 0 type 5   lastApplied 178
018'345 35 S100 apply num 19 migration [5 6]
018'345 31 S100 used size: 865 / 300 
018'346 29 S100 do snapshot for raft 179 179,size 622
018'346 27 S0 raft apply snapshot offset 179 ,lastApplied 179,total log 180, size 463,log cap:2
018'346 31 S100 after snap shot size463 622
018'346 35 S100 num 19 handle num 20 move rpc [0 5]
018'347 35 S100 num 19 handle num 20 move rpc [0 5]
018'347 35 S100 num 19 handle num 20 move rpc [0 5]
018'348 35 S301 num 20 waiting [6] shards 
018'348 35 S201 num 20 sending shards [0 5] to group 100
018'348 35 S201 num 20 sending shards [6] to group 102
018'348 35 S102 num 19 sending shards [5 6] to group 101
018'349 35 S100 num 19 handle num 20 move rpc [0 5]
018'351 30 S301 apply index 69 key num 0 type 5   lastApplied 68
018'351 35 S301 apply num 20 migration [6]
018'351 30 S301 safely recv and decided shard 6
018'351 31 S301 used size: 628 / 300 
018'351 29 S301 do snapshot for raft 69 69,size 601
018'352 27 S1 raft apply snapshot offset 69 ,lastApplied 70,total log 70, size 523,log cap:2
018'352 27 S1 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:20}, Num:0}}
018'352 31 S301 after snap shot size523 601
018'352 30 S301 apply index 70 key num 0 type 5   lastApplied 69
018'352 35 S301 apply num 20 migration [6]
018'352 31 S301 used size: 523 / 300 
018'353 29 S301 do snapshot for raft 70 70,size 601
018'353 27 S1 raft apply snapshot offset 70 ,lastApplied 70,total log 70, size 84,log cap:1
018'353 31 S301 after snap shot size84 601
018'353 35 S301 num 20 move [6] is done yet
018'354 35 S301 num 20 move [6] is done yet
018'355 35 S100 current config num 19 done
018'364 30 S102 apply index 176 key num 0 type 5   lastApplied 175
018'364 35 S102 apply num 19 migration [5 6]
018'364 30 S102 safely delete shard 5
018'364 30 S102 safely delete shard 6
018'364 31 S102 used size: 1016 / 300 
018'365 29 S102 do snapshot for raft 176 176,size 622
018'366 27 S2 raft apply snapshot offset 176 ,lastApplied 179,total log 179, size 867,log cap:4
018'366 27 S2 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:19}, Num:0}}
018'366 31 S102 after snap shot size867 622
018'366 30 S102 apply index 177 key num 0 type 5   lastApplied 176
018'366 35 S102 apply num 19 migration [5 6]
018'366 31 S102 used size: 867 / 300 
018'314 30 S200 apply index 88 key num 0 type 4   lastApplied 87
018'374 34 S200 apply new config num 20 :&{20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
018'374 34 S200 inited need send [0 5 6],need recv []
018'374 31 S200 used size: 461 / 300 
018'375 29 S200 do snapshot for raft 88 88,size 569
018'375 27 S0 raft apply snapshot offset 88 ,lastApplied 88,total log 88, size 84,log cap:1
018'375 31 S200 after snap shot size84 569
018'376 35 S100 num 19 handle num 20 move rpc [0 5]
018'377 35 S302 current config num 19 done
018'377 35 S200 num 20 sending shards [6] to group 102
018'377 35 S200 num 20 sending shards [0 5] to group 100
018'377 35 S200 num 20 handle num 19 move rpc [5 6]
018'378 35 S201 num 20 sending shards [0 5] to group 100
018'379 35 S201 num 20 sending shards [6] to group 102
018'379 29 S102 do snapshot for raft 177 177,size 622
018'380 27 S2 raft apply snapshot offset 177 ,lastApplied 179,total log 179, size 718,log cap:3
018'380 27 S2 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:19}, Num:0}}
018'380 31 S102 after snap shot size718 622
018'380 30 S102 apply index 178 key num 0 type 5   lastApplied 177
018'380 35 S102 apply num 19 migration [5 6]
018'380 35 S100 num 19 handle num 20 move rpc [0 5]
018'380 31 S102 used size: 718 / 300 
018'383 35 S100 num 19 handle num 20 move rpc [0 5]
018'384 30 S100 after send shards ok
018'384 35 S100 num 19 move [5 6] is done yet
018'388 35 S100 num 19 handle num 20 move rpc [0 5]
018'391 29 S102 do snapshot for raft 178 178,size 622
018'392 27 S2 raft apply snapshot offset 178 ,lastApplied 179,total log 179, size 569,log cap:2
018'392 27 S2 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:19}, Num:0}}
018'392 31 S102 after snap shot size569 622
018'392 30 S102 apply index 179 key num 0 type 5   lastApplied 178
018'392 35 S102 apply num 19 migration [5 6]
018'392 31 S102 used size: 569 / 300 
018'393 29 S102 do snapshot for raft 179 179,size 622
018'395 35 S200 num 20 handle num 19 move rpc [5 6]
018'404 27 S2 raft apply snapshot offset 179 ,lastApplied 179,total log 179, size 86,log cap:1
018'404 31 S102 after snap shot size86 622
018'404 35 S102 current config num 19 done
018'404 30 S102 after send shards ok
018'404 35 S102 num 19 move [5 6] is done yet
018'405 35 S301 current config num 20 done
018'405 35 S100 current config num 19 done
018'409 35 S200 num 20 sending shards [0 5] to group 100
018'409 35 S200 num 20 sending shards [6] to group 102
018'411 35 S100 num 19 handle num 20 move rpc [0 5]
018'412 35 S201 num 20 sending shards [0 5] to group 100
018'412 35 S201 num 20 sending shards [6] to group 102
018'416 35 S301 num 20 handle num 20 move rpc [6]
018'416 35 S301 num 20 move [6] is done yet
018'417 30 S201 after send shards ok
018'418 35 S201 move delete propose num 20 shards [6] as leader?
018'419 35 S101 num 19 sending shards [5 6] to group 101
018'423 30 S101 apply index 176 key num 0 type 5   lastApplied 175
018'423 35 S101 apply num 19 migration [5 6]
018'423 30 S101 safely delete shard 5
018'423 30 S101 safely delete shard 6
018'423 31 S101 used size: 1016 / 300 
018'424 29 S101 do snapshot for raft 176 176,size 622
018'424 27 S1 raft apply snapshot offset 176 ,lastApplied 179,total log 179, size 867,log cap:4
018'424 27 S1 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:19}, Num:0}}
018'425 31 S101 after snap shot size867 622
018'425 30 S101 apply index 177 key num 0 type 5   lastApplied 176
018'425 35 S101 apply num 19 migration [5 6]
018'428 35 S302 current config num 19 done
018'425 31 S101 used size: 867 / 300 
018'429 29 S101 do snapshot for raft 177 177,size 622
018'430 27 S1 raft apply snapshot offset 177 ,lastApplied 179,total log 179, size 718,log cap:3
018'430 27 S1 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:19}, Num:0}}
018'430 31 S101 after snap shot size718 622
018'430 30 S101 apply index 178 key num 0 type 5   lastApplied 177
018'430 35 S101 apply num 19 migration [5 6]
018'430 31 S101 used size: 718 / 300 
018'431 29 S101 do snapshot for raft 178 178,size 622
018'431 27 S1 raft apply snapshot offset 178 ,lastApplied 179,total log 179, size 569,log cap:2
018'431 30 S201 apply index 89 key num 0 type 5   lastApplied 88
018'432 35 S201 apply num 20 migration [6]
018'431 27 S1 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:19}, Num:0}}
018'432 31 S101 after snap shot size569 622
018'432 30 S101 apply index 179 key num 0 type 5   lastApplied 178
018'432 35 S101 apply num 19 migration [5 6]
018'432 31 S101 used size: 569 / 300 
018'319 35 S300 current config num 19 done
018'433 35 S300 num 19 handle num 20 move rpc [6]
018'434 30 S300 apply index 68 key num 0 type 4   lastApplied 67
018'434 34 S300 apply new config num 20 :&{20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
018'434 34 S300 inited need send [],need recv [6]
018'434 31 S300 used size: 924 / 300 
018'435 29 S300 do snapshot for raft 68 68,size 575
018'436 27 S0 raft apply snapshot offset 68 ,lastApplied 68,total log 70, size 628,log cap:3
018'436 31 S300 after snap shot size628 575
018'436 35 S300 num 20 handle num 20 move rpc [6]
018'436 35 S300 move handle not leader
018'436 35 S300 num 20 handle num 20 move rpc [6]
018'436 35 S300 move handle not leader
018'437 35 S202 num 20 sending shards [0 5] to group 100
018'437 35 S202 num 20 sending shards [6] to group 102
018'439 35 S300 num 20 handle num 20 move rpc [6]
018'439 35 S300 move handle not leader
018'439 35 S300 num 20 handle num 20 move rpc [6]
018'439 35 S300 move handle not leader
018'440 35 S200 num 20 sending shards [6] to group 102
018'440 35 S200 num 20 sending shards [0 5] to group 100
018'441 34 S100 check new config wanted 20
018'452 29 S101 do snapshot for raft 179 179,size 622
018'452 27 S1 raft apply snapshot offset 179 ,lastApplied 179,total log 179, size 86,log cap:1
018'452 31 S101 after snap shot size86 622
018'452 35 S101 num 19 handle num 20 move rpc [0 5]
018'452 35 S101 num 19 handle num 20 move rpc [0 5]
018'452 35 S101 num 19 handle num 20 move rpc [0 5]
018'453 35 S101 num 19 handle num 20 move rpc [0 5]
018'453 35 S101 num 19 handle num 20 move rpc [0 5]
018'454 35 S101 num 19 handle num 20 move rpc [0 5]
018'454 35 S101 current config num 19 done
018'456 35 S102 current config num 19 done
018'460 35 S300 num 20 handle num 20 move rpc [6]
018'460 35 S300 move handle not leader
018'461 35 S200 num 20 handle num 19 move rpc [5 6]
018'463 30 S102 after send shards ok
018'463 35 S102 num 19 move [5 6] is done yet
018'432 30 S201 safely delete shard 6
018'488 31 S201 used size: 523 / 300 
018'466 35 S100 current config num 19 done
018'466 35 S301 current config num 20 done
018'483 35 S302 current config num 19 done
018'487 35 S300 num 20 handle num 20 move rpc [6]
018'488 35 S300 move handle not leader
018'490 35 S202 num 20 sending shards [0 5] to group 100
018'490 35 S202 num 20 sending shards [6] to group 102
018'491 35 S300 num 20 waiting [6] shards 
018'491 35 S200 num 20 sending shards [0 5] to group 100
018'498 34 S101 got new config {20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 19
018'499 35 S100 num 19 handle num 20 move rpc [0 5]
018'500 29 S201 do snapshot for raft 89 89,size 543
018'505 27 S1 raft apply snapshot offset 89 ,lastApplied 89,total log 89, size 84,log cap:1
018'505 31 S201 after snap shot size84 543
018'521 30 S302 apply index 68 key num 0 type 4   lastApplied 67
018'527 30 S100 apply index 180 key num 0 type 4   lastApplied 179
018'527 34 S100 apply new config num 20 :&{20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
018'527 34 S100 inited need send [],need recv [0 5]
018'527 31 S100 used size: 463 / 300 
018'528 29 S100 do snapshot for raft 180 180,size 579
018'528 27 S0 raft apply snapshot offset 180 ,lastApplied 180,total log 180, size 86,log cap:1
018'528 31 S100 after snap shot size86 579
018'533 30 S300 apply index 69 key num 0 type 5   lastApplied 68
018'533 35 S300 apply num 20 migration [6]
018'533 30 S300 safely recv and decided shard 6
018'533 31 S300 used size: 628 / 300 
018'539 35 S100 num 20 handle num 20 move rpc [0 5]
018'540 35 S100 move handle num 20 shards [0 5] as leader?
018'541 35 S202 num 20 sending shards [0 5] to group 100
018'541 35 S202 num 20 sending shards [6] to group 102
018'542 35 S100 num 20 handle num 20 move rpc [0 5]
018'544 29 S300 do snapshot for raft 69 69,size 601
018'545 27 S0 raft apply snapshot offset 69 ,lastApplied 70,total log 70, size 523,log cap:2
018'545 27 S0 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:20}, Num:0}}
018'545 31 S300 after snap shot size523 601
018'545 30 S300 apply index 70 key num 0 type 5   lastApplied 69
018'545 35 S300 apply num 20 migration [6]
018'546 35 S100 move handle num 20 shards [0 5] as leader?
018'546 35 S100 num 20 handle num 20 move rpc [0 5]
018'547 35 S100 move handle num 20 shards [0 5] as leader?
018'521 34 S302 apply new config num 20 :&{20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
018'550 34 S302 inited need send [],need recv [6]
018'550 31 S302 used size: 924 / 300 
018'551 29 S302 do snapshot for raft 68 68,size 575
018'551 27 S2 raft apply snapshot offset 68 ,lastApplied 68,total log 70, size 628,log cap:3
018'551 31 S302 after snap shot size628 575
018'551 29 S302 recv Installsnapshot 70 68
018'552 27 S2 raft apply snapshot offset 70 ,lastApplied 70,total log 70, size 84,log cap:1
018'552 29 S302 decide Installsnapshot 70 <- 68
018'552 30 S302 install snap index 70,config {20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
018'557 35 S200 num 20 sending shards [6] to group 102
018'559 30 S100 apply index 181 key num 0 type 5   lastApplied 180
018'559 35 S100 apply num 20 migration [0 5]
018'559 30 S100 safely recv and decided shard 0
018'559 30 S100 safely recv and decided shard 5
018'559 31 S100 used size: 941 / 300 
018'560 29 S100 do snapshot for raft 181 181,size 667
018'560 27 S0 raft apply snapshot offset 181 ,lastApplied 183,total log 183, size 767,log cap:3
018'560 27 S0 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:20}, Num:0}}
018'561 31 S100 after snap shot size767 667
018'561 30 S100 apply index 182 key num 0 type 5   lastApplied 181
018'561 35 S100 apply num 20 migration [0 5]
018'561 31 S100 used size: 767 / 300 
018'561 29 S100 do snapshot for raft 182 182,size 667
018'562 27 S0 raft apply snapshot offset 182 ,lastApplied 183,total log 183, size 593,log cap:2
018'562 27 S0 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:20}, Num:0}}
018'562 31 S100 after snap shot size593 667
018'562 30 S100 apply index 183 key num 0 type 5   lastApplied 182
018'562 35 S100 apply num 20 migration [0 5]
018'562 31 S100 used size: 593 / 300 
018'563 29 S100 do snapshot for raft 183 183,size 667
018'563 27 S0 raft apply snapshot offset 183 ,lastApplied 183,total log 183, size 86,log cap:1
018'563 31 S100 after snap shot size86 667
018'563 35 S100 num 20 move [0 5] is done yet
018'564 35 S100 num 20 move [0 5] is done yet
018'564 35 S100 num 20 move [0 5] is done yet
018'565 35 S302 current config num 20 done
018'565 35 S100 current config num 20 done
018'565 35 S301 current config num 20 done
018'545 31 S300 used size: 523 / 300 
018'566 35 S200 num 20 handle num 19 move rpc [5 6]
018'566 29 S300 do snapshot for raft 70 70,size 601
018'566 27 S0 raft apply snapshot offset 70 ,lastApplied 70,total log 70, size 84,log cap:1
018'566 31 S300 after snap shot size84 601
018'566 35 S300 num 20 handle num 20 move rpc [6]
018'567 35 S300 num 20 move [6] is done yet
018'567 35 S300 num 20 handle num 20 move rpc [6]
018'567 35 S300 num 20 move [6] is done yet
018'567 35 S301 num 20 handle num 20 move rpc [6]
018'567 35 S301 num 20 move [6] is done yet
018'568 30 S202 after send shards ok
018'568 35 S202 move delete propose not leader
018'569 30 S202 after send shards ok
018'569 35 S202 move delete propose not leader
018'570 35 S300 current config num 20 done
018'570 35 S100 num 20 handle num 20 move rpc [0 5]
018'570 35 S100 num 20 move [0 5] is done yet
018'571 30 S200 after send shards ok
018'571 35 S200 move delete propose not leader
018'572 30 S202 after send shards ok
018'572 35 S202 move delete propose not leader
018'576 30 S202 after send shards ok
018'576 35 S202 move delete propose not leader
018'577 35 S200 num 20 handle num 19 move rpc [5 6]
018'577 30 S200 apply index 89 key num 0 type 5   lastApplied 88
018'577 35 S200 apply num 20 migration [6]
018'577 30 S200 safely delete shard 6
018'578 31 S200 used size: 523 / 300 
018'579 29 S200 do snapshot for raft 89 89,size 543
018'583 30 S202 apply index 89 key num 0 type 5   lastApplied 88
018'583 35 S202 apply num 20 migration [6]
018'583 30 S202 safely delete shard 6
018'583 31 S202 used size: 523 / 300 
018'584 35 S300 num 20 handle num 20 move rpc [6]
018'584 35 S300 num 20 move [6] is done yet
018'586 35 S301 num 20 handle num 20 move rpc [6]
018'587 35 S301 num 20 move [6] is done yet
018'595 35 S301 num 20 handle num 20 move rpc [6]
018'595 35 S301 num 20 move [6] is done yet
018'605 29 S202 do snapshot for raft 89 89,size 543
018'605 27 S2 raft apply snapshot offset 89 ,lastApplied 89,total log 89, size 84,log cap:1
018'605 31 S202 after snap shot size84 543
018'605 27 S0 raft apply snapshot offset 89 ,lastApplied 89,total log 89, size 84,log cap:1
018'605 31 S200 after snap shot size84 543
018'605 30 S200 after send shards ok
018'605 35 S200 num 20 move [6] is done yet
018'605 35 S202 num 20 sending shards [0 5] to group 100
018'606 30 S200 after send shards ok
018'606 35 S200 num 20 move [6] is done yet
018'607 35 S100 num 20 handle num 20 move rpc [0 5]
018'607 35 S100 num 20 move [0 5] is done yet
018'608 30 S202 after send shards ok
018'608 35 S202 move delete propose not leader
018'615 35 S201 num 20 sending shards [0 5] to group 100
018'615 35 S302 current config num 20 done
018'615 35 S301 current config num 20 done
018'616 35 S100 current config num 20 done
018'617 30 S201 after send shards ok
018'617 35 S201 num 20 move [6] is done yet
018'617 30 S201 after send shards ok
018'617 35 S201 num 20 move [6] is done yet
018'617 30 S201 after send shards ok
018'618 35 S201 num 20 move [6] is done yet
018'618 30 S201 after send shards ok
018'619 35 S201 move delete propose num 20 shards [0 5] as leader?
018'619 30 S201 after send shards ok
018'619 35 S201 num 20 move [6] is done yet
018'619 35 S301 num 20 handle num 20 move rpc [6]
018'619 35 S301 num 20 move [6] is done yet
018'620 35 S100 num 20 handle num 20 move rpc [0 5]
018'620 35 S100 num 20 move [0 5] is done yet
018'621 30 S202 after send shards ok
018'621 35 S202 move delete propose not leader
018'511 35 S102 current config num 19 done
018'621 30 S102 after send shards ok
018'621 35 S102 num 19 move [5 6] is done yet
018'621 30 S102 apply index 180 key num 0 type 4   lastApplied 179
018'621 34 S102 apply new config num 20 :&{20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
018'621 34 S102 inited need send [],need recv [0 5]
018'621 31 S102 used size: 1237 / 300 
018'622 29 S102 do snapshot for raft 180 180,size 579
018'623 27 S2 raft apply snapshot offset 180 ,lastApplied 180,total log 183, size 941,log cap:4
018'623 31 S102 after snap shot size941 579
018'623 29 S102 recv Installsnapshot 183 180
018'623 27 S2 raft apply snapshot offset 183 ,lastApplied 183,total log 183, size 86,log cap:1
018'623 29 S102 decide Installsnapshot 183 <- 180
018'624 30 S102 install snap index 183,config {20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
018'511 35 S101 current config num 19 done
018'625 35 S101 num 19 handle num 20 move rpc [0 5]
018'625 35 S102 num 20 handle num 20 move rpc [0 5]
018'625 35 S102 num 20 move [0 5] is done yet
018'625 35 S102 num 20 handle num 20 move rpc [0 5]
018'625 35 S102 num 20 move [0 5] is done yet
018'626 35 S101 num 19 handle num 20 move rpc [0 5]
018'628 35 S102 num 20 handle num 20 move rpc [0 5]
018'628 35 S102 num 20 move [0 5] is done yet
018'629 30 S201 after send shards ok
018'630 35 S201 move delete propose num 20 shards [0 5] as leader?
018'632 35 S300 current config num 20 done
018'632 35 S102 num 20 handle num 20 move rpc [0 5]
018'632 35 S102 num 20 move [0 5] is done yet
018'633 30 S201 after send shards ok
018'634 35 S201 move delete propose num 20 shards [0 5] as leader?
018'636 35 S102 num 20 handle num 20 move rpc [0 5]
018'636 35 S102 num 20 move [0 5] is done yet
018'639 30 S201 after send shards ok
018'639 35 S301 num 20 handle num 20 move rpc [6]
018'639 35 S301 num 20 move [6] is done yet
018'640 35 S201 move delete propose num 20 shards [0 5] as leader?
018'639 35 S100 num 20 handle num 20 move rpc [0 5]
018'640 35 S100 num 20 move [0 5] is done yet
018'640 30 S201 after send shards ok
018'641 35 S102 num 20 handle num 20 move rpc [0 5]
018'641 35 S102 num 20 move [0 5] is done yet
018'642 35 S202 num 20 sending shards [0 5] to group 100
018'646 35 S301 num 20 handle num 20 move rpc [6]
018'646 35 S301 num 20 move [6] is done yet
018'646 35 S201 move delete propose num 20 shards [0 5] as leader?
018'678 35 S302 current config num 20 done
018'679 35 S100 current config num 20 done
018'688 30 S201 after send shards ok
018'688 35 S201 num 20 move [6] is done yet
018'689 30 S201 after send shards ok
018'690 35 S201 move delete propose num 20 shards [0 5] as leader?
018'691 30 S201 after send shards ok
018'704 35 S301 num 20 handle num 20 move rpc [6]
018'704 35 S301 num 20 move [6] is done yet
018'704 35 S301 current config num 20 done
018'704 35 S102 current config num 20 done
018'626 30 S101 apply index 180 key num 0 type 4   lastApplied 179
018'705 34 S101 apply new config num 20 :&{20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 old :{19 [101 102 102 102 102 101 101 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}
018'705 34 S101 inited need send [],need recv [0 5]
018'705 31 S101 used size: 1237 / 300 
018'706 29 S101 do snapshot for raft 180 180,size 579
018'718 35 S201 move delete propose num 20 shards [0 5] as leader?
018'718 35 S201 num 20 sending shards [0 5] to group 100
018'718 30 S201 after send shards ok
018'718 35 S201 num 20 move [6] is done yet
018'721 30 S201 apply index 90 key num 0 type 5   lastApplied 89
018'721 35 S201 apply num 20 migration [0 5]
018'721 30 S201 safely delete shard 0
018'721 30 S201 safely delete shard 5
018'721 31 S201 used size: 1635 / 300 
018'721 29 S201 do snapshot for raft 90 90,size 455
018'722 27 S1 raft apply snapshot offset 90 ,lastApplied 92,total log 96, size 1461,log cap:7
018'723 35 S202 num 20 sending shards [0 5] to group 100
018'724 35 S300 current config num 20 done
018'729 35 S302 current config num 20 done
018'729 35 S100 current config num 20 done
018'730 35 S200 num 20 sending shards [0 5] to group 100
018'730 30 S200 after send shards ok
018'731 35 S200 num 20 move [6] is done yet
018'731 30 S200 after send shards ok
018'732 35 S200 move delete propose not leader
018'723 27 S1 last applied not snapshoted raft.LogEntry{Term:10, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:20}, Num:0}}
018'738 31 S201 after snap shot size1461 455
018'738 30 S201 apply index 91 key num 0 type 5   lastApplied 90
018'738 35 S201 apply num 20 migration [0 5]
018'738 31 S201 used size: 1461 / 300 
018'739 29 S201 do snapshot for raft 91 91,size 455
018'740 27 S1 raft apply snapshot offset 91 ,lastApplied 92,total log 96, size 1287,log cap:6
018'740 27 S1 last applied not snapshoted raft.LogEntry{Term:10, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:20}, Num:0}}
018'740 31 S201 after snap shot size1287 455
018'740 30 S201 apply index 92 key num 0 type 5   lastApplied 91
018'740 35 S201 apply num 20 migration [0 5]
018'740 31 S201 used size: 1287 / 300 
018'741 29 S201 do snapshot for raft 92 92,size 455
018'742 27 S1 raft apply snapshot offset 92 ,lastApplied 92,total log 96, size 1113,log cap:5
018'742 31 S201 after snap shot size1113 455
018'748 30 S201 apply index 93 key num 0 type 5   lastApplied 92
018'748 35 S201 apply num 20 migration [0 5]
018'748 31 S201 used size: 1113 / 300 
018'748 29 S202 recv Installsnapshot 92 89
018'749 29 S201 do snapshot for raft 93 93,size 455
018'749 27 S2 raft apply snapshot offset 92 ,lastApplied 92,total log 94, size 765,log cap:3
018'749 29 S202 decide Installsnapshot 92 <- 89
018'750 30 S202 install snap index 92,config {20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
018'751 27 S1 raft apply snapshot offset 93 ,lastApplied 94,total log 96, size 939,log cap:4
018'751 27 S1 last applied not snapshoted raft.LogEntry{Term:10, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:20}, Num:0}}
018'752 31 S201 after snap shot size939 455
018'752 30 S201 after send shards ok
018'752 35 S201 num 20 move [6] is done yet
018'752 35 S201 current config num 20 done
018'753 30 S201 apply index 94 key num 0 type 5   lastApplied 93
018'753 35 S201 apply num 20 migration [0 5]
018'753 31 S201 used size: 939 / 300 
018'755 29 S201 do snapshot for raft 94 94,size 455
018'755 27 S1 raft apply snapshot offset 94 ,lastApplied 94,total log 96, size 765,log cap:3
018'755 31 S201 after snap shot size765 455
018'758 35 S102 current config num 20 done
018'758 35 S301 current config num 20 done
018'759 35 S100 num 20 handle num 20 move rpc [0 5]
018'759 35 S100 num 20 move [0 5] is done yet
018'760 35 S200 num 20 handle num 19 move rpc [5 6]
018'761 35 S300 num 20 handle num 20 move rpc [6]
018'761 35 S300 num 20 move [6] is done yet
018'761 35 S200 num 20 sending shards [0 5] to group 100
018'762 35 S300 num 20 handle num 20 move rpc [6]
018'762 35 S300 num 20 move [6] is done yet
018'762 30 S202 after send shards ok
018'762 35 S202 num 20 move [0 5] is done yet
018'763 35 S100 num 20 handle num 20 move rpc [0 5]
018'763 35 S100 num 20 move [0 5] is done yet
018'763 30 S200 apply index 90 key num 0 type 5   lastApplied 89
018'763 35 S200 apply num 20 migration [0 5]
018'764 30 S200 safely delete shard 0
018'764 30 S200 safely delete shard 5
018'764 31 S200 used size: 1635 / 300 
018'764 29 S200 do snapshot for raft 90 90,size 455
018'766 27 S0 raft apply snapshot offset 90 ,lastApplied 94,total log 96, size 1461,log cap:7
018'766 27 S0 last applied not snapshoted raft.LogEntry{Term:10, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:20}, Num:0}}
018'766 31 S200 after snap shot size1461 455
018'766 30 S200 apply index 91 key num 0 type 5   lastApplied 90
018'766 35 S200 apply num 20 migration [0 5]
018'766 31 S200 used size: 1461 / 300 
018'767 29 S200 do snapshot for raft 91 91,size 455
018'768 30 S201 apply index 95 key num 0 type 5   lastApplied 94
018'768 35 S201 apply num 20 migration [0 5]
018'768 31 S201 used size: 765 / 300 
018'769 29 S201 do snapshot for raft 95 95,size 455
018'770 27 S1 raft apply snapshot offset 95 ,lastApplied 96,total log 96, size 591,log cap:2
018'770 27 S1 last applied not snapshoted raft.LogEntry{Term:10, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:20}, Num:0}}
018'770 31 S201 after snap shot size591 455
018'770 30 S201 apply index 96 key num 0 type 5   lastApplied 95
018'770 35 S201 apply num 20 migration [0 5]
018'770 31 S201 used size: 591 / 300 
018'780 29 S201 do snapshot for raft 96 96,size 455
018'770 27 S0 raft apply snapshot offset 91 ,lastApplied 94,total log 96, size 1287,log cap:6
018'780 27 S0 last applied not snapshoted raft.LogEntry{Term:10, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:20}, Num:0}}
018'780 31 S200 after snap shot size1287 455
018'780 30 S200 apply index 92 key num 0 type 5   lastApplied 91
018'781 35 S200 apply num 20 migration [0 5]
018'781 31 S200 used size: 1287 / 300 
018'781 27 S1 raft apply snapshot offset 96 ,lastApplied 96,total log 96, size 84,log cap:1
018'782 31 S201 after snap shot size84 455
018'782 29 S200 do snapshot for raft 92 92,size 455
018'783 27 S0 raft apply snapshot offset 92 ,lastApplied 94,total log 96, size 1113,log cap:5
018'783 27 S0 last applied not snapshoted raft.LogEntry{Term:10, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:20}, Num:0}}
018'784 31 S200 after snap shot size1113 455
018'784 30 S200 after send shards ok
018'784 35 S200 num 20 move [6] is done yet
018'784 30 S200 apply index 93 key num 0 type 5   lastApplied 92
018'784 35 S200 apply num 20 migration [0 5]
018'784 31 S200 used size: 1113 / 300 
018'785 29 S200 do snapshot for raft 93 93,size 455
018'786 27 S0 raft apply snapshot offset 93 ,lastApplied 94,total log 96, size 939,log cap:4
018'786 27 S0 last applied not snapshoted raft.LogEntry{Term:10, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:20}, Num:0}}
018'786 31 S200 after snap shot size939 455
018'786 30 S200 apply index 94 key num 0 type 5   lastApplied 93
018'786 35 S200 apply num 20 migration [0 5]
018'786 31 S200 used size: 939 / 300 
018'788 29 S200 do snapshot for raft 94 94,size 455
018'788 27 S0 raft apply snapshot offset 94 ,lastApplied 94,total log 96, size 765,log cap:3
018'789 31 S200 after snap shot size765 455
018'771 35 S202 current config num 20 done
018'789 27 S1 raft apply snapshot offset 180 ,lastApplied 183,total log 183, size 941,log cap:4
018'789 27 S1 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:20}, Num:0}}
018'789 31 S101 after snap shot size941 579
018'789 30 S101 apply index 181 key num 0 type 5   lastApplied 180
018'789 35 S101 apply num 20 migration [0 5]
018'789 30 S101 safely recv and decided shard 0
018'789 30 S101 safely recv and decided shard 5
018'789 31 S101 used size: 941 / 300 
018'790 29 S101 do snapshot for raft 181 181,size 667
018'791 27 S1 raft apply snapshot offset 181 ,lastApplied 183,total log 183, size 767,log cap:3
018'791 27 S1 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:20}, Num:0}}
018'791 31 S101 after snap shot size767 667
018'791 30 S101 apply index 182 key num 0 type 5   lastApplied 181
018'791 35 S101 apply num 20 migration [0 5]
018'791 31 S101 used size: 767 / 300 
018'791 29 S101 do snapshot for raft 182 182,size 667
018'792 27 S1 raft apply snapshot offset 182 ,lastApplied 183,total log 183, size 593,log cap:2
018'792 27 S1 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:20}, Num:0}}
018'792 31 S101 after snap shot size593 667
018'792 30 S101 apply index 183 key num 0 type 5   lastApplied 182
018'792 35 S101 apply num 20 migration [0 5]
018'792 31 S101 used size: 593 / 300 
018'794 30 S201 after send shards ok
018'794 29 S101 do snapshot for raft 183 183,size 667
018'794 27 S1 raft apply snapshot offset 183 ,lastApplied 183,total log 183, size 86,log cap:1
018'795 31 S101 after snap shot size86 667
018'795 35 S200 current config num 20 done
018'796 30 S202 after send shards ok
018'796 35 S202 num 20 move [6] is done yet
018'797 35 S102 num 20 handle num 20 move rpc [0 5]
018'797 35 S102 num 20 move [0 5] is done yet
018'775 35 S300 current config num 20 done
018'799 35 S102 num 20 handle num 20 move rpc [0 5]
018'799 35 S102 num 20 move [0 5] is done yet
018'800 30 S200 after send shards ok
018'800 35 S200 num 20 move [0 5] is done yet
018'780 35 S100 current config num 20 done
018'800 35 S100 num 20 handle num 20 move rpc [0 5]
018'800 35 S100 num 20 move [0 5] is done yet
018'802 30 S202 after send shards ok
018'802 35 S202 num 20 move [0 5] is done yet
018'780 35 S302 current config num 20 done
018'804 35 S100 num 20 handle num 20 move rpc [0 5]
018'804 35 S100 num 20 move [0 5] is done yet
018'804 29 S202 recv Installsnapshot 95 92
018'805 27 S2 raft apply snapshot offset 95 ,lastApplied 95,total log 95, size 84,log cap:1
018'805 29 S202 decide Installsnapshot 95 <- 92
018'805 30 S202 install snap index 95,config {20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
018'808 35 S101 num 20 handle num 20 move rpc [0 5]
018'808 35 S101 num 20 move [0 5] is done yet
018'809 30 S200 after send shards ok
018'809 35 S200 num 20 move [0 5] is done yet
018'809 30 S101 after send shards ok
018'810 34 S101 check new config wanted 21
018'810 30 S101 after send shards ok
018'811 35 S101 num 20 handle num 20 move rpc [0 5]
018'811 35 S101 num 20 move [0 5] is done yet
018'794 35 S201 num 20 move [0 5] is done yet
018'812 35 S101 current config num 20 done
018'812 30 S201 after send shards ok
018'812 35 S201 num 20 move [0 5] is done yet
018'812 35 S201 current config num 20 done
018'812 30 S201 after send shards ok
018'812 35 S201 num 20 move [0 5] is done yet
018'815 35 S102 current config num 20 done
018'815 35 S301 current config num 20 done
018'823 30 S200 apply index 95 key num 0 type 5   lastApplied 94
018'823 35 S200 apply num 20 migration [0 5]
018'823 31 S200 used size: 765 / 300 
018'824 29 S200 do snapshot for raft 95 95,size 455
018'824 27 S0 raft apply snapshot offset 95 ,lastApplied 96,total log 96, size 591,log cap:2
018'824 27 S0 last applied not snapshoted raft.LogEntry{Term:10, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:0, State:shardkv.ShardState{KVmap:map[string]string{"2":"zk1EViIbur3mFzY3e5LB28AL83aBS"}, NextSeq:map[int64]int{1679014388048817729:28, 2079820695267196558:3}}}, shardkv.ShardIndexed{ShardIndex:5, State:shardkv.ShardState{KVmap:map[string]string{"7":"8WvG-aC2PazR"}, NextSeq:map[int64]int{2079820695267196558:8, 2972145661651991667:11}}}}, Num:20}, Num:0}}
018'825 31 S200 after snap shot size591 455
018'825 30 S200 apply index 96 key num 0 type 5   lastApplied 95
018'825 35 S200 apply num 20 migration [0 5]
018'825 31 S200 used size: 591 / 300 
018'825 29 S200 do snapshot for raft 96 96,size 455
018'825 27 S0 raft apply snapshot offset 96 ,lastApplied 96,total log 96, size 84,log cap:1
018'826 31 S200 after snap shot size84 455
018'830 35 S100 num 20 handle num 20 move rpc [0 5]
018'830 35 S100 num 20 move [0 5] is done yet
018'831 30 S200 after send shards ok
018'831 35 S200 num 20 move [0 5] is done yet
018'833 30 S200 after send shards ok
018'833 35 S200 num 20 move [0 5] is done yet
018'842 35 S202 current config num 20 done
018'847 35 S200 current config num 20 done
018'849 35 S300 current config num 20 done
018'852 35 S100 current config num 20 done
018'856 35 S302 current config num 20 done
018'873 35 S301 current config num 20 done
018'873 35 S102 current config num 20 done
018'873 35 S101 current config num 20 done
018'874 35 S201 current config num 20 done
018'892 35 S202 current config num 20 done
018'903 35 S100 current config num 20 done
018'904 35 S200 current config num 20 done
018'905 35 S300 current config num 20 done
018'906 35 S302 current config num 20 done
018'923 35 S301 current config num 20 done
018'923 35 S102 current config num 20 done
018'926 35 S201 current config num 20 done
018'926 35 S101 current config num 20 done
018'954 35 S100 current config num 20 done
018'955 35 S300 current config num 20 done
018'956 35 S202 current config num 20 done
018'956 35 S200 current config num 20 done
018'974 35 S302 current config num 20 done
018'976 35 S301 current config num 20 done
018'976 35 S102 current config num 20 done
018'977 35 S201 current config num 20 done
018'977 35 S101 current config num 20 done
019'025 35 S302 current config num 20 done
019'031 35 S102 current config num 20 done
019'032 35 S301 current config num 20 done
019'032 35 S201 current config num 20 done
019'032 35 S101 current config num 20 done
019'076 35 S302 current config num 20 done
019'037 35 S100 current config num 20 done
019'037 35 S300 current config num 20 done
019'037 35 S200 current config num 20 done
019'037 35 S202 current config num 20 done
019'110 35 S102 current config num 20 done
019'110 35 S301 current config num 20 done
019'133 29 S202 recv Installsnapshot 96 95
019'134 27 S2 raft apply snapshot offset 96 ,lastApplied 96,total log 96, size 84,log cap:1
019'134 29 S202 decide Installsnapshot 96 <- 95
019'135 30 S202 install snap index 96,config {20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
 pending shards [false false false false false false false false false false]
019'136 35 S302 current config num 20 done
019'137 34 S200 got new config {20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 19
019'143 35 S100 current config num 20 done
019'143 35 S300 current config num 20 done
019'143 35 S200 current config num 20 done
019'143 35 S202 current config num 20 done
019'151 35 S201 current config num 20 done
019'151 35 S101 current config num 20 done
019'163 35 S301 current config num 20 done
019'163 35 S102 current config num 20 done
019'187 35 S302 current config num 20 done
019'197 34 S202 got new config {20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 19
019'213 35 S301 current config num 20 done
019'213 35 S102 current config num 20 done
019'204 35 S300 current config num 20 done
019'204 35 S200 current config num 20 done
019'204 35 S202 current config num 20 done
019'204 35 S100 current config num 20 done
019'204 35 S201 current config num 20 done
019'204 35 S101 current config num 20 done
019'240 28 S100 do request args:Key 6 type 3 num 21 Client 542732653461723544 Seq 4 
019'240 28 S100 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
019'247 34 S200 check new config wanted 21
019'256 35 S302 current config num 20 done
019'270 35 S301 current config num 20 done
019'270 35 S102 current config num 20 done
019'282 35 S101 current config num 20 done
019'282 35 S300 current config num 20 done
019'282 35 S202 current config num 20 done
019'282 35 S200 current config num 20 done
019'282 35 S201 current config num 20 done
019'282 35 S100 current config num 20 done
019'284 34 S102 got new config {20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 19
019'288 28 S100 do request args:Key 5 type 3 num 21 Client 3482757038087095369 Seq 5 
019'288 28 S100 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
019'290 28 S100 do request args:Key 1 type 3 num 21 Client 418781717203629479 Seq 23 
019'290 28 S100 [479--23] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
019'292 28 S100 do request args:Key 8 type 3 num 21 Client 2953714763196401582 Seq 2 
019'292 28 S100 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
019'293 28 S100 do request args:Key 2 type 3 num 21 Client 1679014388048817729 Seq 27 
019'293 28 S100 [729--27] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
019'301 34 S202 check new config wanted 21
019'307 34 S302 got new config {20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 19
019'309 28 S100 do request args:Key 7 type 3 num 21 Client 2972145661651991667 Seq 11 
019'310 28 S100 [667--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
019'310 35 S302 current config num 20 done
019'314 34 S300 got new config {20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 19
019'320 35 S301 current config num 20 done
019'320 35 S102 current config num 20 done
019'346 35 S100 current config num 20 done
019'346 35 S101 current config num 20 done
019'346 35 S202 current config num 20 done
019'347 35 S300 current config num 20 done
019'347 35 S200 current config num 20 done
019'347 35 S201 current config num 20 done
019'372 35 S301 current config num 20 done
019'372 35 S102 current config num 20 done
019'363 35 S302 current config num 20 done
019'376 34 S201 got new config {21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 20
019'376 34 S201 propose new config 21
019'380 28 S100 do request args:Key 9 type 3 num 21 Client 3620950086299709532 Seq 15 
019'380 28 S100 [532--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
019'386 28 S100 do request args:Key 0 type 3 num 21 Client 940626237948413081 Seq 10 
019'386 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
019'399 34 S301 got new config {20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 19
019'400 34 S102 check new config wanted 21
019'406 28 S100 do request args:Key 3 type 3 num 21 Client 2238025532150463055 Seq 8 
019'406 28 S100 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
019'413 34 S302 check new config wanted 21
019'414 30 S201 apply index 97 key num 0 type 4   lastApplied 96
019'414 34 S201 apply new config num 21 :&{21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
019'415 34 S201 inited need send [],need recv []
019'415 31 S201 used size: 418 / 300 
019'415 29 S201 do snapshot for raft 97 97,size 413
019'415 27 S1 raft apply snapshot offset 97 ,lastApplied 97,total log 97, size 84,log cap:1
019'415 31 S201 after snap shot size84 413
019'421 35 S100 current config num 20 done
019'421 35 S101 current config num 20 done
019'422 35 S202 current config num 20 done
019'422 35 S300 current config num 20 done
019'424 35 S302 current config num 20 done
019'429 35 S200 current config num 20 done
019'429 34 S300 check new config wanted 21
019'429 35 S201 current config num 21 done
019'431 30 S200 apply index 97 key num 0 type 4   lastApplied 96
019'432 34 S200 apply new config num 21 :&{21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
019'432 34 S200 inited need send [],need recv []
019'432 31 S200 used size: 418 / 300 
019'432 29 S200 do snapshot for raft 97 97,size 413
019'433 27 S0 raft apply snapshot offset 97 ,lastApplied 97,total log 97, size 84,log cap:1
019'433 31 S200 after snap shot size84 413
019'433 30 S202 apply index 97 key num 0 type 4   lastApplied 96
019'433 34 S202 apply new config num 21 :&{21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
019'433 34 S202 inited need send [],need recv []
019'433 31 S202 used size: 418 / 300 
019'434 29 S202 do snapshot for raft 97 97,size 413
019'434 27 S2 raft apply snapshot offset 97 ,lastApplied 97,total log 97, size 84,log cap:1
019'434 31 S202 after snap shot size84 413
019'440 35 S301 current config num 20 done
019'440 35 S102 current config num 20 done
019'476 35 S302 current config num 20 done
019'476 35 S100 current config num 20 done
019'476 35 S101 current config num 20 done
019'476 35 S202 current config num 21 done
019'476 35 S300 current config num 20 done
019'477 34 S201 check new config wanted 22
019'490 35 S201 current config num 21 done
019'492 35 S200 current config num 21 done
-------wait result---------------
019'528 35 S300 current config num 20 done
019'529 35 S302 current config num 20 done
019'529 35 S100 current config num 20 done
019'529 35 S101 current config num 20 done
019'529 35 S202 current config num 21 done
019'507 34 S301 check new config wanted 21
019'529 35 S301 current config num 20 done
019'513 35 S102 current config num 20 done
019'543 35 S201 current config num 21 done
019'543 35 S200 current config num 21 done
019'590 35 S300 current config num 20 done
019'590 35 S302 current config num 20 done
019'590 35 S100 current config num 20 done
019'590 35 S202 current config num 21 done
019'590 35 S301 current config num 20 done
019'590 35 S101 current config num 20 done
019'590 35 S102 current config num 20 done
019'594 35 S201 current config num 21 done
019'594 35 S200 current config num 21 done
019'637 28 S100 do request args:Key 4 type 3 num 21 Client 132246879705026825 Seq 6 
019'637 28 S100 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
019'640 35 S100 current config num 20 done
019'640 35 S301 current config num 20 done
019'641 35 S102 current config num 20 done
019'648 35 S201 current config num 21 done
019'648 35 S200 current config num 21 done
019'640 35 S101 current config num 20 done
019'640 35 S300 current config num 20 done
019'640 35 S202 current config num 21 done
019'640 35 S302 current config num 20 done
019'691 35 S100 current config num 20 done
019'691 35 S301 current config num 20 done
019'692 35 S102 current config num 20 done
019'702 35 S200 current config num 21 done
019'702 35 S201 current config num 21 done
019'726 35 S101 current config num 20 done
019'727 35 S300 current config num 20 done
019'727 35 S202 current config num 21 done
019'728 35 S302 current config num 20 done
019'749 35 S102 current config num 20 done
019'751 35 S100 current config num 20 done
019'752 35 S301 current config num 20 done
019'753 35 S201 current config num 21 done
019'753 35 S200 current config num 21 done
019'781 35 S302 current config num 20 done
019'781 35 S101 current config num 20 done
019'781 35 S202 current config num 21 done
019'781 35 S300 current config num 20 done
019'800 35 S102 current config num 20 done
019'801 34 S100 got new config {20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} old 19
019'802 35 S100 current config num 20 done
019'802 35 S301 current config num 20 done
019'805 35 S201 current config num 21 done
019'805 35 S200 current config num 21 done
019'832 35 S300 current config num 20 done
019'833 35 S302 current config num 20 done
019'833 35 S101 current config num 20 done
019'837 35 S202 current config num 21 done
019'856 35 S200 current config num 21 done
019'857 35 S102 current config num 20 done
019'857 35 S100 current config num 20 done
019'857 35 S301 current config num 20 done
019'857 35 S201 current config num 21 done
019'884 35 S300 current config num 20 done
019'895 35 S202 current config num 21 done
019'896 35 S302 current config num 20 done
019'896 35 S101 current config num 20 done
019'902 34 S100 check new config wanted 21
019'908 35 S301 current config num 20 done
019'908 35 S200 current config num 21 done
019'908 35 S102 current config num 20 done
019'908 35 S100 current config num 20 done
019'908 35 S201 current config num 21 done
019'935 35 S300 current config num 20 done
019'957 35 S202 current config num 21 done
019'958 35 S101 current config num 20 done
019'958 35 S302 current config num 20 done
019'958 35 S301 current config num 20 done
019'958 35 S100 current config num 20 done
019'959 35 S200 current config num 21 done
019'962 35 S102 current config num 20 done
019'962 35 S201 current config num 21 done
019'992 34 S101 got new config {21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 20
020'002 35 S300 current config num 20 done
020'042 35 S102 current config num 20 done
020'042 35 S201 current config num 21 done
020'043 35 S100 current config num 20 done
020'043 35 S202 current config num 21 done
020'043 35 S101 current config num 20 done
020'043 35 S302 current config num 20 done
020'045 35 S301 current config num 20 done
020'047 35 S200 current config num 21 done
020'062 35 S300 current config num 20 done
020'093 34 S101 check new config wanted 21
020'094 35 S302 current config num 20 done
020'094 35 S102 current config num 20 done
020'094 35 S201 current config num 21 done
020'094 35 S202 current config num 21 done
020'094 35 S101 current config num 20 done
020'094 35 S100 current config num 20 done
020'095 35 S301 current config num 20 done
020'100 35 S200 current config num 21 done
020'121 35 S300 current config num 20 done
020'153 35 S301 current config num 20 done
020'154 35 S302 current config num 20 done
020'154 35 S201 current config num 21 done
020'154 35 S202 current config num 21 done
020'154 35 S101 current config num 20 done
020'154 35 S100 current config num 20 done
020'154 35 S102 current config num 20 done
020'155 35 S200 current config num 21 done
020'173 35 S300 current config num 20 done
020'173 34 S202 got new config {21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 20
020'175 34 S200 got new config {21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 20
020'177 34 S102 got new config {21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 20
020'201 28 S100 do request args:Key 6 type 3 num 21 Client 542732653461723544 Seq 4 
020'201 28 S100 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
020'231 35 S300 current config num 20 done
020'237 28 S100 do request args:Key 5 type 3 num 21 Client 3482757038087095369 Seq 5 
020'237 28 S100 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
020'237 35 S301 current config num 20 done
020'238 35 S302 current config num 20 done
020'238 35 S201 current config num 21 done
020'238 35 S101 current config num 20 done
020'238 35 S100 current config num 20 done
020'238 35 S102 current config num 20 done
020'238 35 S202 current config num 21 done
020'238 35 S200 current config num 21 done
020'262 28 S100 do request args:Key 2 type 3 num 21 Client 1679014388048817729 Seq 27 
020'262 28 S100 [729--27] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
020'274 34 S301 got new config {21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 20
020'275 34 S301 propose new config 21
020'275 28 S100 do request args:Key 9 type 3 num 21 Client 3620950086299709532 Seq 15 
020'275 28 S100 [532--15] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
020'276 28 S100 do request args:Key 3 type 3 num 21 Client 2238025532150463055 Seq 8 
020'276 28 S100 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
020'281 34 S202 check new config wanted 22
020'289 30 S301 apply index 71 key num 0 type 4   lastApplied 70
020'289 35 S202 current config num 21 done
020'289 34 S301 apply new config num 21 :&{21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
020'289 34 S301 inited need send [1 2 3 4 6],need recv []
020'289 31 S301 used size: 418 / 300 
020'290 29 S301 do snapshot for raft 71 71,size 559
020'290 27 S1 raft apply snapshot offset 71 ,lastApplied 71,total log 71, size 84,log cap:1
020'290 31 S301 after snap shot size84 559
020'292 35 S100 current config num 20 done
020'306 28 S100 do request args:Key 1 type 3 num 21 Client 418781717203629479 Seq 23 
020'307 28 S100 [479--23] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
020'289 35 S302 current config num 20 done
020'289 35 S201 current config num 21 done
020'289 35 S101 current config num 20 done
020'289 35 S102 current config num 20 done
020'308 35 S301 num 21 sending shards [1 2 3 4 6] to group 100
020'309 28 S100 do request args:Key 0 type 3 num 21 Client 940626237948413081 Seq 10 
020'309 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
020'309 34 S102 check new config wanted 21
020'291 34 S200 check new config wanted 22
020'291 35 S300 current config num 20 done
020'310 35 S200 current config num 21 done
020'316 35 S100 num 20 handle num 21 move rpc [1 2 3 4 6]
020'323 35 S101 num 20 handle num 21 move rpc [1 2 3 4 6]
020'325 35 S102 num 20 handle num 21 move rpc [1 2 3 4 6]
020'337 34 S302 got new config {21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 20
020'339 34 S201 check new config wanted 22
020'343 35 S202 current config num 21 done
020'347 35 S301 num 21 sending shards [1 2 3 4 6] to group 100
020'347 35 S100 current config num 20 done
020'348 35 S100 num 20 handle num 21 move rpc [1 2 3 4 6]
020'351 35 S101 num 20 handle num 21 move rpc [1 2 3 4 6]
020'354 35 S102 num 20 handle num 21 move rpc [1 2 3 4 6]
020'362 35 S300 current config num 20 done
020'362 35 S200 current config num 21 done
020'363 35 S102 current config num 20 done
020'363 35 S302 current config num 20 done
020'363 35 S201 current config num 21 done
020'363 35 S101 current config num 20 done
020'375 34 S301 check new config wanted 22
020'378 35 S301 num 21 sending shards [1 2 3 4 6] to group 100
020'380 35 S100 num 20 handle num 21 move rpc [1 2 3 4 6]
020'382 35 S101 num 20 handle num 21 move rpc [1 2 3 4 6]
020'384 35 S102 num 20 handle num 21 move rpc [1 2 3 4 6]
020'422 34 S300 got new config {21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 20
020'418 35 S202 current config num 21 done
020'420 35 S200 current config num 21 done
020'420 35 S302 current config num 20 done
020'420 35 S201 current config num 21 done
020'420 35 S101 current config num 20 done
020'420 35 S102 current config num 20 done
020'449 34 S100 got new config {21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 20
020'453 30 S302 apply index 71 key num 0 type 4   lastApplied 70
020'453 34 S302 apply new config num 21 :&{21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
020'459 35 S301 num 21 sending shards [1 2 3 4 6] to group 100
020'420 35 S300 current config num 20 done
020'420 35 S100 current config num 20 done
020'460 28 S100 do request args:Key 7 type 3 num 21 Client 2972145661651991667 Seq 11 
020'460 28 S100 [667--11] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
020'461 34 S100 propose new config 21
020'461 28 S100 do request args:Key 4 type 3 num 21 Client 132246879705026825 Seq 6 
020'461 28 S100 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
020'462 30 S300 apply index 71 key num 0 type 4   lastApplied 70
020'462 34 S300 apply new config num 21 :&{21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
020'463 34 S300 inited need send [1 2 3 4 6],need recv []
020'463 31 S300 used size: 418 / 300 
020'468 29 S300 do snapshot for raft 71 71,size 559
020'469 27 S0 raft apply snapshot offset 71 ,lastApplied 71,total log 71, size 84,log cap:1
020'469 31 S300 after snap shot size84 559
020'453 34 S302 inited need send [1 2 3 4 6],need recv []
020'472 31 S302 used size: 418 / 300 
020'473 29 S302 do snapshot for raft 71 71,size 559
020'473 27 S2 raft apply snapshot offset 71 ,lastApplied 71,total log 71, size 84,log cap:1
020'473 31 S302 after snap shot size84 559
020'473 34 S302 check new config wanted 22
020'475 35 S100 num 20 handle num 21 move rpc [1 2 3 4 6]
020'477 28 S100 do request args:Key 8 type 3 num 21 Client 2953714763196401582 Seq 2 
020'477 28 S100 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"ErrWrongGroup"}
020'480 35 S202 current config num 21 done
020'480 35 S200 current config num 21 done
020'483 35 S101 num 20 handle num 21 move rpc [1 2 3 4 6]
020'493 34 S101 got new config {21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 20
020'506 30 S100 apply index 184 key num 0 type 4   lastApplied 183
020'506 34 S100 apply new config num 21 :&{21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
020'507 34 S100 inited need send [],need recv [1 2 3 4 6]
020'512 31 S100 used size: 420 / 300 
020'513 29 S100 do snapshot for raft 184 184,size 625
020'513 27 S0 raft apply snapshot offset 184 ,lastApplied 184,total log 184, size 86,log cap:1
020'513 31 S100 after snap shot size86 625
020'507 35 S301 num 21 sending shards [1 2 3 4 6] to group 100
020'507 35 S201 current config num 21 done
020'507 35 S302 num 21 sending shards [1 2 3 4 6] to group 100
020'507 35 S102 current config num 20 done
020'507 35 S101 current config num 20 done
020'528 35 S300 num 21 sending shards [1 2 3 4 6] to group 100
020'529 35 S100 num 21 waiting [1 2 3 4 6] shards 
020'531 35 S100 num 21 handle num 21 move rpc [1 2 3 4 6]
020'532 35 S100 move handle num 21 shards [1 2 3 4 6] as leader?
020'532 35 S100 num 21 handle num 21 move rpc [1 2 3 4 6]
020'533 35 S100 move handle num 21 shards [1 2 3 4 6] as leader?
020'533 35 S100 num 21 handle num 21 move rpc [1 2 3 4 6]
020'535 35 S100 move handle num 21 shards [1 2 3 4 6] as leader?
020'535 35 S102 num 20 handle num 21 move rpc [1 2 3 4 6]
020'540 35 S200 current config num 21 done
020'540 35 S202 current config num 21 done
020'545 30 S101 apply index 184 key num 0 type 4   lastApplied 183
020'545 34 S101 apply new config num 21 :&{21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 old :{20 [100 102 102 102 102 100 102 100 100 100] map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}
020'545 34 S101 inited need send [],need recv [1 2 3 4 6]
020'546 31 S101 used size: 1460 / 300 
020'546 29 S101 do snapshot for raft 184 184,size 625
020'547 27 S1 raft apply snapshot offset 184 ,lastApplied 184,total log 187, size 1206,log cap:4
020'547 31 S101 after snap shot size1206 625
020'548 30 S100 apply index 185 key num 0 type 5   lastApplied 184
020'548 35 S100 apply num 21 migration [1 2 3 4 6]
020'548 30 S100 safely recv and decided shard 1
020'548 30 S100 safely recv and decided shard 2
020'548 30 S100 safely recv and decided shard 3
020'548 30 S100 safely recv and decided shard 4
020'548 30 S100 safely recv and decided shard 6
020'548 31 S100 used size: 1206 / 300 
020'557 29 S100 do snapshot for raft 185 185,size 770
020'558 27 S0 raft apply snapshot offset 185 ,lastApplied 187,total log 187, size 944,log cap:3
020'558 27 S0 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:21}, Num:0}}
020'558 31 S100 after snap shot size944 770
020'558 30 S100 apply index 186 key num 0 type 5   lastApplied 185
020'558 35 S100 apply num 21 migration [1 2 3 4 6]
020'558 31 S100 used size: 944 / 300 
020'559 29 S100 do snapshot for raft 186 186,size 770
020'560 27 S0 raft apply snapshot offset 186 ,lastApplied 187,total log 187, size 682,log cap:2
020'560 27 S0 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:21}, Num:0}}
020'560 31 S100 after snap shot size682 770
020'560 30 S100 apply index 187 key num 0 type 5   lastApplied 186
020'560 35 S100 apply num 21 migration [1 2 3 4 6]
020'560 31 S100 used size: 682 / 300 
020'561 29 S100 do snapshot for raft 187 187,size 770
020'561 27 S0 raft apply snapshot offset 187 ,lastApplied 187,total log 187, size 86,log cap:1
020'561 31 S100 after snap shot size86 770
020'561 34 S300 check new config wanted 22
020'562 34 S100 check new config wanted 22
020'562 35 S301 num 21 sending shards [1 2 3 4 6] to group 100
020'562 35 S100 num 21 move [1 2 3 4 6] is done yet
020'562 35 S302 num 21 sending shards [1 2 3 4 6] to group 100
020'563 35 S100 num 21 move [1 2 3 4 6] is done yet
020'571 30 S300 after send shards ok
020'571 35 S300 move delete propose not leader
020'578 35 S101 num 21 waiting [1 2 3 4 6] shards 
020'578 35 S100 num 21 move [1 2 3 4 6] is done yet
020'578 35 S300 num 21 sending shards [1 2 3 4 6] to group 100
020'580 30 S301 after send shards ok
020'581 35 S301 move delete propose num 21 shards [1 2 3 4 6] as leader?
020'581 35 S201 current config num 21 done
020'585 35 S100 num 21 handle num 21 move rpc [1 2 3 4 6]
020'585 35 S100 num 21 move [1 2 3 4 6] is done yet
020'585 29 S102 recv Installsnapshot 187 183
020'586 27 S2 raft apply snapshot offset 187 ,lastApplied 187,total log 187, size 86,log cap:1
020'586 29 S102 decide Installsnapshot 187 <- 183
020'587 30 S102 install snap index 187,config {21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]}
 pending shards [false false false false false false false false false false]
020'589 35 S102 current config num 21 done
020'590 30 S302 after send shards ok
020'590 35 S302 move delete propose not leader
020'592 35 S100 current config num 21 done
020'593 35 S202 current config num 21 done
020'594 35 S200 current config num 21 done
020'602 30 S301 after send shards ok
020'607 35 S301 move delete propose num 21 shards [1 2 3 4 6] as leader?
020'610 35 S100 num 21 handle num 21 move rpc [1 2 3 4 6]
020'610 35 S100 num 21 move [1 2 3 4 6] is done yet
020'611 30 S300 after send shards ok
020'611 35 S300 move delete propose not leader
020'612 35 S301 num 21 sending shards [1 2 3 4 6] to group 100
020'616 35 S300 num 21 sending shards [1 2 3 4 6] to group 100
020'618 35 S100 num 21 handle num 21 move rpc [1 2 3 4 6]
020'619 35 S100 num 21 move [1 2 3 4 6] is done yet
020'619 30 S302 after send shards ok
020'619 35 S302 move delete propose not leader
020'621 35 S302 num 21 sending shards [1 2 3 4 6] to group 100
020'622 34 S101 check new config wanted 22
020'628 35 S101 num 21 waiting [1 2 3 4 6] shards 
020'629 30 S101 apply index 185 key num 0 type 5   lastApplied 184
020'629 35 S101 apply num 21 migration [1 2 3 4 6]
020'629 30 S101 safely recv and decided shard 1
020'630 30 S101 safely recv and decided shard 2
020'630 30 S101 safely recv and decided shard 3
020'630 30 S101 safely recv and decided shard 4
020'630 30 S101 safely recv and decided shard 6
020'630 31 S101 used size: 1206 / 300 
020'631 29 S101 do snapshot for raft 185 185,size 770
020'635 34 S202 check new config wanted 22
020'635 35 S201 current config num 21 done
020'637 27 S1 raft apply snapshot offset 185 ,lastApplied 187,total log 187, size 944,log cap:3
020'637 27 S1 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:21}, Num:0}}
020'637 31 S101 after snap shot size944 770
020'638 30 S101 apply index 186 key num 0 type 5   lastApplied 185
020'638 35 S101 apply num 21 migration [1 2 3 4 6]
020'638 31 S101 used size: 944 / 300 
020'638 29 S101 do snapshot for raft 186 186,size 770
020'639 27 S1 raft apply snapshot offset 186 ,lastApplied 187,total log 187, size 682,log cap:2
020'639 27 S1 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:21}, Num:0}}
020'640 31 S101 after snap shot size682 770
020'640 30 S101 apply index 187 key num 0 type 5   lastApplied 186
020'640 35 S101 apply num 21 migration [1 2 3 4 6]
020'640 31 S101 used size: 682 / 300 
020'640 29 S101 do snapshot for raft 187 187,size 770
020'641 27 S1 raft apply snapshot offset 187 ,lastApplied 187,total log 187, size 86,log cap:1
020'641 31 S101 after snap shot size86 770
020'641 35 S102 current config num 21 done
020'642 35 S100 current config num 21 done
020'643 35 S301 num 21 sending shards [1 2 3 4 6] to group 100
020'645 35 S100 num 21 handle num 21 move rpc [1 2 3 4 6]
020'645 35 S100 num 21 move [1 2 3 4 6] is done yet
020'646 30 S301 after send shards ok
020'647 35 S301 move delete propose num 21 shards [1 2 3 4 6] as leader?
020'648 35 S300 num 21 sending shards [1 2 3 4 6] to group 100
020'649 35 S200 current config num 21 done
020'649 35 S202 current config num 21 done
020'649 35 S100 num 21 handle num 21 move rpc [1 2 3 4 6]
020'649 35 S100 num 21 move [1 2 3 4 6] is done yet
020'650 35 S100 num 21 handle num 21 move rpc [1 2 3 4 6]
020'650 35 S100 num 21 move [1 2 3 4 6] is done yet
020'652 30 S302 after send shards ok
020'652 35 S302 move delete propose not leader
020'653 35 S302 num 21 sending shards [1 2 3 4 6] to group 100
020'654 30 S300 after send shards ok
020'654 35 S300 move delete propose not leader
020'664 30 S301 apply index 72 key num 0 type 5   lastApplied 71
020'664 35 S301 apply num 21 migration [1 2 3 4 6]
020'664 30 S301 safely delete shard 1
020'664 30 S301 safely delete shard 2
020'664 30 S301 safely delete shard 3
020'664 30 S301 safely delete shard 4
020'664 30 S301 safely delete shard 6
020'664 31 S301 used size: 1204 / 300 
020'668 35 S100 num 21 handle num 21 move rpc [1 2 3 4 6]
020'668 35 S100 num 21 move [1 2 3 4 6] is done yet
020'677 29 S301 do snapshot for raft 72 72,size 413
020'679 35 S100 num 21 handle num 21 move rpc [1 2 3 4 6]
020'679 35 S100 num 21 move [1 2 3 4 6] is done yet
020'681 35 S100 num 21 handle num 21 move rpc [1 2 3 4 6]
020'681 35 S100 num 21 move [1 2 3 4 6] is done yet
020'682 30 S300 after send shards ok
020'682 35 S300 move delete propose not leader
020'682 27 S1 raft apply snapshot offset 72 ,lastApplied 73,total log 74, size 942,log cap:3
020'683 27 S1 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:21}, Num:0}}
020'683 31 S301 after snap shot size942 413
020'683 30 S301 apply index 73 key num 0 type 5   lastApplied 72
020'683 35 S301 apply num 21 migration [1 2 3 4 6]
020'683 31 S301 used size: 942 / 300 
020'684 29 S301 do snapshot for raft 73 73,size 413
020'685 27 S1 raft apply snapshot offset 73 ,lastApplied 73,total log 74, size 680,log cap:2
020'685 31 S301 after snap shot size680 413
020'686 30 S301 after send shards ok
020'687 35 S301 num 21 move [1 2 3 4 6] is done yet
020'687 35 S300 num 21 sending shards [1 2 3 4 6] to group 100
020'693 35 S100 num 21 handle num 21 move rpc [1 2 3 4 6]
020'693 35 S100 num 21 move [1 2 3 4 6] is done yet
020'695 30 S302 after send shards ok
020'695 35 S302 move delete propose not leader
020'699 35 S202 current config num 21 done
020'699 35 S200 current config num 21 done
020'703 35 S100 current config num 21 done
020'703 35 S301 current config num 21 done
020'704 35 S101 current config num 21 done
020'704 35 S302 num 21 sending shards [1 2 3 4 6] to group 100
020'704 30 S301 apply index 74 key num 0 type 5   lastApplied 73
020'704 35 S301 apply num 21 migration [1 2 3 4 6]
020'704 31 S301 used size: 680 / 300 
020'704 35 S201 current config num 21 done
020'704 35 S102 current config num 21 done
020'705 30 S300 after send shards ok
020'705 35 S300 move delete propose not leader
020'708 29 S301 do snapshot for raft 74 74,size 413
020'709 27 S1 raft apply snapshot offset 74 ,lastApplied 74,total log 74, size 84,log cap:1
020'709 31 S301 after snap shot size84 413
020'712 35 S100 num 21 handle num 21 move rpc [1 2 3 4 6]
020'712 35 S100 num 21 move [1 2 3 4 6] is done yet
020'713 30 S302 after send shards ok
020'713 35 S302 move delete propose not leader
020'721 35 S300 num 21 sending shards [1 2 3 4 6] to group 100
020'723 35 S100 num 21 handle num 21 move rpc [1 2 3 4 6]
020'723 35 S100 num 21 move [1 2 3 4 6] is done yet
020'724 30 S300 after send shards ok
020'724 35 S300 move delete propose not leader
020'729 30 S302 apply index 72 key num 0 type 5   lastApplied 71
020'729 35 S302 apply num 21 migration [1 2 3 4 6]
020'729 30 S302 safely delete shard 1
020'729 30 S302 safely delete shard 2
020'729 30 S302 safely delete shard 3
020'729 30 S302 safely delete shard 4
020'729 30 S302 safely delete shard 6
020'729 31 S302 used size: 1204 / 300 
020'730 29 S302 do snapshot for raft 72 72,size 413
020'731 27 S2 raft apply snapshot offset 72 ,lastApplied 73,total log 74, size 942,log cap:3
020'731 27 S2 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:21}, Num:0}}
020'733 31 S302 after snap shot size942 413
020'733 30 S302 apply index 73 key num 0 type 5   lastApplied 72
020'733 35 S302 apply num 21 migration [1 2 3 4 6]
020'733 31 S302 used size: 942 / 300 
020'734 29 S302 do snapshot for raft 73 73,size 413
020'734 27 S2 raft apply snapshot offset 73 ,lastApplied 73,total log 74, size 680,log cap:2
020'734 31 S302 after snap shot size680 413
020'734 35 S302 current config num 21 done
020'740 30 S302 apply index 74 key num 0 type 5   lastApplied 73
020'740 35 S302 apply num 21 migration [1 2 3 4 6]
020'740 31 S302 used size: 680 / 300 
020'741 29 S302 do snapshot for raft 74 74,size 413
020'741 30 S300 apply index 72 key num 0 type 5   lastApplied 71
020'741 35 S300 apply num 21 migration [1 2 3 4 6]
020'741 30 S300 safely delete shard 1
020'741 30 S300 safely delete shard 2
020'741 30 S300 safely delete shard 3
020'741 30 S300 safely delete shard 4
020'741 30 S300 safely delete shard 6
020'741 31 S300 used size: 1204 / 300 
020'742 29 S300 do snapshot for raft 72 72,size 413
020'743 27 S0 raft apply snapshot offset 72 ,lastApplied 74,total log 74, size 942,log cap:3
020'743 27 S0 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:21}, Num:0}}
020'743 31 S300 after snap shot size942 413
020'743 30 S300 apply index 73 key num 0 type 5   lastApplied 72
020'743 35 S300 apply num 21 migration [1 2 3 4 6]
020'743 31 S300 used size: 942 / 300 
020'744 29 S300 do snapshot for raft 73 73,size 413
020'744 27 S0 raft apply snapshot offset 73 ,lastApplied 74,total log 74, size 680,log cap:2
020'745 27 S0 last applied not snapshoted raft.LogEntry{Term:7, Command:shardkv.Command{Key:"", ClientID:0, Seq:0, OptType:5, Opt:shardkv.SendShardsArgs{Shards:[]shardkv.ShardIndexed{shardkv.ShardIndexed{ShardIndex:1, State:shardkv.ShardState{KVmap:map[string]string{"3":"9CP5BEMRv"}, NextSeq:map[int64]int{2079820695267196558:4, 2238025532150463055:8}}}, shardkv.ShardIndexed{ShardIndex:2, State:shardkv.ShardState{KVmap:map[string]string{"4":"c3kdHX-"}, NextSeq:map[int64]int{132246879705026825:6, 2079820695267196558:5}}}, shardkv.ShardIndexed{ShardIndex:3, State:shardkv.ShardState{KVmap:map[string]string{"5":"CiEPcn"}, NextSeq:map[int64]int{2079820695267196558:6, 3482757038087095369:5}}}, shardkv.ShardIndexed{ShardIndex:4, State:shardkv.ShardState{KVmap:map[string]string{"6":"wApPR"}, NextSeq:map[int64]int{542732653461723544:4, 2079820695267196558:7}}}, shardkv.ShardIndexed{ShardIndex:6, State:shardkv.ShardState{KVmap:map[string]string{"8":"vHj"}, NextSeq:map[int64]int{2079820695267196558:9, 2953714763196401582:2}}}}, Num:21}, Num:0}}
020'745 31 S300 after snap shot size680 413
020'745 30 S300 apply index 74 key num 0 type 5   lastApplied 73
020'745 35 S300 apply num 21 migration [1 2 3 4 6]
020'745 31 S300 used size: 680 / 300 
020'746 29 S300 do snapshot for raft 74 74,size 413
020'746 27 S0 raft apply snapshot offset 74 ,lastApplied 74,total log 74, size 84,log cap:1
020'746 31 S300 after snap shot size84 413
020'751 35 S200 current config num 21 done
020'751 35 S202 current config num 21 done
020'752 35 S300 current config num 21 done
020'741 27 S2 raft apply snapshot offset 74 ,lastApplied 74,total log 74, size 84,log cap:1
020'752 31 S302 after snap shot size84 413
020'757 35 S201 current config num 21 done
020'757 35 S100 current config num 21 done
020'757 35 S101 current config num 21 done
020'757 35 S301 current config num 21 done
020'757 35 S102 current config num 21 done
020'786 35 S302 current config num 21 done
020'808 35 S200 current config num 21 done
020'809 35 S202 current config num 21 done
020'809 35 S300 current config num 21 done
020'809 35 S102 current config num 21 done
020'810 35 S100 current config num 21 done
020'810 35 S201 current config num 21 done
020'810 35 S101 current config num 21 done
020'810 35 S301 current config num 21 done
020'819 34 S102 got new config {21 [100 100 100 100 100 100 100 100 100 100] map[100:[server-100-0 server-100-1 server-100-2]]} old 20
020'842 35 S302 current config num 21 done
020'862 35 S301 current config num 21 done
020'862 35 S200 current config num 21 done
020'862 35 S202 current config num 21 done
020'862 35 S300 current config num 21 done
020'862 35 S102 current config num 21 done
020'862 35 S100 current config num 21 done
020'862 35 S201 current config num 21 done
020'862 35 S101 current config num 21 done
020'909 35 S302 current config num 21 done
020'913 35 S201 current config num 21 done
020'913 35 S301 current config num 21 done
020'913 35 S202 current config num 21 done
020'913 35 S300 current config num 21 done
020'913 35 S102 current config num 21 done
020'913 35 S200 current config num 21 done
020'913 35 S100 current config num 21 done
020'913 35 S101 current config num 21 done
020'922 34 S102 check new config wanted 22
020'940 34 S201 check new config wanted 22
020'959 35 S302 current config num 21 done
020'963 35 S201 current config num 21 done
020'963 35 S301 current config num 21 done
020'963 35 S202 current config num 21 done
020'963 35 S300 current config num 21 done
020'963 35 S102 current config num 21 done
020'963 35 S200 current config num 21 done
020'963 35 S100 current config num 21 done
020'964 35 S101 current config num 21 done
021'015 35 S101 current config num 21 done
021'015 35 S201 current config num 21 done
021'015 35 S301 current config num 21 done
021'015 35 S302 current config num 21 done
021'015 35 S300 current config num 21 done
021'015 35 S202 current config num 21 done
021'015 35 S102 current config num 21 done
021'015 35 S100 current config num 21 done
021'015 35 S200 current config num 21 done
021'065 35 S300 current config num 21 done
021'065 35 S201 current config num 21 done
021'065 35 S101 current config num 21 done
021'065 35 S301 current config num 21 done
021'065 35 S302 current config num 21 done
021'065 35 S200 current config num 21 done
021'065 35 S202 current config num 21 done
021'065 35 S102 current config num 21 done
021'065 35 S100 current config num 21 done
021'130 35 S201 current config num 21 done
021'131 35 S300 current config num 21 done
021'131 35 S101 current config num 21 done
021'131 35 S301 current config num 21 done
021'131 35 S200 current config num 21 done
021'131 35 S302 current config num 21 done
021'131 35 S102 current config num 21 done
021'131 35 S202 current config num 21 done
021'131 35 S100 current config num 21 done
021'183 35 S101 current config num 21 done
021'185 35 S201 current config num 21 done
021'185 35 S300 current config num 21 done
021'188 35 S302 current config num 21 done
021'188 35 S301 current config num 21 done
021'188 35 S200 current config num 21 done
021'188 35 S202 current config num 21 done
021'188 35 S102 current config num 21 done
021'188 35 S100 current config num 21 done
021'233 35 S101 current config num 21 done
021'264 35 S100 current config num 21 done
021'264 35 S201 current config num 21 done
021'264 35 S300 current config num 21 done
021'264 35 S302 current config num 21 done
021'264 35 S301 current config num 21 done
021'264 35 S202 current config num 21 done
021'264 35 S102 current config num 21 done
021'264 35 S200 current config num 21 done
021'271 28 S100 do request args:Key 2 type 3 num 21 Client 1679014388048817729 Seq 27 
021'271 28 S100 [729--27] successed
021'271 28 S100 [729--27] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
021'271 36 S729 [27] clerk putAppend okkkkk
021'299 35 S101 current config num 21 done
021'316 35 S202 current config num 21 done
021'316 35 S100 current config num 21 done
021'316 35 S300 current config num 21 done
021'316 35 S302 current config num 21 done
021'316 35 S201 current config num 21 done
021'316 35 S301 current config num 21 done
021'316 35 S102 current config num 21 done
021'316 35 S200 current config num 21 done
021'383 35 S101 current config num 21 done
021'383 35 S202 current config num 21 done
021'383 35 S300 current config num 21 done
021'383 35 S302 current config num 21 done
021'383 35 S100 current config num 21 done
021'383 35 S201 current config num 21 done
021'383 35 S102 current config num 21 done
021'383 35 S200 current config num 21 done
021'384 35 S301 current config num 21 done
021'436 35 S301 current config num 21 done
021'436 35 S101 current config num 21 done
021'436 35 S202 current config num 21 done
021'436 35 S302 current config num 21 done
021'436 35 S100 current config num 21 done
021'436 35 S300 current config num 21 done
021'436 35 S201 current config num 21 done
021'436 35 S200 current config num 21 done
021'436 35 S102 current config num 21 done
021'491 35 S101 current config num 21 done
021'491 35 S202 current config num 21 done
021'492 35 S301 current config num 21 done
021'492 35 S100 current config num 21 done
021'492 35 S300 current config num 21 done
021'492 35 S201 current config num 21 done
021'492 35 S302 current config num 21 done
021'492 35 S200 current config num 21 done
021'492 35 S102 current config num 21 done
021'543 35 S200 current config num 21 done
021'544 35 S202 current config num 21 done
021'544 35 S301 current config num 21 done
021'544 35 S101 current config num 21 done
021'545 35 S300 current config num 21 done
021'545 35 S100 current config num 21 done
021'545 35 S201 current config num 21 done
021'545 35 S302 current config num 21 done
021'545 35 S102 current config num 21 done
021'589 28 S100 do request args:Key 6 type 3 num 21 Client 542732653461723544 Seq 4 
021'590 33 S100 start [544--4] as leader?
021'597 30 S100 apply index 188 key6 num 21 type 3   lastApplied 187
021'598 28 S100 [544--4] successed
021'598 28 S100 [544--4] ok 
021'598 28 S100 [544--4] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
021'598 36 S544 [4] clerk putAppend okkkkk
021'599 35 S300 current config num 21 done
021'599 35 S200 current config num 21 done
021'599 35 S301 current config num 21 done
021'599 35 S101 current config num 21 done
021'599 35 S202 current config num 21 done
021'599 35 S100 current config num 21 done
021'599 35 S201 current config num 21 done
021'611 35 S302 current config num 21 done
021'611 35 S102 current config num 21 done
021'647 28 S100 do request args:Key 5 type 3 num 21 Client 3482757038087095369 Seq 5 
021'647 33 S100 start [369--5] as leader?
021'652 28 S100 do request args:Key 8 type 3 num 21 Client 2953714763196401582 Seq 2 
021'653 33 S100 start [582--2] as leader?
021'670 28 S100 do request args:Key 9 type 3 num 21 Client 3620950086299709532 Seq 15 
021'670 28 S100 [532--15] successed
021'670 28 S100 [532--15] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
021'670 36 S532 [15] clerk putAppend okkkkk
021'678 28 S100 do request args:Key 7 type 3 num 21 Client 2972145661651991667 Seq 11 
021'680 35 S300 current config num 21 done
021'680 35 S200 current config num 21 done
021'680 35 S101 current config num 21 done
021'680 35 S301 current config num 21 done
021'680 35 S202 current config num 21 done
021'680 30 S102 apply index 188 key6 num 21 type 3   lastApplied 187
021'680 31 S102 used size: 352 / 300 
021'687 29 S102 do snapshot for raft 188 188,size 771
021'687 27 S2 raft apply snapshot offset 188 ,lastApplied 188,total log 190, size 289,log cap:3
021'687 31 S102 after snap shot size289 771
021'680 33 S100 start [667--11] as leader?
021'688 28 S100 do request args:Key 1 type 3 num 21 Client 418781717203629479 Seq 23 
021'697 30 S102 apply index 189 key5 num 21 type 3   lastApplied 188
021'697 31 S102 used size: 352 / 300 
021'697 29 S102 do snapshot for raft 189 189,size 772
021'698 27 S2 raft apply snapshot offset 189 ,lastApplied 190,total log 191, size 289,log cap:3
021'698 27 S2 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"8", ClientID:2953714763196401582, Seq:2, OptType:3, Opt:"6", Num:21}}
021'698 31 S102 after snap shot size289 772
021'699 30 S102 apply index 190 key8 num 21 type 3   lastApplied 189
021'699 33 S100 start [479--23] as leader?
021'697 35 S201 current config num 21 done
021'697 35 S302 current config num 21 done
021'699 35 S102 current config num 21 done
021'710 30 S101 apply index 188 key6 num 21 type 3   lastApplied 187
021'710 31 S101 used size: 414 / 300 
021'700 35 S100 current config num 21 done
021'710 30 S100 apply index 189 key5 num 21 type 3   lastApplied 188
021'710 31 S100 used size: 477 / 300 
021'713 29 S101 do snapshot for raft 188 188,size 771
021'714 27 S1 raft apply snapshot offset 188 ,lastApplied 190,total log 191, size 352,log cap:4
021'714 27 S1 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"8", ClientID:2953714763196401582, Seq:2, OptType:3, Opt:"6", Num:21}}
021'714 31 S101 after snap shot size352 771
021'714 30 S101 apply index 189 key5 num 21 type 3   lastApplied 188
021'714 31 S101 used size: 352 / 300 
021'714 29 S101 do snapshot for raft 189 189,size 772
021'716 29 S100 do snapshot for raft 189 189,size 772
021'716 27 S0 raft apply snapshot offset 189 ,lastApplied 191,total log 192, size 352,log cap:4
021'716 27 S0 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:11, OptType:3, Opt:"B", Num:21}}
021'717 31 S100 after snap shot size352 772
021'717 30 S100 apply index 190 key8 num 21 type 3   lastApplied 189
021'717 31 S100 used size: 352 / 300 
021'717 29 S100 do snapshot for raft 190 190,size 773
021'718 27 S0 raft apply snapshot offset 190 ,lastApplied 191,total log 192, size 289,log cap:3
021'718 27 S0 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"7", ClientID:2972145661651991667, Seq:11, OptType:3, Opt:"B", Num:21}}
021'718 31 S100 after snap shot size289 773
021'718 30 S100 apply index 191 key7 num 21 type 3   lastApplied 190
021'718 28 S100 [582--2] successed
021'718 28 S100 [582--2] ok 
021'718 28 S100 [582--2] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
021'718 28 S100 [369--5] successed
021'718 28 S100 [369--5] ok 
021'718 28 S100 [369--5] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
021'719 28 S100 do request args:Key 4 type 3 num 21 Client 132246879705026825 Seq 6 
021'719 33 S100 start [825--6] as leader?
021'719 28 S100 do request args:Key 3 type 3 num 21 Client 2238025532150463055 Seq 8 
021'722 30 S102 apply index 191 key7 num 21 type 3   lastApplied 190
021'722 31 S102 used size: 352 / 300 
021'723 29 S102 do snapshot for raft 191 191,size 774
021'723 27 S2 raft apply snapshot offset 191 ,lastApplied 191,total log 192, size 227,log cap:2
021'723 31 S102 after snap shot size227 774
021'724 36 S582 [2] clerk putAppend okkkkk
021'725 36 S369 [5] clerk putAppend okkkkk
021'728 27 S1 raft apply snapshot offset 189 ,lastApplied 190,total log 191, size 289,log cap:3
021'728 27 S1 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"8", ClientID:2953714763196401582, Seq:2, OptType:3, Opt:"6", Num:21}}
021'728 31 S101 after snap shot size289 772
021'728 30 S101 apply index 190 key8 num 21 type 3   lastApplied 189
021'729 30 S101 apply index 191 key7 num 21 type 3   lastApplied 190
021'729 31 S101 used size: 352 / 300 
021'730 29 S101 do snapshot for raft 191 191,size 774
021'730 27 S1 raft apply snapshot offset 191 ,lastApplied 191,total log 192, size 227,log cap:2
021'730 31 S101 after snap shot size227 774
021'732 33 S100 start [ 55--8] as leader?
021'732 28 S100 do request args:Key 0 type 3 num 21 Client 940626237948413081 Seq 10 
021'732 28 S100 [ 81--10] successed
021'732 28 S100 [ 81--10] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
021'733 28 S100 [667--11] successed
021'733 28 S100 [667--11] ok 
021'733 28 S100 [667--11] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
021'733 36 S81 [10] clerk putAppend okkkkk
021'734 30 S100 apply index 192 key1 num 21 type 3   lastApplied 191
021'734 31 S100 used size: 414 / 300 
021'734 35 S300 current config num 21 done
021'734 35 S101 current config num 21 done
021'734 35 S200 current config num 21 done
021'734 35 S301 current config num 21 done
021'734 35 S202 current config num 21 done
021'735 29 S100 do snapshot for raft 192 192,size 775
021'735 36 S667 [11] clerk putAppend okkkkk
021'735 27 S0 raft apply snapshot offset 192 ,lastApplied 192,total log 194, size 289,log cap:3
021'735 31 S100 after snap shot size289 775
021'735 28 S100 [479--23] successed
021'735 28 S100 [479--23] ok 
021'735 28 S100 [479--23] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
021'737 30 S101 apply index 192 key1 num 21 type 3   lastApplied 191
021'737 31 S101 used size: 352 / 300 
021'738 29 S101 do snapshot for raft 192 192,size 775
021'738 27 S1 raft apply snapshot offset 192 ,lastApplied 192,total log 194, size 289,log cap:3
021'738 31 S101 after snap shot size289 775
021'742 30 S100 apply index 193 key4 num 21 type 3   lastApplied 192
021'742 30 S100 apply index 194 key3 num 21 type 3   lastApplied 193
021'742 28 S100 [825--6] successed
021'742 28 S100 [825--6] ok 
021'742 28 S100 [825--6] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
021'742 36 S825 [6] clerk putAppend okkkkk
021'742 28 S100 [ 55--8] successed
021'743 28 S100 [ 55--8] ok 
021'743 28 S100 [ 55--8] putAppend return result&shardkv.PutAppendReply{Err:"OK"}
021'743 36 S55 [8] clerk putAppend okkkkk
021'743 30 S102 apply index 192 key1 num 21 type 3   lastApplied 191
021'743 31 S102 used size: 352 / 300 
021'746 36 S479 [23] clerk putAppend okkkkk
021'747 28 S100 do request args:Key 0 type 1 num 1 Client 2079820695267196558 Seq 10 
021'747 28 S100 [558--10] get return result&shardkv.GetReply{Err:"ErrWrongGroup", Value:""}
021'750 29 S102 do snapshot for raft 192 192,size 775
021'751 27 S2 raft apply snapshot offset 192 ,lastApplied 192,total log 194, size 289,log cap:3
021'751 31 S102 after snap shot size289 775
021'752 30 S101 apply index 193 key4 num 21 type 3   lastApplied 192
021'752 30 S101 apply index 194 key3 num 21 type 3   lastApplied 193
021'755 34 S101 check new config wanted 22
021'757 34 S200 check new config wanted 22
021'759 30 S102 apply index 193 key4 num 21 type 3   lastApplied 192
021'759 30 S102 apply index 194 key3 num 21 type 3   lastApplied 193
021'760 35 S302 current config num 21 done
021'760 35 S201 current config num 21 done
021'761 34 S202 check new config wanted 22
021'764 35 S100 current config num 21 done
021'764 35 S102 current config num 21 done
021'777 34 S102 check new config wanted 22
021'777 34 S201 check new config wanted 22
021'782 34 S301 check new config wanted 22
021'786 34 S100 check new config wanted 22
021'791 35 S202 current config num 21 done
021'791 35 S101 current config num 21 done
021'791 35 S300 current config num 21 done
021'791 35 S301 current config num 21 done
021'791 35 S200 current config num 21 done
021'801 34 S302 check new config wanted 22
021'811 35 S201 current config num 21 done
021'812 35 S302 current config num 21 done
021'812 34 S300 check new config wanted 22
021'814 35 S100 current config num 21 done
021'814 35 S102 current config num 21 done
021'841 35 S101 current config num 21 done
021'841 35 S300 current config num 21 done
021'841 35 S202 current config num 21 done
021'841 35 S301 current config num 21 done
021'841 35 S200 current config num 21 done
021'882 35 S102 current config num 21 done
021'885 35 S302 current config num 21 done
021'885 35 S201 current config num 21 done
021'885 35 S100 current config num 21 done
021'900 35 S101 current config num 21 done
021'900 35 S300 current config num 21 done
021'900 35 S202 current config num 21 done
021'900 35 S301 current config num 21 done
021'900 35 S200 current config num 21 done
021'936 35 S201 current config num 21 done
021'937 35 S302 current config num 21 done
021'937 35 S100 current config num 21 done
021'939 35 S102 current config num 21 done
021'950 35 S300 current config num 21 done
021'950 35 S202 current config num 21 done
021'950 35 S200 current config num 21 done
021'950 35 S101 current config num 21 done
021'950 35 S301 current config num 21 done
022'042 35 S201 current config num 21 done
022'042 35 S302 current config num 21 done
022'042 35 S100 current config num 21 done
022'043 35 S102 current config num 21 done
022'043 35 S300 current config num 21 done
022'043 35 S202 current config num 21 done
022'043 35 S101 current config num 21 done
022'043 35 S301 current config num 21 done
022'043 35 S200 current config num 21 done
022'094 35 S302 current config num 21 done
022'094 35 S100 current config num 21 done
022'094 35 S201 current config num 21 done
022'112 35 S102 current config num 21 done
022'112 35 S300 current config num 21 done
022'112 35 S202 current config num 21 done
022'112 35 S101 current config num 21 done
022'112 35 S301 current config num 21 done
022'114 35 S200 current config num 21 done
022'145 35 S100 current config num 21 done
022'145 35 S302 current config num 21 done
022'145 35 S201 current config num 21 done
022'163 35 S102 current config num 21 done
022'164 35 S300 current config num 21 done
022'164 35 S202 current config num 21 done
022'164 35 S101 current config num 21 done
022'164 35 S301 current config num 21 done
022'174 35 S200 current config num 21 done
022'187 28 S100 do request args:Key 0 type 1 num 21 Client 2079820695267196558 Seq 10 
022'188 33 S100 start [558--10] as leader?
022'200 35 S201 current config num 21 done
022'200 35 S100 current config num 21 done
022'200 35 S302 current config num 21 done
022'200 34 S102 check new config wanted 22
022'202 30 S100 apply index 195 key0 num 21 type 1   lastApplied 194
022'203 31 S100 used size: 339 / 300 
022'203 29 S100 do snapshot for raft 195 195,size 777
022'203 27 S0 raft apply snapshot offset 195 ,lastApplied 195,total log 195, size 86,log cap:1
022'203 31 S100 after snap shot size86 777
022'204 28 S100 [558--10] successed
022'205 28 S100 [558--10] ok 
022'205 28 S100 [558--10] get return result&shardkv.GetReply{Err:"OK", Value:"pEr4ICzmWaVb"}
022'206 36 S558 [10] clerk get okkkkk
022'207 28 S100 do request args:Key 1 type 1 num 21 Client 2079820695267196558 Seq 11 
022'209 34 S200 check new config wanted 22
022'210 34 S202 check new config wanted 22
022'210 34 S201 check new config wanted 22
022'210 34 S301 check new config wanted 22
022'211 34 S101 check new config wanted 22
022'222 33 S100 start [558--11] as leader?
022'223 35 S102 current config num 21 done
022'224 35 S300 current config num 21 done
022'224 35 S200 current config num 21 done
022'225 35 S101 current config num 21 done
022'225 35 S301 current config num 21 done
022'226 35 S202 current config num 21 done
022'240 30 S102 apply index 195 key0 num 21 type 1   lastApplied 194
022'241 31 S102 used size: 388 / 300 
022'241 29 S102 do snapshot for raft 195 195,size 777
022'242 27 S2 raft apply snapshot offset 195 ,lastApplied 195,total log 196, size 214,log cap:2
022'242 31 S102 after snap shot size214 777
022'245 30 S101 apply index 195 key0 num 21 type 1   lastApplied 194
022'245 31 S101 used size: 388 / 300 
022'246 29 S101 do snapshot for raft 195 195,size 777
022'246 27 S1 raft apply snapshot offset 195 ,lastApplied 195,total log 196, size 214,log cap:2
022'246 31 S101 after snap shot size214 777
022'232 34 S100 check new config wanted 22
022'232 34 S300 check new config wanted 22
022'248 30 S100 apply index 196 key1 num 21 type 1   lastApplied 195
022'248 28 S100 [558--11] successed
022'248 28 S100 [558--11] ok 
022'248 28 S100 [558--11] get return result&shardkv.GetReply{Err:"OK", Value:"VydUulPBemaqWkQhicJVcDtGO"}
022'249 36 S558 [11] clerk get okkkkk
022'252 28 S100 do request args:Key 2 type 1 num 21 Client 2079820695267196558 Seq 12 
022'253 33 S100 start [558--12] as leader?
022'254 35 S100 current config num 21 done
022'263 35 S201 current config num 21 done
022'265 30 S101 apply index 196 key1 num 21 type 1   lastApplied 195
022'267 35 S302 current config num 21 done
022'270 30 S102 apply index 196 key1 num 21 type 1   lastApplied 195
022'270 30 S100 apply index 197 key2 num 21 type 1   lastApplied 196
022'270 28 S100 [558--12] successed
022'270 28 S100 [558--12] ok 
022'270 28 S100 [558--12] get return result&shardkv.GetReply{Err:"OK", Value:"zk1EViIbur3mFzY3e5LB28AL83aBS"}
022'270 36 S558 [12] clerk get okkkkk
022'273 28 S100 do request args:Key 3 type 1 num 21 Client 2079820695267196558 Seq 13 
022'273 33 S100 start [558--13] as leader?
022'273 35 S102 current config num 21 done
022'275 35 S300 current config num 21 done
022'275 35 S200 current config num 21 done
022'275 35 S101 current config num 21 done
022'275 35 S301 current config num 21 done
022'278 35 S202 current config num 21 done
022'280 30 S102 apply index 197 key2 num 21 type 1   lastApplied 196
022'280 31 S102 used size: 312 / 300 
022'280 30 S100 apply index 198 key3 num 21 type 1   lastApplied 197
022'280 31 S100 used size: 312 / 300 
022'281 29 S100 do snapshot for raft 198 198,size 777
022'281 27 S0 raft apply snapshot offset 198 ,lastApplied 198,total log 198, size 86,log cap:1
022'281 31 S100 after snap shot size86 777
022'281 28 S100 [558--13] successed
022'281 28 S100 [558--13] ok 
022'281 28 S100 [558--13] get return result&shardkv.GetReply{Err:"OK", Value:"9CP5BEMRvv"}
022'282 36 S558 [13] clerk get okkkkk
022'283 30 S101 apply index 197 key2 num 21 type 1   lastApplied 196
022'283 31 S101 used size: 312 / 300 
022'284 29 S101 do snapshot for raft 197 197,size 777
022'284 27 S1 raft apply snapshot offset 197 ,lastApplied 197,total log 198, size 214,log cap:2
022'284 31 S101 after snap shot size214 777
022'286 30 S101 apply index 198 key3 num 21 type 1   lastApplied 197
022'288 28 S100 do request args:Key 4 type 1 num 21 Client 2079820695267196558 Seq 14 
022'289 33 S100 start [558--14] as leader?
022'290 29 S102 do snapshot for raft 197 197,size 777
022'290 27 S2 raft apply snapshot offset 197 ,lastApplied 198,total log 198, size 214,log cap:2
022'290 27 S2 last applied not snapshoted raft.LogEntry{Term:8, Command:shardkv.Command{Key:"3", ClientID:2079820695267196558, Seq:13, OptType:1, Opt:interface {}(nil), Num:21}}
022'291 31 S102 after snap shot size214 777
022'291 30 S102 apply index 198 key3 num 21 type 1   lastApplied 197
022'295 30 S100 apply index 199 key4 num 21 type 1   lastApplied 198
022'295 28 S100 [558--14] successed
022'295 28 S100 [558--14] ok 
022'295 28 S100 [558--14] get return result&shardkv.GetReply{Err:"OK", Value:"c3kdHX-W"}
022'299 36 S558 [14] clerk get okkkkk
022'299 28 S100 do request args:Key 5 type 1 num 21 Client 2079820695267196558 Seq 15 
022'300 33 S100 start [558--15] as leader?
022'301 34 S302 check new config wanted 22
022'306 35 S100 current config num 21 done
022'312 30 S102 apply index 199 key4 num 21 type 1   lastApplied 198
022'312 31 S102 used size: 312 / 300 
022'312 29 S102 do snapshot for raft 199 199,size 777
022'313 27 S2 raft apply snapshot offset 199 ,lastApplied 199,total log 200, size 214,log cap:2
022'313 31 S102 after snap shot size214 777
022'314 30 S100 apply index 200 key5 num 21 type 1   lastApplied 199
022'314 28 S100 [558--15] successed
022'314 28 S100 [558--15] ok 
022'314 28 S100 [558--15] get return result&shardkv.GetReply{Err:"OK", Value:"CiEPcnv"}
022'314 36 S558 [15] clerk get okkkkk
022'316 28 S100 do request args:Key 6 type 1 num 21 Client 2079820695267196558 Seq 16 
022'316 33 S100 start [558--16] as leader?
022'317 35 S302 current config num 21 done
022'317 30 S101 apply index 199 key4 num 21 type 1   lastApplied 198
022'318 31 S101 used size: 312 / 300 
022'318 29 S101 do snapshot for raft 199 199,size 777
022'319 27 S1 raft apply snapshot offset 199 ,lastApplied 199,total log 200, size 214,log cap:2
022'319 31 S101 after snap shot size214 777
022'319 35 S201 current config num 21 done
022'321 30 S101 apply index 200 key5 num 21 type 1   lastApplied 199
022'322 30 S100 apply index 201 key6 num 21 type 1   lastApplied 200
022'322 31 S100 used size: 312 / 300 
022'323 29 S100 do snapshot for raft 201 201,size 777
022'323 27 S0 raft apply snapshot offset 201 ,lastApplied 201,total log 201, size 86,log cap:1
022'323 31 S100 after snap shot size86 777
022'323 28 S100 [558--16] successed
022'323 28 S100 [558--16] ok 
022'323 28 S100 [558--16] get return result&shardkv.GetReply{Err:"OK", Value:"wApPRc"}
022'324 36 S558 [16] clerk get okkkkk
022'325 28 S100 do request args:Key 7 type 1 num 21 Client 2079820695267196558 Seq 17 
022'326 33 S100 start [558--17] as leader?
022'326 35 S301 current config num 21 done
022'326 35 S300 current config num 21 done
022'326 35 S102 current config num 21 done
022'330 30 S102 apply index 200 key5 num 21 type 1   lastApplied 199
022'330 35 S202 current config num 21 done
022'326 35 S101 current config num 21 done
022'326 35 S200 current config num 21 done
022'341 30 S100 apply index 202 key7 num 21 type 1   lastApplied 201
022'342 28 S100 [558--17] successed
022'342 28 S100 [558--17] ok 
022'342 28 S100 [558--17] get return result&shardkv.GetReply{Err:"OK", Value:"8WvG-aC2PazRB"}
022'342 30 S101 apply index 201 key6 num 21 type 1   lastApplied 200
022'342 31 S101 used size: 312 / 300 
022'343 29 S101 do snapshot for raft 201 201,size 777
022'343 27 S1 raft apply snapshot offset 201 ,lastApplied 201,total log 202, size 214,log cap:2
022'343 31 S101 after snap shot size214 777
022'343 30 S102 apply index 201 key6 num 21 type 1   lastApplied 200
022'343 31 S102 used size: 312 / 300 
022'344 29 S102 do snapshot for raft 201 201,size 777
022'344 27 S2 raft apply snapshot offset 201 ,lastApplied 201,total log 202, size 214,log cap:2
022'344 31 S102 after snap shot size214 777
022'345 36 S558 [17] clerk get okkkkk
022'346 28 S100 do request args:Key 8 type 1 num 21 Client 2079820695267196558 Seq 18 
022'346 33 S100 start [558--18] as leader?
022'367 35 S302 current config num 21 done
022'375 35 S100 current config num 21 done
022'380 35 S102 current config num 21 done
022'384 30 S100 apply index 203 key8 num 21 type 1   lastApplied 202
022'385 28 S100 [558--18] successed
022'385 28 S100 [558--18] ok 
022'385 28 S100 [558--18] get return result&shardkv.GetReply{Err:"OK", Value:"vHj6"}
022'385 30 S102 apply index 202 key7 num 21 type 1   lastApplied 201
022'385 30 S101 apply index 202 key7 num 21 type 1   lastApplied 201
022'386 36 S558 [18] clerk get okkkkk
022'387 28 S100 do request args:Key 9 type 1 num 21 Client 2079820695267196558 Seq 19 
022'387 33 S100 start [558--19] as leader?
022'390 35 S202 current config num 21 done
022'391 35 S201 current config num 21 done
022'416 35 S301 current config num 21 done
022'417 35 S300 current config num 21 done
022'426 35 S100 current config num 21 done
022'426 35 S200 current config num 21 done
022'426 35 S101 current config num 21 done
022'430 35 S302 current config num 21 done
022'443 30 S100 apply index 204 key9 num 21 type 1   lastApplied 203
022'443 31 S100 used size: 312 / 300 
022'444 29 S100 do snapshot for raft 204 204,size 777
022'444 27 S0 raft apply snapshot offset 204 ,lastApplied 204,total log 204, size 86,log cap:1
022'444 31 S100 after snap shot size86 777
022'446 28 S100 [558--19] successed
022'446 28 S100 [558--19] ok 
022'446 28 S100 [558--19] get return result&shardkv.GetReply{Err:"OK", Value:"lwvgJXJ4h-EkNx8lG"}
022'446 30 S101 apply index 203 key8 num 21 type 1   lastApplied 202
022'447 31 S101 used size: 312 / 300 
022'447 29 S101 do snapshot for raft 203 203,size 777
022'448 27 S1 raft apply snapshot offset 203 ,lastApplied 203,total log 204, size 214,log cap:2
022'448 31 S101 after snap shot size214 777
022'448 36 S558 [19] clerk get okkkkk
  ... Passed
022'448 32 S100 server killed######
022'448 32 S101 server killed######
022'448 32 S102 server killed######
022'448 32 S200 server killed######
022'448 32 S201 server killed######
022'448 32 S202 server killed######
022'448 32 S300 server killed######
022'449 32 S301 server killed######
022'449 32 S302 server killed######
PASS
022'439 35 S102 current config num 21 done
022'452 30 S102 apply index 203 key8 num 21 type 1   lastApplied 202
022'452 31 S102 used size: 312 / 300 
ok  	6.824/shardkv	22.492s
